(this.webpackJsonpgeometries=this.webpackJsonpgeometries||[]).push([[63],{1001:function(e,t,r){"use strict";r.d(t,"a",(function(){return h}));var i=r(9),a=r(2),n=r(3),o=r(5),s=r(6),l=r(0),c=(r(13),r(14),r(15),r(1)),u=r(8),b=(r(11),r(19),r(20),r(33)),y=r(793),p=r(159),d=r(931),f=r(414),v={visible:"visibleSublayers",definitionExpression:"layerDefs",labelingInfo:"hasDynamicLayers",labelsVisible:"hasDynamicLayers",opacity:"hasDynamicLayers",minScale:"visibleSublayers",maxScale:"visibleSublayers",renderer:"hasDynamicLayers",source:"hasDynamicLayers"},h=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(){var e;return Object(a.a)(this,r),(e=t.apply(this,arguments))._scale=null,e.view=null,e}return Object(n.a)(r,[{key:"destroy",value:function(){this.layer=this.view=null}},{key:"dynamicLayers",get:function(){if(!this.hasDynamicLayers)return null;var e=this.visibleSublayers.map((function(e){return e.toExportImageJSON()}));return e.length?JSON.stringify(e):null}},{key:"hasDynamicLayers",get:function(){return this.layer&&Object(d.a)(this.visibleSublayers,this.layer.serviceSublayers,this.layer)}},{key:"layer",set:function(e){var t=this;this._get("layer")!==e&&(this._set("layer",e),this.handles.remove("layer"),e&&this.handles.add([e.allSublayers.on("change",(function(){return t.notifyChange("visibleSublayers")})),e.on("sublayer-update",(function(e){return t.notifyChange(v[e.propertyName])}))],"layer"))}},{key:"layers",get:function(){var e=this.visibleSublayers;return e?e.length?"show:"+e.map((function(e){return e.id})).join(","):"show:-1":null}},{key:"layerDefs",get:function(){var e=this.visibleSublayers.filter((function(e){return null!=e.definitionExpression}));return e.length?JSON.stringify(e.reduce((function(e,t){return e[t.id]=t.definitionExpression,e}),{})):null}},{key:"scale",get:function(){return null!=this._scale?this._scale:this.view&&this.view.scale||0},set:function(e){this.view||(this._scale=e,this.notifyChange("scale"))}},{key:"version",get:function(){var e=this;e.layers,e.layerDefs,e.dynamicLayers,e.timeExtent;var t=e.layer;return t&&(t.dpi,t.imageFormat,t.imageTransparency,t.gdbVersion),(this._get("version")||0)+1},set:function(e){this._set("version",e)}},{key:"visibleSublayers",get:function(){var e=this,t=[];if(!this.layer)return t;var r=this.layer.sublayers;r&&r.forEach((function r(i){var a=e.scale,n=0===a,o=0===i.minScale||a<=i.minScale,s=0===i.maxScale||a>=i.maxScale;i.visible&&(n||o&&s)&&(i.sublayers?i.sublayers.forEach(r):t.unshift(i))}));var i=this._get("visibleSublayers");return!i||i.length!==t.length||i.some((function(e,r){return t[r]!==e}))?t:i}},{key:"toJSON",value:function(){var e=this.layer,t={dpi:e.dpi,format:e.imageFormat,transparent:e.imageTransparency,gdbVersion:e.gdbVersion||null};return this.hasDynamicLayers&&this.dynamicLayers?t.dynamicLayers=this.dynamicLayers:t=Object(i.a)(Object(i.a)({},t),{},{layers:this.layers,layerDefs:this.layerDefs}),t}}]),r}(Object(p.b)(b.a));Object(l.a)([Object(c.b)({readOnly:!0,dependsOn:["hasDynamicLayers","visibleSublayers"]})],h.prototype,"dynamicLayers",null),Object(l.a)([Object(c.b)({readOnly:!0,dependsOn:["visibleSublayers","layer.serviceSublayers","layer.capabilities"]})],h.prototype,"hasDynamicLayers",null),Object(l.a)([Object(c.b)()],h.prototype,"layer",null),Object(l.a)([Object(c.b)({readOnly:!0,dependsOn:["visibleSublayers"]})],h.prototype,"layers",null),Object(l.a)([Object(c.b)({readOnly:!0,dependsOn:["visibleSublayers"]})],h.prototype,"layerDefs",null),Object(l.a)([Object(c.b)({type:Number,dependsOn:["view.scale"]})],h.prototype,"scale",null),Object(l.a)([Object(c.b)(y.a)],h.prototype,"timeExtent",void 0),Object(l.a)([Object(c.b)({dependsOn:["layers","layerDefs","dynamicLayers","layer.dpi","layer.imageFormat","layer.imageTransparency","layer.gdbVersion","timeExtent"]})],h.prototype,"version",null),Object(l.a)([Object(c.b)({type:f.a})],h.prototype,"view",void 0),Object(l.a)([Object(c.b)({readOnly:!0,dependsOn:["layer.sublayers","scale"]})],h.prototype,"visibleSublayers",null),h=Object(l.a)([Object(u.a)("esri.layers.mixins.ExportImageParameters")],h)},1007:function(e,t,r){"use strict";r.r(t);var i=r(10),a=r.n(i),n=r(21),o=r(9),s=r(2),l=r(3),c=r(5),u=r(6),b=r(0),y=(r(13),r(4)),p=(r(14),r(15)),d=r(1),f=r(63),v=r(8),h=r(47),O=r(23),m=(r(11),r(19),r(231)),j=(r(20),r(16)),g=r(62),w=r(81),S=r(319),x=r(244),_=r(305),I=r(801),k=r(793),L=r(815),E=r(872),F=r(381),T=r(851),D=r(808),P=r(807),N=r(380),A=r(831),M=r(159),C=r(410),z=r(1008),R=r(954),V=r(931),J=r(1009),B=r(1001),U=function(e){Object(c.a)(r,e);var t=Object(u.a)(r);function r(){var e;Object(s.a)(this,r);for(var i=arguments.length,a=new Array(i),n=0;n<i;n++)a[n]=arguments[n];return(e=t.call.apply(t,[this].concat(a))).alwaysRefetch=!1,e.dpi=96,e.gdbVersion=null,e.imageFormat="png24",e.imageMaxHeight=2048,e.imageMaxWidth=2048,e.imageTransparency=!0,e.labelsVisible=!1,e.isReference=null,e.operationalLayerType="ArcGISMapServiceLayer",e.sourceJSON=null,e.sublayers=null,e.type="map-image",e.url=null,e}return Object(l.a)(r,[{key:"normalizeCtorArgs",value:function(e,t){return"string"==typeof e?Object(o.a)({url:e},t):e}},{key:"load",value:function(e){var t=this,r=Object(y.i)(e)?e.signal:null;return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["Map Service"]},e).then((function(){return t._fetchService(r)}),(function(){return t._fetchService(r)}))),Object(j.u)(this)}},{key:"readImageFormat",value:function(e,t){var r=t.supportedImageFormatTypes;return r&&r.indexOf("PNG32")>-1?"png32":"png24"}},{key:"writeSublayers",value:function(e,t,r,i){if(this.loaded&&e){var a=e.slice().reverse().flatten((function(e){var t=e.sublayers;return t&&t.toArray().reverse()})).toArray(),n=!1;if(this.capabilities&&this.capabilities.operations.supportsExportMap&&this.capabilities.exportMap.supportsDynamicLayers){var s=Object(m.d)(i.origin);if(3===s){var l=this.createSublayersForOrigin("service").sublayers;n=Object(V.c)(a,l,2)}else if(s>3){var c=this.createSublayersForOrigin("portal-item");n=Object(V.c)(a,c.sublayers,Object(m.d)(c.origin))}}var u=[],b=Object(o.a)({writeSublayerStructure:n},i),y=n;a.forEach((function(e){var t=e.write({},b);u.push(t),y=y||"user"===e.originOf("visible")})),u.some((function(e){return Object.keys(e).length>1}))&&(t.layers=u),y&&(t.visibleLayers=a.filter((function(e){return e.visible})).map((function(e){return e.id})))}}},{key:"createExportImageParameters",value:function(e,t,r,i){var a=i&&i.pixelRatio||1;e&&this.version>=10&&(e=e.clone().shiftCentralMeridian());var n=new B.a({layer:this,scale:Object(C.b)({extent:e,width:t})*a}),s=n.toJSON();n.destroy();var l=!i||!i.rotation||this.version<10.3?{}:{rotation:-i.rotation},c=e&&e.spatialReference,u=c.wkid||JSON.stringify(c.toJSON());s.dpi*=a;var b={};if(null!=i&&i.timeExtent){var y=i.timeExtent.toJSON(),p=y.start,d=y.end;b.time=p&&d&&p===d?""+p:"".concat(null==p?"null":p,",").concat(null==d?"null":d)}else this.timeInfo&&!this.timeInfo.hasLiveData&&(b.time="null,null");return Object(o.a)(Object(o.a)(Object(o.a)({bbox:e&&e.xmin+","+e.ymin+","+e.xmax+","+e.ymax,bboxSR:u,imageSR:u,size:t+","+r},s),l),b)}},{key:"fetchImage",value:function(){var e=Object(n.a)(a.a.mark((function e(t,r,i,n){var s,l,c;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s={responseType:"image"},n&&n.timestamp&&(s.query=Object(o.a)(Object(o.a)({},s.query),{},{_ts:n.timestamp})),n&&n.signal&&(s.signal=n.signal),this.customParameters&&Object.keys(this.customParameters).length&&(s.query=Object(o.a)(Object(o.a)({},this.customParameters),s.query)),l=this.parsedUrl.path+"/export",null==(c=Object(o.a)(Object(o.a)(Object(o.a)({},this.parsedUrl.query),this.createExportImageParameters(t,r,i,n)),{},{f:"image",_ts:this.alwaysRefetch?Date.now():null})).dynamicLayers||this.capabilities.exportMap.supportsDynamicLayers){e.next=5;break}return e.abrupt("return",Object(j.t)(new O.a("mapimagelayer:dynamiclayer-not-supported","service ".concat(this.url," doesn't support dynamic layers, which is required to be able to change the sublayer's order, rendering, labeling or source."),{query:c})));case 5:return s.query?s.query=Object(o.a)(Object(o.a)({},c),s.query):s.query=c,e.abrupt("return",Object(w.default)(l,s).then((function(e){return e.data})).catch((function(e){if(Object(j.n)(e))throw e;throw new O.a("mapimagelayer:image-fetch-error","Unable to load image: ".concat(l),{error:e})})));case 7:case"end":return e.stop()}}),e,this)})));return function(t,r,i,a){return e.apply(this,arguments)}}()},{key:"fetchRecomputedExtents",value:function(){var e=Object(n.a)(a.a.mark((function e(){var t,r,i,n,s,l,c,u,b=arguments;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=b.length>0&&void 0!==b[0]?b[0]:{},r=Object(o.a)(Object(o.a)({},t),{},{query:{returnUpdates:!0,f:"json"}}),e.next=4,Object(w.default)(this.url,r);case 4:return i=e.sent,n=i.data,s=n.extent,l=n.fullExtent,c=n.timeExtent,u=s||l,e.abrupt("return",{fullExtent:u&&g.a.fromJSON(u),timeExtent:c&&_.a.fromJSON({start:c[0],end:c[1]})});case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"loadAll",value:function(){var e=this;return Object(S.a)(this,(function(t){t(e.allSublayers)}))}},{key:"_fetchService",value:function(){var e=Object(n.a)(a.a.mark((function e(t){var r,i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.sourceJSON){e.next=2;break}return e.abrupt("return",void this.read(this.sourceJSON,{origin:"service",url:this.parsedUrl}));case 2:return e.next=4,Object(w.default)(this.parsedUrl.path,{query:Object(o.a)(Object(o.a)({f:"json"},this.parsedUrl.query),this.customParameters),signal:t});case 4:r=e.sent,i=r.data,r.ssl&&(this.url=this.url.replace(/^http:/i,"https:")),this.sourceJSON=i,this.read(i,{origin:"service",url:this.parsedUrl});case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),r}(Object(F.a)(Object(A.a)(Object(N.a)(Object(P.a)(Object(J.a)(Object(z.a)(Object(E.a)(Object(L.a)(Object(D.a)(Object(I.a)(Object(T.a)(Object(M.b)(x.a)))))))))))));Object(b.a)([Object(d.b)()],U.prototype,"alwaysRefetch",void 0),Object(b.a)([Object(d.b)()],U.prototype,"dpi",void 0),Object(b.a)([Object(d.b)()],U.prototype,"gdbVersion",void 0),Object(b.a)([Object(d.b)({json:{read:!1,write:!1}})],U.prototype,"popupEnabled",void 0),Object(b.a)([Object(d.b)()],U.prototype,"imageFormat",void 0),Object(b.a)([Object(f.a)("imageFormat",["supportedImageFormatTypes"])],U.prototype,"readImageFormat",null),Object(b.a)([Object(d.b)({json:{origins:{service:{read:{source:"maxImageHeight"}}}}})],U.prototype,"imageMaxHeight",void 0),Object(b.a)([Object(d.b)({json:{origins:{service:{read:{source:"maxImageWidth"}}}}})],U.prototype,"imageMaxWidth",void 0),Object(b.a)([Object(d.b)()],U.prototype,"imageTransparency",void 0),Object(b.a)([Object(d.b)({json:{read:!1,write:!1}})],U.prototype,"labelsVisible",void 0),Object(b.a)([Object(d.b)({type:Boolean,json:{read:!1,write:{enabled:!0,overridePolicy:function(){return{enabled:!1}}}}})],U.prototype,"isReference",void 0),Object(b.a)([Object(d.b)({type:["ArcGISMapServiceLayer"]})],U.prototype,"operationalLayerType",void 0),Object(b.a)([Object(d.b)()],U.prototype,"sourceJSON",void 0),Object(b.a)([Object(d.b)({json:{write:{ignoreOrigin:!0}}})],U.prototype,"sublayers",void 0),Object(b.a)([Object(h.a)("sublayers",{layers:{type:[R.a]},visibleLayers:{type:[p.a]}})],U.prototype,"writeSublayers",null),Object(b.a)([Object(d.b)({type:["show","hide","hide-children"]})],U.prototype,"listMode",void 0),Object(b.a)([Object(d.b)({json:{read:!1},readOnly:!0,value:"map-image"})],U.prototype,"type",void 0),Object(b.a)([Object(d.b)(k.j)],U.prototype,"url",void 0);var q=U=Object(b.a)([Object(v.a)("esri.layers.MapImageLayer")],U);t.default=q},1008:function(e,t,r){"use strict";r.d(t,"a",(function(){return w}));var i=r(12),a=r(9),n=r(10),o=r.n(n),s=r(21),l=r(2),c=r(3),u=r(5),b=r(6),y=r(0),p=(r(13),r(14),r(15),r(1)),d=r(63),f=r(8),v=r(11),h=(r(19),r(20),r(16)),O=r(44),m=r(62),j=r(81),g=r(793),w=function(e){var t=function(e){Object(u.a)(r,e);var t=Object(b.a)(r);function r(){var e;return Object(l.a)(this,r),(e=t.apply(this,arguments)).capabilities=void 0,e.copyright=null,e.fullExtent=null,e.legendEnabled=!0,e.spatialReference=null,e.version=null,e}return Object(c.a)(r,[{key:"readCapabilities",value:function(e,t){var r=t.capabilities&&t.capabilities.split(",").map((function(e){return e.toLowerCase().trim()}));if(!r)return{operations:{supportsQuery:!1,supportsExportMap:!1,supportsExportTiles:!1,supportsTileMap:!1},exportMap:null,exportTiles:null};var i=this.type,a=-1!==r.indexOf("query"),n=-1!==r.indexOf("map"),o=!!t.exportTilesAllowed,s=-1!==r.indexOf("tilemap"),l="tile"!==i&&!!t.supportsDynamicLayers,c="tile"!==i&&(!t.tileInfo||l),u="tile"!==i&&(!t.tileInfo||l);return{operations:{supportsQuery:a,supportsExportMap:n,supportsExportTiles:o,supportsTileMap:s},exportMap:n?{supportsSublayersChanges:"tile"!==i,supportsDynamicLayers:l,supportsSublayerVisibility:c,supportsSublayerDefinitionExpression:u}:null,exportTiles:o?{maxExportTilesCount:+t.maxExportTilesCount}:null}}},{key:"readVersion",value:function(e,t){var r=t.currentVersion;return r||(r=t.hasOwnProperty("capabilities")||t.hasOwnProperty("tables")?10:t.hasOwnProperty("supportedImageFormatTypes")?9.31:9.3),r}},{key:"fetchSublayerInfo",value:function(){var e=Object(s.a)(o.a.mark((function e(t,r){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetchAllLayersAndTables(r);case 2:return e.abrupt("return",this._allLayersAndTablesMap.get(t));case 3:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"fetchAllLayersAndTables",value:function(){var e=Object(s.a)(o.a.mark((function e(t){var r,n=this;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.load(t);case 2:return this._allLayersAndTablesPromise||(this._allLayersAndTablesPromise=Object(j.default)(Object(v.I)(this.url).path+"/layers",{responseType:"json",query:Object(a.a)({f:"json"},this.customParameters)}).then((function(e){n._allLayersAndTablesMap=new Map;var t,r=Object(i.a)(e.data.layers);try{for(r.s();!(t=r.n()).done;){var a=t.value;n._allLayersAndTablesMap.set(a.id,a)}}catch(o){r.e(o)}finally{r.f()}return{result:e.data}}),(function(e){return{error:e}}))),e.next=5,this._allLayersAndTablesPromise;case 5:if(r=e.sent,Object(h.w)(t),!("result"in r)){e.next=8;break}return e.abrupt("return",r.result);case 8:throw r.error;case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),r}(e);return Object(y.a)([Object(p.b)({readOnly:!0})],t.prototype,"capabilities",void 0),Object(y.a)([Object(d.a)("service","capabilities",["capabilities","exportTilesAllowed","maxExportTilesCount","supportsDynamicLayers","tileInfo"])],t.prototype,"readCapabilities",null),Object(y.a)([Object(p.b)({json:{read:{source:"copyrightText"}}})],t.prototype,"copyright",void 0),Object(y.a)([Object(p.b)({type:m.a})],t.prototype,"fullExtent",void 0),Object(y.a)([Object(p.b)({json:{origins:{service:{read:!1},"portal-item":{read:!1}}}})],t.prototype,"id",void 0),Object(y.a)([Object(p.b)({type:Boolean,json:{origins:{service:{read:{enabled:!1}}},read:{source:"showLegend"},write:{target:"showLegend"}}})],t.prototype,"legendEnabled",void 0),Object(y.a)([Object(p.b)(g.g)],t.prototype,"popupEnabled",void 0),Object(y.a)([Object(p.b)({type:O.a})],t.prototype,"spatialReference",void 0),Object(y.a)([Object(p.b)()],t.prototype,"version",void 0),Object(y.a)([Object(d.a)("version",["currentVersion","capabilities","tables","supportedImageFormatTypes"])],t.prototype,"readVersion",null),t=Object(y.a)([Object(f.a)("esri.layers.mixins.ArcGISMapService")],t)}},1009:function(e,t,r){"use strict";r.d(t,"a",(function(){return _}));var i=r(12),a=r(2),n=r(3),o=r(34),s=r(61),l=r(56),c=r(5),u=r(6),b=r(0),y=(r(13),r(14)),p=(r(15),r(98)),d=r(1),f=r(8),v=r(23),h=(r(11),r(19),r(231)),O=(r(20),r(41)),m=r(201),j=r(954),g=r(931),w=y.a.getLogger("esri.layers.TileLayer"),S=O.a.ofType(j.a);function x(e,t){e&&e.forEach((function(e){t(e),e.sublayers&&e.sublayers.length&&x(e.sublayers,t)}))}var _=function(e){var t=function(e){Object(c.a)(r,e);var t=Object(u.a)(r);function r(){var e;Object(a.a)(this,r);for(var i=arguments.length,n=new Array(i),s=0;s<i;s++)n[s]=arguments[s];return(e=t.call.apply(t,[this].concat(n))).allSublayers=new m.a({root:Object(o.a)(e),rootCollectionNames:["sublayers"],getChildrenFunction:function(e){return e.sublayers}}),e.sublayersSourceJSON={2:{},3:{},4:{},5:{}},e.watch("sublayers",(function(t,r){return e._handleSublayersChange(t,r)}),!0),e}return Object(n.a)(r,[{key:"readSublayers",value:function(e,t){if(t&&e){var r=this.sublayersSourceJSON,i=Object(h.d)(t.origin);if(!(i<2)&&(r[i]={context:t,visibleLayers:e.visibleLayers||r[i].visibleLayers,layers:e.layers||r[i].layers},!(i>2))){this._set("serviceSublayers",this.createSublayersForOrigin("service").sublayers);var a=this.createSublayersForOrigin("web-document"),n=a.sublayers,o=a.origin,s=Object(p.a)(this);s.setDefaultOrigin(o),this._set("sublayers",new S(n)),s.setDefaultOrigin("user")}}}},{key:"findSublayerById",value:function(e){return this.allSublayers.find((function(t){return t.id===e}))}},{key:"createServiceSublayers",value:function(){return this.createSublayersForOrigin("service").sublayers}},{key:"createSublayersForOrigin",value:function(e){var t,r=Object(h.d)("web-document"===e?"web-map":e),a=2,n=this.sublayersSourceJSON[2].layers,o=this.sublayersSourceJSON[2].context,s=null,l=[3,4,5].filter((function(e){return e<=r})),c=Object(i.a)(l);try{for(c.s();!(t=c.n()).done;){var u=t.value,b=this.sublayersSourceJSON[u];Object(g.b)(b.layers)&&(a=u,n=b.layers,o=b.context,b.visibleLayers&&(s={visibleLayers:b.visibleLayers,context:b.context}))}}catch(A){c.e(A)}finally{c.f()}var y,p=[3,4,5].filter((function(e){return e>a&&e<=r})),d=null,f=Object(i.a)(p);try{for(f.s();!(y=f.n()).done;){var v=y.value,O=this.sublayersSourceJSON[v],m=O.layers,w=O.visibleLayers,_=O.context;m&&(d={layers:m,context:_}),w&&(s={visibleLayers:w,context:_})}}catch(A){f.e(A)}finally{f.f()}var I=function(e,t){var r=[],i={};return e?(e.forEach((function(e){var a=new j.a;if(a.read(e,t),i[a.id]=a,null!=e.parentLayerId&&-1!==e.parentLayerId){var n=i[e.parentLayerId];n.sublayers||(n.sublayers=[]),n.sublayers.unshift(a)}else r.unshift(a)})),r):r}(n,o),k=new Map,L=new Set;if(d){var E,F=Object(i.a)(d.layers);try{for(F.s();!(E=F.n()).done;){var T=E.value;k.set(T.id,T)}}catch(A){F.e(A)}finally{F.f()}}if(s){var D,P=Object(i.a)(s.visibleLayers);try{for(P.s();!(D=P.n()).done;){var N=D.value;L.add(N)}}catch(A){P.e(A)}finally{P.f()}}return x(I,(function(e){d&&e.read(k.get(e.id),d.context),s&&e.read({defaultVisibility:L.has(e.id)},s.context)})),{origin:Object(h.b)(a),sublayers:new S({items:I})}}},{key:"read",value:function(e,t){Object(s.a)(Object(l.a)(r.prototype),"read",this).call(this,e,t),this.readSublayers(e,t)}},{key:"_handleSublayersChange",value:function(e,t){var r=this;t&&(t.forEach((function(e){e.parent=null,e.layer=null})),this.handles.remove("sublayers-owner")),e&&(e.forEach((function(e){e.parent=r,e.layer=r})),this.handles.add([e.on("after-add",(function(e){var t=e.item;t.parent=r,t.layer=r})),e.on("after-remove",(function(e){var t=e.item;t.parent=null,t.layer=null}))],"sublayers-owner"),"tile"===this.type&&this.handles.add(e.on("before-changes",(function(e){w.error(new v.a("tilelayer:sublayers-non-modifiable","Sublayer can't be added, moved, or removed from the layer's sublayers",{layer:r})),e.preventDefault()})),"sublayers-owner"))}}]),r}(e);return Object(b.a)([Object(d.b)({readOnly:!0})],t.prototype,"allSublayers",void 0),Object(b.a)([Object(d.b)({readOnly:!0,type:O.a.ofType(j.a)})],t.prototype,"serviceSublayers",void 0),Object(b.a)([Object(d.b)({value:null,type:S,json:{read:!1,write:{allowNull:!0,ignoreOrigin:!0}}})],t.prototype,"sublayers",void 0),Object(b.a)([Object(d.b)({readOnly:!0})],t.prototype,"sublayersSourceJSON",void 0),t=Object(b.a)([Object(f.a)("esri.layers.mixins.SublayersOwner")],t),t}},796:function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var i=r(12),a=r(2),n=r(3);function o(e){return"date"===e.type||"esriFieldTypeDate"===e.type}function s(e){return e.toLowerCase().trim()}var l=function(){function e(t){if(Object(a.a)(this,e),this.fields=t,this._fieldsMap=new Map,this._dateFieldsSet=new Set,this.dateFields=[],t){var r,n=[],l=Object(i.a)(t);try{for(l.s();!(r=l.n()).done;){var c=r.value,u=c&&c.name;if(u){var b=s(u);this._fieldsMap.set(u,c),this._fieldsMap.set(b,c),n.push(b),o(c)&&(this.dateFields.push(c),this._dateFieldsSet.add(c))}}}catch(y){l.e(y)}finally{l.f()}n.sort(),this.uid=n.join(",")}}return Object(n.a)(e,[{key:"destroy",value:function(){this._fieldsMap.clear()}},{key:"has",value:function(e){return null!=this.get(e)}},{key:"get",value:function(e){return null!=e?this._fieldsMap.get(e)||this._fieldsMap.get(s(e)):void 0}},{key:"isDateField",value:function(e){return this._dateFieldsSet.has(this.get(e))}},{key:"normalizeFieldName",value:function(e){var t=this.get(e);if(t)return t.name}}]),e}()},798:function(e,t,r){"use strict";r.d(t,"a",(function(){return y})),r.d(t,"b",(function(){return d})),r.d(t,"c",(function(){return v})),r.d(t,"d",(function(){return f})),r.d(t,"e",(function(){return p}));r(13);var i=r(4),a=r(110),n=r(150),o=r(118),s=r(233),l=r(804),c=o.a.fromJSON(l.a),u=a.a.fromJSON(l.c),b=n.a.fromJSON(l.b),y=s.a.fromJSON(l.d);function p(e){if(Object(i.h)(e))return null;switch(e.type){case"mesh":return null;case"point":case"multipoint":return c;case"polyline":return u;case"polygon":case"extent":return b}return null}var d=o.a.fromJSON(l.e),f=a.a.fromJSON(l.g),v=n.a.fromJSON(l.f)},799:function(e,t,r){"use strict";var i,a=r(2),n=r(3),o=r(5),s=r(6),l=r(0),c=(r(13),r(24)),u=(r(14),r(15),r(1)),b=r(50),y=r(63),p=r(8),d=r(47),f=(r(11),r(19),r(20),r(28)),v=r(149),h=r(811),O=i=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(){var e;return Object(a.a)(this,r),(e=t.apply(this,arguments)).expression=null,e.title=null,e.value=null,e}return Object(n.a)(r,[{key:"readExpression",value:function(e,t){return t.value?Object(h.a)(t.value):e}},{key:"writeExpression",value:function(e,t,r){null!=this.value&&(e=Object(h.a)(this.value)),t[r]=e}},{key:"clone",value:function(){return new i({expression:this.expression,title:this.title,value:this.value})}}]),r}(f.a);Object(l.a)([Object(u.b)({type:String,json:{write:{allowNull:!0}}})],O.prototype,"expression",void 0),Object(l.a)([Object(u.b)({type:String,json:{write:!0,origins:{"web-scene":{write:!1}}}})],O.prototype,"title",void 0),Object(l.a)([Object(u.b)({json:{read:!1,write:!1}})],O.prototype,"value",void 0),Object(l.a)([Object(y.a)("expression",["expression","value"])],O.prototype,"readExpression",null),Object(l.a)([Object(d.a)("expression")],O.prototype,"writeExpression",null);var m,j=O=i=Object(l.a)([Object(p.a)("esri.layers.support.LabelExpressionInfo")],O),g=r(798),w=new b.a({esriServerPointLabelPlacementAboveCenter:"above-center",esriServerPointLabelPlacementAboveLeft:"above-left",esriServerPointLabelPlacementAboveRight:"above-right",esriServerPointLabelPlacementBelowCenter:"below-center",esriServerPointLabelPlacementBelowLeft:"below-left",esriServerPointLabelPlacementBelowRight:"below-right",esriServerPointLabelPlacementCenterCenter:"center-center",esriServerPointLabelPlacementCenterLeft:"center-left",esriServerPointLabelPlacementCenterRight:"center-right",esriServerLinePlacementAboveAfter:"above-after",esriServerLinePlacementAboveAlong:"above-along",esriServerLinePlacementAboveBefore:"above-before",esriServerLinePlacementAboveStart:"above-start",esriServerLinePlacementAboveEnd:"above-end",esriServerLinePlacementBelowAfter:"below-after",esriServerLinePlacementBelowAlong:"below-along",esriServerLinePlacementBelowBefore:"below-before",esriServerLinePlacementBelowStart:"below-start",esriServerLinePlacementBelowEnd:"below-end",esriServerLinePlacementCenterAfter:"center-after",esriServerLinePlacementCenterAlong:"center-along",esriServerLinePlacementCenterBefore:"center-before",esriServerLinePlacementCenterStart:"center-start",esriServerLinePlacementCenterEnd:"center-end",esriServerPolygonPlacementAlwaysHorizontal:"always-horizontal"},{ignoreUnknown:!0});function S(e){return!e||"service"!==e.origin&&!(e.layer&&"map-image"===e.layer.type)}var x=m=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var i;return Object(a.a)(this,r),(i=t.call(this,e)).type="label",i.name=null,i.deconflictionStrategy="static",i.labelExpression=null,i.labelExpressionInfo=null,i.labelPlacement=null,i.maxScale=0,i.minScale=0,i.symbol=g.a,i.useCodedValues=void 0,i.where=null,i}return Object(n.a)(r,[{key:"readLabelExpression",value:function(e,t){var r=t.labelExpressionInfo;if(!r||!r.value&&!r.expression)return e}},{key:"writeLabelExpression",value:function(e,t,r,i){if(this.labelExpressionInfo&&(S(i)||i&&"service"===i.origin))if(null!=this.labelExpressionInfo.value)e=Object(h.f)(this.labelExpressionInfo.value);else if(null!=this.labelExpressionInfo.expression){var a=Object(h.e)(this.labelExpressionInfo.expression);a&&(e="["+a+"]")}null!=e&&(t[r]=e)}},{key:"writeLabelExpressionInfo",value:function(e,t,r,i){if(null==e&&null!=this.labelExpression&&S(i))e=new j({expression:this.getLabelExpressionArcade()});else if(!e)return;var a=e.toJSON(i);a.expression&&(t[r]=a)}},{key:"writeMaxScale",value:function(e,t){(e||this.minScale)&&(t.maxScale=e)}},{key:"writeMinScale",value:function(e,t){(e||this.maxScale)&&(t.minScale=e)}},{key:"getLabelExpression",value:function(){return Object(h.b)(this)}},{key:"getLabelExpressionArcade",value:function(){return Object(h.c)(this)}},{key:"getLabelExpressionSingleField",value:function(){return Object(h.d)(this)}},{key:"hash",value:function(){return JSON.stringify(this)}},{key:"clone",value:function(){return new m({deconflictionStrategy:this.deconflictionStrategy,labelExpression:this.labelExpression,labelExpressionInfo:Object(c.a)(this.labelExpressionInfo),labelPlacement:this.labelPlacement,maxScale:this.maxScale,minScale:this.minScale,name:this.name,symbol:Object(c.a)(this.symbol),where:this.where,useCodedValues:this.useCodedValues})}}],[{key:"evaluateWhere",value:function(e,t){var r=function(e,t,r){switch(t){case"=":return e==r;case"<>":return e!=r;case">":return e>r;case">=":return e>=r;case"<":return e<r;case"<=":return e<=r}return!1};try{if(null==e)return!0;var i=e.split(" ");if(3===i.length)return r(t[i[0]],i[1],i[2]);if(7===i.length){var a=r(t[i[0]],i[1],i[2]),n=i[3],o=r(t[i[4]],i[5],i[6]);switch(n){case"AND":return a&&o;case"OR":return a||o}}return!1}catch(t){console.log("Error.: can't parse = "+e)}}}]),r}(f.a);Object(l.a)([Object(u.b)({type:String,json:{write:!0}})],x.prototype,"name",void 0),Object(l.a)([Object(u.b)({type:String,json:{write:!0,default:"static",origins:{"web-scene":{write:!1}}}})],x.prototype,"deconflictionStrategy",void 0),Object(l.a)([Object(u.b)({type:String,json:{write:{allowNull:!0}}})],x.prototype,"labelExpression",void 0),Object(l.a)([Object(y.a)("labelExpression")],x.prototype,"readLabelExpression",null),Object(l.a)([Object(d.a)("labelExpression")],x.prototype,"writeLabelExpression",null),Object(l.a)([Object(u.b)({type:j,json:{write:{overridePolicy:function(e,t,r){return S(r)?{allowNull:!0}:{enabled:!1}}}}})],x.prototype,"labelExpressionInfo",void 0),Object(l.a)([Object(d.a)("labelExpressionInfo")],x.prototype,"writeLabelExpressionInfo",null),Object(l.a)([Object(u.b)({type:w.apiValues,json:{type:w.jsonValues,read:w.read,write:w.write}})],x.prototype,"labelPlacement",void 0),Object(l.a)([Object(u.b)({type:Number})],x.prototype,"maxScale",void 0),Object(l.a)([Object(d.a)("maxScale")],x.prototype,"writeMaxScale",null),Object(l.a)([Object(u.b)({type:Number})],x.prototype,"minScale",void 0),Object(l.a)([Object(d.a)("minScale")],x.prototype,"writeMinScale",null),Object(l.a)([Object(u.b)({types:v.d,json:{origins:{"web-scene":{types:v.g,write:v.j,default:null}},write:v.j,default:null}})],x.prototype,"symbol",void 0),Object(l.a)([Object(u.b)({type:Boolean,json:{write:!0}})],x.prototype,"useCodedValues",void 0),Object(l.a)([Object(u.b)({type:String,json:{write:!0}})],x.prototype,"where",void 0);var _=x=m=Object(l.a)([Object(p.a)("esri.layers.support.LabelClass")],x);t.a=_},803:function(e,t,r){"use strict";var i,a=r(2),n=r(3),o=r(5),s=r(6),l=r(0),c=(r(13),r(14),r(15),r(1)),u=r(8),b=(r(11),r(19),r(20),r(28)),y=r(174),p=i=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var i;return Object(a.a)(this,r),(i=t.call(this,e)).value=0,i.unit="milliseconds",i}return Object(n.a)(r,[{key:"toMilliseconds",value:function(){return this.value*y.b[this.unit]}},{key:"clone",value:function(){return new i({value:this.value,unit:this.unit})}}]),r}(b.a);Object(l.a)([Object(c.b)({type:Number,json:{write:!0},nonNullable:!0})],p.prototype,"value",void 0),Object(l.a)([Object(c.b)({type:y.d.apiValues,json:{type:y.d.jsonValues,read:y.d.read,write:y.d.write},nonNullable:!0})],p.prototype,"unit",void 0);var d=p=i=Object(l.a)([Object(u.a)("esri.TimeInterval")],p);t.a=d},804:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return o})),r.d(t,"c",(function(){return n})),r.d(t,"d",(function(){return s})),r.d(t,"e",(function(){return l})),r.d(t,"f",(function(){return u})),r.d(t,"g",(function(){return c}));var i=[252,146,31,255],a={type:"esriSMS",style:"esriSMSCircle",size:6,color:i,outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[153,153,153,255]}},n={type:"esriSLS",style:"esriSLSSolid",width:.75,color:i},o={type:"esriSFS",style:"esriSFSSolid",color:[252,146,31,196],outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[255,255,255,191]}},s={type:"esriTS",color:[255,255,255,255],font:{family:"arial-unicode-ms",size:10,weight:"bold"},horizontalAlignment:"center",kerning:!0,haloColor:[0,0,0,255],haloSize:1,rotated:!1,text:"",xoffset:0,yoffset:0,angle:0},l={type:"esriSMS",style:"esriSMSCircle",color:[0,0,0,255],outline:null,size:10.5},c={type:"esriSLS",style:"esriSLSSolid",color:[0,0,0,255],width:1.5},u={type:"esriSFS",style:"esriSFSSolid",color:[0,0,0,255],outline:null}},807:function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var i=r(2),a=r(3),n=r(5),o=r(6),s=r(0),l=(r(13),r(14),r(15),r(1)),c=r(8),u=(r(11),r(19),r(20),function(e){var t=function(e){Object(n.a)(r,e);var t=Object(o.a)(r);function r(){var e;return Object(i.a)(this,r),(e=t.apply(this,arguments)).refreshInterval=0,e}return Object(a.a)(r,[{key:"refresh",value:function(){this.emit("refresh")}}]),r}(e);return Object(s.a)([Object(l.b)({type:Number,cast:function(e){return e>=.1?e:e<=0?0:.1},json:{write:!0,origins:{"web-document":{write:!0}}}})],t.prototype,"refreshInterval",void 0),t=Object(s.a)([Object(c.a)("esri.layers.mixins.RefreshableLayer")],t)})},810:function(e,t,r){"use strict";r.d(t,"a",(function(){return h})),r.d(t,"b",(function(){return f})),r.d(t,"c",(function(){return v}));var i=r(26),a=r(12),n=r(4),o=r(98),s=r(33),l=r(41),c=["esri.Color","esri.portal.Portal","esri.symbols.support.Symbol3DAnchorPosition2D","esri.symbols.support.Symbol3DAnchorPosition3D"];function u(e){return e instanceof s.a}function b(e){return e instanceof l.a?Object.keys(e.items):u(e)?Object(o.a)(e).keys():e?Object.keys(e):[]}function y(e,t){return e instanceof l.a?e.items[t]:e[t]}function p(e){return e?e.declaredClass:null}function d(e,t){var r=e.diff;if(r&&"function"==typeof r)return r(e,t);var o=b(e),s=b(t);if(0!==o.length||0!==s.length){if(!o.length||!s.length||function(e,t){return!(!Array.isArray(e)||!Array.isArray(t))&&e.length!==t.length}(e,t))return{type:"complete",oldValue:e,newValue:t};var l,f=s.filter((function(e){return-1===o.indexOf(e)})),v=o.filter((function(e){return-1===s.indexOf(e)})),h=o.filter((function(r){return s.indexOf(r)>-1&&y(e,r)!==y(t,r)})).concat(f,v).sort(),O=p(e);if(O&&c.indexOf(O)>-1&&h.length)return{type:"complete",oldValue:e,newValue:t};var m,j=u(e)&&u(t),g=Object(a.a)(h);try{for(g.s();!(m=g.n()).done;){var w=m.value,S=y(e,w),x=y(t,w),_=void 0;(j||"function"!=typeof S&&"function"!=typeof x)&&S!==x&&(null==S&&null==x||(_=r&&r[w]&&"function"==typeof r[w]?r[w](S,x):"object"==typeof S&&"object"==typeof x&&p(S)===p(x)?d(S,x):{type:"complete",oldValue:S,newValue:x},Object(n.i)(_)&&(Object(n.i)(l)?l.diff[w]=_:l={type:"partial",diff:Object(i.a)({},w,_)})))}}catch(I){g.e(I)}finally{g.f()}return l}}function f(e,t){if(Object(n.h)(e))return!1;var r,i=t.split("."),o=e,s=Object(a.a)(i);try{for(s.s();!(r=s.n()).done;){var l=r.value;if("complete"===o.type)return!0;if("partial"!==o.type)return!1;var c=o.diff[l];if(!c)return!1;o=c}}catch(u){s.e(u)}finally{s.f()}return!0}function v(e,t){var r,i=Object(a.a)(t);try{for(i.s();!(r=i.n()).done;){if(f(e,r.value))return!0}}catch(n){i.e(n)}finally{i.f()}return!1}function h(e,t){if("function"!=typeof e&&"function"!=typeof t&&(e||t))return!e||!t||"object"==typeof e&&"object"==typeof t&&p(e)!==p(t)?{type:"complete",oldValue:e,newValue:t}:d(e,t)}},811:function(e,t,r){"use strict";r.d(t,"a",(function(){return y})),r.d(t,"b",(function(){return c})),r.d(t,"c",(function(){return u})),r.d(t,"d",(function(){return b})),r.d(t,"e",(function(){return h})),r.d(t,"f",(function(){return l}));var i=r(108),a=new RegExp("__begin__","ig"),n=new RegExp("__end__","ig"),o=new RegExp("^__begin__","i"),s=new RegExp("__end__$","i");function l(e){return e.replace(new RegExp("\\{","g"),"[").replace(new RegExp("\\}","g"),"]")}function c(e){var t={expression:"",type:"none"};return e.labelExpressionInfo?e.labelExpressionInfo.value?(t.expression=e.labelExpressionInfo.value,t.type="conventional"):e.labelExpressionInfo.expression&&(t.expression=e.labelExpressionInfo.expression,t.type="arcade"):null!=e.labelExpression&&(t.expression=function(e){return e.replace(new RegExp("\\[","g"),"{").replace(new RegExp("\\]","g"),"}")}(e.labelExpression),t.type="conventional"),t}function u(e){var t=c(e);if(!t)return null;switch(t.type){case"conventional":return y(t.expression);case"arcade":return t.expression}return null}function b(e){var t=c(e);if(!t)return null;switch(t.type){case"conventional":return function(e){var t=e.match(p);return t&&t[1].trim()||null}(t.expression);case"arcade":return h(t.expression)}return null}function y(e){var t;return e?(t=Object(i.c)(e,(function(e){return'__begin__$feature["'+e+'"]__end__'})),t=o.test(t)?t.replace(o,""):'"'+t,t=(t=s.test(t)?t.replace(s,""):t+'"').replace(a,'" + ').replace(n,' + "')):t='""',t}var p=/^\s*\{([^}]+)\}\s*$/i;var d=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])([\w\s]+)(\2)\]));?\s*$/i,f=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])([\w\s]+)(\2)\]));?\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])(\1|\3)(\5)\s*\));?\s*$/i,v=/^\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])([\w\s]+)(\1)\s*\));?\s*$/i;function h(e){if(!e)return null;var t=d.exec(e)||f.exec(e);return t?t[1]||t[3]:(t=v.exec(e))?t[2]:null}},812:function(e,t,r){"use strict";r.d(t,"a",(function(){return l})),r.d(t,"b",(function(){return c})),r.d(t,"c",(function(){return u}));var i=r(32),a=r(12),n=r(2),o=r(3),s=r(129),l=-3,c=function(){function e(t,r,i){Object(n.a)(this,e),this._namespace=t,this._storage=r,this._removeFunc=!1,this._hit=0,this._miss=0,this._storage.register(this),this._namespace+=":",i&&(this._storage.registerRemoveFunc(this._namespace,i),this._removeFunc=!0)}return Object(o.a)(e,[{key:"namespace",get:function(){return this._namespace.slice(0,-1)}},{key:"hitRate",get:function(){return this._hit/(this._hit+this._miss)}},{key:"size",get:function(){return this._storage.size}},{key:"maxSize",get:function(){return this._storage.maxSize}},{key:"resetHitRate",value:function(){this._hit=this._miss=0}},{key:"destroy",value:function(){this._storage.clear(this._namespace),this._removeFunc&&this._storage.deregisterRemoveFunc(this._namespace),this._storage.deregister(this)}},{key:"put",value:function(e,t,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;this._storage.put(this._namespace+e,t,r,i)}},{key:"get",value:function(e){var t=this._storage.get(this._namespace+e);return void 0===t?++this._miss:++this._hit,t}},{key:"pop",value:function(e){var t=this._storage.pop(this._namespace+e);return void 0===t?++this._miss:++this._hit,t}},{key:"updateSize",value:function(e,t,r){this._storage.updateSize(this._namespace+e,t,r)}},{key:"clear",value:function(){this._storage.clear(this._namespace)}},{key:"clearAll",value:function(){this._storage.clearAll()}},{key:"getStats",value:function(){return this._storage.getStats()}},{key:"resetStats",value:function(){this._storage.resetStats()}}]),e}(),u=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10485760;Object(n.a)(this,e),this._maxSize=t,this._db=new Map,this._size=0,this._hit=0,this._miss=0,this._removeFuncs=[],this._users=new s.a}return Object(o.a)(e,[{key:"register",value:function(e){this._users.push(e)}},{key:"deregister",value:function(e){this._users.removeUnordered(e)}},{key:"registerRemoveFunc",value:function(e,t){this._removeFuncs.push([e,t])}},{key:"deregisterRemoveFunc",value:function(e){this._removeFuncs=this._removeFuncs.filter((function(t){return t[0]!==e}))}},{key:"size",get:function(){return this._size}},{key:"maxSize",get:function(){return this._maxSize},set:function(e){this._maxSize=Math.max(e,0),this._checkSizeLimit()}},{key:"put",value:function(e,t,r,i){var a=this._db.get(e);if(a&&(this._size-=a.size,this._db.delete(e),a.entry!==t&&this._notifyRemoved(e,a.entry)),r>this._maxSize)this._notifyRemoved(e,t);else if(void 0!==t)if(!r||r<0)console.warn("Refusing to cache entry with invalid size "+r);else{var n=1+Math.max(i,-3)- -3;this._db.set(e,{entry:t,size:r,lifetime:n,lives:n}),this._size+=r,this._checkSizeLimit()}else console.warn("Refusing to cache undefined entry ")}},{key:"updateSize",value:function(e,t,r){var i=this._db.get(e);i&&i.entry===t&&(this._size-=i.size,r>this._maxSize?this._notifyRemoved(e,t):(i.size=r,this._size+=r,this._checkSizeLimit()))}},{key:"pop",value:function(e){var t=this._db.get(e);if(t)return this._size-=t.size,this._db.delete(e),++this._hit,t.entry;++this._miss}},{key:"get",value:function(e){var t=this._db.get(e);if(void 0!==t)return this._db.delete(e),t.lives=t.lifetime,this._db.set(e,t),++this._hit,t.entry;++this._miss}},{key:"getStats",value:function(){var e=this,t={Size:Math.round(this._size/1048576)+"/"+Math.round(this._maxSize/1048576)+"MB","Hit rate":Math.round(100*this._getHitRate())+"%",Entries:this._db.size.toString()},r={},i=new Array;this._db.forEach((function(t,a){var n=t.lifetime;i[n]=(i[n]||0)+t.size,e._users.forAll((function(e){var i=e.namespace;if(a.startsWith(i)){var n=r[i]||0;r[i]=n+t.size}}))}));var a={};this._users.forAll((function(e){var t=e.namespace;if(!isNaN(e.hitRate)&&e.hitRate>0){var i=r[t]||0;r[t]=i,a[t]=Math.round(100*e.hitRate)+"%"}else a[t]="0%"}));var n=Object.keys(r);n.forEach((function(t){return r[t]=r[t]/e._size*100})),n.sort((function(e,t){return r[t]-r[e]})),n.forEach((function(e){return t[e]=Math.round(r[e])+"% / "+a[e]}));for(var o=i.length-1;o>=0;--o){var s=i[o];s&&(t["Priority "+(o+-3-1)]=Math.round(s/this.size*100)+"%")}return t}},{key:"resetStats",value:function(){this._hit=this._miss=0,this._users.forAll((function(e){return e.resetHitRate()}))}},{key:"clear",value:function(e){var t=this;this._db.forEach((function(r,i){i.startsWith(e)&&(t._size-=r.size,t._db.delete(i),t._notifyRemoved(i,r.entry))}))}},{key:"clearAll",value:function(){var e=this;this._db.forEach((function(t,r){return e._notifyRemoved(r,t.entry)})),this._size=0,this._db.clear()}},{key:"_getHitRate",value:function(){return this._hit/(this._hit+this._miss)}},{key:"_notifyRemoved",value:function(e,t){this._removeFuncs.forEach((function(r){e.startsWith(r[0])&&r[1](t)}))}},{key:"_checkSizeLimit",value:function(){if(!(this._size<=this._maxSize)){var e,t=Object(a.a)(this._db);try{for(t.s();!(e=t.n()).done;){var r=Object(i.a)(e.value,2),n=r[0],o=r[1];if(this._db.delete(n),o.lives<=1?(this._size-=o.size,this._notifyRemoved(n,o.entry)):(--o.lives,this._db.set(n,o)),this._size<=.9*this.maxSize)return}}catch(s){t.e(s)}finally{t.f()}}}}]),e}()},813:function(e,t,r){"use strict";var i,a=r(2),n=r(3),o=r(5),s=r(6),l=r(0),c=(r(13),r(24)),u=(r(14),r(15),r(1)),b=r(63),y=r(8),p=r(47),d=(r(11),r(19),r(20),r(28)),f=r(174),v=r(305),h=r(803),O=i=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var i;return Object(a.a)(this,r),(i=t.call(this,e)).respectsDaylightSaving=!1,i.timezone=null,i}return Object(n.a)(r,[{key:"readRespectsDaylightSaving",value:function(e,t){return void 0!==t.respectsDaylightSaving?t.respectsDaylightSaving:void 0!==t.respectDaylightSaving&&t.respectDaylightSaving}},{key:"clone",value:function(){var e=this.respectsDaylightSaving,t=this.timezone;return new i({respectsDaylightSaving:e,timezone:t})}}]),r}(d.a);Object(l.a)([Object(u.b)({type:Boolean,json:{write:!0}})],O.prototype,"respectsDaylightSaving",void 0),Object(l.a)([Object(b.a)("respectsDaylightSaving",["respectsDaylightSaving","respectDaylightSaving"])],O.prototype,"readRespectsDaylightSaving",null),Object(l.a)([Object(u.b)({type:String,json:{read:{source:"timeZone"},write:{target:"timeZone"}}})],O.prototype,"timezone",void 0);var m,j=O=i=Object(l.a)([Object(y.a)("esri.layers.support.TimeReference")],O),g=m=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var i;return Object(a.a)(this,r),(i=t.call(this,e)).cumulative=!1,i.endField=null,i.fullTimeExtent=null,i.hasLiveData=!1,i.interval=null,i.startField=null,i.timeReference=null,i.trackIdField=null,i.useTime=!0,i}return Object(n.a)(r,[{key:"readFullTimeExtent",value:function(e,t){if(!t.timeExtent||!Array.isArray(t.timeExtent)||2!==t.timeExtent.length)return null;var r=new Date(t.timeExtent[0]),i=new Date(t.timeExtent[1]);return new v.a({start:r,end:i})}},{key:"writeFullTimeExtent",value:function(e,t){e&&e.start&&e.end?t.timeExtent=[e.start.getTime(),e.end.getTime()]:t.timeExtent=null}},{key:"readInterval",value:function(e,t){return t.timeInterval&&t.timeIntervalUnits?new h.a({value:t.timeInterval,unit:f.d.fromJSON(t.timeIntervalUnits)}):t.defaultTimeInterval&&t.defaultTimeIntervalUnits?new h.a({value:t.defaultTimeInterval,unit:f.d.fromJSON(t.defaultTimeIntervalUnits)}):null}},{key:"writeInterval",value:function(e,t){if(e){var r=e.toJSON();t.timeInterval=r.value,t.timeIntervalUnits=r.unit}else t.timeInterval=null,t.timeIntervalUnits=null}},{key:"clone",value:function(){var e=this.cumulative,t=this.endField,r=this.hasLiveData,i=this.interval,a=this.startField,n=this.timeReference,o=this.fullTimeExtent,s=this.trackIdField,l=this.useTime;return new m({cumulative:e,endField:t,hasLiveData:r,interval:i,startField:a,timeReference:Object(c.a)(n),fullTimeExtent:Object(c.a)(o),trackIdField:s,useTime:l})}}]),r}(d.a);Object(l.a)([Object(u.b)({type:Boolean,json:{read:{source:"exportOptions.timeDataCumulative"},write:{target:"exportOptions.timeDataCumulative"}}})],g.prototype,"cumulative",void 0),Object(l.a)([Object(u.b)({type:String,json:{read:{source:"endTimeField"},write:{target:"endTimeField",allowNull:!0}}})],g.prototype,"endField",void 0),Object(l.a)([Object(u.b)({type:v.a,json:{write:{enabled:!0,allowNull:!0}}})],g.prototype,"fullTimeExtent",void 0),Object(l.a)([Object(b.a)("fullTimeExtent",["timeExtent"])],g.prototype,"readFullTimeExtent",null),Object(l.a)([Object(p.a)("fullTimeExtent")],g.prototype,"writeFullTimeExtent",null),Object(l.a)([Object(u.b)({type:Boolean,json:{write:!0}})],g.prototype,"hasLiveData",void 0),Object(l.a)([Object(u.b)({type:h.a,json:{write:{enabled:!0,allowNull:!0}}})],g.prototype,"interval",void 0),Object(l.a)([Object(b.a)("interval",["timeInterval","timeIntervalUnits","defaultTimeInterval","defaultTimeIntervalUnits"])],g.prototype,"readInterval",null),Object(l.a)([Object(p.a)("interval")],g.prototype,"writeInterval",null),Object(l.a)([Object(u.b)({type:String,json:{read:{source:"startTimeField"},write:{target:"startTimeField",allowNull:!0}}})],g.prototype,"startField",void 0),Object(l.a)([Object(u.b)({type:j,json:{write:{enabled:!0,allowNull:!0}}})],g.prototype,"timeReference",void 0),Object(l.a)([Object(u.b)({type:String,json:{write:{enabled:!0,allowNull:!0}}})],g.prototype,"trackIdField",void 0),Object(l.a)([Object(u.b)({type:Boolean,json:{read:{source:"exportOptions.useTime"},write:{target:"exportOptions.useTime"}}})],g.prototype,"useTime",void 0);var w=g=m=Object(l.a)([Object(y.a)("esri.layers.support.TimeInfo")],g);t.a=w},818:function(e,t,r){"use strict";r.d(t,"a",(function(){return b}));var i=r(158),a=(r(130),r(215)),n=(r(309),r(310)),o=r(216),s=r(217),l=(r(218),r(179),r(277)),c=["oid","global-id"],u=["oid","global-id","guid"];function b(e,t){var r=e.displayField,n=e.editFieldsInfo,o=e.fields,c=e.objectIdField,u=e.title;if(!o)return null;var b=h({editFieldsInfo:n,fields:o,objectIdField:c},t);if(!b.length)return null;var y=function(e){var t=Object(i.l)(e),r=e.titleBase;return t?"".concat(r,": {").concat(t.trim(),"}"):r}({titleBase:u,fields:o,displayField:r}),p=[new s.a,new a.a];return new l.a({title:y,content:p,fieldInfos:b})}var y=[/^fnode_$/i,/^tnode_$/i,/^lpoly_$/i,/^rpoly_$/i,/^poly_$/i,/^subclass$/i,/^subclass_$/i,/^rings_ok$/i,/^rings_nok$/i,/shape/i,/perimeter/i,/objectid/i,/_i$/i],p=function(e,t){var r=t.editFieldsInfo,i=t.objectIdField,a=t.visibleFieldNames;return a?a.has(e.name):!f(e.name,r)&&(!i||e.name!==i)&&!(c.indexOf(e.type)>-1)&&!y.some((function(t){return t.test(e.name)}))};function d(e,t){return"oid"===e.type?-1:"oid"===t.type?1:m(e)?-1:m(t)?1:(e.alias||e.name).toLocaleLowerCase().localeCompare((t.alias||t.name).toLocaleLowerCase())}function f(e,t){if(!e||!t)return!1;var r=t.creationDateField,i=t.creatorField,a=t.editDateField,n=t.editorField;return-1!==[r&&r.toLowerCase(),i&&i.toLowerCase(),a&&a.toLowerCase(),n&&n.toLowerCase()].indexOf(e.toLowerCase())}function v(e,t){return e.editable&&-1===u.indexOf(e.type)&&!f(e.name,t)}function h(e,t){var r=e.editFieldsInfo,i=e.fields,a=e.objectIdField;return function(e,t){var r=e;return t&&(e=e.filter((function(e){return-1===t.indexOf(e.type)}))),e===r&&(e=e.slice()),e.sort(d),e}(i,(null==t?void 0:t.ignoreFieldTypes)||j).map((function(e){return new o.a({fieldName:e.name,isEditable:v(e,r),label:e.alias,format:O(e),visible:p(e,{editFieldsInfo:r,objectIdField:a,visibleFieldNames:null==t?void 0:t.visibleFieldNames})})}))}function O(e){switch(e.type){case"small-integer":case"integer":case"single":return new n.a({digitSeparator:!0,places:0});case"double":return new n.a({digitSeparator:!0,places:2});case"date":return new n.a({dateFormat:"long-month-day-year"});default:return null}}function m(e){return"name"===(e.name&&e.name.toLowerCase())||("name"===(e.alias&&e.alias.toLowerCase())||void 0)}var j=["geometry","blob","raster","guid","xml"]},822:function(e,t,r){"use strict";var i=r(2),a=r(3),n=r(5),o=r(6),s=r(0),l=(r(13),r(24)),c=(r(14),r(15),r(1)),u=r(50),b=r(8),y=r(47),p=(r(11),r(19),r(20),r(28)),d=new u.a({esriFeatureEditToolAutoCompletePolygon:"auto-complete-polygon",esriFeatureEditToolCircle:"circle",esriFeatureEditToolEllipse:"ellipse",esriFeatureEditToolFreehand:"freehand",esriFeatureEditToolLine:"line",esriFeatureEditToolNone:"none",esriFeatureEditToolPoint:"point",esriFeatureEditToolPolygon:"polygon",esriFeatureEditToolRectangle:"rectangle",esriFeatureEditToolArrow:"arrow",esriFeatureEditToolTriangle:"triangle",esriFeatureEditToolLeftArrow:"left-arrow",esriFeatureEditToolRightArrow:"right-arrow",esriFeatureEditToolUpArrow:"up-arrow",esriFeatureEditToolDownArrow:"down-arrow"}),f=function(e){Object(n.a)(r,e);var t=Object(o.a)(r);function r(e){var a;return Object(i.a)(this,r),(a=t.call(this,e)).name=null,a.description=null,a.drawingTool=null,a.prototype=null,a.thumbnail=null,a}return Object(a.a)(r,[{key:"writeDrawingTool",value:function(e,t){t.drawingTool=d.toJSON(e)}},{key:"writePrototype",value:function(e,t){t.prototype=Object(l.c)(Object(l.a)(e),!0)}},{key:"writeThumbnail",value:function(e,t){t.thumbnail=Object(l.c)(Object(l.a)(e))}}]),r}(p.a);Object(s.a)([Object(c.b)({json:{write:!0}})],f.prototype,"name",void 0),Object(s.a)([Object(c.b)({json:{write:!0}})],f.prototype,"description",void 0),Object(s.a)([Object(c.b)({json:{read:d.read,write:d.write}})],f.prototype,"drawingTool",void 0),Object(s.a)([Object(y.a)("drawingTool")],f.prototype,"writeDrawingTool",null),Object(s.a)([Object(c.b)({json:{write:!0}})],f.prototype,"prototype",void 0),Object(s.a)([Object(y.a)("prototype")],f.prototype,"writePrototype",null),Object(s.a)([Object(c.b)({json:{write:!0}})],f.prototype,"thumbnail",void 0),Object(s.a)([Object(y.a)("thumbnail")],f.prototype,"writeThumbnail",null);var v=f=Object(s.a)([Object(b.a)("esri.layers.support.FeatureTemplate")],f);t.a=v},831:function(e,t,r){"use strict";r.d(t,"a",(function(){return v}));var i=r(2),a=r(3),n=r(5),o=r(6),s=r(0),l=(r(13),r(14),r(15),r(1)),c=r(63),u=r(8),b=(r(11),r(19),r(20),r(158)),y=r(174),p=r(305),d=r(803),f=r(813);var v=function(e){var t=function(e){Object(n.a)(r,e);var t=Object(o.a)(r);function r(){var e;return Object(i.a)(this,r),(e=t.apply(this,arguments)).timeExtent=null,e.timeOffset=null,e.useViewTime=!0,e}return Object(a.a)(r,[{key:"readOffset",value:function(e,t){var r=t.timeInfo.exportOptions;if(!r)return null;var i=r.timeOffset,a=y.d.fromJSON(r.timeOffsetUnits);return i&&a?new d.a({value:i,unit:a}):null}},{key:"timeInfo",set:function(e){Object(b.k)(e,this.fields),this._set("timeInfo",e)}}]),r}(e);return Object(s.a)([Object(l.b)({type:p.a,json:{write:!1}})],t.prototype,"timeExtent",void 0),Object(s.a)([Object(l.b)({type:d.a})],t.prototype,"timeOffset",void 0),Object(s.a)([Object(c.a)("service","timeOffset",["timeInfo.exportOptions"])],t.prototype,"readOffset",null),Object(s.a)([Object(l.b)({value:null,type:f.a,json:{write:!0,origins:{"web-document":{read:!1,write:!1}}}})],t.prototype,"timeInfo",null),Object(s.a)([Object(l.b)({type:Boolean,json:{read:{source:"timeAnimation"},write:{target:"timeAnimation"},origins:{"web-scene":{read:!1,write:!1}}}})],t.prototype,"useViewTime",void 0),t=Object(s.a)([Object(u.a)("esri.layers.mixins.TemporalLayer")],t),t}},842:function(e,t,r){"use strict";var i=r(2),a=r(3),n=r(5),o=r(6),s=r(0),l=(r(13),r(24)),c=(r(14),r(15),r(1)),u=r(63),b=r(8),y=r(47),p=(r(11),r(19),r(20),r(28)),d=r(283),f=r(281),v=r(282),h=(r(214),r(822)),O=function(e){Object(n.a)(r,e);var t=Object(o.a)(r);function r(e){var a;return Object(i.a)(this,r),(a=t.call(this,e)).id=null,a.name=null,a.domains=null,a.templates=null,a}return Object(a.a)(r,[{key:"readDomains",value:function(e){var t={};for(var r in e)if(e.hasOwnProperty(r)){var i=e[r];switch(i.type){case"range":t[r]=v.a.fromJSON(i);break;case"codedValue":t[r]=d.a.fromJSON(i);break;case"inherited":t[r]=f.a.fromJSON(i)}}return t}},{key:"writeDomains",value:function(e,t){var r={};for(var i in e)e.hasOwnProperty(i)&&(r[i]=e[i]&&e[i].toJSON());Object(l.c)(r),t.domains=r}},{key:"readTemplates",value:function(e){return e&&e.map((function(e){return new h.a(e)}))}},{key:"writeTemplates",value:function(e,t){t.templates=e&&e.map((function(e){return e.toJSON()}))}}]),r}(p.a);Object(s.a)([Object(c.b)({json:{write:!0}})],O.prototype,"id",void 0),Object(s.a)([Object(c.b)({json:{write:!0}})],O.prototype,"name",void 0),Object(s.a)([Object(c.b)({json:{write:!0}})],O.prototype,"domains",void 0),Object(s.a)([Object(u.a)("domains")],O.prototype,"readDomains",null),Object(s.a)([Object(y.a)("domains")],O.prototype,"writeDomains",null),Object(s.a)([Object(c.b)({json:{write:!0}})],O.prototype,"templates",void 0),Object(s.a)([Object(u.a)("templates")],O.prototype,"readTemplates",null),Object(s.a)([Object(y.a)("templates")],O.prototype,"writeTemplates",null);var m=O=Object(s.a)([Object(b.a)("esri.layers.support.FeatureType")],O);t.a=m},851:function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var i=r(2),a=r(5),n=r(6),o=r(0),s=(r(13),r(14),r(15),r(1)),l=r(8),c=(r(11),r(19),r(20),function(e){var t=function(e){Object(a.a)(r,e);var t=Object(n.a)(r);function r(){var e;return Object(i.a)(this,r),(e=t.apply(this,arguments)).customParameters=null,e}return r}(e);return Object(o.a)([Object(s.b)({json:{write:!0,origins:{"web-scene":{write:!1}}}})],t.prototype,"customParameters",void 0),t=Object(o.a)([Object(l.a)("esri.layers.mixins.CustomParametersMixin")],t)})},931:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return s})),r.d(t,"c",(function(){return a}));var i=r(12);function a(e,t,r){return t.flatten((function(e){return e.sublayers})).length!==e.length||(!!e.some((function(e){return e.originIdOf("minScale")>r||e.originIdOf("maxScale")>r||e.originIdOf("renderer")>r||e.originIdOf("labelingInfo")>r||e.originIdOf("opacity")>r||e.originIdOf("labelsVisible")>r||e.originIdOf("source")>r}))||!o(e,t))}function n(e,t,r){return!!e.some((function(e){var t=e.source;return!(!t||"map-layer"===t.type&&t.mapLayerId===e.id&&(!t.gdbVersion||t.gdbVersion===r.gdbVersion))||e.originIdOf("renderer")>2||e.originIdOf("labelingInfo")>2||e.originIdOf("opacity")>2||e.originIdOf("labelsVisible")>2}))||!o(e,t)}function o(e,t){if(!e||!e.length)return!0;var r=t.slice().reverse().flatten((function(e){var t=e.sublayers;return t&&t.toArray().reverse()})).map((function(e){return e.id})).toArray();if(e.length>r.length)return!1;var a,n=0,o=r.length,s=Object(i.a)(e);try{for(s.s();!(a=s.n()).done;){for(var l=a.value.id;n<o&&r[n]!==l;)n++;if(n>=o)return!1}}catch(c){s.e(c)}finally{s.f()}return!0}function s(e){return!!e&&e.some((function(e){return null!=e.minScale||e.layerDefinition&&null!=e.layerDefinition.minScale}))}},954:function(e,t,r){"use strict";var i,a=r(32),n=r(12),o=r(10),s=r.n(o),l=r(9),c=r(21),u=r(2),b=r(3),y=r(5),p=r(6),d=r(0),f=(r(13),r(24)),v=r(14),h=r(15),O=r(98),m=r(1),j=r(73),g=r(63),w=r(8),S=r(47),x=r(23),_=r(11),I=(r(19),r(231)),k=(r(20),r(16)),L=r(62),E=(r(77),r(41)),F=r(158),T=r(247),D=r(277),P=r(81),N=r(137),A=r(149),M=r(801),C=(r(819),r(829),r(838),r(868),r(879),r(880),r(867),r(876)),z=(r(875),r(246)),R=r(796),V=r(799),J=r(842),B=r(409),U=r(236),q=r(818),$=r(278),H=r(159);function G(e){return e&&"esriSMS"===e.type}function W(e,t,r){var i;return{ignoreOrigin:!0,enabled:!!r&&"map-image"===(null==(i=r.layer)?void 0:i.type)&&(r.writeSublayerStructure||this.originIdOf(t)>=Object(I.d)(r.origin))}}function Q(e,t,r){var i;return{enabled:!!r&&"tile"===(null==(i=r.layer)?void 0:i.type)&&this._isOverridden(t)}}function Z(e,t,r){return{ignoreOrigin:!0,enabled:r&&r.writeSublayerStructure||!1}}function X(e,t,r){return{ignoreOrigin:!0,enabled:!!r&&(r.writeSublayerStructure||this.originIdOf(t)>=Object(I.d)(r.origin))}}var K=v.a.getLogger("esri.layers.support.Sublayer"),Y=0,ee=new Set;ee.add("layer"),ee.add("parent"),ee.add("loaded"),ee.add("loadStatus"),ee.add("loadError"),ee.add("loadWarnings");var te=i=function(e){Object(y.a)(o,e);var t=Object(p.a)(o);function o(e){var r;return Object(u.a)(this,o),(r=t.call(this,e)).capabilities=void 0,r.fields=null,r.fullExtent=null,r.globalIdField=null,r.legendEnabled=!0,r.objectIdField=null,r.popupEnabled=!0,r.popupTemplate=null,r.sourceJSON=null,r.title=null,r.typeIdField=null,r.types=null,r}return Object(b.a)(o,[{key:"load",value:function(){var e=Object(c.a)(s.a.mark((function e(t){var r=this;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(this.addResolvingPromise(Object(c.a)(s.a.mark((function e(){var i,a,n,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.layer||r.url){e.next=2;break}throw new x.a("sublayer:missing-layer","Sublayer can't be loaded without being part of a layer",{sublayer:r});case 2:if(a=null,r.layer&&!(r.originIdOf("url")>2)&&"data-layer"!==(null==(i=r.source)?void 0:i.type)){e.next=9;break}return e.next=6,Object(P.default)(r.url,Object(l.a)({responseType:"json",query:{f:"json"}},t));case 6:a=e.sent.data,e.next=14;break;case 9:return o=r.id,"map-layer"===(null==(n=r.source)?void 0:n.type)&&(o=r.source.mapLayerId),e.next=13,r.layer.fetchSublayerInfo(o,t);case 13:a=e.sent;case 14:a&&(r.sourceJSON=a,r.read({layerDefinition:a},{origin:"service"}));case 15:case"end":return e.stop()}}),e)})))()),this));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"readCapabilities",value:function(e,t){var r=(e=(t=t.layerDefinition||t).capabilities||e)?e.toLowerCase().split(",").map((function(e){return e.trim()})):[];return{exportMap:{supportsModification:!!t.canModifyLayer},operations:{supportsQuery:-1!==r.indexOf("query")}}}},{key:"definitionExpression",set:function(e){this._setAndNotifyLayer("definitionExpression",e)}},{key:"fieldsIndex",get:function(){return new R.a(this.fields||[])}},{key:"readGlobalIdFieldFromService",value:function(e,t){if((t=t.layerDefinition||t).globalIdField)return t.globalIdField;if(t.fields){var r,i=Object(n.a)(t.fields);try{for(i.s();!(r=i.n()).done;){var a=r.value;if("esriFieldTypeGlobalID"===a.type)return a.name}}catch(o){i.e(o)}finally{i.f()}}}},{key:"id",get:function(){var e=this._get("id");return null==e?Y++:e},set:function(e){this._get("id")!==e&&(!1!==this.get("layer.capabilities.exportMap.supportsDynamicLayers")?this._set("id",e):this._logLockedError("id","capability not available 'layer.capabilities.exportMap.supportsDynamicLayers'"))}},{key:"labelingInfo",set:function(e){this._setAndNotifyLayer("labelingInfo",e)}},{key:"writeLabelingInfo",value:function(e,t,r,i){e&&e.length&&(t.layerDefinition={drawingInfo:{labelingInfo:e.map((function(e){return e.write({},i)}))}})}},{key:"labelsVisible",set:function(e){this._setAndNotifyLayer("labelsVisible",e)}},{key:"layer",set:function(e){this._set("layer",e),this.sublayers&&this.sublayers.forEach((function(t){return t.layer=e}))}},{key:"listMode",set:function(e){this._set("listMode",e)}},{key:"minScale",set:function(e){this._setAndNotifyLayer("minScale",e)}},{key:"readMinScale",value:function(e,t){return t.minScale||t.layerDefinition&&t.layerDefinition.minScale||0}},{key:"maxScale",set:function(e){this._setAndNotifyLayer("maxScale",e)}},{key:"readMaxScale",value:function(e,t){return t.maxScale||t.layerDefinition&&t.layerDefinition.maxScale||0}},{key:"readObjectIdFieldFromService",value:function(e,t){if((t=t.layerDefinition||t).objectIdField)return t.objectIdField;if(t.fields){var r,i=Object(n.a)(t.fields);try{for(i.s();!(r=i.n()).done;){var a=r.value;if("esriFieldTypeOID"===a.type)return a.name}}catch(o){i.e(o)}finally{i.f()}}}},{key:"opacity",set:function(e){this._setAndNotifyLayer("opacity",e)}},{key:"readOpacity",value:function(e,t){var r=t.layerDefinition;return 1-.01*(null!=r.transparency?r.transparency:r.drawingInfo.transparency)}},{key:"writeOpacity",value:function(e,t,r,i){t.layerDefinition={drawingInfo:{transparency:100-100*e}}}},{key:"writeParent",value:function(e,t){this.parent&&this.parent!==this.layer?t.parentLayerId=Object(h.e)(this.parent.id):t.parentLayerId=-1}},{key:"defaultPopupTemplate",get:function(){return this.createPopupTemplate()}},{key:"renderer",set:function(e){if(e){var t,r=Object(n.a)(e.getSymbols());try{for(r.s();!(t=r.n()).done;){var i=t.value;if(Object(A.h)(i)){K.warn("Sublayer renderer should use 2D symbols");break}}}catch(a){r.e(a)}finally{r.f()}}this._setAndNotifyLayer("renderer",e)}},{key:"source",get:function(){return this._get("source")||new B.a({mapLayerId:this.id})},set:function(e){this._setAndNotifyLayer("source",e)}},{key:"sublayers",set:function(e){this._handleSublayersChange(e,this._get("sublayers")),this._set("sublayers",e)}},{key:"castSublayers",value:function(e){return Object(h.m)(E.a.ofType(i),e)}},{key:"writeSublayers",value:function(e,t,r){this.get("sublayers.length")&&(t[r]=this.sublayers.map((function(e){return e.id})).toArray().reverse())}},{key:"readTypeIdField",value:function(e,t){var r=(t=t.layerDefinition||t).typeIdField;if(r){var i=Object(F.n)(t.fields,r);if(i)return i.name}return null}},{key:"url",get:function(){var e,t,r=null!=(e=null==(t=this.layer)?void 0:t.parsedUrl)?e:this._lastParsedUrl,i=this.source;if(!r)return null;if(this._lastParsedUrl=r,"map-layer"===(null==i?void 0:i.type))return"".concat(r.path,"/").concat(i.mapLayerId);var a={layer:JSON.stringify({source:this.source})};return"".concat(r.path,"/dynamicLayer?").concat(Object(_.C)(a))},set:function(e){e?this._override("url",e):this._clearOverride("url")}},{key:"visible",set:function(e){this._setAndNotifyLayer("visible",e)}},{key:"writeVisible",value:function(e,t,r,i){t[r]=this.getAtOrigin("defaultVisibility","service")||e}},{key:"clone",value:function(){var e=Object(O.a)(this).store,t=new i;return Object(O.a)(t).store=e.clone(ee),this.url,t._lastParsedUrl=this._lastParsedUrl,t}},{key:"createPopupTemplate",value:function(e){return Object(q.a)(this,e)}},{key:"createQuery",value:function(){return new $.a({returnGeometry:!0,where:this.definitionExpression||"1=1"})}},{key:"createFeatureLayer",value:function(){var e=Object(c.a)(s.a.mark((function e(){var t,i,a,n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.hasOwnProperty("sublayers")){e.next=2;break}return e.abrupt("return",null);case 2:return a=null==(t=this.layer)?void 0:t.parsedUrl,e.next=6,r.e(70).then(r.bind(null,832));case 6:return e.t0=e.sent.default,e.t1={url:a.path},n=new e.t0(e.t1),e.abrupt("return",(a&&this.source&&("map-layer"===this.source.type?n.layerId=this.source.mapLayerId:n.dynamicDataSource=this.source),null!=this.layer.refreshInterval&&(n.refreshInterval=this.layer.refreshInterval),this.definitionExpression&&(n.definitionExpression=this.definitionExpression),this.originIdOf("labelingInfo")>2&&(n.labelingInfo=Object(f.a)(this.labelingInfo)),this.originIdOf("labelsVisible")>0&&(n.labelsVisible=this.labelsVisible),this.originIdOf("legendEnabled")>0&&(n.legendEnabled=this.legendEnabled),this.originIdOf("visible")>0&&(n.visible=this.visible),this.originIdOf("minScale")>0&&(n.minScale=this.minScale),this.originIdOf("maxScale")>0&&(n.maxScale=this.maxScale),this.originIdOf("opacity")>0&&(n.opacity=this.opacity),this.originIdOf("popupTemplate")>0&&(n.popupTemplate=Object(f.a)(this.popupTemplate)),this.originIdOf("renderer")>2&&(n.renderer=Object(f.a)(this.renderer)),"data-layer"===(null==(i=this.source)?void 0:i.type)&&(n.dynamicDataSource=this.source.clone()),this.originIdOf("title")>0&&(n.title=this.title),"map-image"===this.layer.type&&this.layer.originIdOf("customParameters")>0&&(n.customParameters=this.layer.customParameters),"tile"===this.layer.type&&this.layer.originIdOf("customParameters")>0&&(n.customParameters=this.layer.customParameters),n));case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getFeatureType",value:function(e){var t=this.typeIdField,r=this.types;if(!t||!e)return null;var i=e.attributes?e.attributes[t]:void 0;if(null==i)return null;var a=null;return r.some((function(e){var t=e.id;return null!=t&&(t.toString()===i.toString()&&(a=e),!!a)})),a}},{key:"getFieldDomain",value:function(e,t){var r=t&&t.feature,i=this.getFeatureType(r);if(i){var a=i.domains&&i.domains[e];if(a&&"inherited"!==a.type)return a}return this._getLayerDomain(e)}},{key:"queryFeatures",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.createQuery(),i=arguments.length>1?arguments[1]:void 0;return this.load().then((function(){if(!e.get("capabilities.operations.supportsQuery"))throw new x.a("Sublayer.queryFeatures","this layer doesn't support queries.");return Object(k.b)([Promise.resolve().then(r.bind(null,251)),Promise.resolve().then(r.bind(null,363))])})).then((function(r){var n=Object(a.a)(r,2),o=n[0].executeQuery,s=n[1].default;return o(e.url,$.a.from(t),e.layer?e.layer.spatialReference:null,Object(l.a)(Object(l.a)({},i),{},{query:Object(l.a)({},e.layer.customParameters)})).then((function(e){return s.fromJSON(e.data)}))})).then((function(t){return t&&t.features&&t.features.forEach((function(t){t.sourceLayer=e})),t}))}},{key:"toExportImageJSON",value:function(){var e,t=this,r={id:this.id,source:(null==(e=this.source)?void 0:e.toJSON())||{mapLayerId:this.id,type:"mapLayer"}};this.definitionExpression&&(r.definitionExpression=this.definitionExpression);var i=["renderer","labelingInfo","opacity","labelsVisible"].reduce((function(e,r){return e[r]=t.originIdOf(r),e}),{});if(Object.keys(i).some((function(e){return i[e]>2}))){var a=r.drawingInfo={};i.renderer>2&&(a.renderer=this.renderer?this.renderer.toJSON():null),i.labelsVisible>2&&(a.showLabels=this.labelsVisible),this.labelsVisible&&i.labelingInfo>2&&(a.labelingInfo=this.labelingInfo?this.labelingInfo.map((function(e){return e.write({},{origin:"service"})})):null,a.showLabels=!0),i.opacity>2&&(a.transparency=100-100*this.opacity),this._assignDefaultSymbolColors(a.renderer)}return r}},{key:"_assignDefaultSymbolColors",value:function(e){this._forEachSimpleMarkerSymbols(e,(function(e){e.color||"esriSMSX"!==e.style&&"esriSMSCross"!==e.style||(e.outline&&e.outline.color?e.color=e.outline.color:e.color=[0,0,0,0])}))}},{key:"_forEachSimpleMarkerSymbols",value:function(e,t){if(e){var r,i="uniqueValueInfos"in e?e.uniqueValueInfos:"classBreakInfos"in e?e.classBreakInfos:[],a=Object(n.a)(i);try{for(a.s();!(r=a.n()).done;){var o=r.value;G(o.symbol)&&t(o.symbol)}}catch(s){a.e(s)}finally{a.f()}"symbol"in e&&G(e.symbol)&&t(e.symbol),"defaultSymbol"in e&&G(e.defaultSymbol)&&t(e.defaultSymbol)}}},{key:"_setAndNotifyLayer",value:function(e,t){var r,i,a=this.layer,n=this._get(e);switch(e){case"definitionExpression":r="supportsSublayerDefinitionExpression";case"minScale":case"maxScale":case"visible":r="supportsSublayerVisibility";break;case"labelingInfo":case"labelsVisible":case"opacity":case"renderer":case"source":r="supportsDynamicLayers",i="supportsModification"}var o=Object(O.a)(this).getDefaultOrigin();if("service"!==o){if(r&&!1===this.get("layer.capabilities.exportMap.".concat(r)))return void this._logLockedError(e,"capability not available 'layer.capabilities.exportMap.".concat(r,"'"));if(i&&!1===this.get("capabilities.exportMap.".concat(i)))return void this._logLockedError(e,"capability not available 'capabilities.exportMap.".concat(i,"'"))}"source"!==e||"not-loaded"===this.loadStatus?(this._set(e,t),"service"!==o&&n!==t&&a&&a.emit&&a.emit("sublayer-update",{propertyName:e,target:this})):this._logLockedError(e,"'source' can't be changed after calling sublayer.load()")}},{key:"_handleSublayersChange",value:function(e,t){var r=this;t&&(t.forEach((function(e){e.parent=null,e.layer=null})),this.handles.removeAll()),e&&(e.forEach((function(e){e.parent=r,e.layer=r.layer})),this.handles.add([e.on("after-add",(function(e){var t=e.item;t.parent=r,t.layer=r.layer})),e.on("after-remove",(function(e){var t=e.item;t.parent=null,t.layer=null})),e.on("before-changes",(function(e){var t=r.get("layer.capabilities.exportMap.supportsSublayersChanges");null==t||t||(K.error(new x.a("sublayer:sublayers-non-modifiable","Sublayer can't be added, moved, or removed from the layer's sublayers",{sublayer:r,layer:r.layer})),e.preventDefault())}))]))}},{key:"_logLockedError",value:function(e,t){K.error(new x.a("sublayer:locked","Property '".concat(e,"' can't be changed on Sublayer from the layer '").concat(this.layer.id,"'"),{reason:t,sublayer:this,layer:this.layer}))}},{key:"_getLayerDomain",value:function(e){var t=this.fieldsIndex.get(e);return t?t.domain:null}}]),o}(Object(H.b)(Object(M.a)(Object(T.a)(N.a))));te.test={isMapImageLayerOverridePolicy:function(e){return e===Z||e===W},isTileImageLayerOverridePolicy:function(e){return e===Q}},Object(d.a)([Object(m.b)({readOnly:!0})],te.prototype,"capabilities",void 0),Object(d.a)([Object(g.a)("service","capabilities",["layerDefinition.canModifyLayer","layerDefinition.capabilities"])],te.prototype,"readCapabilities",null),Object(d.a)([Object(m.b)({type:String,value:null,json:{read:{source:"layerDefinition.definitionExpression"},write:{target:"layerDefinition.definitionExpression",overridePolicy:W}}})],te.prototype,"definitionExpression",null),Object(d.a)([Object(m.b)({type:[z.a],json:{origins:{service:{read:{source:"layerDefinition.fields"}}}}})],te.prototype,"fields",void 0),Object(d.a)([Object(m.b)({readOnly:!0,dependsOn:["fields"]})],te.prototype,"fieldsIndex",null),Object(d.a)([Object(m.b)({type:L.a,json:{read:{source:"layerDefinition.extent"}}})],te.prototype,"fullExtent",void 0),Object(d.a)([Object(m.b)({type:String})],te.prototype,"globalIdField",void 0),Object(d.a)([Object(g.a)("service","globalIdField",["layerDefinition.globalIdField","layerDefinition.fields"])],te.prototype,"readGlobalIdFieldFromService",null),Object(d.a)([Object(m.b)({type:h.a,json:{write:{ignoreOrigin:!0}}})],te.prototype,"id",null),Object(d.a)([Object(m.b)({value:null,type:[V.a],json:{read:{source:"layerDefinition.drawingInfo.labelingInfo"},write:{target:"layerDefinition.drawingInfo.labelingInfo",overridePolicy:Z}}})],te.prototype,"labelingInfo",null),Object(d.a)([Object(S.a)("labelingInfo")],te.prototype,"writeLabelingInfo",null),Object(d.a)([Object(m.b)({type:Boolean,value:!0,json:{read:{source:"layerDefinition.drawingInfo.showLabels"},write:{target:"layerDefinition.drawingInfo.showLabels",overridePolicy:Z}}})],te.prototype,"labelsVisible",null),Object(d.a)([Object(m.b)({value:null})],te.prototype,"layer",null),Object(d.a)([Object(m.b)({type:Boolean,value:!0,json:{origins:{service:{read:{enabled:!1}}},read:{source:"showLegend"},write:{target:"showLegend",overridePolicy:X}}})],te.prototype,"legendEnabled",void 0),Object(d.a)([Object(m.b)({type:["show","hide","hide-children"],value:"show",json:{read:!1,write:!1,origins:{"web-scene":{read:!0,write:!0}}}})],te.prototype,"listMode",null),Object(d.a)([Object(m.b)({type:Number,value:0,json:{write:{overridePolicy:Z}}})],te.prototype,"minScale",null),Object(d.a)([Object(g.a)("minScale",["minScale","layerDefinition.minScale"])],te.prototype,"readMinScale",null),Object(d.a)([Object(m.b)({type:Number,value:0,json:{write:{overridePolicy:Z}}})],te.prototype,"maxScale",null),Object(d.a)([Object(g.a)("maxScale",["maxScale","layerDefinition.maxScale"])],te.prototype,"readMaxScale",null),Object(d.a)([Object(m.b)({type:String})],te.prototype,"objectIdField",void 0),Object(d.a)([Object(g.a)("service","objectIdField",["layerDefinition.objectIdField","layerDefinition.fields"])],te.prototype,"readObjectIdFieldFromService",null),Object(d.a)([Object(m.b)({type:Number,value:1,json:{write:{target:"layerDefinition.drawingInfo.transparency",overridePolicy:Z}}})],te.prototype,"opacity",null),Object(d.a)([Object(g.a)("opacity",["layerDefinition.drawingInfo.transparency","layerDefinition.transparency"])],te.prototype,"readOpacity",null),Object(d.a)([Object(S.a)("opacity")],te.prototype,"writeOpacity",null),Object(d.a)([Object(m.b)({json:{type:h.a,write:{target:"parentLayerId",allowNull:!0,overridePolicy:Z}}})],te.prototype,"parent",void 0),Object(d.a)([Object(S.a)("parent")],te.prototype,"writeParent",null),Object(d.a)([Object(m.b)({type:Boolean,value:!0,json:{read:{source:"disablePopup",reader:function(e,t){return!t.disablePopup}},write:{target:"disablePopup",overridePolicy:X,writer:function(e,t,r){t[r]=!e}}}})],te.prototype,"popupEnabled",void 0),Object(d.a)([Object(m.b)({type:D.a,json:{read:{source:"popupInfo"},write:{target:"popupInfo",overridePolicy:X}}})],te.prototype,"popupTemplate",void 0),Object(d.a)([Object(m.b)({readOnly:!0,dependsOn:["fields","title"]})],te.prototype,"defaultPopupTemplate",null),Object(d.a)([Object(m.b)({types:C.a,value:null,json:{name:"layerDefinition.drawingInfo.renderer",write:{overridePolicy:Z},origins:{"web-scene":{types:C.b,name:"layerDefinition.drawingInfo.renderer",write:{overridePolicy:Z}}}}})],te.prototype,"renderer",null),Object(d.a)([Object(m.b)({types:{key:"type",base:null,typeMap:{"data-layer":U.a,"map-layer":B.a}},cast:function(e){if(e){if("mapLayerId"in e)return Object(h.d)(B.a,e);if("dataSource"in e)return Object(h.d)(U.a,e)}return e},json:{name:"layerDefinition.source",write:{overridePolicy:Z}}})],te.prototype,"source",null),Object(d.a)([Object(m.b)()],te.prototype,"sourceJSON",void 0),Object(d.a)([Object(m.b)({value:null,json:{type:[h.a],write:{target:"subLayerIds",allowNull:!0,overridePolicy:Z}}})],te.prototype,"sublayers",null),Object(d.a)([Object(j.a)("sublayers")],te.prototype,"castSublayers",null),Object(d.a)([Object(S.a)("sublayers")],te.prototype,"writeSublayers",null),Object(d.a)([Object(m.b)({type:String,json:{read:{source:"name"},write:{target:"name",allowNull:!0,overridePolicy:X}}})],te.prototype,"title",void 0),Object(d.a)([Object(m.b)({type:String})],te.prototype,"typeIdField",void 0),Object(d.a)([Object(g.a)("typeIdField",["layerDefinition.typeIdField"])],te.prototype,"readTypeIdField",null),Object(d.a)([Object(m.b)({type:[J.a],json:{origins:{service:{read:{source:"layerDefinition.types"}}}}})],te.prototype,"types",void 0),Object(d.a)([Object(m.b)({type:String,dependsOn:["layer","source"],json:{read:{source:"layerUrl"},write:{target:"layerUrl",overridePolicy:Q}}})],te.prototype,"url",null),Object(d.a)([Object(m.b)({type:Boolean,value:!0,json:{read:{source:"defaultVisibility"},write:{target:"defaultVisibility",overridePolicy:Z}}})],te.prototype,"visible",null),Object(d.a)([Object(S.a)("visible")],te.prototype,"writeVisible",null);var re=te=i=Object(d.a)([Object(w.a)("esri.layers.support.Sublayer")],te);t.a=re}}]);
//# sourceMappingURL=63.36856e07.chunk.js.map