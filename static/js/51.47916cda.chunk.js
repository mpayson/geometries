(this.webpackJsonpgeometries=this.webpackJsonpgeometries||[]).push([[51],{1100:function(e,t,r){"use strict";var n=r(2),i=r(3),a=r(5),s=r(6),o=r(0),c=(r(13),r(14),r(15),r(1)),u=r(8),l=(r(11),r(19),r(20),function(e){Object(a.a)(r,e);var t=Object(s.a)(r);function r(){return Object(n.a)(this,r),t.apply(this,arguments)}return Object(i.a)(r,[{key:"initialize",value:function(){}},{key:"destroy",value:function(){}},{key:"supportsTileUpdates",get:function(){return!1}},{key:"spatialReference",get:function(){var e=this.get("tileStore.tileScheme.spatialReference");return e&&e.toJSON()||null}}]),r}(r(158).a));Object(o.a)([Object(c.b)({readOnly:!0})],l.prototype,"supportsTileUpdates",null),Object(o.a)([Object(c.b)({constructOnly:!0})],l.prototype,"remoteClient",void 0),Object(o.a)([Object(c.b)({constructOnly:!0})],l.prototype,"service",void 0),Object(o.a)([Object(c.b)({dependsOn:["tileStore.tileScheme.spatialReference"]})],l.prototype,"spatialReference",null),Object(o.a)([Object(c.b)({constructOnly:!0})],l.prototype,"tileInfo",void 0),Object(o.a)([Object(c.b)({constructOnly:!0})],l.prototype,"tileStore",void 0);var h=l=Object(o.a)([Object(u.a)("esri.views.2d.layers.features.processors.BaseProcessor")],l);t.a=h},1315:function(e,t,r){"use strict";r.r(t);var n=r(12),i=r(10),a=r.n(i),s=r(21),o=r(2),c=r(3),u=r(5),l=r(6),h=r(0),f=r(13),p=r(4),v=r(14),y=(r(15),r(1),r(8)),d=(r(23),r(11),r(19),r(20),r(16)),b=r(44),m=r(804),x=r(779),O=r(831),g=r(904),_=r(843),j=r(859),k=r(901),M=r(894),w=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;Object(o.a)(this,e),this._bucketSize=t,this._rowsLength=x.F/t,this._colsLength=x.F/t,this._elementsPerBucket=r,this._grid=this._initGrid()}return Object(c.a)(e,[{key:"checkOverlap",value:function(e,t){var r=Math.floor(e/this._bucketSize),n=Math.floor(t/this._bucketSize);return r<0||r>=this._rowsLength||n<0||n>=this._colsLength||this._grid[n*this._colsLength+r]>=this._elementsPerBucket}},{key:"markUsed",value:function(e,t){var r=Math.floor(e/this._bucketSize),n=Math.floor(t/this._bucketSize);this._grid[n*this._colsLength+r]+=1}},{key:"reset",value:function(){this._grid=this._initGrid()}},{key:"_initGrid",value:function(){return new Uint8Array(this._rowsLength*this._colsLength)}}]),e}(),S=r(1100);v.a.getLogger("esri.views.2d.layers.features.processors.SymbolProcessor");var z=function(e){Object(u.a)(r,e);var t=Object(l.a)(r);function r(){var e;return Object(o.a)(this,r),(e=t.apply(this,arguments)).type="symbol",e}return Object(c.a)(r,[{key:"destroy",value:function(){}},{key:"supportsTileUpdates",get:function(){return!0}},{key:"update",value:function(){var e=Object(s.a)(a.a.mark((function e(t,r){var n,i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("symbol"===(n=r.schema.processors[0]).type){e.next=3;break}return e.abrupt("return");case 3:i=Object(m.a)(this._schema,n),Object(m.b)(i,"mesh")&&(Object(f.a)("esri-2d-update-debug")&&console.debug("Applying Update - Processor:",i),t.mesh=!0,t.why.mesh.push("Symbology changed"),this._schema=n,this._factory=this._createFactory(n),this._factory.update(n,this.tileStore.tileScheme.tileInfo));case 5:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"onTileData",value:function(e,t,r){return Object(d.w)(r),this._onTileData(e,t,r)}},{key:"onTileError",value:function(e,t,r){var n=r.signal,i={tileKey:e.id,error:t};return this.remoteClient.invoke("tileRenderer.onTileError",i,{signal:n})}},{key:"_createFactory",value:function(e){var t=this,r=this.service,n=r.geometryType,i=r.objectIdField,a={geometryType:n,fields:r.fields,spatialReference:b.a.fromJSON(this.spatialReference)},s=new j.a((function(e,r){return t.remoteClient.invoke("tileRenderer.getMaterialItems",e,r)}),!1);return this._store=s,this._matcher=Object(g.a)(e.mesh.matcher,s,a),new k.a(n,i,s)}},{key:"_onTileData",value:function(){var e=Object(s.a)(a.a.mark((function e(t,r,n){var i,s,o,c,u,l,h,f,v,y,b,m;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=r.type,s=r.addOrUpdate,o=r.remove,c=r.end,s){e.next=4;break}return u={type:i,addOrUpdate:null,remove:o,clear:!1,end:c},e.abrupt("return",this.remoteClient.invoke("tileRenderer.onTileData",{tileKey:t.id,data:u},n));case 4:return l=this._processFeatures(t,s,n),h=n.signal,e.prev=5,e.next=8,l;case 8:return f=e.sent,v=Object(p.a)(f,(function(e){return e.message})),y=Object(p.a)(f,(function(e){return e.transferList}))||[],b={type:i,addOrUpdate:v,remove:o,clear:!1,end:c},m={transferList:Object(p.o)(y)||[],signal:h},e.abrupt("return",(Object(d.w)(m),this.remoteClient.invoke("tileRenderer.onTileData",{tileKey:t.id,data:b},m)));case 16:e.prev=16,e.t0=e.catch(5),this._handleError(t,e.t0,n);case 19:case"end":return e.stop()}}),e,this,[[5,16]])})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"_processFeatures",value:function(){var e=Object(s.a)(a.a.mark((function e(t,r,n){var i,s,o,c,u;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Object(p.h)(r)&&r.hasFeatures){e.next=2;break}return e.abrupt("return",null);case 2:return i={transform:t.transform,hasZ:!1,hasM:!1},s=this._factory,o={viewingMode:"",scale:t.scale},e.next=7,this._matcher;case 7:return c=e.sent,Object(d.w)(n),u=this._getLabelInfos(t,r),e.next=12,s.analyze(r.getCursor(),c,i,o);case 12:return Object(d.w)(n),e.abrupt("return",this._writeFeatureSet(t,r,i,u,s));case 14:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"_writeFeatureSet",value:function(e,t,r,n,i){for(var a=i.createMeshData(t.getApproximateSize()),s={viewingMode:"",scale:e.scale},o=t.getCursor();o.next();)try{var c=o.getDisplayId(),u=Object(p.i)(n)?n.get(c):null;i.writeCursor(a,o,r,s,e.level,u)}catch(e){}return this._encodeDisplayData(a)}},{key:"_encodeDisplayData",value:function(e){var t={},r=new Array;return e.encode(t,r),{message:t,transferList:r}}},{key:"_handleError",value:function(e,t,r){if(!Object(d.n)(t)){var n={tileKey:e.id,error:t.message};return this.remoteClient.invoke("tileRenderer.onTileError",n,{signal:r.signal})}}},{key:"_shouldDiscard",value:function(e,t){switch(this.service.geometryType){case"esriGeometryPoint":var r=t.readLegacyPointGeometry();return!r||e.checkOverlap(r.x,r.y);case"esriGeometryPolygon":var n=t.readLegacyCentroid();return!n||e.checkOverlap(n.x,n.y);default:return!1}}},{key:"_markUsed",value:function(e,t){switch(this.service.geometryType){case"esriGeometryPoint":var r=t.readLegacyPointGeometry(),n=r.x,i=r.y;return e.markUsed(n,i);case"esriGeometryPolygon":var a=t.readLegacyCentroid(),s=a.x,o=a.y;return e.markUsed(s,o)}}},{key:"_getLabelInfos",value:function(e,t){var r=this,i=this._schema.mesh.labels,a=Object(p.a)(i,(function(t){return t.filter((function(t){return function(e,t){return(!e.minScale||e.minScale>=t)&&(!e.maxScale||e.maxScale<=t)}(t,e.scale)}))}));if(Object(p.h)(a)||0===a.length)return null;for(var s=new Map,o=new w(x.e),c=t.getCursor(),u=function(){var e=c.getDisplayId();if(r._shouldDiscard(o,c))return s.has(e)||s.set(e,null),"continue";var t,i=!1,u=[],l=Object(M.b)(e),h=l&&1!==c.readAttribute("cluster_count")?"aggregate":"feature",f=Object(n.a)(a);try{var p=function(){var n=t.value;if(n.target!==h)return"continue";var a=c.getStorage(),s=l&&"feature"===h?a.getComputedStringAtIndex(c.readAttribute("referenceId"),n.fieldIndex):a.getComputedStringAtIndex(e,n.fieldIndex);if(!s)return"continue";var o=Object(O.a)(s.toString()),f=o[0],p=o[1];r._store.getMosaicItem(n.symbol,Object(_.a)(f)).then((function(e){u[n.index]={glyphs:e.glyphMosaicItems,rtl:p,index:n.index}})),i=!0};for(f.s();!(t=f.n()).done;)p()}catch(v){f.e(v)}finally{f.f()}s.set(e,u),i&&r._markUsed(o,c)};c.next();)u();return s}}]),r}(S.a),C=z=Object(h.a)([Object(y.a)("esri.views.2d.layers.features.processors.SymbolProcessor")],z);t.default=C},782:function(e,t,r){"use strict";r.d(t,"a",(function(){return g})),r.d(t,"b",(function(){return M})),r.d(t,"c",(function(){return j})),r.d(t,"d",(function(){return _})),r.d(t,"e",(function(){return d})),r.d(t,"f",(function(){return k})),r.d(t,"g",(function(){return v})),r.d(t,"h",(function(){return y}));var n=r(9),i=r(61),a=r(55),s=r(5),o=r(6),c=r(2),u=r(3),l=r(23),h=r(780),f=r(922);function p(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=h.e.SIZE_FIELD_STOPS|h.e.SIZE_MINMAX_VALUE|h.e.SIZE_SCALE_STOPS|h.e.SIZE_UNIT_VALUE,n=(e&(h.f.FIELD_TARGETS_OUTLINE|h.f.MINMAX_TARGETS_OUTLINE|h.f.SCALE_TARGETS_OUTLINE|h.f.UNIT_TARGETS_OUTLINE))>>>4;return t?r&n:r&~n}function v(e,t,r,n,i){switch(e){case h.d.FILL:return g.from(t,n);case h.d.LINE:return j.from(t,r);case h.d.MARKER:return _.from(t);case h.d.TEXT:return k.from(t);case h.d.LABEL:return M.from(t,i);default:throw new Error("Unable to createMaterialKey for unknown geometryType ".concat(e))}}function y(e){switch(d.load(e).geometryType){case h.d.MARKER:return new _(e);case h.d.FILL:return new g(e);case h.d.LINE:return new j(e);case h.d.TEXT:return new k(e);case h.d.LABEL:return new M(e)}}var d=function(){function e(t){Object(c.a)(this,e),this._data=0,this._data=t}return Object(u.a)(e,[{key:"data",get:function(){return this._data},set:function(e){this._data=e}},{key:"geometryType",get:function(){return this.bits(8,11)},set:function(e){this.setBits(e,8,11)}},{key:"mapAligned",get:function(){return!!this.bit(20)},set:function(e){this.setBit(20,e)}},{key:"sdf",get:function(){return!!this.bit(11)},set:function(e){this.setBit(11,e)}},{key:"pattern",get:function(){return!!this.bit(12)},set:function(e){this.setBit(12,e)}},{key:"textureBinding",get:function(){return this.bits(0,8)},set:function(e){this.setBits(e,0,8)}},{key:"geometryTypeString",get:function(){switch(this.geometryType){case h.d.FILL:return"fill";case h.d.MARKER:return"marker";case h.d.LINE:return"line";case h.d.TEXT:return"text";case h.d.LABEL:return"label";default:throw new l.a("Unable to handle unknown geometryType: ".concat(this.geometryType))}}},{key:"setBit",value:function(e,t){var r=1<<e;t?this._data|=r:this._data&=~r}},{key:"bit",value:function(e){return(this._data&1<<e)>>e}},{key:"setBits",value:function(e,t,r){for(var n=t,i=0;n<r;n++,i++)this.setBit(n,0!=(e&1<<i))}},{key:"bits",value:function(e,t){for(var r=0,n=e,i=0;n<t;n++,i++)r|=this.bit(n)<<i;return r}},{key:"hasVV",value:function(){return!1}},{key:"setVV",value:function(e,t){}},{key:"getVariation",value:function(){return{mapAligned:this.mapAligned,pattern:this.pattern,sdf:this.sdf}}},{key:"getVariationHash",value:function(){return this._data&~(7&this.textureBinding)}}],[{key:"load",value:function(e){var t=this.shared;return t.data=e,t}}]),e}();d.shared=new d(0);var b=function(e){return function(e){Object(s.a)(r,e);var t=Object(o.a)(r);function r(){return Object(c.a)(this,r),t.apply(this,arguments)}return Object(u.a)(r,[{key:"vvSizeMinMaxValue",get:function(){return 0!==this.bit(16)},set:function(e){this.setBit(16,e)}},{key:"vvSizeScaleStops",get:function(){return 0!==this.bit(17)},set:function(e){this.setBit(17,e)}},{key:"vvSizeFieldStops",get:function(){return 0!==this.bit(18)},set:function(e){this.setBit(18,e)}},{key:"vvSizeUnitValue",get:function(){return 0!==this.bit(19)},set:function(e){this.setBit(19,e)}},{key:"hasVV",value:function(){return Object(i.a)(Object(a.a)(r.prototype),"hasVV",this).call(this)||this.vvSizeMinMaxValue||this.vvSizeScaleStops||this.vvSizeFieldStops||this.vvSizeUnitValue}},{key:"setVV",value:function(e,t){Object(i.a)(Object(a.a)(r.prototype),"setVV",this).call(this,e,t);var n=p(e,t)&e;this.vvSizeMinMaxValue=!!(n&h.e.SIZE_MINMAX_VALUE),this.vvSizeFieldStops=!!(n&h.e.SIZE_FIELD_STOPS),this.vvSizeUnitValue=!!(n&h.e.SIZE_UNIT_VALUE),this.vvSizeScaleStops=!!(n&h.e.SIZE_SCALE_STOPS)}}]),r}(e)},m=function(e){return function(e){Object(s.a)(r,e);var t=Object(o.a)(r);function r(){return Object(c.a)(this,r),t.apply(this,arguments)}return Object(u.a)(r,[{key:"vvRotation",get:function(){return 0!==this.bit(15)},set:function(e){this.setBit(15,e)}},{key:"hasVV",value:function(){return Object(i.a)(Object(a.a)(r.prototype),"hasVV",this).call(this)||this.vvRotation}},{key:"setVV",value:function(e,t){Object(i.a)(Object(a.a)(r.prototype),"setVV",this).call(this,e,t),this.vvRotation=!t&&!!(e&h.e.ROTATION)}}]),r}(e)},x=function(e){return function(e){Object(s.a)(r,e);var t=Object(o.a)(r);function r(){return Object(c.a)(this,r),t.apply(this,arguments)}return Object(u.a)(r,[{key:"vvColor",get:function(){return 0!==this.bit(13)},set:function(e){this.setBit(13,e)}},{key:"hasVV",value:function(){return Object(i.a)(Object(a.a)(r.prototype),"hasVV",this).call(this)||this.vvColor}},{key:"setVV",value:function(e,t){Object(i.a)(Object(a.a)(r.prototype),"setVV",this).call(this,e,t),this.vvColor=!t&&!!(e&h.e.COLOR)}}]),r}(e)},O=function(e){return function(e){Object(s.a)(r,e);var t=Object(o.a)(r);function r(){return Object(c.a)(this,r),t.apply(this,arguments)}return Object(u.a)(r,[{key:"vvOpacity",get:function(){return 0!==this.bit(14)},set:function(e){this.setBit(14,e)}},{key:"hasVV",value:function(){return Object(i.a)(Object(a.a)(r.prototype),"hasVV",this).call(this)||this.vvOpacity}},{key:"setVV",value:function(e,t){Object(i.a)(Object(a.a)(r.prototype),"setVV",this).call(this,e,t),this.vvOpacity=!t&&!!(e&h.e.OPACITY)}}]),r}(e)},g=function(e){Object(s.a)(r,e);var t=Object(o.a)(r);function r(){return Object(c.a)(this,r),t.apply(this,arguments)}return Object(u.a)(r,[{key:"getVariation",value:function(){return Object(n.a)(Object(n.a)({},Object(i.a)(Object(a.a)(r.prototype),"getVariation",this).call(this)),{},{dotDensity:this.dotDensity,vvColor:this.vvColor,vvOpacity:this.vvOpacity})}},{key:"dotDensity",get:function(){return!!this.bit(15)},set:function(e){this.setBit(15,e)}}],[{key:"load",value:function(e){var t=this.shared;return t.data=e,t}},{key:"from",value:function(e,t){var r=this.load(0);return r.geometryType=h.d.FILL,t?r.dotDensity=!0:r.setVV(e,!1),r.data}}]),r}(x(O(d)));g.shared=new g(0);var _=function(e){Object(s.a)(r,e);var t=Object(o.a)(r);function r(){return Object(c.a)(this,r),t.apply(this,arguments)}return Object(u.a)(r,[{key:"getVariation",value:function(){return Object(n.a)(Object(n.a)({},Object(i.a)(Object(a.a)(r.prototype),"getVariation",this).call(this)),{},{vvColor:this.vvColor,vvRotation:this.vvRotation,vvOpacity:this.vvOpacity,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue})}}],[{key:"load",value:function(e){var t=this.shared;return t.data=e,t}},{key:"from",value:function(e){var t=this.load(0);return t.geometryType=h.d.MARKER,t.setVV(e,!1),t.data}}]),r}(x(O(m(b(d)))));_.shared=new _(0);var j=function(e){Object(s.a)(r,e);var t=Object(o.a)(r);function r(){return Object(c.a)(this,r),t.apply(this,arguments)}return Object(u.a)(r,[{key:"getVariation",value:function(){return Object(n.a)(Object(n.a)({},Object(i.a)(Object(a.a)(r.prototype),"getVariation",this).call(this)),{},{vvColor:this.vvColor,vvOpacity:this.vvOpacity,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue})}}],[{key:"load",value:function(e){var t=this.shared;return t.data=e,t}},{key:"from",value:function(e,t){var r=this.load(0);return r.geometryType=h.d.LINE,r.setVV(e,t),r.data}}]),r}(x(O(b(d))));j.shared=new j(0);var k=function(e){Object(s.a)(r,e);var t=Object(o.a)(r);function r(){return Object(c.a)(this,r),t.apply(this,arguments)}return Object(u.a)(r,[{key:"getVariation",value:function(){return Object(n.a)(Object(n.a)({},Object(i.a)(Object(a.a)(r.prototype),"getVariation",this).call(this)),{},{vvColor:this.vvColor,vvOpacity:this.vvOpacity,vvRotation:this.vvRotation,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue})}}],[{key:"load",value:function(e){var t=this.shared;return t.data=e,t}},{key:"from",value:function(e){var t=this.load(e);return t.geometryType=h.d.TEXT,t.setVV(e,!1),t.data}}]),r}(x(O(m(b(d)))));k.shared=new k(0);var M=function(e){Object(s.a)(r,e);var t=Object(o.a)(r);function r(){return Object(c.a)(this,r),t.apply(this,arguments)}return Object(u.a)(r,[{key:"getVariation",value:function(){return Object(n.a)(Object(n.a)({},Object(i.a)(Object(a.a)(r.prototype),"getVariation",this).call(this)),{},{vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue})}}],[{key:"load",value:function(e){var t=this.shared;return t.data=e,t}},{key:"from",value:function(e,t){var r=this.load(0);return r.geometryType=h.d.LABEL,r.setVV(e,!1),r.mapAligned=!!Object(f.a)(t),r.data}}]),r}(b(d));M.shared=new M(0)},792:function(e,t,r){"use strict";r.d(t,"a",(function(){return f})),r.d(t,"b",(function(){return v})),r.d(t,"c",(function(){return d})),r.d(t,"d",(function(){return y})),r.d(t,"e",(function(){return p}));r(13);var n=r(4),i=r(110),a=r(150),s=r(118),o=r(231),c=r(798),u=s.a.fromJSON(c.a),l=i.a.fromJSON(c.c),h=a.a.fromJSON(c.b),f=o.a.fromJSON(c.d);function p(e){if(Object(n.h)(e))return null;switch(e.type){case"mesh":return null;case"point":case"multipoint":return u;case"polyline":return l;case"polygon":case"extent":return h}return null}var v=s.a.fromJSON(c.e),y=i.a.fromJSON(c.g),d=a.a.fromJSON(c.f)},796:function(e,t,r){"use strict";r.d(t,"a",(function(){return p}));var n=r(2),i=r(3),a=r(4),s=r(58),o=r(780),c=r(12),u=r(791),l=r(911),h=r(872),f=function(){function e(){Object(n.a)(this,e)}return Object(i.a)(e,null,[{key:"executeEffects",value:function(e,t){var r,n=Object(u.c)(t),i=new l.a(n),a=Object(c.a)(e);try{for(a.s();!(r=a.n()).done;){var s=r.value,o=Object(h.a)(s);o&&(i=o.execute(i,s,1.3333333333333333))}}catch(f){a.e(f)}finally{a.f()}return i}},{key:"next",value:function(e){var t=e.next();return Object(u.d)(t),t}}]),e}(),p=function(){function e(){Object(n.a)(this,e)}return Object(i.a)(e,[{key:"needsPixelBuffer",get:function(){return!!this.effects||this.geometryType===o.d.MARKER||this.geometryType===o.d.TEXT||this.geometryType===o.d.LABEL}},{key:"writeMesh",value:function(e,t,r,n,i){if(Object(a.h)(this.effects))return this.writeMeshWithGeometry(e,t,r,n,i);for(var o=f.executeEffects(this.effects,r.readLegacyGeometry()),c=f.next(o);c;)this.writeMeshWithGeometry(e,t,r,Object(s.c)(c),i,c),c=f.next(o)}},{key:"writeMeshWithGeometry",value:function(e,t,r,n,i,a){}},{key:"bindFeature",value:function(e,t,r){}}]),e}()},799:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i}));var n=r(12);function i(e,t){if(null!==t){e.push(t.length);var r,i=Object(n.a)(t);try{for(i.s();!(r=i.n()).done;){r.value.serialize(e)}}catch(a){i.e(a)}finally{i.f()}return e}e.push(0)}function a(e,t,r){for(var n=e.readInt32(),i=new Array(n),a=0;a<i.length;a++)i[a]=t.deserialize(e,r);return i}},803:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(23);function i(e,t){if(e&&"name"in e){var r=e;return t&&t.error(new n.a(r.name,r.message,r.details)),!1}return!0}},811:function(e,t,r){"use strict";var n=r(12),i=r(2),a=r(3),s=r(14),o=r(779),c=r(360),u=r(906),l=r(799),h=s.a.getLogger("esri/views/2d/engine/webgl/collisions/Metric"),f=function(){function e(t,r,n,a,s){Object(i.a)(this,e),this.id=t,this.range=r,this.boxes=null,this.minZoom=-1,this.size=0,this.directionX=0,this.directionY=0,this.offsetX=0,this.offsetY=0,this.placementPadding=0,this.anchor=Object(c.b)(n,a),this.baseZoom=s}return Object(a.a)(e,[{key:"add",value:function(e,t,r){e.x=e.x+t,e.y=e.y+r,this.bounds?this.boxes?(this.boxes.push(e),this.bounds.extend(e)):(this.boxes=[this.bounds,e],this.bounds=this.bounds.clone(),this.bounds.extend(e)):this.bounds=e}},{key:"computeIndex",value:function(){var e=this.anchor[0],t=this.anchor[1],r=Math.floor(e/o.d),n=Math.floor(t/o.d);this.xBucket=r,this.yBucket=n;var i=o.F/o.d;if(this.hasVV)return this.xOverflow=i,void(this.yOverflow=i);this.xOverflow=Math.min(i,Math.ceil(2*this.bounds.width/o.d)),this.yOverflow=Math.min(i,Math.ceil(2*this.bounds.height/o.d))}},{key:"findCollisionDelta",value:function(e){var t=this.bounds.findCollisionDelta(e.bounds),r=this.boxes&&this.boxes.length,n=e.boxes&&e.boxes.length;return Math.abs(t)>o.f||!r&&!n?t:r&&n?this._boxesToBoxes(e):r?this._boxesToBox(e):this._boxToBoxes(e)}},{key:"computeVVOffset",value:function(e,t){t||h.error("mapview-labeling","Unable to compute label offset. Expected an evaluator function but found ".concat(t));var r=this.size;if(this.hasVV){var n=t(e);r=isNaN(n)||null==n||n===1/0?this.size:n}this._computeOffset(r)}},{key:"setPlacementOffset",value:function(e,t,r,n,i){this.hasVV=e,this.size=t,this.placementPadding=Math.round(r),this.directionX=n,this.directionY=i}},{key:"clone",value:function(){var t=new e(this.id,this.range,this.anchor[0],this.anchor[1],this.baseZoom);return t.minZoom=this.minZoom,this.bounds&&(t.bounds=this.bounds.clone()),this.boxes&&(t.boxes=this.boxes.map((function(e){return e.clone()}))),t.xBucket=this.xBucket,t.yBucket=this.yBucket,t.xOverflow=this.xOverflow,t.yOverflow=this.yOverflow,t.hasVV=this.hasVV,t.size=this.size,t.directionX=this.directionX,t.directionY=this.directionY,t.offsetX=this.offsetX,t.offsetY=this.offsetY,t}},{key:"_boxToBoxes",value:function(e){var t,r=-1/0,i=Object(n.a)(e.boxes);try{for(i.s();!(t=i.n()).done;){var a=t.value,s=this.bounds.findCollisionDelta(a);r=Math.max(s,r)}}catch(o){i.e(o)}finally{i.f()}return r}},{key:"_boxesToBox",value:function(e){for(var t=this.boxes[0].findCollisionDelta(e.bounds),r=1;r<this.boxes.length;r++){var n=this.boxes[r].findCollisionDelta(e.bounds);t=Math.max(n,t)}return t}},{key:"_boxesToBoxes",value:function(e){for(var t=-1/0,r=0;r<this.boxes.length;r++){var i,a=this.boxes[r],s=Object(n.a)(e.boxes);try{for(s.s();!(i=s.n()).done;){var o=i.value,c=a.findCollisionDelta(o);t=Math.max(c,t)}}catch(u){s.e(u)}finally{s.f()}}return t}},{key:"_computeOffset",value:function(e){this.offsetX=this.directionX*(e/2+this.placementPadding),this.offsetY=this.directionY*(e/2+this.placementPadding)}},{key:"serialize",value:function(e){return e.push(this.id),this.bounds.serialize(e),e.push(this.range.from),e.push(this.range.count),e.push(this.anchor[0]),e.push(this.anchor[1]),e.push(this.baseZoom),e.push(this.hasVV?1:0),e.push(this.size),e.writeF32(this.directionX),e.writeF32(this.directionY),e.push(this.offsetX),e.push(this.offsetY),e.push(this.placementPadding),Object(l.b)(e,this.boxes),e}}],[{key:"deserialize",value:function(t){var r=t.readInt32(),n=u.a.deserialize(t),i={from:t.readInt32(),count:t.readInt32()},a=t.readInt32(),s=t.readInt32(),o=t.readInt32(),c=t.readInt32(),h=t.readInt32(),f=t.readF32(),p=t.readF32(),v=t.readInt32(),y=t.readInt32(),d=t.readInt32(),b=Object(l.a)(t,u.a),m=new e(r,i,a,s,o);return m.bounds=n,m.boxes=b,m.setPlacementOffset(!!c,h,d,f,p),m.offsetX=v,m.offsetY=y,m.computeIndex(),c||m._computeOffset(h),m}}]),e}();t.a=f},814:function(e,t,r){"use strict";var n=r(12),i=r(2),a=r(3),s=r(781),o=function(){function e(){Object(i.a)(this,e),this.vertexData=new Map,this.vertexCount=0,this.indexData=[]}return Object(a.a)(e,[{key:"clear",value:function(){this.vertexData.clear(),this.vertexCount=0,this.indexData=[]}},{key:"update",value:function(e,t,r){for(var n in e)this.vertexData.set(n,e[n]);for(var i in this.vertexData)null===e[i]&&this.vertexData.delete(i);this.vertexCount=t,this.indexData=r}}]),e}(),c=function(){function e(t,r,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;Object(i.a)(this,e),this.id=t,this.geometryType=r,this.materialKey=n,this.minZoom=a,this.maxZoom=s,this.meshData=null,this.symbolLevel=0,this.zOrder=0,this.vertexFrom=0,this.vertexCount=0,this.indexFrom=0,this.indexCount=0}return Object(a.a)(e,[{key:"sortKey",get:function(){return void 0===this._sortKey&&this._computeSortKey(),this._sortKey}},{key:"clone",value:function(){return this.copy()}},{key:"copy",value:function(){var t=new e(this.id,this.geometryType,this.materialKey);return t.vertexFrom=this.vertexFrom,t.vertexCount=this.vertexCount,t.indexFrom=this.indexFrom,t.indexCount=this.indexCount,t.zOrder=this.zOrder,t.symbolLevel=this.symbolLevel,t.meshData=this.meshData,t.minZoom=this.minZoom,t.maxZoom=this.maxZoom,t}},{key:"setMeshDataFromBuffers",value:function(e,t,r){var n=new o;for(var i in t){for(var a=t[i].stride,c=t[i].data,u=[],l=Object(s.o)(a),h=0;h<a*e.vertexCount/l;++h)u[h]=c[h+a*e.vertexFrom/l];n.vertexData.set(i,u)}n.indexData.length=0;for(var f=0;f<e.indexCount;++f)n.indexData[f]=r[f+e.indexFrom]-e.vertexFrom;n.vertexCount=e.vertexCount,this.meshData=n}},{key:"readMeshDataFromBuffers",value:function(e,t){for(var r in this.meshData?this.meshData.clear():this.meshData=new o,e){for(var n=e[r].stride,i=e[r].data,a=[],c=Object(s.o)(n),u=0;u<n*this.vertexCount/c;++u)a[u]=i[u+n*this.vertexFrom/c];this.meshData.vertexData.set(r,a)}this.meshData.indexData.length=0;for(var l=0;l<this.indexCount;++l)this.meshData.indexData[l]=t[l+this.indexFrom]-this.vertexFrom;this.meshData.vertexCount=this.vertexCount}},{key:"writeMeshDataToBuffers",value:function(e,t,r,n){for(var i in t)for(var a=t[i].stride,o=this.meshData.vertexData.get(i),c=t[i].data,u=Object(s.o)(a),l=0;l<a*this.meshData.vertexCount/u;++l)c[l+a*e/u]=o[l];for(var h=0;h<this.meshData.indexData.length;++h)n[h+r]=this.meshData.indexData[h]+e;this.vertexFrom=e,this.vertexCount=this.meshData.vertexCount,this.indexFrom=r,this.indexCount=this.meshData.indexData.length}},{key:"_computeSortKey",value:function(){this._sortKey=(31&this.symbolLevel)<<12|(127&this.zOrder)<<4|7&this.geometryType}},{key:"serialize",value:function(e){return e.push(this.geometryType),e.push(this.materialKey),e.push(this.vertexFrom),e.push(this.vertexCount),e.push(this.indexFrom),e.push(this.indexCount),e.push(this.minZoom),e.push(this.maxZoom),e}}],[{key:"writeAllMeshDataToBuffers",value:function(e,t,r){var i,a=0,s=0,o=Object(n.a)(e);try{for(o.s();!(i=o.n()).done;){var c=i.value;c.writeMeshDataToBuffers(a,t,s,r),a+=c.vertexCount,s+=c.indexCount}}catch(u){o.e(u)}finally{o.f()}}},{key:"deserialize",value:function(t,r){var n=t.readInt32(),i=t.readInt32(),a=new e(r.id,n,i);return a.vertexFrom=t.readInt32(),a.vertexCount=t.readInt32(),a.indexFrom=t.readInt32(),a.indexCount=t.readInt32(),a.minZoom=t.readInt32(),a.maxZoom=t.readInt32(),a}}]),e}();t.a=c},815:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(2),i=r(3),a=function(){function e(t,r){Object(n.a)(this,e),this._pos=0;var i=r?this._roundToNearest(r,t.BYTES_PER_ELEMENT):40;this._array=new ArrayBuffer(i),this._buffer=new t(this._array),this._ctor=t}return Object(i.a)(e,[{key:"length",get:function(){return this._pos}},{key:"_roundToNearest",value:function(e,t){var r=Math.round(e);return r+(t-r%t)}},{key:"_ensureSize",value:function(e){if(this._pos+e>=this._buffer.length){var t=this._roundToNearest(1.5*(this._array.byteLength+e*this._buffer.BYTES_PER_ELEMENT),this._buffer.BYTES_PER_ELEMENT),r=new ArrayBuffer(t),n=new this._ctor(r);n.set(this._buffer,0),this._array=r,this._buffer=n}}},{key:"writeF32",value:function(e){this._ensureSize(1);var t=this._pos;return new Float32Array(this._array,4*this._pos,1)[0]=e,this._pos++,t}},{key:"push",value:function(e){this._ensureSize(1);var t=this._pos;return this._buffer[this._pos++]=e,t}},{key:"writeFixed",value:function(e){this._buffer[this._pos++]=e}},{key:"setValue",value:function(e,t){this._buffer[e]=t}},{key:"getValue",value:function(e){return this._buffer[e]}},{key:"incr",value:function(e){this._buffer[e]++}},{key:"decr",value:function(e){this._buffer[e]--}},{key:"writeRegion",value:function(e){this._ensureSize(e.length);var t=this._pos;return this._buffer.set(e,this._pos),this._pos+=e.length,t}},{key:"buffer",value:function(){var e=this._array.slice(0,4*this._pos);return this.destroy(),e}},{key:"toArray",value:function(){for(var e=this._array,t=[],r=0;r<e.byteLength/4;r++)t.push(e[r]);return t}},{key:"seek",value:function(e){this._pos=e}},{key:"destroy",value:function(){this._array=null,this._buffer=null}}]),e}()},819:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r(2),i=r(3),a=r(806),s=function(){function e(t,r){Object(n.a)(this,e),this._storage=new a.c,this._storage.maxSize=t,r&&this._storage.registerRemoveFunc("",r)}return Object(i.a)(e,[{key:"put",value:function(e,t,r){this._storage.put(e,t,r,1)}},{key:"pop",value:function(e){return this._storage.pop(e)}},{key:"get",value:function(e){return this._storage.get(e)}},{key:"clear",value:function(){this._storage.clearAll()}},{key:"destroy",value:function(){this._storage.clearAll()}},{key:"maxSize",get:function(){return this._storage.maxSize},set:function(e){this._storage.maxSize=e}}]),e}()},827:function(e,t,r){"use strict";r.d(t,"a",(function(){return l})),r.d(t,"b",(function(){return c})),r.d(t,"c",(function(){return u})),r.d(t,"d",(function(){return o}));Number.POSITIVE_INFINITY;var n=Math.PI,i=128/n,a=1/Math.LN2;function s(e,t){return(e%=t)>=0?e:e+t}function o(e){return s(e*i,256)}function c(e){return s(.7111111111111111*e,256)}function u(e){return Math.log(e)*a}function l(e,t,r){return e>=t&&e<=r||e>=r&&e<=t}},828:function(e,t,r){"use strict";r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return a})),r.d(t,"c",(function(){return c})),r.d(t,"d",(function(){return f})),r.d(t,"e",(function(){return l})),r.d(t,"f",(function(){return p})),r.d(t,"g",(function(){return h})),r.d(t,"h",(function(){return o})),r.d(t,"i",(function(){return u}));var n=r(32),i=r(12);function a(e,t,r){var a=function(e){for(var t=e.length;t--;)if(-1===" /-,\n".indexOf(e.charAt(t)))return!1;return!0},o=[],c=0,u=-1;do{if((u=t.indexOf("[",c))>=c){if(u>c){var l=t.substr(c,u-c);o.push([l,null,a(l)])}if(c=u+1,(u=t.indexOf("]",c))>=c){if(u>c){var h=e[t.substr(c,u-c)];h&&o.push([null,h,!1])}c=u+1}}}while(-1!==u);if(c<t.length-1){var f=t.substr(c);o.push([f,null,a(f)])}return function(e){var t,a="",c=null,u=Object(i.a)(o);try{for(u.s();!(t=u.n()).done;){var l=t.value,h=Object(n.a)(l,3),f=h[0],p=h[1],v=h[2];if(f)v?c=f:(c&&(a+=c,c=null),a+=f);else{var y=e.attributes[p];y&&(c&&(a+=c,c=null),a+=y)}}}catch(d){u.e(d)}finally{u.f()}return s(a,r)}}function s(e,t){switch("string"!=typeof e&&(e=String(e)),t){case"LowerCase":return e.toLowerCase();case"Allcaps":return e.toUpperCase();default:return e}}function o(e,t,r,n,i,a){for(var s=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],o=t/i,c=r/a,u=Math.ceil(o/2),l=Math.ceil(c/2),h=0;h<a;h++)for(var f=0;f<i;f++){for(var p=4*(f+(s?a-h-1:h)*i),v=0,y=0,d=0,b=0,m=0,x=0,O=0,g=(h+.5)*c,_=Math.floor(h*c);_<(h+1)*c;_++)for(var j=Math.abs(g-(_+.5))/l,k=(f+.5)*o,M=j*j,w=Math.floor(f*o);w<(f+1)*o;w++){var S=Math.abs(k-(w+.5))/u,z=Math.sqrt(M+S*S);z>=-1&&z<=1&&((v=2*z*z*z-3*z*z+1)>0&&(O+=v*e[(S=4*(w+_*t))+3],d+=v,e[S+3]<255&&(v=v*e[S+3]/250),b+=v*e[S],m+=v*e[S+1],x+=v*e[S+2],y+=v))}n[p]=b/y,n[p+1]=m/y,n[p+2]=x/y,n[p+3]=O/d}}function c(e){return e?{r:e[0],g:e[1],b:e[2],a:e[3]/255}:{r:0,g:0,b:0,a:0}}function u(e){var t;return null==(t=e.data)?void 0:t.symbol}function l(e){return"CIMVectorMarker"===e.type||"CIMPictureMarker"===e.type||"CIMBarChartMarker"===e.type||"CIMCharacterMarker"===e.type||"CIMPieChartMarker"===e.type||"CIMStackedBarChartMarker"===e.type}function h(e){return"CIMGradientStroke"===e.type||"CIMPictureStroke"===e.type||"CIMSolidStroke"===e.type}function f(e){return"CIMGradientFill"===e.type||"CIMHatchFill"===e.type||"CIMPictureFill"===e.type||"CIMSolidFill"===e.type||"CIMWaterFill"===e.type}function p(e){return"CIMMarkerPlacementAlongLineRandomSize"===e.type||"CIMMarkerPlacementAlongLineSameSize"===e.type||"CIMMarkerPlacementAlongLineVariableSize"===e.type||"CIMMarkerPlacementAtExtremities"===e.type||"CIMMarkerPlacementAtMeasuredUnits"===e.type||"CIMMarkerPlacementAtRatioPositions"===e.type||"CIMMarkerPlacementOnLine"===e.type||"CIMMarkerPlacementOnVertices"===e.type}},838:function(e,t,r){"use strict";var n=r(2),i=r(3),a=r(814),s=r(799),o=r(811),c=function(){function e(t){Object(n.a)(this,e),this.insertAfter=null,this.id=t,this.displayRecords=[],this.metrics=[]}return Object(i.a)(e,[{key:"copy",value:function(){var t=new e(this.id);return t.set(this),t}},{key:"clone",value:function(){var t=new e(this.id);return t.displayRecords=this.displayRecords.map((function(e){return e.clone()})),t.metrics=this.metrics.map((function(e){return e.clone()})),t.insertAfter=this.insertAfter,t}},{key:"set",value:function(e){this.id=e.id,this.displayRecords=e.displayRecords,this.metrics=e.metrics,this.insertAfter=e.insertAfter}},{key:"serialize",value:function(e){return e.push(this.id),Object(s.b)(e,this.metrics),Object(s.b)(e,this.displayRecords),e}}],[{key:"deserialize",value:function(t){var r=t.readInt32(),n=new e(r),i={id:r},c=Object(s.a)(t,o.a);return c.length&&(n.metrics=c),n.displayRecords=Object(s.a)(t,a.a,i),n}}]),e}();t.a=c},840:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(2),i=r(3),a=r(781),s=function(){function e(t,r,i){Object(n.a)(this,e),this.data=t,this.stride=r,this.vertexCount=i}return Object(i.a)(e,null,[{key:"decode",value:function(t){return new e(Object(a.c)(t.data,t.stride),t.stride,t.vertexCount)}},{key:"fromVertexVector",value:function(t){return new e(Object(a.c)(t.data.buffer(),t.stride),t.stride,t.vertexCount)}}]),e}(),o=function(){function e(t,r,i){Object(n.a)(this,e),this.geometryType=t,this.indexBuffer=new Uint32Array(r),this.namedBuffers=i}return Object(i.a)(e,null,[{key:"decode",value:function(t){var r=t.geometryType,n=t.indexBuffer,i={};for(var a in t.namedBuffers)i[a]=s.decode(t.namedBuffers[a]);return new e(r,n,i)}},{key:"fromVertexVectors",value:function(t){var r=t.geometryType,n=t.indexVector.buffer(),i={};for(var a in t.namedVectors)i[a]=s.fromVertexVector(t.namedVectors[a]);return new e(r,n,i)}}]),e}()},843:function(e,t,r){"use strict";function n(e){for(var t=new Array(e.length),r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}r.d(t,"a",(function(){return n}))},846:function(e,t,r){"use strict";r.d(t,"a",(function(){return f}));var n=r(41),i=r(2),a=r(3),s=r(814),o=r(799),c=r(811),u=r(838),l=function(){function e(t){Object(i.a)(this,e),this._pos=0,this._buffer=t,this._i32View=new Int32Array(this._buffer),this._f32View=new Float32Array(this._buffer)}return Object(a.a)(e,[{key:"readInt32",value:function(){return this._i32View[this._pos++]}},{key:"readF32",value:function(){return this._f32View[this._pos++]}}]),e}(),h=r(815),f=function(){function e(t,r){Object(i.a)(this,e),this.vertexVectorsMap=t,this._currentIndex=-1,this._currentRecordOffset=0,this._currentMetricOffset=0,this._currentMetrics=[];var n=4*(4*r.features+1),a=4*(8*r.records+1),s=4*(20*r.metrics+1);this._bufDisplayObjects=new h.a(Uint32Array,n+4),this._bufDisplayRecords=new h.a(Uint32Array,a+4),this._bufMetrics=new h.a(Uint32Array,s+4),this._bufDisplayObjects.push(0),this._bufDisplayRecords.push(0),this._bufMetrics.push(0)}return Object(a.a)(e,[{key:"vertexBuffersMap",get:function(){if(!this._vertexBuffersMap){this._vertexBuffersMap={};for(var e=0;e<this.vertexVectorsMap.length;e++)this._vertexBuffersMap[e]=this.vertexVectorsMap[e].intoBuffers();this.vertexVectorsMap=null}return this._vertexBuffersMap}},{key:"get",value:function(e){return this.vertexVectorsMap[e]}},{key:"currentDisplayRecordCount",value:function(){return this._bufDisplayRecords[this._currentRecordOffset]}},{key:"writeDisplayObject",value:function(e,t){this._bufDisplayObjects.incr(0),this._currentIndex=this._bufDisplayObjects.push(e),this._bufDisplayObjects.push(t),this._bufDisplayObjects.push(0),this._bufDisplayObjects.push(0),this._currentRecordOffset=0,this._currentMetricOffset=0,this._currentMetrics=[]}},{key:"hasDisplayRecords",value:function(){return!(0===this._currentRecordOffset)}},{key:"endDisplayObject",value:function(){this.hasDisplayRecords()?this._currentMetrics&&(0===this._currentMetricOffset&&(this._bufDisplayObjects.setValue(this._currentIndex+3,this._bufMetrics.length),this._currentMetricOffset=this._bufMetrics.length),Object(o.b)(this._bufMetrics,this._currentMetrics)):this._rollbackDisplayObject()}},{key:"writeDisplayRecord",value:function(e,t,r,n,i,a){var s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0;0===this._currentRecordOffset&&(this._currentRecordOffset=this._bufDisplayRecords.push(0),this._bufDisplayObjects.setValue(this._currentIndex+2,this._currentRecordOffset)),this._bufDisplayRecords.incr(this._currentRecordOffset),this._bufDisplayRecords.push(e),this._bufDisplayRecords.push(t),this._bufDisplayRecords.push(r),this._bufDisplayRecords.push(n),this._bufDisplayRecords.push(i),this._bufDisplayRecords.push(a),this._bufDisplayRecords.push(s),this._bufDisplayRecords.push(o)}},{key:"writeMetrics",value:function(e){var t;e&&(t=this._currentMetrics).push.apply(t,Object(n.a)(e))}},{key:"encode",value:function(e,t){for(var r={},n=0;n<this.vertexVectorsMap.length;n++){var i=this.vertexVectorsMap[n];r[n]={},i.transfer(r[n],t)}e.bufDisplayObjects=this._bufDisplayObjects.buffer(),e.bufRecords=this._bufDisplayRecords.buffer(),e.bufMetrics=this._bufMetrics.buffer(),t.push(e.bufDisplayObjects),t.push(e.bufMetrics),t.push(e.bufRecords),e.vertexBuffersMap=r,this.destroy()}},{key:"destroy",value:function(){this.vertexVectorsMap=null,this._bufDisplayObjects=null,this._bufDisplayRecords=null,this._bufMetrics=null}},{key:"_rollbackDisplayObject",value:function(){this._bufDisplayObjects.decr(0),this._bufDisplayObjects.seek(this._bufDisplayObjects.length-4),this._currentIndex=this._bufDisplayObjects.length}}],[{key:"deserializeDisplayObjects",value:function(e){var t=e.bufDisplayObjects,r=e.bufMetrics,n=e.bufRecords,i=new l(t),a=new l(n),h=new l(r),f=[],p=i.readInt32();for(a.readInt32(),h.readInt32();p--;){var v=i.readInt32(),y=i.readInt32(),d=i.readInt32(),b=i.readInt32(),m=new u.a(v);0!==y&&(m.insertAfter=y),0!==d&&(m.displayRecords=Object(o.a)(a,s.a,{id:v})),0!==b&&(m.metrics=Object(o.a)(h,c.a)),f.push(m)}return f}}]),e}()},848:function(e,t,r){"use strict";r.d(t,"a",(function(){return U})),r.d(t,"b",(function(){return w}));var n=r(10),i=r.n(n),a=r(32),s=r(9),o=r(12),c=r(21),u=r(108),l=r(14),h=r(16),f=r(244),p=r(52),v=r(36),y=r(828),d=r(849),b=r(876),m=r(891),x=l.a.getLogger("esri.symbols.cim.cimAnalyzer");function O(e){switch(e){case"Butt":return 0;case"Square":return 2;case"Round":default:return 1}}function g(e){switch(e){case"Bevel":return 0;case"Miter":return 2;case"Round":default:return 1}}function _(e){switch(e){case"Left":default:return"left";case"Right":return"right";case"Center":return"center";case"Justify":return"justify"}}function j(e){switch(e){case"Top":default:return"top";case"Center":return"middle";case"Baseline":return"baseline";case"Bottom":return"bottom"}}function k(e,t,r,n){var i;e[t]?i=e[t]:(i={},e[t]=i),i[r]=n}function M(e){var t=e.markerPlacement;return t&&t.angleToLine?1:0}function w(e,t,r,n){return S.apply(this,arguments)}function S(){return(S=Object(c.a)(i.a.mark((function e(t,r,n,a){var s,c,u,l,p,v,y,d;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=n||[],t){e.next=3;break}return e.abrupt("return",s);case 3:if(l={},"CIMSymbolReference"===t.type){e.next=6;break}return e.abrupt("return",(x.error("Expect cim type to be 'CIMSymbolReference'"),s));case 6:if(c=t.symbol,!(u=t.primitiveOverrides)){e.next=12;break}p=[],v=Object(o.a)(u);try{for(d=function(){var e=y.value,t=e.valueExpressionInfo;if(t&&r){var n=t.expression,i=Object(f.d)(n,r.spatialReference,r.fields).then((function(t){t&&k(l,e.primitiveName,e.propertyName,t)}));p.push(i)}else null!=e.value&&k(l,e.primitiveName,e.propertyName,e.value)},v.s();!(y=v.n()).done;)d()}catch(i){v.e(i)}finally{v.f()}return e.next=12,Object(h.b)(p);case 12:switch(c.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":!function(e,t,r,n,i,a){if(e){var s=e.symbolLayers;if(s){var o,c=b.a.getSize(e);"CIMPointSymbol"===e.type&&"Map"===e.angleAlignment&&(o=1);for(var u=s.length;u--;){var l=s[u];if(l&&!1!==l.enable){var h=[];switch(b.b.findApplicableOverrides(l,t,h),l.type){case"CIMSolidFill":z(l,r,h,n,i);break;case"CIMPictureFill":C(l,r,h,n,i);break;case"CIMHatchFill":L(l,r,h,n,i);break;case"CIMGradientFill":I(l,r,h,n,i);break;case"CIMSolidStroke":T(l,r,h,n,i,"CIMPolygonSymbol"===e.type,c);break;case"CIMPictureStroke":P(l,r,h,n,i,"CIMPolygonSymbol"===e.type,c);break;case"CIMGradientStroke":V(l,r,h,n,i,"CIMPolygonSymbol"===e.type,c);break;case"CIMCharacterMarker":if(D(l,r,h,n,i))break;break;case"CIMPictureMarker":if(D(l,r,h,n,i))break;"CIMLineSymbol"===e.type&&(o=M(l)),R(l,r,h,n,i,o,c);break;case"CIMVectorMarker":if(D(l,r,h,n,i))break;"CIMLineSymbol"===e.type&&(o=M(l)),F(l,r,h,n,i,o,c,a);break;default:x.error("Cannot analyze CIM layer",l.type)}}}}}}(c,u,l,r,s,a)}return e.abrupt("return",s);case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function z(e,t,r,n,i){var a=e.primitiveName,s=Object(y.c)(e.color),o=Object(u.b)(JSON.stringify(e)).toString();i.push({type:"fill",templateHash:o,materialHash:0===r.length?o:function(){return o},cim:e,materialOverrides:null,colorLocked:e.colorLocked,color:X(a,t,"Color",n,s,Z),height:0,angle:0,offsetX:0,offsetY:0,scaleX:1,effects:e.effects})}function C(e,t,r,n,i){var a=e.primitiveName,s=e.tintColor?Object(y.c)(e.tintColor):{r:255,g:255,b:255,a:1},o=Object(u.b)(JSON.stringify(e)).toString(),c=Object(u.b)("".concat(e.url).concat(JSON.stringify(e.colorSubstitutions))).toString();i.push({type:"fill",templateHash:o,materialHash:0===r.length?c:function(){return c},cim:e,materialOverrides:null,colorLocked:e.colorLocked,effects:e.effects,color:X(a,t,"TintColor",n,s,Z),height:X(a,t,"Height",n,e.height),scaleX:X(a,t,"ScaleX",n,e.scaleX),angle:X(a,t,"Rotation",n,e.rotation),offsetX:X(a,t,"OffsetX",n,e.offsetX),offsetY:X(a,t,"OffsetY",n,e.offsetY)})}function L(e,t,r,n,i){var a=["Rotation","OffsetX","OffsetY"],s=r.filter((function(t){return t.primitiveName!==e.primitiveName&&-1===a.indexOf(t.propertyName)})),o=e.primitiveName,c=Object(u.b)(JSON.stringify(e)).toString(),l=Object(u.b)("".concat(e.separation).concat(JSON.stringify(e.lineSymbol))).toString();i.push({type:"fill",templateHash:c,materialHash:0===r.length?l:G(l,t,s,n),cim:e,materialOverrides:s,colorLocked:e.colorLocked,effects:e.effects,color:{r:255,g:255,b:255,a:1},height:X(o,t,"Separation",n,e.separation),scaleX:1,angle:X(o,t,"Rotation",n,e.rotation),offsetX:X(o,t,"OffsetX",n,e.offsetX),offsetY:X(o,t,"OffsetY",n,e.offsetY)})}function I(e,t,r,n,i){var a=Object(u.b)(JSON.stringify(e)).toString();i.push({type:"fill",templateHash:a,materialHash:0===r.length?a:G(a,t,r,n),cim:e,materialOverrides:null,colorLocked:e.colorLocked,effects:e.effects,color:{r:128,g:128,b:128,a:1},height:0,angle:0,offsetX:0,offsetY:0,scaleX:1})}function T(e,t,r,n,i,a,s){var o=Object(u.b)(JSON.stringify(e)).toString(),c=e.primitiveName,l=Object(y.c)(e.color),h=void 0!==e.width?e.width:4,f=O(e.capStyle),p=g(e.joinStyle),v=e.miterLimit;i.push({type:"line",templateHash:o,materialHash:0===r.length?o:function(){return o},cim:e,materialOverrides:null,isOutline:a,colorLocked:e.colorLocked,effects:e.effects,color:X(c,t,"Color",n,l,Z),width:X(c,t,"Width",n,h),cap:X(c,t,"CapStyle",n,f),join:X(c,t,"JoinStyle",n,p),miterLimit:X(c,t,"MiterLimit",n,v),referenceWidth:s,zOrder:B(e.name),isDashed:!1})}function P(e,t,r,n,i,a,s){var o=Object(u.b)("".concat(e.url).concat(JSON.stringify(e.colorSubstitutions))).toString(),c=e.primitiveName,l=Object(y.c)(e.tintColor),h=void 0!==e.width?e.width:4,f=O(e.capStyle),p=g(e.joinStyle),v=e.miterLimit,d=Object(u.b)(JSON.stringify(e)).toString();i.push({type:"line",templateHash:d,materialHash:0===r.length?o:function(){return o},cim:e,materialOverrides:null,isOutline:a,colorLocked:e.colorLocked,effects:e.effects,color:X(c,t,"TintColor",n,l,Z),width:X(c,t,"Width",n,h),cap:X(c,t,"CapStyle",n,f),join:X(c,t,"JoinStyle",n,p),miterLimit:X(c,t,"MiterLimit",n,v),referenceWidth:s,zOrder:B(e.name),isDashed:!1})}function V(e,t,r,n,i,a,s){var o=e.primitiveName,c=void 0!==e.width?e.width:4,l=O(e.capStyle),h=g(e.joinStyle),f=e.miterLimit,p=Object(u.b)(JSON.stringify(e)).toString();i.push({type:"line",templateHash:p,materialHash:0===r.length?p:G(p,t,r,n),cim:e,materialOverrides:null,isOutline:a,colorLocked:e.colorLocked,effects:e.effects,color:{r:128,g:128,b:128,a:1},width:X(o,t,"Width",n,c),cap:X(o,t,"CapStyle",n,l),join:X(o,t,"JoinStyle",n,h),miterLimit:X(o,t,"MiterLimit",n,f),referenceWidth:s,zOrder:B(e.name),isDashed:!1})}function D(e,t,r,n,i){var a=e.markerPlacement;if(!a||"CIMMarkerPlacementInsidePolygon"!==a.type)return!1;var s=a,o=["Rotation","OffsetX","OffsetY"],c=r.filter((function(t){return t.primitiveName!==e.primitiveName&&-1===o.indexOf(t.propertyName)})),l=Object(u.b)(JSON.stringify(e)).toString();return i.push({type:"fill",templateHash:l,materialHash:0===r.length?l:G(l,t,c,n),cim:e,materialOverrides:c,colorLocked:e.colorLocked,effects:e.effects,color:{r:255,g:255,b:255,a:1},height:X(s.primitiveName,t,"StepY",n,s.stepY),scaleX:1,angle:X(s.primitiveName,t,"GridAngle",n,s.gridAngle),offsetX:X(s.primitiveName,t,"OffsetX",n,s.offsetX),offsetY:X(s.primitiveName,t,"OffsetY",n,s.offsetY)}),!0}function R(e,t,r,n,i,a,s){var c,l=e.primitiveName,h=e.size,f=e.scaleX,p=e.rotation,v=e.offsetX,d=e.offsetY,b=Object(y.c)(e.tintColor),m=Object(u.b)("".concat(e.url).concat(JSON.stringify(e.colorSubstitutions))).toString(),x=!1,O="",g=Object(o.a)(r);try{for(g.s();!(c=g.n()).done;){var _=c.value;_.primitiveName===l&&(void 0!==_.value?O+="-".concat(_.primitiveName,"-").concat(_.propertyName,"-").concat(JSON.stringify(_.value)):_.valueExpressionInfo&&(x=!0))}}catch(j){g.e(j)}finally{g.f()}i.push({type:"marker",templateHash:Object(u.b)(JSON.stringify(e)+O).toString(),materialHash:x?function(){return m}:m,cim:e,materialOverrides:null,colorLocked:e.colorLocked,effects:e.effects,scaleSymbolsProportionally:!1,alignment:a,size:X(l,t,"Size",n,h),scaleX:X(l,t,"ScaleX",n,f),rotation:X(l,t,"Rotation",n,p),offsetX:X(l,t,"OffsetX",n,v),offsetY:X(l,t,"OffsetY",n,d),color:X(l,t,"TintColor",n,b,Z),anchorPoint:e.anchorPoint,isAbsoluteAnchorPoint:"Relative"!==e.anchorPointUnits,outlineColor:{r:0,g:0,b:0,a:0},outlineWidth:0,frameHeight:0,rotateClockwise:e.rotateClockwise,referenceSize:s,sizeRatio:1,markerPlacement:e.markerPlacement})}function F(e,t,r,n,i,a,s,c){var u=e.markerGraphics;if(u){var l=0;if(e.scaleSymbolsProportionally){var h=e.frame;h&&(l=h.ymax-h.ymin)}var f,p=Object(o.a)(u);try{for(p.s();!(f=p.n()).done;){var v=f.value;if(v){var y=v.symbol;if(!y)continue;switch(y.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":N(e,v,r,t,n,i,a,s,l,c);break;case"CIMTextSymbol":A(e,v,t,r,n,i,a,s,l)}}}}catch(d){p.e(d)}finally{p.f()}}}function A(e,t,r,n,i,a,c,l,h){b.b.findApplicableOverrides(t,n,[]);var f=t.geometry;if("x"in f&&"y"in f){var p,v=t.symbol,d=(p=v).underline?"underline":p.strikethrough?"line-through":"none",m=function(e){var t="normal",r="normal";if(e){var n=e.toLowerCase();-1!==n.indexOf("italic")?t="italic":-1!==n.indexOf("oblique")&&(t="oblique"),-1!==n.indexOf("bold")?r="bold":-1!==n.indexOf("light")&&(r="lighter")}return{style:t,weight:r}}(v.fontStyleName);v.font=Object(s.a)({family:v.fontFamilyName,decoration:d},m);var x=e.frame,O=f.x-.5*(x.xmin+x.xmax),g=f.y-.5*(x.ymin+x.ymax),k=e.size/h,M=e.primitiveName,w=(v.height||0)*k,S=v.angle||0,z=((v.offsetX||0)+O)*k,C=((v.offsetY||0)+g)*k,L=Object(y.c)(b.a.getFillColor(v)),I=Object(y.c)(b.a.getStrokeColor(v)),T=b.a.getStrokeWidth(v);T||(I=Object(y.c)(b.a.getFillColor(v.haloSymbol)),T=v.haloSize*k);var P,V="",D=Object(o.a)(n);try{for(D.s();!(P=D.n()).done;){var R=P.value;R.primitiveName===M&&void 0!==R.value&&(V+="-".concat(R.primitiveName,"-").concat(R.propertyName,"-").concat(JSON.stringify(R.value)))}}catch(N){D.e(N)}finally{D.f()}var F=JSON.stringify(e.effects)+Number(e.colorLocked)+JSON.stringify(e.anchorPoint)+e.anchorPointUnits+JSON.stringify(e.markerPlacement),A=Object(u.b)(JSON.stringify(t)+F+V).toString();a.push({type:"text",templateHash:A,materialHash:function(){return Object(u.b)(JSON.stringify(v.font)).toString()},cim:v,materialOverrides:null,colorLocked:e.colorLocked,effects:e.effects,alignment:c,anchorPoint:{x:e.anchorPoint?e.anchorPoint.x:0,y:e.anchorPoint?e.anchorPoint.y:0},isAbsoluteAnchorPoint:"Relative"!==e.anchorPointUnits,fontName:v.fontFamilyName,decoration:"none",weight:"normal",style:"normal",size:X(M,r,"Size",i,w),angle:X(M,r,"Rotation",i,S),offsetX:X(M,r,"OffsetX",i,z),offsetY:X(M,r,"OffsetY",i,C),horizontalAlignment:_(v.horizontalAlignment),verticalAlignment:j(v.verticalAlignment),text:X(t.primitiveName,r,"TextString",i,t.textString,y.a,v.textCase),color:L,outlineColor:I,outlineSize:T,referenceSize:l,sizeRatio:1,markerPlacement:e.markerPlacement})}}function N(e,t,r,n,i,c,l,h,f,p){var v=t.symbol,d=t.geometry;if(d){var x=v.symbolLayers;if(x)if(p)E(e,t,n,r,i,c,l,h,f);else for(var O=x.length;O--;){var g=x[O];if(g&&!1!==g.enable)switch(g.type){case"CIMSolidFill":case"CIMSolidStroke":var _=function(){var p=Object(m.b)(d);if(!p)return"continue";var v=Object(m.d)(p,e.frame,e.size,e.anchorPoint,"Relative"!==e.anchorPointUnits),x=Object(a.a)(v,3),O=x[0],_=x[1],j=x[2],k="CIMSolidFill"===g.type,M={type:"sdf",geom:d,asFill:k},w=e.primitiveName,S=e.size,z=e.rotation||0,C=e.offsetX,L=e.offsetY,I=g.primitiveName,T=Object(y.c)(k?b.a.getFillColor(g):b.a.getStrokeColor(g)),P=k?{r:0,g:0,b:0,a:0}:Object(y.c)(b.a.getStrokeColor(g)),V=b.a.getStrokeWidth(g);if(!k&&!V)return"break";var D,R=!1,F="",A=Object(o.a)(r);try{for(A.s();!(D=A.n()).done;){var N=D.value;N.primitiveName!==I&&N.primitiveName!==w||(void 0!==N.value?F+="-".concat(N.primitiveName,"-").concat(N.propertyName,"-").concat(JSON.stringify(N.value)):N.valueExpressionInfo&&(R=!0))}}catch(U){A.e(U)}finally{A.f()}var E=JSON.stringify(Object(s.a)(Object(s.a)({},e),{},{markerGraphics:null})),B=Object(u.b)(JSON.stringify(M)).toString(),G={type:"marker",templateHash:Object(u.b)(JSON.stringify(t)+JSON.stringify(g)+E+F).toString(),materialHash:R?function(){return B}:B,cim:M,materialOverrides:null,colorLocked:e.colorLocked,effects:e.effects,scaleSymbolsProportionally:e.scaleSymbolsProportionally,alignment:l,anchorPoint:{x:_,y:j},isAbsoluteAnchorPoint:!1,size:X(e.primitiveName,n,"Size",i,S),rotation:X(e.primitiveName,n,"Rotation",i,z),offsetX:X(e.primitiveName,n,"OffsetX",i,C),offsetY:X(e.primitiveName,n,"OffsetY",i,L),scaleX:1,frameHeight:f,rotateClockwise:e.rotateClockwise,referenceSize:h,sizeRatio:O,color:X(I,n,"Color",i,T,Z),outlineColor:X(I,n,"Color",i,P,Z),outlineWidth:X(I,n,"Width",i,V),markerPlacement:e.markerPlacement};return c.push(G),"break"}();if("continue"===_)continue;if("break"===_)break;default:E(e,t,n,r,i,c,l,h,f)}}}}function E(e,t,r,n,i,s,c,l,h){var f,p=function(e,t){return{type:e.type,enable:!0,name:e.name,colorLocked:e.colorLocked,primitiveName:e.primitiveName,anchorPoint:e.anchorPoint,anchorPointUnits:e.anchorPointUnits,offsetX:0,offsetY:0,rotateClockwise:e.rotateClockwise,rotation:0,size:e.size,billboardMode3D:e.billboardMode3D,depth3D:e.depth3D,frame:e.frame,markerGraphics:[t],scaleSymbolsProportionally:e.scaleSymbolsProportionally,respectFrame:e.respectFrame,clippingPath:e.clippingPath,effects:e.effects}}(e,t),y=["Rotation","OffsetX","OffsetY"];f=n.filter((function(t){return t.primitiveName!==e.primitiveName||-1===y.indexOf(t.propertyName)}));var d,m="",x=Object(o.a)(n);try{for(x.s();!(d=x.n()).done;){var O=d.value;void 0!==O.value&&(m+="-".concat(O.primitiveName,"-").concat(O.propertyName,"-").concat(JSON.stringify(O.value)))}}catch(T){x.e(T)}finally{x.f()}var g=b.a.getTextureAnchor(p),_=Object(a.a)(g,3),j=_[0],k=_[1],M=_[2],w=e.primitiveName,S=e.rotation||0,z=e.offsetX||0,C=e.offsetY||0,L=Object(u.b)(JSON.stringify(p)+m).toString(),I={type:"marker",templateHash:L,materialHash:0===f.length?L:G(L,r,f,i),cim:p,materialOverrides:f,colorLocked:e.colorLocked,effects:e.effects,scaleSymbolsProportionally:e.scaleSymbolsProportionally,alignment:c,anchorPoint:{x:j,y:k},isAbsoluteAnchorPoint:!1,size:e.size,rotation:X(w,r,"Rotation",i,S),offsetX:X(w,r,"OffsetX",i,z),offsetY:X(w,r,"OffsetY",i,C),color:{r:0,g:0,b:0,a:0},outlineColor:{r:0,g:0,b:0,a:0},outlineWidth:0,scaleX:1,frameHeight:h,rotateClockwise:e.rotateClockwise,referenceSize:l,sizeRatio:M/Object(v.g)(e.size),markerPlacement:e.markerPlacement};s.push(I)}function B(e){if(e&&0===e.indexOf("Level_")){var t=parseInt(e.substr(6),10);if(NaN!==t)return t}return 0}function Z(e){if(!e||0===e.length)return null;var t=new p.a(e).toRgba();return{r:t[0],g:t[1],b:t[2],a:t[3]}}function X(e,t,r,n,i,a,s){var o=t[e];if(o){var c=o[r];if("string"==typeof c||"number"==typeof c||c instanceof Array)return a?a.call(null,c,s):c;if(null!=c&&c instanceof f.a)return function(e,t,r){var o=Object(d.a)(c,e,{$view:r},n.geometryType,t);return null!==o&&a&&(o=a.call(null,o,s)),null!==o?o:i}}return i}function G(e,t,r,n){var i,a=Object(o.a)(r);try{for(a.s();!(i=a.n()).done;){var s=i.value;s.valueExpressionInfo&&function(){var e=t[s.primitiveName]&&t[s.primitiveName][s.propertyName];e instanceof f.a&&(s.fn=function(t,r,i){return Object(d.a)(e,t,{$view:i},n.geometryType,r)})}()}}catch(c){a.e(c)}finally{a.f()}return function(t,n,i){var a,s=Object(o.a)(r);try{for(s.s();!(a=s.n()).done;){var l=a.value;l.fn&&(l.value=l.fn(t,n,i))}}catch(c){s.e(c)}finally{s.f()}return Object(u.b)(e+b.b.buildOverrideKey(r)).toString()}}function U(e,t){if(!t||0===t.length)return e;var r=JSON.parse(JSON.stringify(e));return b.b.applyOverrides(r,t),r}},849:function(e,t,r){"use strict";var n=r(9),i=r(14),a=r(23),s=r(279);var o=new Map;t.a=function(e,t,r,c,u){var l=e.referencesGeometry()&&u?function(e,t,r){var c=r.transform,u=r.hasZ,l=r.hasM;o.has(t)||o.set(t,function(e){var t={};switch(e){case"esriGeometryPoint":return function(e,r,n,i){return Object(s.e)(r,t,e,n,i)};case"esriGeometryPolygon":return function(e,r,n,i){return Object(s.f)(r,t,e,n,i)};case"esriGeometryPolyline":return function(e,r,n,i){return Object(s.g)(r,t,e,n,i)};case"esriGeometryMultipoint":return function(e,r,n,i){return Object(s.d)(r,t,e,n,i)};default:return i.a.getLogger("esri.views.2d.support.arcadeOnDemand").error(new a.a("mapview-arcade","Unable to handle geometryType: ".concat(e))),function(e){return e}}}(t));var h=o.get(t)(e.geometry,c,u,l);return Object(n.a)(Object(n.a)({},e),{},{geometry:h})}(t,c,u):t,h=e.repurposeFeature(l);try{return e.evaluate(Object(n.a)(Object(n.a)({},r),{},{$feature:h}))}catch(f){return i.a.getLogger("esri.views.2d.support.arcadeOnDemand").warn("Feature arcade evaluation failed:",f),null}}},850:function(e,t,r){"use strict";var n,i=r(2),a=r(3),s=r(5),o=r(6),c=r(0),u=(r(13),r(14),r(15),r(1)),l=r(8),h=(r(11),r(19),r(20),r(868)),f=n=function(e){Object(s.a)(r,e);var t=Object(o.a)(r);function r(){var e;return Object(i.a)(this,r),(e=t.apply(this,arguments)).showLegend=null,e}return Object(a.a)(r,[{key:"clone",value:function(){return new n({title:this.title,showLegend:this.showLegend})}}]),r}(h.a);Object(c.a)([Object(u.b)({type:Boolean,json:{write:!0}})],f.prototype,"showLegend",void 0);var p=f=n=Object(c.a)([Object(l.a)("esri.renderers.visualVariables.support.VisualVariableLegendOptions")],f);t.a=p},851:function(e,t,r){"use strict";var n=r(32),i=r(2),a=r(3),s=r(5),o=r(6),c=r(36),u=r(810),l=r(831),h=r(782),f=r(785),p=r(852),v=r(796),y=function(e){Object(s.a)(r,e);var t=Object(o.a)(r);function r(e,n,a,s,o,l,f,p,v,y,d,b,m,x,O,g,_){var j,k=arguments.length>17&&void 0!==arguments[17]&&arguments[17];Object(i.a)(this,r),(j=t.call(this))._xOffset=Object(c.g)(b),j._yOffset=Object(c.g)(m),j._decoration=v||"none",j._color=s,j._haloColor=o,j._haloSize=Math.min(Math.floor(5*Object(c.g)(Object(c.j)(a))),127),j._size=Math.min(Math.round(Object(c.g)(n)),127);var M=Math.min(Math.round(Object(c.g)(n)),127);j._referenceSize=Math.round(Math.sqrt(256*M)),j._scale=j._size/24,j._angle=d,j._justify=Object(u.c)(l||"center"),j._xAlignD=Object(u.d)(l||"center"),j._yAlignD=Object(u.f)(f||"baseline"),j._baseline="baseline"===(f||"baseline"),j._bitset=(1===p?1:0)|(y?1:0)<<1;var w=h.e.load(e);return w.sdf=!0,j._materialKey=w.data,j._lineWidth=Object(c.g)(x)||512,j._lineHeight=O||1,j._textPlacement=g,j.effects=_,j._isCIM=k,j}return Object(a.a)(r,null,[{key:"fromText",value:function(e,t){var i=new r(e.materialKey,e.font.size,e.haloSize||0,e.color&&Object(f.d)(e.color)||0,e.haloColor&&Object(f.d)(e.haloColor)||0,e.horizontalAlignment,e.verticalAlignment,0,e.font.decoration,!1,e.angle||0,e.xoffset,e.yoffset,e.lineWidth,e.lineHeight,null,null,!1),a=Object(l.a)(e.text),s=Object(n.a)(a,2)[1];return i.bindTextInfo(t,s),i}},{key:"fromCIMText",value:function(e,t){var i=e.scaleFactor||1,a=new r(e.materialKey,e.size*e.sizeRatio*i,e.outlineSize*e.sizeRatio,Object(f.c)(e.color),Object(f.c)(e.outlineColor),e.horizontalAlignment,e.verticalAlignment,e.alignment,e.decoration,e.colorLocked,e.angle,e.offsetX*e.sizeRatio*i,e.offsetY*e.sizeRatio*i,512,1,e.markerPlacement,e.effects,!0),s=Object(l.a)(e.text),o=Object(n.a)(s,2)[1];return a.bindTextInfo(t,o),a}}]),r}(Object(p.a)(v.a));t.a=y},852:function(e,t,r){"use strict";var n=r(12),i=r(32),a=r(2),s=r(3),o=r(5),c=r(6),u=r(4),l=r(36),h=r(359),f=r(779),p=r(783),v=r(883),y=r(780),d=r(782),b=r(853);t.a=function(e){return function(e){Object(o.a)(r,e);var t=Object(c.a)(r);function r(){var e;Object(a.a)(this,r);for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return(e=t.call.apply(t,[this].concat(i)))._isCIM=!1,e.geometryType=y.d.TEXT,e._aux=Object(p.b)(0,0,e._referenceSize,e._bitset),e}return Object(s.a)(r,[{key:"bindTextInfo",value:function(e,t){var r=this;e&&e.length?this._shapingInfo=Object(u.a)(e,(function(e){return Object(v.a)(e,t,{scale:r._scale,angle:r._angle,xOffset:r._xOffset,yOffset:r._yOffset,hAlign:r._xAlignD,vAlign:r._yAlignD,maxLineWidth:Math.max(32,Math.min(r._lineWidth,512)),lineHeight:f.n*Math.max(.25,Math.min(r._lineHeight,4)),decoration:r._decoration,isCIM:r._isCIM})})):this._shapingInfo=null}},{key:"writeMeshWithGeometry",value:function(e,t,r,n,a,s){var o=this;if(Object(u.i)(this._textPlacement)){var c=null!=s?s:r.readLegacyGeometry();return this._writePlacedText(e,t,a,c)}var l=s?Object(h.p)(Object(h.d)(s),2):"esriGeometryPolygon"===n?r.readCentroid():r.readUnquantizedGeometry();if(l){if(l.isPoint){var f=Object(i.a)(l.coords,2),p=f[0],v=f[1];return this._writeGlyphs(e,t,a,{x:p,y:v})}l.forEachVertex((function(r,n){return o._writeGlyphs(e,t,a,{x:r,y:n})}))}}},{key:"_writePlacedText",value:function(e,t,r,i){var a=this._shapingInfo;if(!Object(u.h)(a)){var s=d.e.load(this._materialKey),o=Object(u.o)(this._textPlacement),c=b.a.getPlacement(i,o,Object(l.g)(1));if(c)for(var h,f,v=c.next();null!=v;){f=Object(p.a)(Math.round(8*v.tx),Math.round(8*v.ty)),h=v.getAngle(),a.setRotation(h);var y,m=Object(n.a)(a.glyphs);try{for(m.s();!(y=m.n()).done;){var x=y.value;s.textureBinding=x.textureBinding;var O=t.getVector("geometry").vertexCount,g=t.indexVector.length,_=this._writeIndices(t),j=this._writeVertex(t,r,f,x);e.writeDisplayRecord(this.geometryType,s.data,O,j,g,_)}}catch(k){m.e(k)}finally{m.f()}a.setRotation(-h),v=c.next()}}}},{key:"_writeGlyphs",value:function(e,t,r,i){var a=this._shapingInfo;if(!Object(u.h)(a)){var s,o=d.e.load(this._materialKey),c=Object(p.a)(Math.round(8*i.x),Math.round(8*i.y)),l=Object(n.a)(a.glyphs);try{for(l.s();!(s=l.n()).done;){var h=s.value;o.textureBinding=h.textureBinding;var f=t.getVector("geometry").vertexCount,v=t.indexVector.length,y=this._writeIndices(t),b=this._writeVertex(t,r,c,h);e.writeDisplayRecord(this.geometryType,o.data,f,b,v,y)}}catch(m){l.e(m)}finally{l.f()}}}},{key:"_writeVertexCommon",value:function(e,t,r,n){var i=this._color,a=this._haloColor,s=Object(p.b)(0,0,this._referenceSize,this._bitset),o=Object(p.b)(0,0,this._size,this._haloSize);e.push(r),e.push(t),e.push(i),e.push(a),e.push(o),e.push(s)}},{key:"_writeVertex",value:function(e,t,r,n){var i=e.get("geometry");return this._writeVertexCommon(i,t,r,n),i.push(n.offsets.upperLeft),i.push(n.texcoords.upperLeft),this._writeVertexCommon(i,t,r,n),i.push(n.offsets.upperRight),i.push(n.texcoords.upperRight),this._writeVertexCommon(i,t,r,n),i.push(n.offsets.lowerLeft),i.push(n.texcoords.lowerLeft),this._writeVertexCommon(i,t,r,n),i.push(n.offsets.lowerRight),i.push(n.texcoords.lowerRight),4}},{key:"_writeIndices",value:function(e){var t=e.getVector("geometry").vertexCount,r=e.indexVector;return r.push(t+0),r.push(t+1),r.push(t+2),r.push(t+1),r.push(t+3),r.push(t+2),6}}]),r}(e)}},853:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(2),i=r(3),a=r(791),s=r(872),o=function(){function e(){Object(n.a)(this,e)}return Object(i.a)(e,null,[{key:"getPlacement",value:function(e,t,r){var n=Object(s.b)(t);if(!n)return null;var i=Object(a.c)(e);return n.execute(i,t,r)}}]),e}()},854:function(e,t,r){"use strict";var n=r(2),i=r(3),a=r(5),s=r(6),o=r(4),c=r(36),u=r(779),l=r(377),h=r(360),f=r(783),p=r(782),v=r(785),y=r(796),d=r(855),b=function(e){Object(a.a)(r,e);var t=Object(s.a)(r);function r(e,i,a,s,o,c,v,y,d,b,m,x,O,g,_,j,k,M,w,S,z){var C;Object(n.a)(this,r),(C=t.call(this)).angle=s,C.height=v,C.width=c,C.xOffset=i*w,C.yOffset=a*w,C._markerPlacement=S,C.effects=z,C._anchorX=.5-(.5+j)*_.width/_.width,C._anchorY=.5-(.5+k)*_.height/_.height;var L=(1===g?1:0)|(m?1:0)<<1|(O?1:0)<<2|(x?1:0)<<3,I=_&&_.sdf,T=p.d.load(e);T.sdf=I,T.pattern=!0,T.textureBinding=_.textureBinding,C._materialKey=T.data,C._fillColor=o,C._outlineColor=d,C._sizeOutlineWidth=Object(f.b)(Math.round(Math.min(Math.sqrt(128*c),255)),Math.round(Math.min(Math.sqrt(128*v),255)),Math.round(Math.min(Math.sqrt(128*b),255)),Math.round(Math.min(Math.sqrt(128*y),255)));var P=_.rect.x+u.r,V=_.rect.y+u.r,D=P+_.width,R=V+_.height;C._texUpperLeft=Object(f.a)(P,V),C._texUpperRight=Object(f.a)(D,V),C._texBottomLeft=Object(f.a)(P,R),C._texBottomRight=Object(f.a)(D,R),c*=M,v*=M,c*=w,v*=w;var F=Math.round(Math.min(64*M,255));C._bitestAndDistRatio=Object(f.b)(0,0,L,F),C._computedWidth=c,C._computedHeight=v;var A=Object(h.a)(),N=Object(l.a)();return C._applyTransformation(N,A),C}return Object(i.a)(r,null,[{key:"fromCIMMarker",value:function(e,t){var n=t&&t.width||1,i=t&&t.height||1,a=e.size,s=n/i*e.scaleX,u=e.scaleSymbolsProportionally&&e.frameHeight?a/e.frameHeight:1,l=Object(v.c)(e.color),h=Object(v.c)(e.outlineColor),f=Object(c.g)(a),p=f*s,y=Object(c.g)(e.offsetX||0),d=Object(c.g)(e.offsetY||0),b=Object(c.g)(e.outlineWidth||0)*u,m=e.alignment||0,x=Object(c.g)(e.referenceSize),O=e.rotation||0;e.rotateClockwise||(O=-O);var g=0,_=0,j=e.anchorPoint;return j&&(e.isAbsoluteAnchorPoint?a&&(g=-j.x/(a*s),_=j.y/a):(g=j.x,_=j.y)),new r(e.materialKey,y,d,O,l,p,f,x,h,b,e.colorLocked,e.scaleSymbolsProportionally,!1,m,t,g,_,e.sizeRatio,Object(o.p)(e.scaleFactor,1),e.markerPlacement,e.effects)}},{key:"fromPictureMarker",value:function(e,t){var n=Math.round(Object(c.g)(e.width)),i=Math.round(Object(c.g)(e.height)),a=u.q,s=Math.round(Object(c.g)(e.xoffset||0)),o=Math.round(Object(c.g)(e.yoffset||0));return new r(e.materialKey,s,o,e.angle,a,n,i,i,0,0,!1,!1,!1,0,t,0,0,1,1,null,null)}},{key:"fromSimpleMarker",value:function(e,t){var n=Object(v.d)(e.color),i=Math.round(Object(c.g)(e.size)),a=i,s=Math.round(Object(c.g)(e.xoffset||0)),o=Math.round(Object(c.g)(e.yoffset||0)),u=e.style,l=e.outline,h=0|(l&&l.color&&Object(v.d)(l.color)),f=0|(l&&l.width&&Math.round(Object(c.g)(l.width))),p=new r(e.materialKey,s,o,e.angle,n,i,a,a,h,f,!1,!1,"esriSMSCross"===u||"esriSMSX"===u,0,t,0,0,126/64,1,null,null);return p.boundsType="esriSMSCircle"===u?"circle":"square",p}},{key:"fromLineSymbolMarker",value:function(e,t){var n,i=Object(v.d)(e.color),a=Math.round(Object(c.g)(6*e.lineWidth)),s=a,o="cross"===e.style||"x"===e.style;switch(e.placement){case"begin-end":n="Both";break;case"begin":n="JustBegin";break;case"end":n="JustEnd";break;default:n="None"}var u={type:"CIMMarkerPlacementAtExtremities",angleToLine:!0,offset:0,extremityPlacement:n,offsetAlongLine:0},l=new r(e.materialKey,0,0,0,i,a,s,s/6,i,o?Math.round(Object(c.g)(e.lineWidth)):0,!1,!1,o,1,t,0,0,126/64,1,u,null);return l.boundsType="circle"===e.style?"circle":"square",l}}]),r}(Object(d.a)(y.a));t.a=b},855:function(e,t,r){"use strict";var n=r(32),i=r(2),a=r(3),s=r(5),o=r(6),c=r(4),u=r(36),l=r(359),h=r(29),f=r(109),p=r(377),v=r(360),y=r(783),d=r(780),b=r(853);t.a=function(e){return function(e){Object(s.a)(r,e);var t=Object(o.a)(r);function r(){var e;Object(i.a)(this,r);for(var n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];return(e=t.call.apply(t,[this].concat(a))).angle=0,e.xOffset=0,e.yOffset=0,e.width=0,e.height=0,e.boundsType="square",e._anchorX=0,e._anchorY=0,e._computedWidth=0,e._computedHeight=0,e.geometryType=d.d.MARKER,e}return Object(a.a)(r,[{key:"writeMeshWithGeometry",value:function(e,t,r,i,a,s){var o=this,u=t.indexVector,h=t.get("geometry"),f=t.getVector("geometry"),p=f.vertexCount,v=p,y=u.length;if(Object(c.i)(this._markerPlacement)){var d=null!=s?s:r.readLegacyGeometry();this._writePlacedMarkers(h,u,p,a,d)}else{var b=s?Object(l.p)(Object(l.d)(s),2):"esriGeometryPolygon"===i?r.readCentroid():r.readUnquantizedGeometry();if(!b)return;if(b.isPoint){var m=Object(n.a)(b.coords,2),x=m[0],O=m[1];this._writeVertices(h,a,this._getPos(x,O)),this._writeIndices(u,p)}else b.forEachVertex((function(e,t){var r=f.vertexCount;o._writeVertices(h,a,o._getPos(e,t)),o._writeIndices(u,r)}))}var g=t.getVector("geometry").vertexCount-v,_=u.length-y;e.writeDisplayRecord(this.geometryType,this._materialKey,v,g,y,_)}},{key:"_applyTransformation",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;Object(f.d)(e),Object(f.h)(e,e,Object(v.b)(this.xOffset,-this.yOffset)),this.angle+r!==0&&Object(f.f)(e,e,.017453292519944444*(this.angle+r));var n=this._computedWidth,i=this._computedHeight,a=(this._anchorX-.5)*n,s=(this._anchorY-.5)*i;Object(h.r)(t,a,s),Object(h.s)(t,t,e),this._offsetUpperLeft=Object(y.a)(16*t[0],16*t[1]),Object(h.r)(t,a+n,s),Object(h.s)(t,t,e),this._offsetUpperRight=Object(y.a)(16*t[0],16*t[1]),Object(h.r)(t,a,s+i),Object(h.s)(t,t,e),this._offsetBottomLeft=Object(y.a)(16*t[0],16*t[1]),Object(h.r)(t,a+n,s+i),Object(h.s)(t,t,e),this._offsetBottomRight=Object(y.a)(16*t[0],16*t[1])}},{key:"_writePlacedMarkers",value:function(e,t,r,n,i){var a=b.a.getPlacement(i,Object(c.o)(this._markerPlacement),Object(u.g)(1));if(a)for(var s=Object(v.a)(),o=Object(p.a)(),l=0,h=a.next();null!=h;)h.tx>=-128&&h.tx<=640&&h.ty>=-128&&h.ty<=640&&(this._applyTransformation(o,s,h.getAngle()/.017453292519944444),this._writeVertices(e,n,this._getPos(h.tx,h.ty)),this._writeIndices(t,r+l),l+=4),h=a.next()}},{key:"_getPos",value:function(e,t){return Object(y.a)(Math.round(8*e),Math.round(8*t))}},{key:"_writeVertices",value:function(e,t,r){e.push(r),e.push(this._offsetUpperLeft),e.push(this._texUpperLeft),e.push(this._bitestAndDistRatio),e.push(t),e.push(this._fillColor),e.push(this._outlineColor),e.push(this._sizeOutlineWidth),e.push(r),e.push(this._offsetUpperRight),e.push(this._texUpperRight),e.push(this._bitestAndDistRatio),e.push(t),e.push(this._fillColor),e.push(this._outlineColor),e.push(this._sizeOutlineWidth),e.push(r),e.push(this._offsetBottomLeft),e.push(this._texBottomLeft),e.push(this._bitestAndDistRatio),e.push(t),e.push(this._fillColor),e.push(this._outlineColor),e.push(this._sizeOutlineWidth),e.push(r),e.push(this._offsetBottomRight),e.push(this._texBottomRight),e.push(this._bitestAndDistRatio),e.push(t),e.push(this._fillColor),e.push(this._outlineColor),e.push(this._sizeOutlineWidth)}},{key:"_writeIndices",value:function(e,t){var r=t;e.push(r+0),e.push(r+1),e.push(r+2),e.push(r+1),e.push(r+3),e.push(r+2)}}]),r}(e)}},859:function(e,t,r){"use strict";r.d(t,"a",(function(){return Ke})),r.d(t,"b",(function(){return Ue}));var n=r(10),i=r.n(n),a=r(21),s=r(12),o=r(2),c=r(3),u=r(14),l=r(23),h=r(16),f=r(792),p=r(803),v=r(837),y=r(851),d=r(854),b=r(177),m=r(5),x=r(6),O=r(38),g=r(36),_=r(779),j=r(783),k=r(782),M=r(785),w=r(827),S=r(788),z=r(359),C=r(780),L=r(142),I=(r(907),r(842));function T(e,t,r,n,i,a,s){re=0;var o,c,u,l,h,f=(n-r)*a,p=i&&i.length,v=p?(i[0]-r)*a:f,y=P(t,r,n,0,v,a,!0);if(y&&y.next!==y.prev){if(p&&(y=function(e,t,r,n,i,a){for(var s=new Array,o=0,c=n.length;o<c;o++){var u=P(e,t,r,n[o]*a,o<c-1?n[o+1]*a:r*a,a,!1);u===u.next&&(u.steiner=!0),s.push(E(u))}s.sort(W);for(var l=0,h=s;l<h.length;l++){B(h[l],i),i=V(i,i.next)}return i}(t,r,n,i,y,a)),f>80*a){o=u=t[0+r*a],c=l=t[1+r*a];for(var d=a;d<v;d+=a){var b=t[d+r*a],m=t[d+1+r*a];o=Math.min(o,b),c=Math.min(c,m),u=Math.max(u,b),l=Math.max(l,m)}h=0!==(h=Math.max(u-o,l-c))?1/h:0}D(y,e,a,o,c,h,s,0)}}function P(e,t,r,n,i,a,s){var o;if(s===function(e,t,r,n,i,a){for(var s=0,o=n,c=i-a;o<i;o+=a)s+=(e[c+t*a]-e[o+t*a])*(e[o+1+t*a]+e[c+1+t*a]),c=o;return s}(e,t,0,n,i,a)>0)for(var c=n;c<i;c+=a)o=A(c+t*a,e[c+t*a],e[c+1+t*a],o);else for(var u=i-a;u>=n;u-=a)o=A(u+t*a,e[u+t*a],e[u+1+t*a],o);return o&&H(o,o.next)&&(N(o),o=o.next),o}function V(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;if(!e)return e;var r,n=e;do{if(r=!1,n.steiner||!H(n,n.next)&&0!==X(n.prev,n,n.next))n=n.next;else{if(N(n),(n=t=n.prev)===n.next)break;r=!0}}while(r||n!==t);return t}function D(e,t,r,n,i,a,s,o){if(e){!o&&a&&(e=Z(e,n,i,a));for(var c=e;e.prev!==e.next;){var u=e.prev,l=e.next;if(a?F(e,n,i,a):R(e))t.push(u.index/r+s),t.push(e.index/r+s),t.push(l.index/r+s),N(e),e=l.next,c=l.next;else if((e=l)===c){o?1===o?D(e=q(e,t,r,s),t,r,n,i,a,s,2):2===o&&J(e,t,r,n,i,a,s):D(V(e),t,r,n,i,a,s,1);break}}}}function R(e){var t=e.prev,r=e,n=e.next;if(X(t,r,n)>=0)return!1;for(var i=e.next.next,a=i,s=0;i!==e.prev&&(0===s||i!==a);){if(s++,U(t.x,t.y,r.x,r.y,n.x,n.y,i.x,i.y)&&X(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function F(e,t,r,n){var i=e.prev,a=e,s=e.next;if(X(i,a,s)>=0)return!1;for(var o=i.x<a.x?i.x<s.x?i.x:s.x:a.x<s.x?a.x:s.x,c=i.y<a.y?i.y<s.y?i.y:s.y:a.y<s.y?a.y:s.y,u=i.x>a.x?i.x>s.x?i.x:s.x:a.x>s.x?a.x:s.x,l=i.y>a.y?i.y>s.y?i.y:s.y:a.y>s.y?a.y:s.y,h=Y(o,c,t,r,n),f=Y(u,l,t,r,n),p=e.prevZ,v=e.nextZ;p&&p.z>=h&&v&&v.z<=f;){if(p!==e.prev&&p!==e.next&&U(i.x,i.y,a.x,a.y,s.x,s.y,p.x,p.y)&&X(p.prev,p,p.next)>=0)return!1;if(p=p.prevZ,v!==e.prev&&v!==e.next&&U(i.x,i.y,a.x,a.y,s.x,s.y,v.x,v.y)&&X(v.prev,v,v.next)>=0)return!1;v=v.nextZ}for(;p&&p.z>=h;){if(p!==e.prev&&p!==e.next&&U(i.x,i.y,a.x,a.y,s.x,s.y,p.x,p.y)&&X(p.prev,p,p.next)>=0)return!1;p=p.prevZ}for(;v&&v.z<=f;){if(v!==e.prev&&v!==e.next&&U(i.x,i.y,a.x,a.y,s.x,s.y,v.x,v.y)&&X(v.prev,v,v.next)>=0)return!1;v=v.nextZ}return!0}function A(e,t,r,n){var i=ee.create(e,t,r);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function N(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function E(e){var t=e,r=e;do{(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next}while(t!==e);return r}function B(e,t){if(t=function(e,t){var r,n=t,i=e.x,a=e.y,s=-1/0;do{if(a<=n.y&&a>=n.next.y&&n.next.y!==n.y){var o=n.x+(a-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(o<=i&&o>s){if(s=o,o===i){if(a===n.y)return n;if(a===n.next.y)return n.next}r=n.x<n.next.x?n:n.next}}n=n.next}while(n!==t);if(!r)return null;if(i===s)return r.prev;var c,u=r,l=r.x,h=r.y,f=1/0;for(n=r.next;n!==u;)i>=n.x&&n.x>=l&&i!==n.x&&U(a<h?i:s,a,l,h,a<h?s:i,a,n.x,n.y)&&(((c=Math.abs(a-n.y)/(i-n.x))<f||c===f&&n.x>r.x)&&K(n,e)&&(r=n,f=c)),n=n.next;return r}(e,t)){var r=$(t,e);V(r,r.next)}}function Z(e,t,r,n){for(var i;i!==e;i=i.next){if(null===(i=i||e).z&&(i.z=Y(i.x,i.y,t,r,n)),i.prev.next!==i||i.next.prev!==i)return i.prev.next=i,i.next.prev=i,Z(e,t,r,n);i.prevZ=i.prev,i.nextZ=i.next}return e.prevZ.nextZ=null,e.prevZ=null,function(e){for(var t,r=1;;){var n=void 0,i=e;e=null,t=null;for(var a=0;i;){a++,n=i;for(var s=0;s<r&&n;s++)n=n.nextZ;for(var o=r;s>0||o>0&&n;){var c=void 0;0===s?(c=n,n=n.nextZ,o--):0!==o&&n?i.z<=n.z?(c=i,i=i.nextZ,s--):(c=n,n=n.nextZ,o--):(c=i,i=i.nextZ,s--),t?t.nextZ=c:e=c,c.prevZ=t,t=c}i=n}if(t.nextZ=null,r*=2,a<2)return e}}(e)}function X(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function G(e,t,r,n){return!!(H(e,t)&&H(r,n)||H(e,n)&&H(r,t))||X(e,t,r)>0!=X(e,t,n)>0&&X(r,n,e)>0!=X(r,n,t)>0}function U(e,t,r,n,i,a,s,o){return(i-s)*(t-o)-(e-s)*(a-o)>=0&&(e-s)*(n-o)-(r-s)*(t-o)>=0&&(r-s)*(a-o)-(i-s)*(n-o)>=0}function K(e,t){return X(e.prev,e,e.next)<0?X(e,t,e.next)>=0&&X(e,e.prev,t)>=0:X(e,t,e.prev)<0||X(e,e.next,t)<0}function Y(e,t,r,n,i){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*i)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*i)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function H(e,t){return e.x===t.x&&e.y===t.y}function W(e,t){return e.x-t.x}function q(e,t,r,n){var i=e;do{var a=i.prev,s=i.next.next;!H(a,s)&&G(a,i,i.next,s)&&K(a,s)&&K(s,a)&&(t.push(a.index/r+n),t.push(i.index/r+n),t.push(s.index/r+n),N(i),N(i.next),i=e=s),i=i.next}while(i!==e);return i}function J(e,t,r,n,i,a,s){var o=e;do{for(var c=o.next.next;c!==o.prev;){if(o.index!==c.index&&Q(o,c)){var u=$(o,c);return o=V(o,o.next),u=V(u,u.next),D(o,t,r,n,i,a,s,0),void D(u,t,r,n,i,a,s,0)}c=c.next}o=o.next}while(o!==e)}function Q(e,t){return e.next.index!==t.index&&e.prev.index!==t.index&&!function(e,t){var r=e;do{if(r.index!==e.index&&r.next.index!==e.index&&r.index!==t.index&&r.next.index!==t.index&&G(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}(e,t)&&K(e,t)&&K(t,e)&&function(e,t){var r=e,n=!1,i=(e.x+t.x)/2,a=(e.y+t.y)/2;do{r.y>a!=r.next.y>a&&r.next.y!==r.y&&i<(r.next.x-r.x)*(a-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next}while(r!==e);return n}(e,t)}function $(e,t){var r=ee.create(e.index,e.x,e.y),n=ee.create(t.index,t.x,t.y),i=e.next,a=t.prev;return e.next=t,t.prev=e,r.next=i,i.prev=r,n.next=r,r.prev=n,a.next=n,n.prev=a,n}for(var ee=function(){function e(){Object(o.a)(this,e),this.index=0,this.x=0,this.y=0,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}return Object(c.a)(e,null,[{key:"create",value:function(e,t,r){var n=te[re++];return n.index=e,n.x=t,n.y=r,n.prev=null,n.next=null,n.z=null,n.prevZ=null,n.nextZ=null,n.steiner=!1,n}}]),e}(),te=new Array,re=0,ne=0;ne<8096;ne++)te.push(new ee);var ie=new(r(892).a),ae=new I.b(0,0,0,1,128);function se(e,t,r){for(var n=0,i=1;i<r;i++){var a=e[2*(t+i-1)],s=e[2*(t+i-1)+1];n+=(e[2*(t+i)]-a)*(e[2*(t+i)+1]+s)}return n}function oe(e,t,r,n,i){for(var a=0,s=r;s<n;s+=3){var o=2*(e.getValue(s)-i),c=2*(e.getValue(s+1)-i),u=2*(e.getValue(s+2)-i);a+=Math.abs((t[o]-t[u])*(t[c+1]-t[o+1])-(t[o]-t[c])*(t[u+1]-t[o+1]))}return a}ae.setExtent(_.F);var ce=function(e){return function(e){Object(m.a)(r,e);var t=Object(x.a)(r);function r(){var e;Object(o.a)(this,r);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(e=t.call.apply(t,[this].concat(i))).forceLibtess=!1,e.geometryType=C.d.FILL,e}return Object(c.a)(r,[{key:"writeMeshWithGeometry",value:function(e,t,r,n,i,a){var o=k.a.load(this._materialKey),c=t.indexVector,u=t.getVector("geometry"),l=u.vertexCount,h=c.length,f=a?Object(z.p)(Object(z.d)(a),2):r.readUnquantizedGeometry();if(f&&(f=function(e){if(!function(e,t,r){for(var n=0,i=0;i<e.lengths.length;i++){for(var a=e.lengths[i],s=0;s<a;s++){var o=e.coords[2*(s+n)],c=e.coords[2*(s+n)+1];if(o<-128||o>r||c<-128||c>r)return!0}n+=a}return!1}(e,0,_.F+128))return e;ae.reset(3);for(var t=0,r=0;r<e.lengths.length;r++){var n=e.lengths[r],i=e.coords[2*(0+t)],a=e.coords[2*(0+t)+1];ae.moveTo(i,a);for(var o=1;o<n;o++)i=e.coords[2*(o+t)],a=e.coords[2*(o+t)+1],ae.lineTo(i,a);ae.close(),t+=n}var c=ae.result(!1);if(!c)return null;var u,l=[],h=[],f=Object(s.a)(c);try{for(f.s();!(u=f.n()).done;){var p,v=u.value,y=0,d=Object(s.a)(v);try{for(d.s();!(p=d.n()).done;){var b=p.value;h.push(b.x),h.push(b.y),y++}}catch(m){d.e(m)}finally{d.f()}l.push(y)}}catch(m){f.e(m)}finally{f.f()}return new L.a(l,h)}(f))){var p=f.coords;!this.forceLibtess&&function(e,t,r){var n=t.coords,i=t.lengths;if(t.hasIndeterminateRingOrder)return!1;for(var a=e.length,s=0,o=0;o<i.length;){for(var c=o,u=i[o],l=se(n,s,u),h=[];++c<i.length;){var f=i[c],p=se(n,s+u,f);if(!(p>0))break;l+=p,h.push(s+u),u+=f}var v=e.length;T(e,n,s,s+u,h,2,r);var y=oe(e,n,v,e.length,r),d=Math.abs(l);if(Math.abs((y-d)/Math.max(1e-7,d))>1e-5)return e.seek(a),!1;o=c,s+=u}return!0}(c,f,l)||function(e,t,r,n){var i=[],a=r.coords,s=r.lengths;ie.beginPolygon(e,i);for(var o=0,c=0;c<s.length;c++){var u=r.lengths[c];ie.beginContour();for(var l=0;l<u;l++){var h=[a[2*(o+l)],a[2*(o+l)+1],0];ie.addVertex(h,h)}ie.endContour(),o+=u}ie.endPolygon();for(var f=0;f<i.length;f++)t.push(i[f]+n)}(p=[],c,f,l),this._write(u,r,i,p,o);var v=u.vertexCount-l,y=c.length-h;e.writeDisplayRecord(this.geometryType,this._materialKey,l,v,h,y)}}},{key:"_write",value:function(e,t,r,n,i){for(var a=0;a<n.length;a+=2){var s=Object(j.a)(1*n[a],1*n[a+1]);e.data.push(s),e.data.push(r),i.dotDensity?e.data.writeF32(1/Math.abs(t.readGeometryArea())):(e.data.push(this.fillColor),e.data.push(this.tl),e.data.push(this.br),e.data.push(this.aux1),e.data.push(this.aux2),e.data.push(this.aux3))}}}]),r}(e)},ue=r(848),le=r(796),he=u.a.getLogger("esri.views.2d.engine.webgl.WGLDynamicMeshTemplate"),fe=function(e){Object(m.a)(r,e);var t=Object(x.a)(r);function r(e){var n;return Object(o.a)(this,r),(n=t.call(this))._ongoingMaterialRequestMap=new Map,n._materialCache=new Map,n._dynamicPropertyMap=new Map,n._cimLayer=e,n}return Object(c.a)(r,[{key:"analyze",value:function(e,t,r,n){var i=this,a=t.readLegacyFeature(),s=this._materialCache,o=this._cimLayer.materialHash;if(!o)return he.error("A Dynamic mesh template must have a material hash value or function!"),Object(h.t)(null);var c="function"==typeof o?o(a,r,n):o;if(s.has(c)){var u=s.get(c);return Object(h.u)(u)}if(this._ongoingMaterialRequestMap.has(c))return this._ongoingMaterialRequestMap.get(c);var l=Object(ue.a)(this._cimLayer.cim,this._cimLayer.materialOverrides);l.mosaicHash=c;var f=e.getMosaicItem(l).then((function(e){return i._ongoingMaterialRequestMap.delete(c),s.set(c,e),e})).catch((function(e){return i._ongoingMaterialRequestMap.delete(c),he.error(".analyze()",e.message),null}));return this._ongoingMaterialRequestMap.set(c,f),f}}]),r}(le.a),pe=function(e){Object(m.a)(r,e);var t=Object(x.a)(r);function r(e){var n;if(Object(o.a)(this,r),n=t.call(this,e),Object(S.c)(e.color)){n._dynamicPropertyMap.set("_fillColor",(function(t,r,n){var i=e.color(t,r,n);return i&&Object(M.c)(i)||0}))}else{var i=e.color;n.fillColor=i&&Object(M.c)(i)||0}var a=0;Object(S.c)(e.height)||(a=e.height||0),n._dynamicPropertyMap.set("_height",(function(t,r,n){return Object(S.c)(e.height)?e.height(t,r,n):a}));var s=0;Object(S.c)(e.offsetX)||(s=Object(g.g)(e.offsetX||0)+128)>255&&(s=255),n._dynamicPropertyMap.set("_offsetX",(function(t,r,n){if(Object(S.c)(e.offsetX)){var i=Object(g.g)(e.offsetX(t,r,n))+128;return i>255&&(i=255),i}return s}));var c=1;Object(S.c)(e.scaleX)||(c=e.scaleX||1),n._dynamicPropertyMap.set("_scaleX",(function(t,r,n){return Object(S.c)(e.scaleX)?e.scaleX(t,r,n):c}));var u=0;Object(S.c)(e.offsetY)||(u=Object(g.g)(-e.offsetY||0)+128)>255&&(u=255),n._dynamicPropertyMap.set("_offsetY",(function(t,r,n){if(Object(S.c)(e.offsetY)){var i=Object(g.g)(-e.offsetY(t,r,n))+128;return i>255&&(i=255),i}return u}));var l=0;return Object(S.c)(e.angle)||(l=Object(w.d)(e.angle)||0),n._dynamicPropertyMap.set("_angle",(function(t,r,n){return Object(S.c)(e.angle)?Object(w.d)(e.angle(t,r,n)):l})),n.effects=e.effects,n._cimFillLayer=e,n._fillMaterialKey=k.a.load(e.materialKey),Object(b.a)(n)}return Object(c.a)(r,[{key:"bindFeature",value:function(e,t,r){var n=this,i=e.readLegacyFeature();this._dynamicPropertyMap.forEach((function(e,a){n[a]=e(i,t,r)}));var a=this._fillMaterialKey,s=this._materialCache,o=this._cimFillLayer;this.aux3=Object(j.b)(0,0,this._angle,o.colorLocked?1:0);var c=(0,o.materialHash)(i,t,r),u=s.get(c),l=null;if(u&&Object(p.a)(u.spriteMosaicItem)&&(l=u.spriteMosaicItem),l){var h=l,f=h.rect,v=h.width,y=h.height,d=f.x+_.r,b=f.y+_.r,m=d+v,x=b+y,k=Object(O.j)(Object(g.g)(this._height));k>255?k=255:k<=0&&(k=Object(O.j)(x-b));var M=Object(O.j)(Object(g.g)(this._height/y*v||0));M>255?M=255:M<=0&&(M=Object(O.j)(m-d));var w=this._scaleX;this.tl=Object(j.a)(d,b),this.br=Object(j.a)(m,x),this.aux1=Object(j.b)(M,k,this._offsetX,this._offsetY),this.aux2=Object(j.a)(128*w,128),a.sdf=l.sdf,a.pattern=!0,a.textureBinding=l.textureBinding}else this.tl=0,this.br=0,this.aux1=0,this.aux2=0,a.sdf=!1,a.pattern=!1,a.textureBinding=0;this._materialKey=a.data}}],[{key:"fromCIMFill",value:function(e){return new r(e)}}]),r}(ce(fe)),ve=r(32),ye=(r(13),r(893)),de=_.F+16,be=new I.b(0,0,0,1,16);be.setExtent(_.F);var me=new Uint32Array(9),xe=new Uint32Array(36),Oe=new Uint32Array(3),ge=new Uint32Array(6),_e=function(e){return function(t){ge[0]=t.leftExit0,ge[1]=t.rightEntry0,ge[2]=t.leftExit2,ge[3]=t.rightEntry0,ge[4]=t.rightEntry2,ge[5]=t.leftExit2,e.indexCount+=6,e.indexBuf.writeRegion(ge)}},je=function(e){return function(e){Object(m.a)(r,e);var t=Object(x.a)(r);function r(){var e;Object(o.a)(this,r);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(e=t.call.apply(t,[this].concat(i))).tessellationProperties={_fillColor:null,_tl:null,_br:null,_halfWidth:null,_bitset:null,_halfReferenceWidth:null,id:null,indexBuf:null,indexCount:null,geometryBuf:null,vertexCount:null,offset:null},e._tessellationOptions={},e.geometryType=C.d.LINE,e}return Object(c.a)(r,[{key:"writeMeshWithGeometry",value:function(e,t,r,n,i,a){var s=t.indexVector,o=t.get("geometry"),c=t.getVector("geometry").vertexCount,u=s.length,l=null!=a?a:r.readLegacyGeometry();if(l){switch(n){case"esriGeometryPolyline":var h=this._clipLines(l.paths);if(0===h.length)return;this._write(s,o,c,i,h);break;case"esriGeometryPolygon":var f=this._clipLines(l.rings);if(0===f.length)return;this._write(s,o,c,i,f)}var p=this.tessellationProperties.vertexCount,v=this.tessellationProperties.indexCount;e.writeDisplayRecord(this.geometryType,this._materialKey,c,p,u,v)}}},{key:"_clipLines",value:function(e){for(var t=[],r=!1,n=0;n<e.length;){var i=[],a=e[n];be.reset(2);var o=Object(ve.a)(a[0],2),c=o[0],u=o[1];if(r)be.moveTo(c,u);else{if(c<-16||c>de||u<-16||u>de){r=!0;continue}i.push({x:c,y:u})}for(var l=!1,h=a.length,f=1;f<h;++f)if(c+=a[f][0],u+=a[f][1],r)be.lineTo(c,u);else{if(c<-16||c>de||u<-16||u>de){l=!0;break}i.push({x:c,y:u})}if(l)r=!0;else{if(r){var p=be.resultWithStarts();if(p){var v,y=Object(s.a)(p);try{for(y.s();!(v=y.n()).done;){var d=v.value;t.push(d)}}catch(b){y.e(b)}finally{y.f()}}}else t.push({line:i,start:0});n++,r=!1}}return t}},{key:"_write",value:function(e,t,r,n,i){this.tessellationProperties.id=n,this.tessellationProperties.indexBuf=e,this.tessellationProperties.indexCount=0,this.tessellationProperties.geometryBuf=t,this.tessellationProperties.vertexCount=0,this.tessellationProperties.offset=r;var a,o=Object(s.a)(i);try{for(o.s();!(a=o.n()).done;){var c=a.value,u=c.line;u.length<2||(this._tessellationOptions.initialDistance=c.start%65535,this._tessellationCallbacks instanceof ye.a&&(this._tessellationCallbacks.capType=this._capType,this._tessellationCallbacks.joinType=this._joinType),Object(ye.d)(u,this._tessellationOptions,this._tessellationCallbacks),Object(ye.b)())}}catch(l){o.e(l)}finally{o.f()}}},{key:"_initializeTessellator",value:function(e){var t,r=k.c.load(this._materialKey);if(this._tessellationOptions.trackDistance=this._isDashed||this._hasPattern,this._tessellationOptions.thin=!e&&this.tessellationProperties._halfWidth<_.E/2&&!(r.vvSizeFieldStops||r.vvSizeMinMaxValue||r.vvSizeScaleStops||r.vvSizeUnitValue),this._tessellationOptions.wrapDistance=65535,this._tessellationOptions.outerBisectorAutoSplitThreshold=.2631578947368421,this._tessellationOptions.enableOuterBisectorSplit=this._isDashed||this._hasPattern,this._tessellationOptions.innerBisectorAutoSplitThreshold=.2631578947368421,this._tessellationOptions.enableInnerBisectorSplit=this._isDashed||this._hasPattern,this._tessellationOptions.thin)this._tessellationCallbacks={vertex:(t=this.tessellationProperties,function(e){var r=Math.ceil(1024*t._halfWidth),n=Math.ceil(1024*t._halfReferenceWidth);e.entry0=t.offset+t.vertexCount++;var i=Object(j.a)(e.distance,r),a=Object(j.b)(Math.round(31*e.prevNormal.x),Math.round(31*e.prevNormal.y),Math.round(0),Math.round(-31)),s=Object(j.b)(0,0,0,t._bitset);xe[0]=Object(j.a)(8*e.currentVertex.x,8*e.currentVertex.y),xe[1]=t.id,xe[2]=t._fillColor,xe[3]=a,xe[4]=i,xe[5]=t._tl,xe[6]=t._br,xe[7]=s,xe[8]=Object(j.a)(n,0),e.entry2=t.offset+t.vertexCount++;var o=Object(j.a)(e.distance,r),c=Object(j.b)(Math.round(31*-e.prevNormal.x),Math.round(31*-e.prevNormal.y),Math.round(0),Math.round(31)),u=Object(j.b)(0,0,0,t._bitset);xe[9]=Object(j.a)(8*e.currentVertex.x,8*e.currentVertex.y),xe[10]=t.id,xe[11]=t._fillColor,xe[12]=c,xe[13]=o,xe[14]=t._tl,xe[15]=t._br,xe[16]=u,xe[17]=Object(j.a)(n,0),e.exit0=t.offset+t.vertexCount++;var l=Object(j.a)(e.distance,r),h=Object(j.b)(Math.round(31*e.nextNormal.x),Math.round(31*e.nextNormal.y),Math.round(0),Math.round(-31)),f=Object(j.b)(0,0,0,t._bitset);xe[18]=Object(j.a)(8*e.currentVertex.x,8*e.currentVertex.y),xe[19]=t.id,xe[20]=t._fillColor,xe[21]=h,xe[22]=l,xe[23]=t._tl,xe[24]=t._br,xe[25]=f,xe[26]=Object(j.a)(n,0),e.exit2=t.offset+t.vertexCount++;var p=Object(j.a)(e.distance,r),v=Object(j.b)(Math.round(31*-e.nextNormal.x),Math.round(31*-e.nextNormal.y),Math.round(0),Math.round(31)),y=Object(j.b)(0,0,0,t._bitset);xe[27]=Object(j.a)(8*e.currentVertex.x,8*e.currentVertex.y),xe[28]=t.id,xe[29]=t._fillColor,xe[30]=v,xe[31]=p,xe[32]=t._tl,xe[33]=t._br,xe[34]=y,xe[35]=Object(j.a)(n,0),t.geometryBuf.writeRegion(xe)}),bridge:_e(this.tessellationProperties)};else{var n=new ye.a(function(e){return function(t,r,n,i,a,s,o,c,u){var l=Object(j.a)(u,Math.ceil(1024*e._halfWidth)),h=Object(j.b)(Math.round(31*a),Math.round(31*s),Math.round(31*o),Math.round(31*c)),f=Object(j.b)(31*n,31*i,0,e._bitset);return me[0]=Object(j.a)(8*t,8*r),me[1]=e.id,me[2]=e._fillColor,me[3]=h,me[4]=l,me[5]=e._tl,me[6]=e._br,me[7]=f,me[8]=Object(j.a)(Math.ceil(1024*e._halfReferenceWidth),0),e.geometryBuf.writeRegion(me),e.offset+e.vertexCount++}}(this.tessellationProperties),function(e){return function(t,r,n){Oe[0]=t,Oe[1]=r,Oe[2]=n,e.indexCount+=3,e.indexBuf.writeRegion(Oe)}}(this.tessellationProperties));n.miterLimitCosine=this._miterLimitCosine,n.textured=this._isDashed||this._hasPattern,n.joinOnUTurn=this._joinOnUTurn,this._tessellationCallbacks=n}}}]),r}(e)},ke=function(e){Object(m.a)(r,e);var t=Object(x.a)(r);function r(e){var n;Object(o.a)(this,r),(n=t.call(this,e))._cimLineLayer=e;var i=0;if(Object(S.c)(e.width)||(i=.5*Object(g.g)(e.width)),n._dynamicPropertyMap.set("_halfWidth",(function(t,r,n){return Object(S.c)(e.width)?.5*Object(g.g)(e.width(t,r,n)):i})),Object(S.c)(e.cap)?n._dynamicPropertyMap.set("_capType",e.cap):n._capType=e.cap,Object(S.c)(e.join)?n._dynamicPropertyMap.set("_joinType",e.join):n._joinType=e.join,Object(S.c)(e.color)){n._dynamicPropertyMap.set("_fillColor",(function(t,r,n){var i=e.color(t,r,n);return i&&Object(M.c)(i)||0}))}else{var a=e.color;n._fillColor=a&&Object(M.c)(a)||0}if(Object(S.c)(e.miterLimit)){n._dynamicPropertyMap.set("_miterLimitCosine",(function(t,r,n){return Object(S.b)(e.miterLimit(t,r,n))}))}else n._miterLimitCosine=Object(S.b)(e.miterLimit);return n._scaleFactor=e.scaleFactor||1,n._isDashed=e.isDashed,n.effects=e.effects,n.tessellationProperties._bitset=e.colorLocked?1:0,n._materialKey=e.materialKey,n._initializeTessellator(!0),n}return Object(c.a)(r,[{key:"bindFeature",value:function(e,t,r){var n=this,i=e.readLegacyFeature();this._dynamicPropertyMap.forEach((function(e,a){n[a]=e(i,t,r)})),this._halfWidth*=this._scaleFactor;var a=this._materialCache,s=(0,this._cimLineLayer.materialHash)(i,t,r),o=a.get(s),c=null;if(o&&Object(p.a)(o.spriteMosaicItem)&&(c=o.spriteMosaicItem),c){this._hasPattern=!0;var u=c,l=u.rect,h=u.width,f=u.height,v=l.x+_.r,y=l.y+_.r,d=v+h,b=y+f;this.tessellationProperties._tl=Object(j.a)(v,y),this.tessellationProperties._br=Object(j.a)(d,b)}else this._hasPattern=!1,this.tessellationProperties._tl=0,this.tessellationProperties._br=0;this.tessellationProperties._fillColor=this._fillColor,this.tessellationProperties._halfWidth=this._halfWidth,this.tessellationProperties._halfReferenceWidth=this.tessellationProperties._halfWidth;var m=k.c.load(this._materialKey);c&&(m.sdf=c.sdf,m.pattern=!0,m.textureBinding=c.textureBinding),this._materialKey=m.data}}],[{key:"fromCIMLine",value:function(e){return new r(e)}}]),r}(je(fe)),Me=r(4),we=r(377),Se=r(360),ze=r(855),Ce=Object(Se.a)(),Le=Object(we.a)(),Ie=u.a.getLogger("esri.views.2d.engine.webgl.WGLDynamicMarkerTemplate"),Te=function(e){Object(m.a)(r,e);var t=Object(x.a)(r);function r(e){var n;if(Object(o.a)(this,r),(n=t.call(this,e))._cimMarkerLayer=e,Object(S.c)(e.color)){n._dynamicPropertyMap.set("_fillColor",(function(t,r,n){return Object(M.c)(e.color(t,r,n))}))}else n._fillColor=Object(M.c)(e.color);if(Object(S.c)(e.outlineColor)){n._dynamicPropertyMap.set("_outlineColor",(function(t,r,n){return Object(M.c)(e.outlineColor(t,r,n))}))}else n._outlineColor=Object(M.c)(e.outlineColor);if(Object(S.c)(e.size)){n._dynamicPropertyMap.set("_size",(function(t,r,n){return Object(g.g)(e.size(t,r,n))}))}else n._size=Object(g.g)(e.size);if(Object(S.c)(e.scaleX)?n._dynamicPropertyMap.set("_scaleX",e.scaleX):n._scaleX=e.scaleX,Object(S.c)(e.offsetX)){n._dynamicPropertyMap.set("xOffset",(function(t,r,n){return Object(g.g)(e.offsetX(t,r,n))}))}else n.xOffset=Object(g.g)(e.offsetX);if(Object(S.c)(e.offsetY)){n._dynamicPropertyMap.set("yOffset",(function(t,r,n){return Object(g.g)(e.offsetY(t,r,n))}))}else n.yOffset=Object(g.g)(e.offsetY);if(Object(S.c)(e.outlineWidth)){n._dynamicPropertyMap.set("_outlineWidth",(function(t,r,n){return Object(g.g)(e.outlineWidth(t,r,n))}))}else n._outlineWidth=Object(g.g)(e.outlineWidth);return Object(S.c)(e.rotation)?n._dynamicPropertyMap.set("_angle",e.rotation):n._angle=e.rotation,n._scaleFactor=Object(Me.p)(e.scaleFactor,1),n._markerPlacement=e.markerPlacement,n.effects=e.effects,n._bitSet=(1===e.alignment?1:0)|(e.colorLocked?1:0)<<1|(e.scaleSymbolsProportionally?1:0)<<3,n._materialKey=e.materialKey,Object(b.a)(n)}return Object(c.a)(r,[{key:"bindFeature",value:function(e,t,r){var n=this,i=e.readLegacyFeature();this._dynamicPropertyMap.forEach((function(e,a){n[a]=e(i,t,r)}));var a=this._cimMarkerLayer.materialHash,s="function"==typeof a?a(i,t,r):a,o=this._materialCache.get(s);if(o&&Object(p.a)(o.spriteMosaicItem)&&o.spriteMosaicItem){var c=o.spriteMosaicItem,u=this._cimMarkerLayer.sizeRatio,h=c.width/c.height*this._scaleX,f=this._cimMarkerLayer.rotateClockwise?this._angle:-this._angle,v=this._size,y=v*h,d=this.xOffset,b=this.yOffset;this.xOffset*=this._scaleFactor,this.yOffset*=this._scaleFactor;var m=this._cimMarkerLayer.scaleSymbolsProportionally&&this._cimMarkerLayer.frameHeight?this._size/Object(g.g)(this._cimMarkerLayer.frameHeight):1,x=this._outlineWidth*m,O=Object(g.g)(this._cimMarkerLayer.referenceSize),M=0,w=0,S=this._cimMarkerLayer.anchorPoint;S&&(this._cimMarkerLayer.isAbsoluteAnchorPoint?this._size&&(M=-S.x/(this._size*h),w=S.y/this._size):(M=S.x,w=S.y)),this._sizeOutlineWidth=Object(j.b)(Math.round(Math.min(Math.sqrt(128*y),255)),Math.round(Math.min(Math.sqrt(128*v),255)),Math.round(Math.min(Math.sqrt(128*x),255)),Math.round(Math.min(Math.sqrt(128*O),255))),this.angle=f;var z=Math.round(Math.min(64*u,255));this._bitestAndDistRatio=Object(j.b)(0,0,this._bitSet,z);var C=c.rect.x+_.r,L=c.rect.y+_.r,I=C+c.width,T=L+c.height;this._texUpperLeft=Object(j.a)(C,L),this._texUpperRight=Object(j.a)(I,L),this._texBottomLeft=Object(j.a)(C,T),this._texBottomRight=Object(j.a)(I,T);var P=k.d.load(this._materialKey);P.sdf=c.sdf,P.pattern=!0,P.textureBinding=c.textureBinding,this._materialKey=P.data,this._anchorX=.5-(.5+M)*c.width/c.width,this._anchorY=.5-(.5+w)*c.height/c.height,y*=u,v*=u,y*=this._scaleFactor,v*=this._scaleFactor,y*=c.rect.width/c.width,v*=c.rect.height/c.height,this._computedWidth=y,this._computedHeight=v,this._applyTransformation(Le,Ce),this.xOffset=d,this.yOffset=b}else Ie.error(new l.a("mapview-cim","Encountered an error when binding feature"))}}],[{key:"fromCIMMarker",value:function(e){return new r(e)}}]),r}(Object(ze.a)(fe)),Pe=r(843),Ve=r(810),De=r(852),Re=function(e){Object(m.a)(r,e);var t=Object(x.a)(r);function r(e){var n;Object(o.a)(this,r),(n=t.call(this,e))._horizontalAlignment="center",n._verticalAlignment="middle",n._textToGlyphs=new Map;var i,a,s,c=e.scaleFactor||1;if(n._cimTextLayer=e,Object(S.c)(e.color)){n._dynamicPropertyMap.set("_color",(function(t,r,n){return Object(M.c)(e.color(t,r,n))}))}else n._color=Object(M.c)(e.color);if(Object(S.c)(e.color)){n._dynamicPropertyMap.set("_haloColor",(function(t,r,n){return Object(M.c)(e.outlineColor(t,r,n))}))}else n._haloColor=Object(M.c)(e.outlineColor);if(Object(S.c)(e.size)||(i=Math.min(Math.round(Object(g.g)(e.size*e.sizeRatio)),127)),n._dynamicPropertyMap.set("_size",(function(t,r,n){return Object(S.c)(e.size)?Math.min(Math.round(Object(g.g)(e.size(t,r,n)*e.sizeRatio)),127):i})),Object(S.c)(e.outlineSize)){n._dynamicPropertyMap.set("_haloSize",(function(t,r,n){return Math.min(Math.floor(5*Object(g.g)(e.outlineSize(t,r,n)*e.sizeRatio)),127)}))}else n._haloSize=Math.min(Math.floor(5*Object(g.g)(e.outlineSize*e.sizeRatio)),127);Object(S.c)(e.offsetX)||(a=Math.round(Object(g.g)(e.offsetX*e.sizeRatio))),n._dynamicPropertyMap.set("_xOffset",(function(t,r,n){return Object(S.c)(e.offsetX)?Math.round(Object(g.g)(e.offsetX(t,r,n)*e.sizeRatio)):a})),Object(S.c)(e.offsetY)||(s=Math.round(Object(g.g)(e.offsetY*e.sizeRatio))),n._dynamicPropertyMap.set("_yOffset",(function(t,r,n){return Object(S.c)(e.offsetY)?Math.round(Object(g.g)(e.offsetY(t,r,n)*e.sizeRatio)):s})),Object(S.c)(e.angle)?n._dynamicPropertyMap.set("_angle",e.angle):n._angle=e.angle,Object(S.c)(e.horizontalAlignment)?n._dynamicPropertyMap.set("_horizontalAlignment",e.horizontalAlignment):n._horizontalAlignment=e.horizontalAlignment,Object(S.c)(e.verticalAlignment)?n._dynamicPropertyMap.set("_verticalAlignment",e.verticalAlignment):n._verticalAlignment=e.verticalAlignment,n._scaleFactor=c,Object(S.c)(e.text)?n._dynamicPropertyMap.set("_text",e.text):n._text=e.text;var u=Math.min(Math.round(Object(g.g)(e.referenceSize*e.sizeRatio)),127);n._referenceSize=Math.round(Math.sqrt(256*u)),n._materialKey=e.materialKey;var l=k.f.load(n._materialKey);return l.sdf=!0,n._bitset=(1===e.alignment?1:0)|(e.colorLocked?1:0)<<1,n._materialKey=l.data,n._decoration="none",n._lineHeight=1,n._lineWidth=512,n._textPlacement=e.markerPlacement,n.effects=e.effects,n._isCIM=!0,n}return Object(c.a)(r,[{key:"analyze",value:function(){var e=Object(a.a)(i.a.mark((function e(t,r,n,a){var s,o,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=r.readLegacyFeature(),o=function(e,t,r,n){return"string"==typeof e.text?e.text:"function"==typeof e.text?e.text(t,r,n):""}(this._cimTextLayer,s,n,a),e.next=4,t.getMosaicItem(this._cimTextLayer.cim,Object(Pe.a)(o));case 4:return c=e.sent,e.abrupt("return",(this._textToGlyphs.set(o,c.glyphMosaicItems),c));case 6:case"end":return e.stop()}}),e,this)})));return function(t,r,n,i){return e.apply(this,arguments)}}()},{key:"bindFeature",value:function(e,t,r){var n=this,i=e.readLegacyFeature();if(this._dynamicPropertyMap.forEach((function(e,a){n[a]=e(i,t,r)})),this._text&&0!==this._text.length){this._size*=this._scaleFactor,this._scale=this._size/24,this._xOffset*=this._scaleFactor,this._yOffset*=this._scaleFactor,this._xAlignD=Object(Ve.d)(this._horizontalAlignment||"center"),this._yAlignD=Object(Ve.f)(this._verticalAlignment||"baseline");var a=this._textToGlyphs.get(this._text);this.bindTextInfo(a,!1)}else this._shapingInfo=null}}],[{key:"fromCIMText",value:function(e){return new r(e)}}]),r}(Object(De.a)(fe)),Fe=function(e){Object(m.a)(r,e);var t=Object(x.a)(r);function r(e,n,i,a,s,c,u,l,h){var f;Object(o.a)(this,r),(f=t.call(this)).effects=h;var p=k.a.load(e);return n&&(p.sdf=n.sdf,p.pattern=!0,p.textureBinding=n.textureBinding),f.fillColor=i,f.tl=a,f.br=s,f.aux1=c,f.aux2=u,f.aux3=l,f._materialKey=p.data,f}return Object(c.a)(r,null,[{key:"fromCIMFill",value:function(e,t){var n=e.color,i=n&&Object(M.c)(n)||0,a=e.materialKey;if(!t)return new r(a,null,i,0,0,0,0,Object(j.b)(0,0,0,e.colorLocked?1:0),e.effects);var s=t.rect,o=t.width,c=t.height,u=s.x+_.r,l=s.y+_.r,h=u+o,f=l+c,p=Object(O.j)(Object(g.g)(e.height||0));p>255?p=255:p<=0&&(p=Object(O.j)(f-l));var v=Object(O.j)(Object(g.g)(e.height/c*o||0));v>255?v=255:v<=0&&(v=Object(O.j)(h-u));var y=Object(g.g)(e.offsetX||0)+128;y>255&&(y=255);var d=Object(g.g)(-e.offsetY||0)+128;d>255&&(d=255);var b=e.scaleX||1;return new r(a,t,i,Object(j.a)(u,l),Object(j.a)(h,f),Object(j.b)(v,p,y,d),Object(j.a)(128*b,128),Object(j.b)(0,0,Object(w.b)(e.angle),e.colorLocked?1:0),e.effects)}},{key:"fromSimpleFill",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=e.color,a=i&&"esriSFSNull"!==e.style&&Object(M.d)(i)||0,s=Object(j.b)(0,0,0,n?255:0),o=e.materialKey;if(!t)return new r(o,null,a,0,0,0,0,s,null);var c=t.rect,u=t.width,l=t.height,h=c.x+_.r,f=c.y+_.r,p=h+u,v=f+l,y=Object(j.a)(h,f),d=Object(j.a)(p,v),b=Object(j.b)(Object(O.j)(p-h),Object(O.j)(v-f),0,0),m=Object(j.a)(128,128);return new r(o,t,a,y,d,b,m,s,null)}},{key:"fromPictureFill",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=_.q,a=t.rect,s=t.width,o=t.height,c=a.x+_.r,u=a.y+_.r,l=c+s,h=u+o,f=Object(j.a)(c,u),p=Object(j.a)(l,h),v=Object(O.j)(Object(g.g)(e.width));v>255&&(v=255);var y=Object(O.j)(Object(g.g)(e.height));y>255&&(y=255);var d=Object(g.g)(e.xoffset)+128;d>255&&(d=255);var b=Object(g.g)(-e.yoffset)+128;b>255&&(b=255);var m=Object(j.b)(v,y,d,b),x=Object(j.a)(128*e.xscale,128*e.yscale),k=Object(j.b)(0,0,0,n?255:0),M=e.materialKey;return new r(M,t,i,f,p,m,x,k,null)}}]),r}(ce(le.a)),Ae=r(781),Ne=u.a.getLogger("esri.views.2d.engine.webgl.WGLLineTemplate"),Ee=function(e){Object(m.a)(r,e);var t=Object(x.a)(r);function r(e,n,i,a,s,c,u,l,h,f,p,v,y,d,b,m){var x;Object(o.a)(this,r),x=t.call(this);var O=k.c.load(e);return n&&(O.sdf=n.sdf,O.pattern=!0,O.textureBinding=n.textureBinding),x._capType=a,x._joinType=s,x._miterLimitCosine=Object(S.b)(c),x.tessellationProperties._fillColor=u,x.tessellationProperties._tl=l,x.tessellationProperties._br=h,x._hasPattern=f,x._isDashed=p,x._joinOnUTurn=b,x._isColorLocked=v,x._zOrder=d,x.effects=m,x._materialKey=O.data,x.tessellationProperties._bitset=v?1:0,x.tessellationProperties._halfWidth=.5*i,x.tessellationProperties._halfReferenceWidth=.5*y,x._initializeTessellator(!1),x}return Object(c.a)(r,null,[{key:"fromCIMLine",value:function(e,t,n){var i=e.color,a=e.scaleFactor||1,s=e.isDashed,o=e.cap;s&&1===o&&(o=2);var c=e.join,u=Object(g.g)(e.width)*a,l=Object(g.g)(e.referenceWidth),h=Object(g.g)(e.miterLimit),f=i&&Object(M.c)(i)||0;if(!t)return new r(e.materialKey,t,u,o,c,h,f,0,0,!1,s,e.colorLocked,l,e.zOrder,n,e.effects);var p=t.rect,v=t.width,y=t.height,d=p.x+_.r,b=p.y+_.r,m=d+v,x=b+y,O=Object(j.a)(d,b),k=Object(j.a)(m,x);return new r(e.materialKey,t,u,o,c,h,f,O,k,!0,s,e.colorLocked,l,e.zOrder,n,e.effects)}},{key:"fromSimpleLine",value:function(e,t,n){var i=e.color,a="esriSLSSolid"!==e.style&&"esriSLSNull"!==e.style,s=Object(Ae.g)(e.cap||"round",a),o=Object(Ae.h)(e.join||"round"),c=i&&"esriSLSNull"!==e.style&&Object(M.d)(i)||0;"esriSLSNull"===e.style&&(c=0);var u=Object(g.g)(e.width),l=e.miterLimit;if(!t)return new r(e.materialKey,t,u,s,o,l,c,0,0,!1,a,!1,u,0,n,null);var h=t.rect,f=t.width,p=t.height,v=h.x+_.r,y=h.y+_.r,d=v+f,b=y+p,m=Object(j.a)(v,y),x=Object(j.a)(d,b);return new r(e.materialKey,t,u,s,o,l,c,m,x,!0,a,!1,u,0,n,null)}},{key:"fromPictureLineSymbol",value:function(e,t,r,n){return Ne.error("PictureLineSymbol support does not exist!"),null}}]),r}(je(le.a));var Be=function(){function e(){Object(o.a)(this,e),this._resolver=null}return Object(c.a)(e,[{key:"isHeld",value:function(){return!!this._resolver}},{key:"acquire",value:function(){var e=this;return this._resolver?this._resolver.promise.then((function(){return e.acquire()})):(this._resolver=Object(h.g)(),Object(h.u)())}},{key:"release",value:function(){var e=this._resolver;this._resolver=null,e.resolve()}}]),e}(),Ze=u.a.getLogger("esri.views.2d.engine.webgl.mesh.templates.WGLTemplateStore"),Xe=new Array;function Ge(e,t){var r=e.length;return e.push(null),t.then((function(t){return e[r]=t})),e}function Ue(e){return!!(1&e)}var Ke=function(){function e(t,r){Object(o.a)(this,e),this._idCounter=1,this._templateIdCounter=1,this._idToTemplateGroup=new Map,this._symbolToTemplate=new Map,this._fetchQueue=[],this._idToResolver=new Map,this._cimTemplateCache=new Map,this._cimAnalyses=[],this._lock=new Be,this._fetchResource=t,this._joinOnUTurn=r}return Object(c.a)(e,[{key:"_markerError",get:function(){return this._errorTemplates.marker[0]}},{key:"_fillError",get:function(){return this._errorTemplates.fill[0]}},{key:"_lineError",get:function(){return this._errorTemplates.line[0]}},{key:"_textError",get:function(){return this._errorTemplates.line[0]}},{key:"createTemplateGroup",value:function(e,t){this._initErrorTemplates();var r=e.hash;if(this._symbolToTemplate.has(r))return this._symbolToTemplate.get(r);var n=new Array;t&&this._createMeshTemplates(n,t,!0),this._createMeshTemplates(n,e,!1);var i=this._createGroupId("expanded-cim"===e.type);return this._idToTemplateGroup.set(i,n),this._symbolToTemplate.set(r,i),i}},{key:"getTemplateGroup",value:function(e){return this._idToTemplateGroup.has(e)?this._idToTemplateGroup.get(e):Xe}},{key:"getDynamicTemplateGroup",value:function(e){return this._idToTemplateGroup.has(e)?(Ue(e)||Ze.error("mapview-template-store","Id ".concat(e," does not refer to a dynamic template")),this._idToTemplateGroup.get(e)):Xe}},{key:"getMosaicItem",value:function(e,t){var r=this,n=this._createTemplateId(),i=Object(h.c)((function(e){return r._idToResolver.set(n,e)}));return this._fetchQueue.push({symbol:e,id:n,glyphIds:t}),i}},{key:"finalize",value:function(e){return this._fetchQueue.length||this._lock.isHeld()?function(e,t,r){return e.acquire().then((function(){return t(r)})).then((function(){return e.release()})).catch((function(t){throw e.release(),t}))}(this._lock,this._fetchAllQueuedResources.bind(this),e):Object(h.u)()}},{key:"_initErrorTemplates",value:function(){this._errorTemplates||(this._errorTemplates={fill:this._createMeshTemplates([],Object(v.c)(f.c),!1),marker:this._createMeshTemplates([],Object(v.c)(f.b),!1),line:this._createMeshTemplates([],Object(v.c)(f.d),!1)})}},{key:"_fetchAllQueuedResources",value:function(e){var t=this;if(!this._fetchQueue.length)return Object(h.u)();var r=this._fetchQueue,n=this._cimAnalyses;return this._fetchQueue=[],this._cimAnalyses=[],Object(h.b)(n).then((function(){return t._fetchResource(r,e).then((function(e){var r,n=Object(s.a)(e);try{for(n.s();!(r=n.n()).done;){var i=r.value,a=i.id,o=i.mosaicItem;t._idToResolver.get(a)(o),t._idToResolver.delete(a)}}catch(c){n.e(c)}finally{n.f()}}))})).catch((function(e){Object(h.n)(e)?t._fetchQueue=t._fetchQueue.concat(r):function(e){return"worker:port-closed"===e.name}(e)||Ze.error(new l.a("mapview-template-store","Unable to fetch requested texture resources",e))}))}},{key:"_createGroupId",value:function(e){return this._idCounter++<<1|(e?1:0)}},{key:"_createTemplateId",value:function(){return this._templateIdCounter++}},{key:"_createSMS",value:function(){var e=Object(a.a)(i.a.mark((function e(t){var r,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getMosaicItem(t);case 2:return r=e.sent,n=r.spriteMosaicItem,e.abrupt("return",Object(p.a)(n,Ze)?d.a.fromSimpleMarker(t,n):this._markerError);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_createPMS",value:function(){var e=Object(a.a)(i.a.mark((function e(t){var r,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getMosaicItem(t);case 2:return r=e.sent,n=r.spriteMosaicItem,e.abrupt("return",Object(p.a)(n,Ze)?d.a.fromPictureMarker(t,n):this._markerError);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_createSFS",value:function(){var e=Object(a.a)(i.a.mark((function e(t,r){var n,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getMosaicItem(t);case 2:return n=e.sent,a=n.spriteMosaicItem,e.abrupt("return",Object(p.a)(a,Ze)?Fe.fromSimpleFill(t,a,r):this._fillError);case 5:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_createPFS",value:function(){var e=Object(a.a)(i.a.mark((function e(t,r){var n,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getMosaicItem(t);case 2:return n=e.sent,a=n.spriteMosaicItem,e.abrupt("return",Object(p.a)(a,Ze)?Fe.fromPictureFill(t,a,r):this._fillError);case 5:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_createSLS",value:function(){var e=Object(a.a)(i.a.mark((function e(t,r){var n,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getMosaicItem(t);case 2:return n=e.sent,a=n.spriteMosaicItem,e.abrupt("return",Object(p.a)(a,Ze)?Ee.fromSimpleLine(t,a,this._joinOnUTurn):this._lineError);case 5:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_createLMS",value:function(){var e=Object(a.a)(i.a.mark((function e(t){var r,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getMosaicItem(t);case 2:return r=e.sent,n=r.spriteMosaicItem,e.abrupt("return",Object(p.a)(n,Ze)?d.a.fromLineSymbolMarker(t,n):this._markerError);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_createTS",value:function(){var e=Object(a.a)(i.a.mark((function e(t){var r,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getMosaicItem(t);case 2:return r=e.sent,n=r.glyphMosaicItems,e.abrupt("return",y.a.fromText(t,n));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_createCIMText",value:function(){var e=Object(a.a)(i.a.mark((function e(t){var r,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getMosaicItem(t.cim,Object(Pe.a)(t.text));case 2:return r=e.sent,n=r.glyphMosaicItems,e.abrupt("return",(t.cim.mosaicHash=t.materialHash,Object(p.a)(n,Ze)?y.a.fromCIMText(t,n):this._textError));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_createCIMFill",value:function(){var e=Object(a.a)(i.a.mark((function e(t){var r,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.cim.mosaicHash=t.materialHash,e.next=3,this.getMosaicItem(t.cim);case 3:return r=e.sent,n=r.spriteMosaicItem,e.abrupt("return",Object(p.a)(n,Ze)?Fe.fromCIMFill(t,n):this._fillError);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_createCIMLine",value:function(){var e=Object(a.a)(i.a.mark((function e(t){var r,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.cim.mosaicHash=t.materialHash,e.next=3,this.getMosaicItem(t.cim);case 3:return r=e.sent,n=r.spriteMosaicItem,e.abrupt("return",Object(p.a)(n,Ze)?Ee.fromCIMLine(t,n,this._joinOnUTurn):this._lineError);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_createCIMMarker",value:function(){var e=Object(a.a)(i.a.mark((function e(t){var r,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.cim.mosaicHash=t.materialHash,e.next=3,this.getMosaicItem(t.cim);case 3:return r=e.sent,n=r.spriteMosaicItem,e.abrupt("return",Object(p.a)(n,Ze)?d.a.fromCIMMarker(t,n):this._markerError);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_createCIM",value:function(){var e=Object(a.a)(i.a.mark((function e(t){var r,n,a=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.templateHash,!this._cimTemplateCache.has(r)){e.next=3;break}return e.abrupt("return",this._cimTemplateCache.get(r));case 3:e.t0=t.type,e.next="marker"===e.t0?6:"line"===e.t0?8:"fill"===e.t0?10:"text"===e.t0?12:13;break;case 6:return n=this._createCIMMarker(t),e.abrupt("break",13);case 8:return n=this._createCIMLine(t),e.abrupt("break",13);case 10:return n=this._createCIMFill(t),e.abrupt("break",13);case 12:n=this._createCIMText(t);case 13:return e.abrupt("return",(n.then((function(e){return a._cimTemplateCache.set(r,e)})),n));case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_createDynamicCIM",value:function(e){var t,r=e.templateHash;if(this._cimTemplateCache.has(r))return this._cimTemplateCache.get(r);switch(e.type){case"marker":t=Te.fromCIMMarker(e);break;case"line":t=ke.fromCIMLine(e);break;case"fill":t=pe.fromCIMFill(e);break;case"text":t=Re.fromCIMText(e)}return this._cimTemplateCache.set(r,t),t}},{key:"_createPrimitiveMeshTemplates",value:function(e,t,r){switch(t.type){case"esriSMS":return Ge(e,this._createSMS(t));case"esriPMS":return Ge(e,this._createPMS(t));case"esriSFS":return Ge(e,this._createSFS(t,r));case"line-marker":return Ge(e,this._createLMS(t));case"esriPFS":return Ge(e,this._createPFS(t,r));case"esriSLS":return Ge(e,this._createSLS(t,!1));case"esriTS":return Ge(e,this._createTS(t));default:return Ze.error("Unable to create mesh template for unknown symbol type {: $ }{symbol.type}"),e}}},{key:"_createMeshTemplates",value:function(e,t,r){if(-1!==t.type.indexOf("3d"))return Ze.error("3D symbols are not supported with MapView"),e;if("expanded-cim"===t.type){var n,i=Object(s.a)(t.layers);try{for(i.s();!(n=i.n()).done;){var a=n.value;"function"==typeof a.materialHash?e.push(this._createDynamicCIM(a)):Ge(e,this._createCIM(a))}}catch(l){i.e(l)}finally{i.f()}return e}if("composite-symbol"===t.type){var o,c=Object(s.a)(t.layers);try{for(c.s();!(o=c.n()).done;){var u=o.value;this._createPrimitiveMeshTemplates(e,u,r)}}catch(l){c.e(l)}finally{c.f()}return e}return"cim"===t.type||"label"===t.type||"web-style"===t.type?e:this._createPrimitiveMeshTemplates(e,t,r)}}]),e}()},865:function(e,t,r){"use strict";r.d(t,"a",(function(){return d}));var n=r(10),i=r.n(n),a=r(21),s=(r(16),r(235)),o=(r(149),r(848)),c=r(12),u=r(2),l=r(3),h=r(780),f=r(782),p={marker:h.d.MARKER,fill:h.d.FILL,line:h.d.LINE,text:h.d.TEXT},v=function(){function e(t,r,n){Object(u.a)(this,e),this.layers=t,this.data=r,this.hash=this._createHash(),this.rendererKey=n;var i,a=Object(c.a)(t);try{for(a.s();!(i=a.n()).done;){var s=i.value,o=p[s.type];s.materialKey=Object(f.g)(o,this.rendererKey,!1,!1)}}catch(l){a.e(l)}finally{a.f()}}return Object(l.a)(e,[{key:"type",get:function(){return"expanded-cim"}},{key:"_createHash",value:function(){var e,t="",r=Object(c.a)(this.layers);try{for(r.s();!(e=r.n()).done;){t+=e.value.templateHash}}catch(n){r.e(n)}finally{r.f()}return t}}]),e}(),y=function(){var e=Object(a.a)(i.a.mark((function e(t,r){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=v,e.next=3,Object(o.b)(t.data,r);case 3:return e.t1=e.sent,e.t2=t.data,e.t3=t.rendererKey,e.abrupt("return",new e.t0(e.t1,e.t2,e.t3));case 7:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),d=function(){var e=Object(a.a)(i.a.mark((function e(t,r,n){var a,o;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",null);case 2:if("cim"!==t.type){e.next=4;break}return e.abrupt("return",y(t,r));case 4:if("web-style"!==t.type){e.next=12;break}return a=s.a.fromJSON(t),e.next=8,a.fetchCIMSymbol(n);case 8:return e.t0=e.sent.data,e.t1=t.rendererKey,o={type:"cim",data:e.t0,rendererKey:e.t1},e.abrupt("return",y(o,r));case 12:return e.abrupt("return",t);case 13:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}()},868:function(e,t,r){"use strict";var n,i=r(2),a=r(3),s=r(5),o=r(6),c=r(0),u=(r(13),r(14),r(15),r(1)),l=r(8),h=(r(11),r(19),r(20),r(28)),f=n=function(e){Object(s.a)(r,e);var t=Object(o.a)(r);function r(){var e;return Object(i.a)(this,r),(e=t.apply(this,arguments)).title=null,e}return Object(a.a)(r,[{key:"clone",value:function(){return new n({title:this.title})}}]),r}(h.a);Object(c.a)([Object(u.b)({type:String,json:{write:!0}})],f.prototype,"title",void 0);var p=f=n=Object(c.a)([Object(l.a)("esri.renderers.support.LegendOptions")],f);t.a=p},878:function(e,t,r){"use strict";var n=r(2),i=r(3),a=r(5),s=r(6),o=r(0),c=(r(13),r(14)),u=r(15),l=r(1),h=r(73),f=r(50),p=r(8),v=(r(11),r(19),r(20),r(28)),y=r(850),d=c.a.getLogger("esri.renderers.visualVariables.VisualVariable"),b=new f.a({colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation",sizeInfo:"size"}),m=function(e){Object(a.a)(r,e);var t=Object(s.a)(r);function r(e){var i;return Object(n.a)(this,r),(i=t.call(this,e)).index=null,i.type=null,i.field=null,i.valueExpression=null,i.valueExpressionTitle=null,i.legendOptions=null,i}return Object(i.a)(r,[{key:"castField",value:function(e){return null==e?e:"function"==typeof e?(d.error(".field: field must be a string value"),null):Object(u.l)(e)}},{key:"arcadeRequired",get:function(){return!!this.valueExpression}},{key:"clone",value:function(){}},{key:"getAttributeHash",value:function(){return"".concat(this.type,"-").concat(this.field,"-").concat(this.valueExpression)}}]),r}(v.a);Object(o.a)([Object(l.b)()],m.prototype,"index",void 0),Object(o.a)([Object(l.b)({type:b.apiValues,readOnly:!0,json:{read:b.read,write:b.write}})],m.prototype,"type",void 0),Object(o.a)([Object(l.b)({type:String,json:{write:!0}})],m.prototype,"field",void 0),Object(o.a)([Object(h.a)("field")],m.prototype,"castField",null),Object(o.a)([Object(l.b)({type:String,json:{write:!0}})],m.prototype,"valueExpression",void 0),Object(o.a)([Object(l.b)({type:String,json:{write:!0}})],m.prototype,"valueExpressionTitle",void 0),Object(o.a)([Object(l.b)({readOnly:!0,dependsOn:["valueExpression"]})],m.prototype,"arcadeRequired",null),Object(o.a)([Object(l.b)({type:y.a,json:{write:!0}})],m.prototype,"legendOptions",void 0);var x=m=Object(o.a)([Object(p.a)("esri.renderers.visualVariables.VisualVariable")],m);t.a=x},882:function(e,t,r){"use strict";var n,i=r(2),a=r(3),s=r(5),o=r(6),c=r(0),u=(r(13),r(14),r(15),r(1)),l=r(8),h=(r(11),r(19),r(20),r(28)),f=r(36),p=n=function(e){Object(s.a)(r,e);var t=Object(o.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).label=null,n.size=null,n.value=null,n}return Object(a.a)(r,[{key:"clone",value:function(){return new n({label:this.label,size:this.size,value:this.value})}}]),r}(h.a);Object(c.a)([Object(u.b)({type:String,json:{write:!0}})],p.prototype,"label",void 0),Object(c.a)([Object(u.b)({type:Number,cast:f.j,json:{write:!0}})],p.prototype,"size",void 0),Object(c.a)([Object(u.b)({type:Number,json:{write:!0}})],p.prototype,"value",void 0);var v=p=n=Object(c.a)([Object(l.a)("esri.renderers.visualVariables.support.SizeStop")],p);t.a=v},885:function(e,t,r){"use strict";var n,i=r(2),a=r(3),s=r(61),o=r(55),c=r(5),u=r(6),l=r(9),h=r(0),f=(r(13),r(14)),p=r(1),v=r(73),y=r(50),d=r(63),b=r(8),m=r(47),x=r(23),O=(r(11),r(19),r(20),r(36)),g=r(878),_=r(882),j=(r(15),r(850)),k=n=function(e){Object(c.a)(r,e);var t=Object(u.a)(r);function r(){var e;return Object(i.a)(this,r),(e=t.apply(this,arguments)).customValues=null,e}return Object(a.a)(r,[{key:"clone",value:function(){return new n({title:this.title,showLegend:this.showLegend,customValues:this.customValues&&this.customValues.slice(0)})}}]),r}(j.a);Object(h.a)([Object(p.b)({type:[Number],json:{write:!0}})],k.prototype,"customValues",void 0);var M,w=k=n=Object(h.a)([Object(b.a)("esri.renderers.visualVariables.support.SizeVariableLegendOptions")],k),S=r(794),z=r(820),C=f.a.getLogger("esri.renderers.visualVariables.SizeVariable"),L=new y.a({width:"width",depth:"depth",height:"height",widthAndDepth:"width-and-depth",all:"all"}),I=new y.a({unknown:"unknown",inch:"inches",foot:"feet",yard:"yards",mile:"miles","nautical-mile":"nautical-miles",millimeter:"millimeters",centimeter:"centimeters",decimeter:"decimeters",meter:"meters",kilometer:"kilometers","decimal-degree":"decimal-degrees"});function T(e){if(null!=e)return"string"==typeof e||"number"==typeof e?Object(O.j)(e):"size"===e.type?Object(S.c)(e)?e:(delete(e=Object(l.a)({},e)).type,new V(e)):void 0}function P(e,t,r){if("object"!=typeof e)return e;var n=new V;return n.read(e,r),n}var V=M=function(e){Object(c.a)(r,e);var t=Object(u.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).axis=null,n.legendOptions=null,n.normalizationField=null,n.scaleBy=null,n.target=null,n.type="size",n.useSymbolValue=null,n.valueExpression=null,n.valueRepresentation=null,n.valueUnit=null,n}return Object(a.a)(r,[{key:"cache",get:function(){return{ipData:this._interpolateData(),hasExpression:!!this.valueExpression,compiledFunc:null,isScaleDriven:z.g.test(this.valueExpression)}}},{key:"expression",set:function(e){C.warn("'expression' is deprecated since version 4.2. Use 'valueExpression' instead. The only supported expression is 'view.scale'."),"view.scale"===e?(this.valueExpression="$view.scale",this._set("expression",e)):this._set("expression",null)}},{key:"index",set:function(e){Object(S.c)(this.maxSize)&&(this.maxSize.index="visualVariables[".concat(e,"].maxSize")),Object(S.c)(this.minSize)&&(this.minSize.index="visualVariables[".concat(e,"].minSize")),this._set("index",e)}},{key:"inputValueType",get:function(){return Object(S.a)(this)}},{key:"maxDataValue",set:function(e){e&&this.stops&&(C.warn("cannot set maxDataValue when stops is not null."),e=null),this._set("maxDataValue",e)}},{key:"maxSize",set:function(e){e&&this.stops&&(C.warn("cannot set maxSize when stops is not null."),e=null),this._set("maxSize",e)}},{key:"castMaxSize",value:function(e){return T(e)}},{key:"readMaxSize",value:function(e,t,r){return P(e,0,r)}},{key:"minDataValue",set:function(e){e&&this.stops&&(C.warn("cannot set minDataValue when stops is not null."),e=null),this._set("minDataValue",e)}},{key:"minSize",set:function(e){e&&this.stops&&(C.warn("cannot set minSize when stops is not null."),e=null),this._set("minSize",e)}},{key:"castMinSize",value:function(e){return T(e)}},{key:"readMinSize",value:function(e,t,r){return P(e,0,r)}},{key:"arcadeRequired",get:function(){return!!this.valueExpression||this.minSize&&"object"==typeof this.minSize&&this.minSize.arcadeRequired||this.maxSize&&"object"==typeof this.maxSize&&this.maxSize.arcadeRequired}},{key:"stops",set:function(e){null==this.minDataValue&&null==this.maxDataValue&&null==this.minSize&&null==this.maxSize?e&&Array.isArray(e)&&(e=e.filter((function(e){return!!e}))).sort((function(e,t){return e.value-t.value})):e&&(C.warn("cannot set stops when one of minDataValue, maxDataValue, minSize or maxSize is not null."),e=null),this._set("stops",e)}},{key:"transformationType",get:function(){return Object(S.b)(this,this.inputValueType)}},{key:"readValueExpression",value:function(e,t){return e||t.expression&&"$view.scale"}},{key:"writeValueExpressionWebScene",value:function(e,t,r,n){if("$view.scale"===e){if(n&&n.messages){var i=this.index,a="string"==typeof i?i:"visualVariables[".concat(i,"]");n.messages.push(new x.a("property:unsupported",this.type+"VisualVariable.valueExpression = '$view.scale' is not supported in Web Scene. Please remove this property to save the Web Scene.",{instance:this,propertyName:a+".valueExpression",context:n}))}}else t[r]=e}},{key:"readValueUnit",value:function(e){return e?I.read(e):null}},{key:"clone",value:function(){return new M({axis:this.axis,field:this.field,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,maxDataValue:this.maxDataValue,maxSize:Object(S.c)(this.maxSize)?this.maxSize.clone():this.maxSize,minDataValue:this.minDataValue,minSize:Object(S.c)(this.minSize)?this.minSize.clone():this.minSize,normalizationField:this.normalizationField,stops:this.stops&&this.stops.map((function(e){return e.clone()})),target:this.target,useSymbolValue:this.useSymbolValue,valueRepresentation:this.valueRepresentation,valueUnit:this.valueUnit,legendOptions:this.legendOptions&&this.legendOptions.clone()})}},{key:"flipSizes",value:function(){if("clamped-linear"===this.transformationType){var e=this.minSize,t=this.maxSize;return this.minSize=t,this.maxSize=e,this}if("stops"===this.transformationType){for(var r=this.stops,n=r.map((function(e){return e.size})).reverse(),i=r.length,a=0;a<i;a++)r[a].size=n[a];return this}return this}},{key:"getAttributeHash",value:function(){return"".concat(Object(s.a)(Object(o.a)(r.prototype),"getAttributeHash",this).call(this),"-").concat(this.target,"-").concat(this.normalizationField)}},{key:"_interpolateData",value:function(){return this.stops&&this.stops.map((function(e){return e.value||0}))}}]),r}(g.a);Object(h.a)([Object(p.b)({readOnly:!0,dependsOn:["valueExpression","stops"]})],V.prototype,"cache",null),Object(h.a)([Object(p.b)({type:L.apiValues,json:{type:L.jsonValues,origins:{"web-map":{read:!1}},read:L.read,write:L.write}})],V.prototype,"axis",void 0),Object(h.a)([Object(p.b)({type:String,value:null,json:{read:!1}})],V.prototype,"expression",null),Object(h.a)([Object(p.b)()],V.prototype,"index",null),Object(h.a)([Object(p.b)({type:String,readOnly:!0,dependsOn:["field","valueExpression"]})],V.prototype,"inputValueType",null),Object(h.a)([Object(p.b)({type:w,json:{write:!0}})],V.prototype,"legendOptions",void 0),Object(h.a)([Object(p.b)({type:Number,value:null,json:{write:!0}})],V.prototype,"maxDataValue",null),Object(h.a)([Object(p.b)({type:Number,value:null,json:{write:!0}})],V.prototype,"maxSize",null),Object(h.a)([Object(v.a)("maxSize")],V.prototype,"castMaxSize",null),Object(h.a)([Object(d.a)("maxSize")],V.prototype,"readMaxSize",null),Object(h.a)([Object(p.b)({type:Number,value:null,json:{write:!0}})],V.prototype,"minDataValue",null),Object(h.a)([Object(p.b)({type:Number,value:null,json:{write:!0}})],V.prototype,"minSize",null),Object(h.a)([Object(v.a)("minSize")],V.prototype,"castMinSize",null),Object(h.a)([Object(d.a)("minSize")],V.prototype,"readMinSize",null),Object(h.a)([Object(p.b)({type:String,json:{write:!0}})],V.prototype,"normalizationField",void 0),Object(h.a)([Object(p.b)({readOnly:!0,dependsOn:["valueExpression","minSize.arcadeRequired","maxSize.arcadeRequired"]})],V.prototype,"arcadeRequired",null),Object(h.a)([Object(p.b)({type:String})],V.prototype,"scaleBy",void 0),Object(h.a)([Object(p.b)({type:[_.a],value:null,json:{write:!0}})],V.prototype,"stops",null),Object(h.a)([Object(p.b)({type:["outline"],json:{write:!0}})],V.prototype,"target",void 0),Object(h.a)([Object(p.b)({type:String,readOnly:!0,dependsOn:["minDataValue","maxDataValue","minSize","maxSize","valueUnit","inputValueType","stops"]})],V.prototype,"transformationType",null),Object(h.a)([Object(p.b)({type:["size"],json:{type:["sizeInfo"]}})],V.prototype,"type",void 0),Object(h.a)([Object(p.b)({type:Boolean,json:{write:!0,origins:{"web-map":{read:!1}}}})],V.prototype,"useSymbolValue",void 0),Object(h.a)([Object(p.b)({type:String,json:{write:!0}})],V.prototype,"valueExpression",void 0),Object(h.a)([Object(d.a)("valueExpression",["valueExpression","expression"])],V.prototype,"readValueExpression",null),Object(h.a)([Object(m.a)("web-scene","valueExpression")],V.prototype,"writeValueExpressionWebScene",null),Object(h.a)([Object(p.b)({type:["radius","diameter","area","width","distance"],json:{write:!0}})],V.prototype,"valueRepresentation",void 0),Object(h.a)([Object(p.b)({type:I.apiValues,json:{write:I.write,origins:{"web-map":{read:!1},"web-scene":{write:!0}}}})],V.prototype,"valueUnit",void 0),Object(h.a)([Object(d.a)("valueUnit")],V.prototype,"readValueUnit",null);var D=V=M=Object(h.a)([Object(b.a)("esri.renderers.visualVariables.SizeVariable")],V);t.a=D},891:function(e,t,r){"use strict";r.d(t,"a",(function(){return f})),r.d(t,"b",(function(){return l})),r.d(t,"c",(function(){return c})),r.d(t,"d",(function(){return h}));var n=r(32),i=r(12),a=r(58),s=r(898),o=r(912);function c(e){if(!e)return null;switch(e.type){case"CIMPointSymbol":var t=e.symbolLayers;return t&&1===t.length?c(t[0]):null;case"CIMVectorMarker":var r=e.markerGraphics;if(!r||1!==r.length)return null;var n=r[0];if(!n)return null;var i=n.geometry;if(!i)return null;var a=n.symbol;return!a||"CIMPolygonSymbol"!==a.type&&"CIMLineSymbol"!==a.type?null:{geom:i,asFill:"CIMPolygonSymbol"===a.type};case"sdf":return{geom:e.geom,asFill:e.asFill}}return null}function u(e){var t,r=1/0,n=-1/0,a=1/0,s=-1/0,o=Object(i.a)(e);try{for(o.s();!(t=o.n()).done;){var c,u=t.value,l=Object(i.a)(u);try{for(l.s();!(c=l.n()).done;){var h=c.value;h[0]<r&&(r=h[0]),h[0]>n&&(n=h[0]),h[1]<a&&(a=h[1]),h[1]>s&&(s=h[1])}}catch(f){l.e(f)}finally{l.f()}}}catch(f){o.e(f)}finally{o.f()}return[r,a,n,s]}function l(e){return e?e.rings?u(e.rings):e.paths?u(e.paths):Object(a.d)(e)?[e.xmin,e.ymin,e.xmax,e.ymax]:null:null}function h(e,t,r,i,a){var s=Object(n.a)(e,4),o=s[0],c=s[1],u=s[2],l=s[3];if(u<o||l<c)return[0,0,0];var h=u-o,f=l-c,p=Math.floor(31.5),v=(128-2*(p+1))/Math.max(h,f),y=Math.round(h*v)+2*p,d=Math.round(f*v)+2*p,b=1;t&&(b=d/v/(t.ymax-t.ymin));var m=0,x=0;if(i)if(a){if(t&&r&&t.ymax-t.ymin>0){var O=(t.xmax-t.xmin)/(t.ymax-t.ymin);m=i.x/(r*O),x=i.y/r}}else m=i.x,x=i.y;return m=.5*(t.xmax+t.xmin)+m*(t.xmax-t.xmin),x=.5*(t.ymax+t.ymin)+x*(t.ymax-t.ymin),m-=o,x-=c,m*=v,x*=v,[b,(m+=p)/y-.5,-((x+=p)/d-.5)]}function f(e){var t,r,a=(t=e.geom)?t.rings?t.rings:t.paths?t.paths:void 0!==t.xmin&&void 0!==t.ymin&&void 0!==t.xmax&&void 0!==t.ymax?[[[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]]]:null:null,o=function(e){var t,r=1/0,n=-1/0,a=1/0,o=-1/0,c=Object(i.a)(e);try{for(c.s();!(t=c.n()).done;){var u,l=t.value,h=Object(i.a)(l);try{for(h.s();!(u=h.n()).done;){var f=u.value;f[0]<r&&(r=f[0]),f[0]>n&&(n=f[0]),f[1]<a&&(a=f[1]),f[1]>o&&(o=f[1])}}catch(p){h.e(p)}finally{h.f()}}}catch(p){c.e(p)}finally{c.f()}return new s.a(r,a,n-r,o-a)}(a),c=Math.floor(31.5),u=(128-2*(c+1))/Math.max(o.width,o.height),l=Math.round(o.width*u)+2*c,h=Math.round(o.height*u)+2*c,f=[],v=Object(i.a)(a);try{for(v.s();!(r=v.n()).done;){var y=r.value;if(y&&y.length>1){var d,b=[],m=Object(i.a)(y);try{for(m.s();!(d=m.n()).done;){var x=d.value,O=Object(n.a)(x,2),g=O[0],_=O[1];g-=o.x,_-=o.y,g*=u,_*=u,g+=c-.5,_+=c-.5,b.push([g,_])}}catch(M){m.e(M)}finally{m.f()}if(e.asFill){var j=b.length-1;b[0][0]===b[j][0]&&b[0][1]===b[j][1]||b.push(b[0])}f.push(b)}}}catch(M){v.e(M)}finally{v.f()}var k=function(e,t,r,n){for(var a=t*r,s=new Array(a),o=n*n+1,c=0;c<a;++c)s[c]=o;var u,l=Object(i.a)(e);try{for(l.s();!(u=l.n()).done;)for(var h=u.value,f=h.length,p=1;p<f;++p){var v=h[p-1],y=h[p],d=void 0,b=void 0,m=void 0,x=void 0;v[0]<y[0]?(d=v[0],b=y[0]):(d=y[0],b=v[0]),v[1]<y[1]?(m=v[1],x=y[1]):(m=y[1],x=v[1]);var O=Math.floor(d)-n,g=Math.floor(b)+n,_=Math.floor(m)-n,j=Math.floor(x)+n;O<0&&(O=0),g>t&&(g=t),_<0&&(_=0),j>r&&(j=r);for(var k=y[0]-v[0],w=y[1]-v[1],S=k*k+w*w,z=O;z<g;z++)for(var C=_;C<j;C++){var L=void 0,I=void 0,T=(z-v[0])*k+(C-v[1])*w;T<0?(L=v[0],I=v[1]):T>S?(L=y[0],I=y[1]):(T/=S,L=v[0]+T*k,I=v[1]+T*w);var P=(z-L)*(z-L)+(C-I)*(C-I),V=(r-C-1)*t+z;P<s[V]&&(s[V]=P)}}}catch(M){l.e(M)}finally{l.f()}for(var D=0;D<a;++D)s[D]=Math.sqrt(s[D]);return s}(f,l,h,c);return e.asFill&&function(e,t,r,n,a){var s,o=Object(i.a)(e);try{for(o.s();!(s=o.n()).done;)for(var c=s.value,u=c.length,l=1;l<u;++l){var h=c[l-1],f=c[l],p=void 0,v=void 0,y=void 0,d=void 0;h[0]<f[0]?(p=h[0],v=f[0]):(p=f[0],v=h[0]),h[1]<f[1]?(y=h[1],d=f[1]):(y=f[1],d=h[1]);var b=Math.floor(p),m=Math.floor(v)+1,x=Math.floor(y),O=Math.floor(d)+1;b<n&&(b=n),m>t-n&&(m=t-n),x<n&&(x=n),O>r-n&&(O=r-n);for(var g=x;g<O;++g)if(h[1]>g!=f[1]>g){for(var _=(r-g-1)*t,j=b;j<m;++j)j<(f[0]-h[0])*(g-h[1])/(f[1]-h[1])+h[0]&&(a[_+j]=-a[_+j]);for(var k=n;k<b;++k)a[_+k]=-a[_+k]}}}catch(M){o.e(M)}finally{o.f()}}(f,l,h,c,k),[p(k,c),l,h]}function p(e,t){for(var r=2*t,n=e.length,i=new Uint8Array(4*n),a=0;a<n;++a){var s=.5-e[a]/r;Object(o.a)(s,i,4*a)}return i}},901:function(e,t,r){"use strict";r.d(t,"a",(function(){return q}));var n=r(10),i=r.n(n),a=r(12),s=r(21),o=r(2),c=r(3),u=(r(13),r(4)),l=r(16),h=r(779),f=r(780),p=r(846),v=r(781),y=r(815),d=r(840),b=function(){function e(t,r){Object(o.a)(this,e),this.data=t,this.stride=r}return Object(c.a)(e,[{key:"vertexCount",get:function(){var e=this.stride/4,t=this.data.length/e;return t!==(0|t)&&console.debug("Corrupted stride"),t}},{key:"transfer",value:function(e,t){var r=this.data.buffer();e.vertexCount=this.vertexCount,e.data=r,e.stride=this.stride,t.push(r)}}]),e}(),m=function(){function e(t,r){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];Object(o.a)(this,e),this.geometryType=t,this.indexVector=new y.a(Uint32Array,6*r),this.namedVectors={};var i=Object(v.k)(t,n);for(var a in i){var s=i[a],c=void 0;switch(s%4){case 0:case 2:c=new y.a(Uint32Array,s*r);break;case 1:case 3:c=new y.a(Uint8Array,s*r)}this.namedVectors[a]=new b(c,s)}}return Object(c.a)(e,[{key:"get",value:function(e){return this.namedVectors[e].data}},{key:"getVector",value:function(e){return this.namedVectors[e]}},{key:"transfer",value:function(e,t){var r=this.indexVector.buffer(),n={};for(var i in t.push(r),this.namedVectors){var a=this.namedVectors[i];n[i]={},a.transfer(n[i],t)}e.geometryType=this.geometryType,e.indexBuffer=r,e.namedBuffers=n,this.destroy()}},{key:"intoBuffers",value:function(){var e=d.a.fromVertexVectors(this);return this.destroy(),e}},{key:"destroy",value:function(){this.indexVector=null,this.namedVectors=null}}]),e}(),x=r(32),O=r(5),g=r(6),_=r(14),j=r(23),k=r(38),M=r(36),w=r(810),S=r(783),z=r(922),C=r(782),L=r(785),I=r(811),T=r(788);function P(e,t){return e[t+1]}function V(e){return e.length-1}function D(e){for(var t=0,r=0;r<V(e);r++)t+=R(e,r);return t}function R(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=P(e,t),i=Object(x.a)(n,2),a=i[0],s=i[1];return Math.sqrt(a*a+s*s)*r}var F=function(){function e(t,r,n,i,a){Object(o.a)(this,e),this._segments=t,this._index=r,this._distance=n,this._xStart=i,this._yStart=a,this._done=!1}return Object(c.a)(e,[{key:"clone",value:function(){return new e(this._segments,this._index,this._distance,this.xStart,this.yStart)}},{key:"equals",value:function(e){return this._index===e._index||e._index===this._index-1&&(0===this._distance||1===e._distance)||e._index===this._index+1&&(1===this._distance||0===e._distance)}},{key:"leq",value:function(e){return this._index<e._index||this._index===e._index&&this._distance<=e._distance}},{key:"geq",value:function(e){return this._index>e._index||this._index===e._index&&this._distance>=e._distance}},{key:"_segment",get:function(){return this._segments[this._index+1]}},{key:"angle",get:function(){var e=this.dy,t=(0*e+-1*-this.dx)/(1*this.length),r=Math.acos(t);return e>0&&(r=2*Math.PI-r),r}},{key:"xStart",get:function(){return this._xStart}},{key:"yStart",get:function(){return this._yStart}},{key:"x",get:function(){return this.xStart+this.distance*this.dx}},{key:"y",get:function(){return this.yStart+this.distance*this.dy}},{key:"dx",get:function(){return this._segment[0]}},{key:"dy",get:function(){return this._segment[1]}},{key:"xMidpoint",get:function(){return this.xStart+.5*this.dx}},{key:"yMidpoint",get:function(){return this.yStart+.5*this.dy}},{key:"xEnd",get:function(){return this.xStart+this.dx}},{key:"yEnd",get:function(){return this.yStart+this.dy}},{key:"length",get:function(){var e=this.dx,t=this.dy;return Math.sqrt(e*e+t*t)}},{key:"remainingLength",get:function(){return this.length*(1-this._distance)}},{key:"backwardLength",get:function(){return this.length*this._distance}},{key:"distance",get:function(){return this._distance}},{key:"done",get:function(){return this._done}},{key:"hasPrev",value:function(){return this._index-1>=0}},{key:"hasNext",value:function(){return this._index+1<V(this._segments)}},{key:"next",value:function(){return this.hasNext()?(this._xStart+=this.dx,this._yStart+=this.dy,this._distance=0,this._index+=1,this):null}},{key:"prev",value:function(){return this.hasPrev()?(this._index-=1,this._xStart-=this.dx,this._yStart-=this.dy,this._distance=1,this):(this._done=!0,null)}},{key:"_seekBackwards",value:function(e,t){var r=this.backwardLength;if(e<=r)return this._distance=(r-e)/this.length,this;for(var n=this.backwardLength;this.prev();){if(n+this.length>e)return this._seekBackwards(e-n);n+=this.length}return this._distance=0,t?this:null}},{key:"seek",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e<0)return this._seekBackwards(Math.abs(e),t);if(e<=this.remainingLength)return this._distance=(this.backwardLength+e)/this.length,this;for(var r=this.remainingLength;this.next();){if(r+this.length>e)return this.seek(e-r,t);r+=this.length}return this._distance=1,t?this:null}}],[{key:"create",value:function(t){return new e(t,0,0,t[0][0],t[0][1])}}]),e}();function A(e,t,r){var n=D(e),i=F.create(e),a=n/2,s=(n-t)/2,o=Math.floor(s/t),c=a-o*t;i.seek(c);for(var u=-o;u<=o;u++)i.x<512&&i.x>=0&&i.y<512&&i.y>=0&&r(i.clone(),u,a+u*t,n),i.seek(t)}function N(e,t){var r=1e-6;if(!(t<=0)){var n=e.length;if(!(n<3)){var i=[],a=0;i.push(0);for(var s=1;s<n;s++)a+=Object(T.a)(e[s],e[s-1]),i.push(a);t=Math.min(t,.2*a);var o=[];o.push(e[0][0]),o.push(e[0][1]);var c=e[n-1][0],u=e[n-1][1],l=Object(T.e)([0,0],e[0],e[1]);Object(T.d)(l),e[0][0]+=t*l[0],e[0][1]+=t*l[1],Object(T.e)(l,e[n-1],e[n-2]),Object(T.d)(l),e[n-1][0]+=t*l[0],e[n-1][1]+=t*l[1];for(var h=1;h<n;h++)i[h]+=t;i[n-1]+=t;for(var f=.5*t,p=1;p<n-1;p++){for(var v=0,y=0,d=0,b=p-1;b>=0&&!(i[b+1]<i[p]-f);b--){var m=f+i[b+1]-i[p],x=i[b+1]-i[b],O=i[p]-i[b]<f?1:m/x;if(Math.abs(O)<r)break;var g=O*O,_=O*m-.5*g*x,j=O*x/t,k=e[b+1],M=e[b][0]-k[0],w=e[b][1]-k[1];v+=j/_*(k[0]*O*m+.5*g*(m*M-x*k[0])-g*O*x*M/3),y+=j/_*(k[1]*O*m+.5*g*(m*w-x*k[1])-g*O*x*w/3),d+=j}for(var S=p+1;S<n&&!(i[S-1]>i[p]+f);S++){var z=f-i[S-1]+i[p],C=i[S]-i[S-1],L=i[S]-i[p]<f?1:z/C;if(Math.abs(L)<r)break;var I=L*L,P=L*z-.5*I*C,V=L*C/t,D=e[S-1],R=e[S][0]-D[0],F=e[S][1]-D[1];v+=V/P*(D[0]*L*z+.5*I*(z*R-C*D[0])-I*L*C*R/3),y+=V/P*(D[1]*L*z+.5*I*(z*F-C*D[1])-I*L*C*F/3),d+=V}o.push(v/d),o.push(y/d)}o.push(c),o.push(u);for(var A=0,N=0;A<n;A++)e[A][0]=o[N++],e[A][1]=o[N++]}}}var E=r(851),B=_.a.getLogger("esri.views.2d.engine.webgl.WGLLabelTemplate"),Z=function(e){var t=new Map;return function(e){return t.has(e)||t.set(e,function(e){var t=0;if(0===e)return 1/0;for(;!(e%2);)t++,e/=2;return t}(e)),t.get(e)}}(),X=function(e){return Math.floor(127*e+127)},G=function(e){return Math.floor(10*e)},U=function(e){return Math.round(e*(254/360))},K=function(e,t){return Object(S.a)(Math.round(8*e),Math.round(8*t))},Y=function(e){Object(O.a)(r,e);var t=Object(g.a)(r);function r(e,n,i,a){var s;Object(o.a)(this,r),(s=t.call(this,e,i.font.size,i.haloSize||0,i.color&&Object(L.d)(i.color)||0,i.haloColor&&Object(L.d)(i.haloColor)||0,i.horizontalAlignment,i.verticalAlignment,Object(z.a)(n.labelPlacement)?1:0,i.font.decoration,!1,i.angle||0,i.xoffset,i.yoffset,i.lineWidth,i.lineHeight,null,null))._outLineLabelAngle=0,s._refPlacementPadding=0,s._refPlacementDirX=0,s._refPlacementDirY=0,s._refOffsetX=0,s._refOffsetY=0,s.geometryType=f.d.LABEL;var c=function(e,t){var r=!!e.minScale&&t.scaleToZoom(e.minScale)||0;return Object(k.c)(r,0,25.5)}(n,a),u=function(e,t){var r=!!e.maxScale&&t.scaleToZoom(e.maxScale)||255;return Object(k.c)(r,0,25.5)}(n,a),l=n.labelPlacement,p=Object(w.b)(l),v=Object(x.a)(p,2),y=v[0],d=v[1];s._xAlignD=y,s._yAlignD=d,s._minZoom=c,s._maxZoom=u,s._refPlacementPadding=Object(M.g)(i.haloSize)+h.D;var b=C.b.load(e);return b.sdf=!0,s._materialKey=b.data,s}return Object(c.a)(r,[{key:"_shapedBox",get:function(){return Object(u.o)(this._shapingInfo).bounds}},{key:"bindReferenceTemplate",value:function(e){var t=Object(w.e)(this._xAlignD),r=Object(w.g)(this._yAlignD);if(this._refOffsetX=0,this._refOffsetY=0,Object(u.h)(e))this._refSymbolAndPlacementOffset=Object(S.b)(0,0,X(t),X(r));else{if("circle"===e.boundsType&&(t||r)){var n=Math.sqrt(t*t+r*r);t/=n,r/=n}var i=Math.max(e.height,e.width),a=4*this._refPlacementPadding;this._refSymbolAndPlacementOffset=Object(S.b)(a,i,X(t),X(r)),this._referenceSize=i,this._refPlacementDirX=t,this._refPlacementDirY=r,this._refOffsetX=e.xOffset,this._refOffsetY=e.yOffset}}},{key:"writeMesh",value:function(e,t,r,n,i,a){if(!Object(u.h)(this._shapingInfo)){var s=new Array,o=this._shapingInfo,c="esriGeometryPolygon"===r.geometryType?r.readLegacyCentroid():r.readLegacyGeometry();if(c){switch(this.current={out:e,outVecs:t,outMetrics:s,inId:i,inShaping:o,zoomLevel:a},n){case"esriGeometryPolyline":this._placeLineLabels(c);break;case"esriGeometryPoint":case"esriGeometryPolygon":this._placePointLabels(c);break;default:!function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"mapview-labeling";B.error(new j.a(t,e))}("mapview-labeling","Geometry of type ".concat(n," is not supported"))}e.writeMetrics(this.current.outMetrics)}}}},{key:"_isVisible",value:function(e,t){var r=G(this.current.zoomLevel);return G(e)<=r&&r<=G(t)}},{key:"_placePointLabels",value:function(e){var t=this.current,r=t.out,n=t.outVecs,i=t.outMetrics,a=t.inId;this._writeGlyphs(r,n,a,e,i)}},{key:"_placeLineLabels",value:function(e){var t,r=function(e,t){for(var r=t,n=0;n<e.length;n++){var i=e[n],a=[];a.push(i[0]);for(var s=1;s<i.length;s++){var o=Object(x.a)(a[s-1],2),c=o[0],u=o[1];c+=i[s][0],u+=i[s][1],a.push([c,u])}N(a,r);var l=[];l.push(a[0]);for(var h=1;h<a.length;h++){var f=Object(x.a)(a[h-1],2),p=f[0],v=f[1],y=Object(x.a)(a[h],2),d=y[0],b=y[1],m=Math.round(d-p),O=Math.round(b-v);l.push([m,O])}e[n]=l,i=l}return e}(e.paths,this.current.inShaping.bounds.width),n=this._placeSubdivGlyphs.bind(this),i=(this._shapedBox.width+128)/4,s=Object(a.a)(r);try{for(s.s();!(t=s.n()).done;){A(t.value,i,n)}}catch(o){s.e(o)}finally{s.f()}}},{key:"_placeSubdivGlyphs",value:function(e,t,r,n){var i=Z(t),a=this._shapedBox.width/4,s=Math.min(r,n-r),o=Object(k.i)(s/(4+a/2)),c=0===t?o:Math.min(i,o),u=Math.max(this._minZoom,this.current.zoomLevel+2-c),l=this.current.zoomLevel-u,h=this._shapedBox.width/2*Math.pow(2,l);this.current.inShaping.isMultiline?0===t&&this._placeStraight(e,u):this._placeCurved(e,u,h)}},{key:"_placeStraight",value:function(e,t){var r=this.current,n=r.out,i=r.outVecs,a=r.outMetrics,s=r.inId;this._writeGlyphs(n,i,s,e,a,t)}},{key:"_placeCurved",value:function(e,t,r){var n={from:this.current.out.currentDisplayRecordCount(),count:-1},i=new I.a(this.current.inId,n,e.x,e.y,t),a=e.clone(),s=e.angle*(180/Math.PI)%360,o=(e.angle*(180/Math.PI)+180)%360;this._outLineLabelAngle=U(s),this._placeFirst(a,i,t,1),this._placeBack(e,a,i,t,r,1),this._placeForward(e,a,i,t,r,1),this._outLineLabelAngle=U(o),this._placeFirst(a,i,t,0),this._placeBack(e,a,i,t,r,0),this._placeForward(e,a,i,t,r,0),i.range.count=this.current.out.currentDisplayRecordCount()-i.range.from,i.bounds&&this.current.outMetrics.push(i)}},{key:"_placeBack",value:function(e,t,r,n,i,a){for(var s=e.clone(),o=e.backwardLength+0;s.prev()&&!(o>=i);)this._placeOnSegment(s,t,r,o,n,-1,a),o+=s.length+0}},{key:"_placeForward",value:function(e,t,r,n,i,a){for(var s=e.clone(),o=e.remainingLength+0;s.next()&&!(o>=i);)this._placeOnSegment(s,t,r,o,n,1,a),o+=s.length+0}},{key:"_placeFirst",value:function(e,t,r,n){var i,s=e,o=this.current.inShaping,c=o.glyphs,u=this.current.zoomLevel,l=this.current,h=l.out,f=l.outVecs,p=l.inId,v=K(s.x,s.y),y=Object(a.a)(c);try{for(y.s();!(i=y.n()).done;){var d=i.value,b=d.x>o.bounds.x?n:1-n,m=b*e.remainingLength+(1-b)*e.backwardLength,x=Math.abs(d.x+d.width/2-o.bounds.x),O=Math.max(0,u+Object(k.i)(x/(m+0))),g=Math.max(r,O);d.maxZoom=25,d.angle=e.angle+(1-n)*Math.PI,d.minZoom=g,this._writeGlyph(h,f,d,p,v),n&&this._isVisible(d.minZoom,d.maxZoom)&&t.add(d.bounds,0,0)}}catch(_){y.e(_)}finally{y.f()}}},{key:"_placeOnSegment",value:function(e,t,r,n,i,s,o){var c,u=this.current.inShaping.glyphs,l=this.current,h=l.out,f=l.outVecs,p=l.inId,v=this.current.inShaping,y=this.current.zoomLevel,d=e.dx/e.length,b=e.dy/e.length,m={x:e.x+n*-s*d,y:e.y+n*-s*b},x=K(m.x,m.y),O=Object(a.a)(u);try{for(O.s();!(c=O.n()).done;){var g=c.value,_=g.x>v.bounds.x?o:1-o;if(_&&1===s||!_&&-1===s){var j=Math.abs(g.x+g.width/2-v.bounds.x),M=Math.max(0,y+Object(k.i)(j/n)-.1),w=Math.max(i,y+Object(k.i)(j/(n+e.length+0)));0!==M&&(g.angle=e.angle+(1-o)*Math.PI,g.minZoom=w,g.maxZoom=M,this._writeGlyph(h,f,g,p,x),o&&this._isVisible(g.minZoom,g.maxZoom)&&r.add(g.bounds,e.x-t.x,e.y-t.y))}}}catch(S){O.e(S)}finally{O.f()}}},{key:"_writeGlyphs",value:function(e,t,r,n,i){var s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:this._minZoom,o=this._shapingInfo;if(!Object(u.h)(o)&&!(n.x<0||n.x>=512||n.y<0||n.y>=512)){var c,l=e.currentDisplayRecordCount(),h=K(n.x+this._refOffsetX,n.y-this._refOffsetY),f=new I.a(r,{from:l,count:-1},n.x+this._refOffsetX,n.y-this._refOffsetY,s),p=Object(a.a)(o.glyphs);try{for(p.s();!(c=p.n()).done;){var v=c.value;v.minZoom=s,v.maxZoom=this._maxZoom,this._writeGlyph(e,t,v,r,h)}}catch(x){p.e(x)}finally{p.f()}f.range.count=e.currentDisplayRecordCount()-f.range.from,f.bounds=o.boundsT;var y=C.b.load(this._materialKey),d=this._refPlacementDirX,b=this._refPlacementDirY,m=y.vvSizeFieldStops||y.vvSizeMinMaxValue||y.vvSizeScaleStops||y.vvSizeUnitValue;f.setPlacementOffset(m,this._referenceSize,this._refPlacementPadding,d,b),i.push(f)}}},{key:"_writeGlyph",value:function(e,t,r,n,i){var a=C.e.load(this._materialKey);a.textureBinding=r.textureBinding;var s=t.indexVector.length,o=t.getVector("geometry").vertexCount,c=this._writeIndices(t),u=this._writeVertex(t,n,i,r);e.writeDisplayRecord(this.geometryType,a.data,o,u,s,c)}},{key:"_writeVertexCommon",value:function(e,t,r,n){var i=this._color,a=this._haloColor,s=Object(S.b)(0,0,this._size,this._haloSize),o=Math.max(n.minZoom,this._minZoom),c=Math.min(n.maxZoom,this._maxZoom),u=Object(S.b)(G(o),G(c),this._outLineLabelAngle,0);e.push(r),e.push(t),e.push(i),e.push(a),e.push(s),e.push(this._refSymbolAndPlacementOffset),e.push(u)}}],[{key:"fromLabelClass",value:function(e,t){if("center-along"===e.labelPlacement){var n=e.symbol;n.xoffset=0,n.yoffset=0,n.angle=0,n.font.decoration="none"}return new r(e.materialKey,e,e.symbol,t)}}]),r}(E.a),H=r(854),W=r(859),q=function(){function e(t,r,n){Object(o.a)(this,e),this._isDD=!1,this._geometryType=t,this._idField=r,this._templateStore=n}return Object(c.a)(e,[{key:"update",value:function(e,t){this._isDD="simple"===e.mesh.matcher.type&&e.mesh.matcher.isDotDensity,Object(u.i)(e.mesh.labels)&&this._setLabelTemplates(e.mesh.labels,t)}},{key:"_setLabelTemplates",value:function(e,t){this._labelTemplates=e.map((function(e){return Y.fromLabelClass(e,t)}))}},{key:"templates",get:function(){return this._templateStore}},{key:"createMeshData",value:function(e){var t=new Array(5),r=this._labelTemplates&&this._labelTemplates.length>0,n="esriGeometryPolyline"===this._geometryType?h.k:h.j;return t[f.d.MARKER]=new m(f.d.MARKER,4*e),t[f.d.FILL]=new m(f.d.FILL,e,this._isDD),t[f.d.LINE]=new m(f.d.LINE,e),t[f.d.TEXT]=new m(f.d.TEXT,4*e),t[f.d.LABEL]=new m(f.d.LABEL,r?4*n:0),new p.a(t,{features:e,records:e,metrics:0})}},{key:"analyze",value:function(){var e=Object(s.a)(i.a.mark((function e(t,r,n,s,o){var c,u,h,f,p,v,y;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Object(l.o)(o)){e.next=2;break}return e.abrupt("return");case 2:if(e.t0="dictionary"===r.type,!e.t0){e.next=7;break}return e.next=6,r.analyze(this._idField,t.copy(),n,s,o);case 6:c=e.sent;case 7:for(u=0;t.next();)if(void 0,h=c?c[u++]:r.match(this._idField,t,this._geometryType,n,s),t.setGroupId(h),Object(W.b)(h)){f=this._templateStore.getDynamicTemplateGroup(h),p=Object(a.a)(f);try{for(p.s();!(v=p.n()).done;)(y=v.value)&&y.analyze&&y.analyze(this._templateStore,t,n,s)}catch(i){p.e(i)}finally{p.f()}}return e.abrupt("return",this._templateStore.finalize(o));case 10:case"end":return e.stop()}}),e,this)})));return function(t,r,n,i,a){return e.apply(this,arguments)}}()},{key:"analyzeGraphics",value:function(){var e=Object(s.a)(i.a.mark((function e(t,r,n,s,o){var c,u,h,f,p,v;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Object(l.o)(o)){e.next=2;break}return e.abrupt("return");case 2:if(c=t.getCursor(),e.t0=r,!e.t0){e.next=7;break}return e.next=7,r.analyze(this._idField,c.copy(),n,s,o);case 7:if(!c.next()){e.next=13;break}if(null!=(u=c.getGroupId())&&-1!==u||(u=r.match(this._idField,c,c.geometryType,n,s),c.setGroupId(u)),Object(W.b)(u)){h=this._templateStore.getDynamicTemplateGroup(u),f=Object(a.a)(h);try{for(f.s();!(p=f.n()).done;)(v=p.value)&&v.analyze&&v.analyze(this._templateStore,c,n,s)}catch(i){f.e(i)}finally{f.f()}}c.setGroupId(u);case 11:e.next=7;break;case 13:return e.abrupt("return",this._templateStore.finalize(o));case 14:case"end":return e.stop()}}),e,this)})));return function(t,r,n,i,a){return e.apply(this,arguments)}}()},{key:"writeGraphic",value:function(e,t){var r=t.getGroupId(),n=t.getDisplayId(),i=this._templateStore.getTemplateGroup(r),s=t.geometryType;if(null!=n){if(Object(W.b)(r)){var o,c=Object(a.a)(i);try{for(c.s();!(o=c.n()).done;){o.value.bindFeature(t,null,null)}}catch(p){c.e(p)}finally{c.f()}}if(i){e.writeDisplayObject(n,t.readGraphic().insertAfter);var u,l=Object(a.a)(i);try{for(l.s();!(u=l.n()).done;){var h=u.value;if(h){var f=e.get(h.geometryType);h.writeMesh(e,f,t,s,n)}}}catch(p){l.e(p)}finally{l.f()}}}}},{key:"writeCursor",value:function(e,t,r,n,i,s){var o=t.getGroupId(),c=t.getDisplayId(),l=this._templateStore.getTemplateGroup(o);if(null!=c&&l){if(e.writeDisplayObject(c,0),Object(W.b)(o)){var h,f=Object(a.a)(l);try{for(f.s();!(h=f.n()).done;){h.value.bindFeature(t,r,n)}}catch(x){f.e(x)}finally{f.f()}}var p,v=Object(a.a)(l);try{for(v.s();!(p=v.n()).done;){var y=p.value,d=e.get(y.geometryType);!y.needsPixelBuffer&&t.hasFilter()||y.writeMesh(e,d,t,this._geometryType,c)}}catch(x){v.e(x)}finally{v.f()}var b=e.hasDisplayRecords();if(Object(u.i)(s)&&b){var m=s&&this._findLabelRef(l);this._writeLabels(e,t,c,s,m,i)}e.endDisplayObject()}}},{key:"_findLabelRef",value:function(e){var t,r=Object(a.a)(e);try{for(r.s();!(t=r.n()).done;){var n=t.value;if(n instanceof H.a)return n}}catch(i){r.e(i)}finally{r.f()}return null}},{key:"_writeLabels",value:function(e,t,r,n,i,s){var o,c=Object(a.a)(n);try{for(c.s();!(o=c.n()).done;){var l=o.value;if(Object(u.i)(l)&&l){var h=l.glyphs,f=l.rtl,p=l.index,v=this._labelTemplates[p],y=e.get(v.geometryType);v.bindReferenceTemplate(i),v.bindTextInfo(h,f),v.writeMesh(e,y,t,this._geometryType,r,s)}}}catch(d){c.e(d)}finally{c.f()}}}]),e}()},904:function(e,t,r){"use strict";r.d(t,"a",(function(){return C}));var n=r(10),i=r.n(n),a=r(21),s=r(14),o=r(23),c=r(9),u=r(12),l=r(61),h=r(55),f=r(5),p=r(6),v=r(2),y=r(3),d=r(16),b=r(244),m=r(828),x=r(819),O=r(849),g=r(865),_=r(837),j=s.a.getLogger("esri/views/2d/engine/webgl/util/Matcher"),k=function(){function e(){Object(v.a)(this,e),this.type="feature",this._defaultResult=null}return Object(y.a)(e,[{key:"size",value:function(){return 1}},{key:"getDefault",value:function(){return this._defaultResult}},{key:"setDefault",value:function(e){this._defaultResult=e}},{key:"match",value:function(e,t,r,n,i){return this.getDefault()}},{key:"analyze",value:function(){var e=Object(a.a)(i.a.mark((function e(t,r,n,a,s){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",null);case 1:case"end":return e.stop()}}),e)})));return function(t,r,n,i,a){return e.apply(this,arguments)}}()}],[{key:"fromBasicRenderer",value:function(){var t=Object(a.a)(i.a.mark((function t(r,n,a){var s,o,c;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s=new e,!r.symbol){t.next=7;break}return t.next=4,Object(g.a)(r.symbol,a);case 4:o=t.sent,c=n.createTemplateGroup(o,null),s.setDefault(c);case 7:return t.abrupt("return",s);case 8:case"end":return t.stop()}}),t)})));return function(e,r,n){return t.apply(this,arguments)}}()}]),e}(),M=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e,n,i,a){var s;return Object(v.a)(this,r),(s=t.call(this)).type="interval",s._intervals=[],s._isMaxInclusive=n,s._fieldIndex=a,s._field=e,s._normalizationInfo=i,s}return Object(y.a)(r,[{key:"add",value:function(e,t){this._intervals.push({interval:e,result:t}),this._intervals.sort((function(e,t){return e.interval.min-t.interval.min}))}},{key:"size",value:function(){return Object(l.a)(Object(h.a)(r.prototype),"size",this).call(this)+this._intervals.length}},{key:"match",value:function(e,t,r,n,i){if(null==this._fieldIndex&&!this._field)return this.getDefault();var a=null!=this._fieldIndex?t.getComputedNumericAtIndex(this._fieldIndex):this._getValueFromField(t);if(!a&&(null==a||isNaN(a)))return this.getDefault();for(var s=0;s<this._intervals.length;s++){var o=this._intervals[s],c=o.interval,u=o.result,l=a>=c.min,h=this._isMaxInclusive?a<=c.max:a<c.max;if(l&&h)return u}return this.getDefault()}},{key:"_needsNormalization",value:function(){var e=this._normalizationInfo;return e&&(e.normalizationField||e.normalizationTotal||e.normalizationType)}},{key:"_getValueFromField",value:function(e){var t=e.readAttribute(this._field);if(!this._needsNormalization())return t;var r=this._normalizationInfo,n=r.normalizationField,i=r.normalizationTotal,a=r.normalizationType,s=!!n&&e.readAttribute(n);if(a)switch(a){case"esriNormalizeByField":return s?t/s:void 0;case"esriNormalizeByLog":return Math.log(t)*Math.LOG10E;case"esriNormalizeByPercentOfTotal":return t/i*100;default:return void j.error("Found unknown normalization type: ".concat(a))}else j.error("Normalization is required, but no type was set!")}}],[{key:"fromCBRenderer",value:function(){var e=Object(a.a)(i.a.mark((function e(t,n,s){var o,c,u,l,h,f,p,v,y;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=t.isMaxInclusive,c=t.normalizationField,u=t.normalizationTotal,l=t.normalizationType,h=t.field,f=new r(h,o,{normalizationField:c,normalizationTotal:u,normalizationType:l},t.fieldIndex),e.next=8,Object(g.a)(t.backgroundFillSymbol,s);case 8:return p=e.sent,e.next=11,Object(d.b)(t.intervals.map(function(){var e=Object(a.a)(i.a.mark((function e(t){var r,a,o;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(g.a)(t.symbol,s);case 2:return r=e.sent,e.next=5,n.createTemplateGroup(r,p);case 5:a=e.sent,o={min:t.min,max:t.max},f.add(o,a);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 11:return e.next=13,Object(g.a)(t.defaultSymbol,s);case 13:if(!(v=e.sent)){e.next=19;break}return e.next=17,n.createTemplateGroup(v,p);case 17:y=e.sent,f.setDefault(y);case 19:return e.abrupt("return",f);case 20:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}()}]),r}(k),w=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(e,n,i){var a;return Object(v.a)(this,r),(a=t.call(this)).type="map",a._nullResult=null,a._resultsMap=new Map,a._fieldsIndex=i,a._fields=e,a._seperator=n||"",a}return Object(y.a)(r,[{key:"setNullResult",value:function(e){this._nullResult=e}},{key:"add",value:function(e,t){this._resultsMap.set(e.toString(),t)}},{key:"size",value:function(){return Object(l.a)(Object(h.a)(r.prototype),"size",this).call(this)+this._resultsMap.size}},{key:"match",value:function(e,t,r,n,i){if(null==this._fieldsIndex&&!this._fields)return this.getDefault();var a=null!=this._fieldsIndex?t.getComputedStringAtIndex(this._fieldsIndex):this._getValueFromFields(t);if(null!==this._nullResult&&(null==a||""===a||"<Null>"===a))return this._nullResult;if(!a&&null==a)return this.getDefault();var s=a.toString();return this._resultsMap.has(s)?this._resultsMap.get(s):this.getDefault()}},{key:"_getValueFromFields",value:function(e){var t,r=[],n=Object(u.a)(this._fields);try{for(n.s();!(t=n.n()).done;){var i=t.value,a=e.readAttribute(i);r.push(a)}}catch(s){n.e(s)}finally{n.f()}return r.join(this._seperator)}}],[{key:"fromUVRenderer",value:function(){var e=Object(a.a)(i.a.mark((function e(t,n,s){var o,c,u,l,h,f;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=t.fieldDelimiter,c=[t.field],t.field2&&c.push(t.field2),t.field3&&c.push(t.field3),e.next=4,Object(g.a)(t.backgroundFillSymbol,s);case 4:return u=e.sent,l=new r(c,o,t.fieldIndex),e.next=8,Object(d.b)(t.map.map(function(){var e=Object(a.a)(i.a.mark((function e(t){var r,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(g.a)(t.symbol,s);case 2:return r=e.sent,e.next=5,n.createTemplateGroup(r,u);case 5:a=e.sent,"<Null>"===t.value?l.setNullResult(a):l.add(t.value,a);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 8:return e.next=10,Object(g.a)(t.defaultSymbol,s);case 10:if(!(h=e.sent)){e.next=16;break}return e.next=14,n.createTemplateGroup(h,u);case 14:f=e.sent,l.setDefault(f);case 16:return e.abrupt("return",l);case 17:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}()}]),r}(k),S=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(e,r,i,a){var s;return Object(v.a)(this,n),(s=t.call(this)).type="dictionary",s._groupIdCache=new x.a(100),s._renderer=e,s._fieldMap=e.fieldMap,s._symbolFields=e.getSymbolFields(),s._templates=r,s._info=i,s._scaleFn=a,s}return Object(y.a)(n,[{key:"_analyzeFeature",value:function(){var e=Object(a.a)(i.a.mark((function e(t,r,n,a){var s,l,h,f,p,v,y,d,b=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=t.readLegacyFeature(),l=this._scaleFn(s,r,n),h=this._attributeHash(s)+"-"+l,!(f=this._groupIdCache.get(h))){e.next=3;break}return e.abrupt("return",f);case 3:return p=Object(c.a)(Object(c.a)({},n),{},{spatialReference:this._info.spatialReference,abortOptions:a,fields:this._info.fields}),e.next=6,this._renderer.getSymbolAsync(s,p);case 6:return v=e.sent,y=Object(_.c)(v,this._renderer),d=Object(g.a)(y,this._info,a).then((function(e){if("expanded-cim"!==e.type)return j.error(new o.a("mapview-bad-type","Found unexpected type ".concat(e.type," in dictionary response"))),null;e.hash+="-"+l;var t,r=Object(u.a)(e.layers);try{for(r.s();!(t=r.n()).done;){var n=t.value;n.scaleFactor=l,n.templateHash+="-"+l,"text"===n.type&&"string"==typeof n.text&&n.text.indexOf("[")>-1&&(n.text=Object(m.b)(b._fieldMap,n.text,n.cim.textCase))}}catch(i){r.e(i)}finally{r.f()}return b._templates.createTemplateGroup(e,null)})),e.abrupt("return",(this._groupIdCache.put(h,d,1),d));case 10:case"end":return e.stop()}}),e,this)})));return function(t,r,n,i){return e.apply(this,arguments)}}()},{key:"analyze",value:function(){var e=Object(a.a)(i.a.mark((function e(t,r,n,a,s){var o,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(o=r.getCursor(),c=[];o.next();)c.push(this._analyzeFeature(o,n,a,s));return e.abrupt("return",Object(d.b)(c));case 3:case"end":return e.stop()}}),e,this)})));return function(t,r,n,i,a){return e.apply(this,arguments)}}()},{key:"match",value:function(e,t,r,n,i){return null}},{key:"_attributeHash",value:function(e){var t,r="",n=Object(u.a)(this._symbolFields);try{for(n.s();!(t=n.n()).done;){var i=t.value,a=this._fieldMap[i];a&&(r+=e.attributes[a]+"-")}}catch(s){n.e(s)}finally{n.f()}return r}}],[{key:"fromDictionaryRenderer",value:function(){var e=Object(a.a)(i.a.mark((function e(t,s,o){var c,u;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([r.e(3),r.e(207)]).then(r.bind(null,862));case 2:return c=e.sent.default.fromJSON(t.renderer),e.next=5,c.fetchResources({spatialReference:o.spatialReference,fields:o.fields});case 5:return e.next=7,function(){var e=Object(a.a)(i.a.mark((function e(t,r){var n,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("number"!=typeof(n=t||1)){e.next=3;break}return e.abrupt("return",(function(e,t,r){return n}));case 3:return e.next=5,Object(b.d)(n,r.spatialReference,r.fields);case 5:return a=e.sent,e.abrupt("return",(function(e,t,n){return Object(O.a)(a,e,{$view:n},r.geometryType,t)||1}));case 7:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()(c.scaleExpression,o);case 7:return u=e.sent,e.abrupt("return",new n(c,s,o,u));case 9:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}()}]),n}(k),z=s.a.getLogger("esri/views/2d/engine/webgl/mesh/factories/matcherUtils");function C(e,t,r){return L.apply(this,arguments)}function L(){return(L=Object(a.a)(i.a.mark((function e(t,r,n){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t.type,e.next="simple"===e.t0?3:"map"===e.t0?4:"interval"===e.t0?5:"dictionary"===e.t0?6:7;break;case 3:return e.abrupt("return",k.fromBasicRenderer(t,r,n));case 4:return e.abrupt("return",w.fromUVRenderer(t,r,n));case 5:return e.abrupt("return",M.fromCBRenderer(t,r,n));case 6:return e.abrupt("return",S.fromDictionaryRenderer(t,r,n));case 7:return e.abrupt("return",(z.error(new o.a("mapview-mesh:invalid-renderer","Unable to handle unknown renderer type")),null));case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},907:function(e,t,r){"use strict";r.d(t,"a",(function(){return y})),r.d(t,"b",(function(){return i}));var n=r(2);function i(e,t,r){var n,i,c,u,l,h=t&&t.length,v=h?t[0]*r:e.length,y=a(e,0,v,r,!0),d=new Array;if(!y||y.next===y.prev)return d;if(h&&(y=function(e,t,r,n){for(var i=new Array,o=0,c=t.length;o<c;o++){var u=a(e,t[o]*n,o<c-1?t[o+1]*n:e.length,n,!1);u===u.next&&(u.steiner=!0),i.push(f(u))}i.sort(j);for(var l=0,h=i;l<h.length;l++){p(h[l],r),r=s(r,r.next)}return r}(e,t,y,r)),e.length>80*r){n=c=e[0],i=u=e[1];for(var b=r;b<v;b+=r){var m=e[b],x=e[b+1];n=Math.min(n,m),i=Math.min(i,x),c=Math.max(c,m),u=Math.max(u,x)}l=0!==(l=Math.max(c-n,u-i))?1/l:0}return o(y,d,r,n,i,l),d}function a(e,t,r,n,i){var a;if(i===m(e,t,r,n)>0)for(var s=t;s<r;s+=n)a=l(s,e[s],e[s+1],a);else for(var o=r-n;o>=t;o-=n)a=l(o,e[o],e[o+1],a);return a&&_(a,a.next)&&(h(a),a=a.next),a}function s(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;if(!e)return e;var r,n=e;do{if(r=!1,n.steiner||!_(n,n.next)&&0!==d(n.prev,n,n.next))n=n.next;else{if(h(n),(n=t=n.prev)===n.next)break;r=!0}}while(r||n!==t);return t}function o(e,t,r,n,i,a){var l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0;if(e){!l&&a&&(e=v(e,n,i,a));for(var f=e;e.prev!==e.next;){var p=e.prev,y=e.next;if(a?u(e,n,i,a):c(e))t.push(p.index/r),t.push(e.index/r),t.push(y.index/r),h(e),e=y.next,f=y.next;else if((e=y)===f){l?1===l?o(e=k(e,t,r),t,r,n,i,a,2):2===l&&M(e,t,r,n,i,a):o(s(e),t,r,n,i,a,1);break}}}}function c(e){var t=e.prev,r=e,n=e.next;if(d(t,r,n)>=0)return!1;for(var i=e.next.next,a=i,s=0;i!==e.prev&&(0===s||i!==a);){if(s++,x(t.x,t.y,r.x,r.y,n.x,n.y,i.x,i.y)&&d(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function u(e,t,r,n){var i=e.prev,a=e,s=e.next;if(d(i,a,s)>=0)return!1;for(var o=i.x<a.x?i.x<s.x?i.x:s.x:a.x<s.x?a.x:s.x,c=i.y<a.y?i.y<s.y?i.y:s.y:a.y<s.y?a.y:s.y,u=i.x>a.x?i.x>s.x?i.x:s.x:a.x>s.x?a.x:s.x,l=i.y>a.y?i.y>s.y?i.y:s.y:a.y>s.y?a.y:s.y,h=g(o,c,t,r,n),f=g(u,l,t,r,n),p=e.prevZ,v=e.nextZ;p&&p.z>=h&&v&&v.z<=f;){if(p!==e.prev&&p!==e.next&&x(i.x,i.y,a.x,a.y,s.x,s.y,p.x,p.y)&&d(p.prev,p,p.next)>=0)return!1;if(p=p.prevZ,v!==e.prev&&v!==e.next&&x(i.x,i.y,a.x,a.y,s.x,s.y,v.x,v.y)&&d(v.prev,v,v.next)>=0)return!1;v=v.nextZ}for(;p&&p.z>=h;){if(p!==e.prev&&p!==e.next&&x(i.x,i.y,a.x,a.y,s.x,s.y,p.x,p.y)&&d(p.prev,p,p.next)>=0)return!1;p=p.prevZ}for(;v&&v.z<=f;){if(v!==e.prev&&v!==e.next&&x(i.x,i.y,a.x,a.y,s.x,s.y,v.x,v.y)&&d(v.prev,v,v.next)>=0)return!1;v=v.nextZ}return!0}function l(e,t,r,n){var i=new z(e,t,r);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function h(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function f(e){var t=e,r=e;do{(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next}while(t!==e);return r}function p(e,t){if(t=function(e,t){var r,n=t,i=e.x,a=e.y,s=-1/0;do{if(a<=n.y&&a>=n.next.y&&n.next.y!==n.y){var o=n.x+(a-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(o<=i&&o>s){if(s=o,o===i){if(a===n.y)return n;if(a===n.next.y)return n.next}r=n.x<n.next.x?n:n.next}}n=n.next}while(n!==t);if(!r)return null;if(i===s)return r.prev;var c,u=r,l=r.x,h=r.y,f=1/0;for(n=r.next;n!==u;)i>=n.x&&n.x>=l&&i!==n.x&&x(a<h?i:s,a,l,h,a<h?s:i,a,n.x,n.y)&&(((c=Math.abs(a-n.y)/(i-n.x))<f||c===f&&n.x>r.x)&&O(n,e)&&(r=n,f=c)),n=n.next;return r}(e,t)){var r=S(t,e);s(r,r.next)}}function v(e,t,r,n){for(var i;i!==e;i=i.next){if(null===(i=i||e).z&&(i.z=g(i.x,i.y,t,r,n)),i.prev.next!==i||i.next.prev!==i)return i.prev.next=i,i.next.prev=i,v(e,t,r,n);i.prevZ=i.prev,i.nextZ=i.next}return e.prevZ.nextZ=null,e.prevZ=null,function(e){for(var t,r=1;;){var n=void 0,i=e;e=null,t=null;for(var a=0;i;){a++,n=i;for(var s=0;s<r&&n;s++)n=n.nextZ;for(var o=r;s>0||o>0&&n;){var c=void 0;0===s?(c=n,n=n.nextZ,o--):0!==o&&n?i.z<=n.z?(c=i,i=i.nextZ,s--):(c=n,n=n.nextZ,o--):(c=i,i=i.nextZ,s--),t?t.nextZ=c:e=c,c.prevZ=t,t=c}i=n}if(t.nextZ=null,r*=2,a<2)return e}}(e)}function y(e,t,r,n){var i=t&&t.length,a=i?t[0]*r:e.length,s=Math.abs(m(e,0,a,r));if(i)for(var o=0,c=t.length;o<c;o++){var u=t[o]*r,l=o<c-1?t[o+1]*r:e.length;s-=Math.abs(m(e,u,l,r))}for(var h=0,f=0;f<n.length;f+=3){var p=n[f]*r,v=n[f+1]*r,y=n[f+2]*r;h+=Math.abs((e[p]-e[y])*(e[v+1]-e[p+1])-(e[p]-e[v])*(e[y+1]-e[p+1]))}return 0===s&&0===h?0:Math.abs((h-s)/s)}function d(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function b(e,t,r,n){return!!(_(e,t)&&_(r,n)||_(e,n)&&_(r,t))||d(e,t,r)>0!=d(e,t,n)>0&&d(r,n,e)>0!=d(r,n,t)>0}function m(e,t,r,n){for(var i=0,a=t,s=r-n;a<r;a+=n)i+=(e[s]-e[a])*(e[a+1]+e[s+1]),s=a;return i}function x(e,t,r,n,i,a,s,o){return(i-s)*(t-o)-(e-s)*(a-o)>=0&&(e-s)*(n-o)-(r-s)*(t-o)>=0&&(r-s)*(a-o)-(i-s)*(n-o)>=0}function O(e,t){return d(e.prev,e,e.next)<0?d(e,t,e.next)>=0&&d(e,e.prev,t)>=0:d(e,t,e.prev)<0||d(e,e.next,t)<0}function g(e,t,r,n,i){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*i)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*i)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function _(e,t){return e.x===t.x&&e.y===t.y}function j(e,t){return e.x-t.x}function k(e,t,r){var n=e;do{var i=n.prev,a=n.next.next;!_(i,a)&&b(i,n,n.next,a)&&O(i,a)&&O(a,i)&&(t.push(i.index/r),t.push(n.index/r),t.push(a.index/r),h(n),h(n.next),n=e=a),n=n.next}while(n!==e);return n}function M(e,t,r,n,i,a){var c=e;do{for(var u=c.next.next;u!==c.prev;){if(c.index!==u.index&&w(c,u)){var l=S(c,u);return c=s(c,c.next),l=s(l,l.next),o(c,t,r,n,i,a),void o(l,t,r,n,i,a)}u=u.next}c=c.next}while(c!==e)}function w(e,t){return e.next.index!==t.index&&e.prev.index!==t.index&&!function(e,t){var r=e;do{if(r.index!==e.index&&r.next.index!==e.index&&r.index!==t.index&&r.next.index!==t.index&&b(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}(e,t)&&O(e,t)&&O(t,e)&&function(e,t){var r=e,n=!1,i=(e.x+t.x)/2,a=(e.y+t.y)/2;do{r.y>a!=r.next.y>a&&r.next.y!==r.y&&i<(r.next.x-r.x)*(a-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next}while(r!==e);return n}(e,t)}function S(e,t){var r=new z(e.index,e.x,e.y),n=new z(t.index,t.x,t.y),i=e.next,a=t.prev;return e.next=t,t.prev=e,r.next=i,i.prev=r,n.next=r,r.prev=n,a.next=n,n.prev=a,n}var z=function e(t,r,i){Object(n.a)(this,e),this.index=t,this.x=r,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}},922:function(e,t,r){"use strict";function n(e){switch(e){case"above-along":case"below-along":case"center-along":return 1;default:return 0}}r.d(t,"a",(function(){return n}))}}]);
//# sourceMappingURL=51.47916cda.chunk.js.map