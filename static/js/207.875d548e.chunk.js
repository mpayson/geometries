(this.webpackJsonpgeometries=this.webpackJsonpgeometries||[]).push([[207],{862:function(e,t,r){"use strict";r.r(t);var n,i=r(41),a=r(9),s=r(32),o=r(10),c=r.n(o),u=r(12),l=r(21),b=r(2),p=r(3),f=r(61),h=r(55),y=r(5),d=r(6),m=r(0),v=(r(13),r(24)),j=r(4),O=r(108),g=r(14),x=(r(15),r(1)),w=r(8),_=r(47),k=r(23),S=(r(11),r(19),r(20),r(16)),R=r(244),M=r(157),P=r(52),E=r(364),T=r(81),V=r(813),q=r(909),C=r(819),N=g.a.getLogger("esri.renderers.DictionaryRenderer"),I=n=function(e){Object(y.a)(r,e);var t=Object(d.a)(r);function r(e){var n;return Object(b.a)(this,r),(n=t.call(this,e))._ongoingRequests=new Map,n._symbolCache=new C.a(100),n.config=null,n.fieldMap=null,n.scaleExpression=null,n.scaleExpressionTitle=null,n.url=null,n.type="dictionary",n}return Object(p.a)(r,[{key:"writeData",value:function(e,t){e&&(t.scalingExpressionInfo={expression:e,returnType:"number"})}},{key:"writeVisualVariables",value:function(e,t,n,i){null!=i&&i.origin||Object(f.a)(Object(h.a)(r.prototype),"writeVisualVariables",this).call(this,e,t,n,i)}},{key:"clone",value:function(){return new n({config:Object(v.a)(this.config),scaleExpression:this.scaleExpression,scaleExpressionTitle:this.scaleExpressionTitle,fieldMap:Object(v.a)(this.fieldMap),url:Object(v.a)(this.url),visualVariables:Object(v.a)(this.visualVariables)})}},{key:"getSymbolAsync",value:function(){var e=Object(l.a)(c.a.mark((function e(t,r){var n,i,a,s,o,l,b,p,f,h,y,d,m,v,j,g,x,w,_,k,R,M,E,T,V,q=this;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._dictionaryPromise||(this._dictionaryPromise=this.fetchResources(r)),e.prev=1,e.next=4,this._dictionaryPromise;case 4:n=e.sent,e.next=11;break;case 7:if(e.prev=7,e.t0=e.catch(1),!Object(S.n)(e.t0)){e.next=11;break}return e.abrupt("return",(this._dictionaryPromise=null,null));case 11:if(i={},this.fieldMap){a=Object(u.a)(this._symbolFields);try{for(a.s();!(s=a.n()).done;)o=s.value,(l=this.fieldMap[o])&&null!==t.attributes[l]&&void 0!==t.attributes[l]?(b=""+t.attributes[l],i[o]=b):i[o]=""}catch(c){a.e(c)}finally{a.f()}}if((p=n(i,r))&&"string"==typeof p){e.next=16;break}return e.abrupt("return",null);case 16:if(f=Object(O.b)(p).toString(),!(h=this._symbolCache.get(f))){e.next=19;break}return e.abrupt("return",(h.catch((function(){q._symbolCache.pop(f)})),h));case 19:y=p.split(";"),d=[],m=[],v=Object(u.a)(y);try{for(v.s();!(j=v.n()).done;)if((g=j.value)&&0!==g.length)if(-1===g.indexOf("po:"))if(-1!==g.indexOf("|")){x=Object(u.a)(g.split("|"));try{for(x.s();!(w=x.n()).done;)_=w.value,this._itemNames.has(_)&&d.push(_)}catch(c){x.e(c)}finally{x.f()}}else this._itemNames.has(g)&&d.push(g);else 3===(k=g.substr(3).split("|")).length&&(R=k[0],M=k[1],E=k[2],"DashTemplate"===M?E=E.split(" ").map((function(e){return Number(e)})):"Color"===M?(T=new P.a(E).toRgba(),E=[T[0],T[1],T[2],255*T[3]]):E=Number(E),m.push({primitiveName:R,propertyName:M,value:E}))}catch(c){v.e(c)}finally{v.f()}return V=this._cimPartsToCIMSymbol(d,m,r),e.abrupt("return",(this._symbolCache.put(f,V,1),V));case 24:case"end":return e.stop()}}),e,this,[[1,7]])})));return function(t,r){return e.apply(this,arguments)}}()},{key:"collectRequiredFields",value:function(){var e=Object(l.a)(c.a.mark((function e(t,r){var n,i;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.collectVVRequiredFields(t,r);case 2:if(e.t0=this.scaleExpression,!e.t0){e.next=6;break}return e.next=6,Object(M.a)(t,r,this.scaleExpression);case 6:for(i in n=r.map((function(e){return e.name})),this.fieldMap)n.indexOf(this.fieldMap[i])<0||t.add(this.fieldMap[i]);case 8:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"arcadeRequired",get:function(){return!0}},{key:"fetchResources",value:function(){var e=Object(l.a)(c.a.mark((function e(t){var r,n,i,o,l,b,p,f,h,y,d,m,v,O,g,x,w,_=this;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._dictionaryPromise){e.next=2;break}return e.abrupt("return",this._dictionaryPromise);case 2:if(this.url){e.next=4;break}return e.abrupt("return",void N.error("no valid URL!"));case 4:return r=Object(j.i)(t)?t.abortOptions:null,n=Object(T.default)(this.url+"/resources/styles/dictionary-info.json",Object(a.a)({responseType:"json",query:{f:"json"}},r)),e.next=8,Object(S.b)([n,Object(R.e)()]);case 8:if(i=e.sent,o=Object(s.a)(i,1),l=o[0].data){e.next=13;break}throw this._dictionaryPromise=null,new k.a("esri.renderers.DictionaryRenderer","Bad dictionary data!");case 13:if(b=l.expression,p=l.authoringInfo,this._refSymbolUrlTemplate=this.url+"/"+l.cimRefTemplateUrl,this._itemNames=new Set(l.itemsNames),this._symbolFields=p.symbol,f={},this.config)for(y in h=this.config)f[y]=h[y];d=Object(u.a)(p.configuration);try{for(d.s();!(m=d.n()).done;)v=m.value,f.hasOwnProperty(v.name)||(f[v.name]=v.value)}catch(c){d.e(c)}finally{d.f()}if(O=[],Object(j.i)(t)&&t.fields&&this.fieldMap){g=Object(u.a)(this._symbolFields);try{for(w=function(){var e=x.value,r=_.fieldMap[e],n=t.fields.filter((function(e){return e.name===r}));n.length>0&&O.push(Object(a.a)(Object(a.a)({},n[0]),{},{name:e}))},g.s();!(x=g.n()).done;)w()}catch(c){g.e(c)}finally{g.f()}}return e.abrupt("return",(this._dictionaryPromise=Object(R.b)(b,Object(j.i)(t)?t.spatialReference:null,O,f).then((function(e){var t={scale:0};return function(r,n){var i=e.repurposeFeature({geometry:null,attributes:r});return t.scale=Object(j.i)(n)?n.scale:void 0,e.evaluate({$feature:i,$view:t})}})).catch((function(e){return N.error("Creating dictinoary expression failed:",e),null})),this._dictionaryPromise));case 22:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getSymbol",value:function(){return null}},{key:"getSymbols",value:function(){return[]}},{key:"getAttributeHash",value:function(){return this.visualVariables&&this.visualVariables.reduce((function(e,t){return e+t.getAttributeHash()}),"")}},{key:"getMeshHash",value:function(){return"".concat(this.url,"-").concat(JSON.stringify(this.fieldMap))}},{key:"getSymbolFields",value:function(){return this._symbolFields}},{key:"_getSymbolPart",value:function(){var e=Object(l.a)(c.a.mark((function e(t,r){var n,i;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._ongoingRequests.has(t)){e.next=2;break}return e.abrupt("return",this._ongoingRequests.get(t).then((function(e){return e.data})));case 2:return n=this._refSymbolUrlTemplate.replace(/\{itemName\}/gi,t),i=Object(T.default)(n,Object(a.a)({responseType:"json",query:{f:"json"}},r)),this._ongoingRequests.set(t,i),e.prev=4,e.next=7,i;case 7:return e.abrupt("return",e.sent.data);case 10:return e.prev=10,e.t0=e.catch(4),e.abrupt("return",(this._ongoingRequests.delete(t),Object(S.t)(e.t0)));case 13:case"end":return e.stop()}}),e,this,[[4,10]])})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_combineSymbolParts",value:function(e,t){if(!e||0===e.length)return null;if(1===e.length)return{type:"CIMSymbolReference",symbol:e[0],primitiveOverrides:t};var r=Object(a.a)({},e[0]);r.symbolLayers=[];var n,s=Object(u.a)(e);try{for(s.s();!(n=s.n()).done;){var o,c=n.value;(o=r.symbolLayers).unshift.apply(o,Object(i.a)(c.symbolLayers))}}catch(l){s.e(l)}finally{s.f()}return{type:"CIMSymbolReference",symbol:r,primitiveOverrides:t}}},{key:"_cimPartsToCIMSymbol",value:function(){var e=Object(l.a)(c.a.mark((function e(t,r,n){var i,a,s;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(i=new Array(t.length),a=0;a<t.length;a++)i[a]=this._getSymbolPart(t[a],n);return e.next=4,Object(S.b)(i);case 4:return s=e.sent,e.abrupt("return",new E.a({data:this._combineSymbolParts(s,r)}));case 6:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()}]),r}(Object(q.a)(V.a));Object(m.a)([Object(x.b)({type:Object,json:{read:{source:"configuration"},write:{target:"configuration"}}})],I.prototype,"config",void 0),Object(m.a)([Object(x.b)({type:Object,json:{write:!0}})],I.prototype,"fieldMap",void 0),Object(m.a)([Object(x.b)({type:String,json:{read:{source:"scalingExpressionInfo.expression"},write:!0}})],I.prototype,"scaleExpression",void 0),Object(m.a)([Object(_.a)("scaleExpression")],I.prototype,"writeData",null),Object(m.a)([Object(x.b)({type:String,json:{read:{source:"scalingExpressionInfo.title"},write:{target:"scalingExpressionInfo.title",overridePolicy:function(e){return{enabled:!!e&&!!this.scaleExpression}}}}})],I.prototype,"scaleExpressionTitle",void 0),Object(m.a)([Object(x.b)({type:String,json:{write:!0}})],I.prototype,"url",void 0),Object(m.a)([Object(_.a)("visualVariables")],I.prototype,"writeVisualVariables",null);var F=I=n=Object(m.a)([Object(w.a)("esri.renderers.DictionaryRenderer")],I);t.default=F}}]);
//# sourceMappingURL=207.875d548e.chunk.js.map