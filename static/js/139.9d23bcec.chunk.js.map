{"version":3,"sources":["../node_modules/@arcgis/core/layers/graphics/sources/FeatureLayerSource.js","../node_modules/@arcgis/core/layers/graphics/sources/support/clientSideDefaults.js"],"names":["q","Set","I","arguments","type","e","t","s","signal","this","addResolvingPromise","_fetchService","d","layer","capabilities","query","supportsFormatPBF","r","parsedUrl","a","dynamicDataSource","gdbVersion","o","spatialReference","i","fieldsIndex","u","F","url","path","format","sourceSpatialReference","load","attributes","objectIdField","_getLayerRequestOptions","_getFormDataForAttachment","p","body","_createFeatureEditResult","data","addAttachmentResult","_createAttachmentErrorResult","attachmentId","updateAttachmentResult","addFeatures","map","_serializeFeature","updateFeatures","_getFeatureIds","deleteFeatures","g","deleteAttachments","addAttachments","_serializeAttachment","push","updateAttachments","n","length","adds","updates","deletes","l","method","JSON","stringify","join","rollbackOnFailure","rollbackOnFailureEnabled","useGlobalIds","globalIdUsed","attachments","_createEditsResult","attachmentIds","deleteAttachmentResults","then","returnUpdates","layerId","id","extent","fullExtent","timeExtent","y","fromJSON","f","start","end","get","objectIds","c","parentObjectId","attachmentInfos","b","queryTask","executeAttachmentQuery","execute","customParameters","executeJSON","executeForIds","executeForCount","executeForExtent","executeRelationshipQuery","executeRelationshipQueryForCount","sourceJSON","returnAdvancedSymbols","_patchServiceJSON","has","geometryType","drawingInfo","renderer","defaultSymbol","R","geometry","toJSON","feature","attachment","globalId","name","contentType","uploadId","parentGlobalId","globalIdField","h","FileReader","readAsDataURL","onload","result","onerror","mediaType","File","_getIdsFromFeatureIdentifier","_getIdsFromFeatures","objectId","addFeatureResults","addResults","updateFeatureResults","updateResults","deleteFeatureResults","deleteResults","addAttachmentResults","updateAttachmentResults","success","error","code","description","details","messages","message","httpStatus","messageCode","FormData","elements","set","append","source","responseType","m","prototype","constructOnly","readOnly","dependsOn","_","symbol","indexOf","Function"],"mappings":"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","file":"static/js/139.9d23bcec.chunk.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import t from\"../../../core/has.js\";import{fixJson as r}from\"../../../core/lang.js\";import{setDeepValue as a}from\"../../../core/object.js\";import{isSome as s,isNone as o}from\"../../../core/maybe.js\";import\"../../../core/Logger.js\";import\"../../../core/accessorSupport/ensureType.js\";import{property as i}from\"../../../core/accessorSupport/decorators/property.js\";import{subclass as u}from\"../../../core/accessorSupport/decorators/subclass.js\";import n from\"../../../core/Error.js\";import{dataComponents as l}from\"../../../core/urlUtils.js\";import\"../../../core/uuid.js\";import\"../../../portal/support/resourceExtension.js\";import{resolve as d,all as c,create as h}from\"../../../core/promiseUtils.js\";import y from\"../../../geometry/Extent.js\";import p from\"../../../request.js\";import m from\"../../../core/Loadable.js\";import f from\"../../../TimeExtent.js\";import{unapplyEditsZUnitScaling as g}from\"../../../tasks/operations/zscale.js\";import{processAttachmentQueryResult as b}from\"../../../tasks/operations/queryAttachments.js\";import F from\"../../../tasks/QueryTask.js\";import{createDrawingInfo as R}from\"./support/clientSideDefaults.js\";const q=new Set([\"Feature Layer\",\"Table\"]);let I=class extends m{constructor(){super(...arguments),this.type=\"feature-layer\"}load(e){const t=s(e)?e.signal:null;return this.addResolvingPromise(this._fetchService(t)),d(this)}get queryTask(){const{capabilities:{query:{supportsFormatPBF:e}},parsedUrl:r,dynamicDataSource:a,gdbVersion:s,spatialReference:o,fieldsIndex:i}=this.layer,u=t(\"featurelayer-pbf\")&&e?\"pbf\":\"json\";return new F({url:r.path,format:u,fieldsIndex:i,dynamicDataSource:a,gdbVersion:s,sourceSpatialReference:o})}async addAttachment(e,t){await this.load();const r=e.attributes[this.layer.objectIdField],a=this.layer.parsedUrl.path+\"/\"+r+\"/addAttachment\",s=this._getLayerRequestOptions(),o=this._getFormDataForAttachment(t,s.query);try{const e=await p(a,{body:o});return this._createFeatureEditResult(e.data.addAttachmentResult)}catch(e){throw this._createAttachmentErrorResult(r,e)}}async updateAttachment(e,t,r){await this.load();const a=e.attributes[this.layer.objectIdField],s=this.layer.parsedUrl.path+\"/\"+a+\"/updateAttachment\",o=this._getLayerRequestOptions({query:{attachmentId:t}}),i=this._getFormDataForAttachment(r,o.query);try{const e=await p(s,{body:i});return this._createFeatureEditResult(e.data.updateAttachmentResult)}catch(e){throw this._createAttachmentErrorResult(a,e)}}async applyEdits(e,t){await this.load();const r=e.addFeatures.map(this._serializeFeature,this),a=e.updateFeatures.map(this._serializeFeature,this),s=this._getFeatureIds(e.deleteFeatures);g(r,a,this.layer.spatialReference);const o=[],i=[],u=[...e.deleteAttachments];for(const t of e.addAttachments)o.push(await this._serializeAttachment(t));for(const t of e.updateAttachments)i.push(await this._serializeAttachment(t));const n=o.length||i.length||u.length?{adds:o,updates:i,deletes:u}:null,l=this._getLayerRequestOptions({method:\"post\",query:{adds:r.length?JSON.stringify(r):null,updates:a.length?JSON.stringify(a):null,deletes:s.length?s.join(\",\"):null,gdbVersion:null==t?void 0:t.gdbVersion,rollbackOnFailure:null==t?void 0:t.rollbackOnFailureEnabled,useGlobalIds:null==t?void 0:t.globalIdUsed,attachments:n&&JSON.stringify(n)}}),d=await p(this.layer.parsedUrl.path+\"/applyEdits\",l);return this._createEditsResult(d)}async deleteAttachments(e,t){await this.load();const r=e.attributes[this.layer.objectIdField],a=this.layer.parsedUrl.path+\"/\"+r+\"/deleteAttachments\";try{return(await p(a,this._getLayerRequestOptions({query:{attachmentIds:t.join(\",\")},method:\"post\"}))).data.deleteAttachmentResults.map(this._createFeatureEditResult)}catch(e){throw this._createAttachmentErrorResult(r,e)}}fetchRecomputedExtents(e={}){const t=e.signal;return this.load({signal:t}).then((async()=>{const t=this._getLayerRequestOptions({...e,query:{returnUpdates:!0}}),{layerId:r,url:a}=this.layer,{data:s}=await p(`${a}/${r}`,t),{id:o,extent:i,fullExtent:u,timeExtent:n}=s,l=i||u;return{id:o,fullExtent:l&&y.fromJSON(l),timeExtent:n&&f.fromJSON({start:n[0],end:n[1]})}}))}async queryAttachments(e,t={}){const{parsedUrl:r}=this.layer,a=r.path;await this.load();const s=this._getLayerRequestOptions(t);if(!this.layer.get(\"capabilities.operations.supportsQueryAttachments\")){const{objectIds:t}=e,r=[];for(const e of t){const t=a+\"/\"+e+\"/attachments\";r.push(p(t,s))}return c(r).then((e=>t.map(((t,r)=>({parentObjectId:t,attachmentInfos:e[r].data.attachmentInfos}))))).then((e=>b(e,a)))}return this.queryTask.executeAttachmentQuery(e,s)}async queryFeatures(e,t){return await this.load(),this.queryTask.execute(e,{...t,query:{...this.layer.customParameters,...null==t?void 0:t.query}})}async queryFeaturesJSON(e,t){return await this.load(),this.queryTask.executeJSON(e,{...t,query:{...this.layer.customParameters,...null==t?void 0:t.query}})}async queryObjectIds(e,t){return await this.load(),this.queryTask.executeForIds(e,{...t,query:{...this.layer.customParameters,...null==t?void 0:t.query}})}async queryFeatureCount(e,t){return await this.load(),this.queryTask.executeForCount(e,{...t,query:{...this.layer.customParameters,...null==t?void 0:t.query}})}async queryExtent(e,t){return await this.load(),this.queryTask.executeForExtent(e,{...t,query:{...this.layer.customParameters,...null==t?void 0:t.query}})}async queryRelatedFeatures(e,t){return await this.load(),this.queryTask.executeRelationshipQuery(e,{...t,query:{...this.layer.customParameters,...null==t?void 0:t.query}})}async queryRelatedFeaturesCount(e,t){return await this.load(),this.queryTask.executeRelationshipQueryForCount(e,{...t,query:{...this.layer.customParameters,...null==t?void 0:t.query}})}async _fetchService(e){let r=this.layer.sourceJSON;if(!r){const{data:a}=await p(this.layer.parsedUrl.path,this._getLayerRequestOptions({query:t(\"featurelayer-advanced-symbols\")?{returnAdvancedSymbols:!0}:{},signal:e}));r=a}this.sourceJSON=this._patchServiceJSON(r);const a=r.type;if(!q.has(a))throw new n(\"feature-layer-source:unsupported-type\",`Source type \"${a}\" is not supported`)}_patchServiceJSON(e){var t;if(\"Table\"!==e.type&&e.geometryType&&(null==e||null==(t=e.drawingInfo)||!t.renderer)&&!e.defaultSymbol){const t=R(e.geometryType).renderer;a(\"drawingInfo.renderer\",t,e)}return e}_serializeFeature(e){const{geometry:t,attributes:r}=e;return o(t)?{attributes:r}:\"mesh\"===t.type||\"extent\"===t.type?null:{geometry:t.toJSON(),attributes:r}}async _serializeAttachment(e){const{feature:t,attachment:r}=e,{globalId:a,name:s,contentType:o,data:i,uploadId:u}=r,n={globalId:a,parentGlobalId:null,contentType:null,name:null,uploadId:null,data:null};if(t&&(n.parentGlobalId=\"attributes\"in t?t.attributes&&t.attributes[this.layer.globalIdField]:t.globalId),u)n.uploadId=u;else if(i){const e=await async function(e){if(\"string\"==typeof e){return l(e)||{data:e}}return h(((t,r)=>{const a=new FileReader;a.readAsDataURL(e),a.onload=()=>t(l(a.result)),a.onerror=e=>r(e)}))}(i);n.contentType=e.mediaType,n.data=e.data,i instanceof File&&(n.name=i.name)}return s&&(n.name=s),o&&(n.contentType=o),n}_getFeatureIds(e){const t=e[0];return t?\"objectId\"in t?this._getIdsFromFeatureIdentifier(e):this._getIdsFromFeatures(e):[]}_getIdsFromFeatures(e){const t=this.layer.objectIdField;return e.map((e=>e.attributes&&e.attributes[t]))}_getIdsFromFeatureIdentifier(e){return e.map((e=>e.objectId))}_createEditsResult(e){const t=e.data,r=e.data&&e.data.attachments;return{addFeatureResults:t.addResults?t.addResults.map(this._createFeatureEditResult,this):[],updateFeatureResults:t.updateResults?t.updateResults.map(this._createFeatureEditResult,this):[],deleteFeatureResults:t.deleteResults?t.deleteResults.map(this._createFeatureEditResult,this):[],addAttachmentResults:r&&r.addResults?r.addResults.map(this._createFeatureEditResult,this):[],updateAttachmentResults:r&&r.updateResults?r.updateResults.map(this._createFeatureEditResult,this):[],deleteAttachmentResults:r&&r.deleteResults?r.deleteResults.map(this._createFeatureEditResult,this):[]}}_createFeatureEditResult(e){const t=!0===e.success?null:e.error||{code:void 0,description:void 0};return{objectId:e.objectId,globalId:e.globalId,error:t?new n(\"feature-layer-source:edit-failure\",t.description,{code:t.code}):null}}_createAttachmentErrorResult(e,t){const r=t.details.messages&&t.details.messages[0]||t.message,a=t.details.httpStatus||t.details.messageCode;return{objectId:e,globalId:null,error:new n(\"feature-layer-source:attachment-failure\",r,{code:a})}}_getFormDataForAttachment(e,t){const r=e instanceof FormData?e:e&&e.elements?new FormData(e):null;if(r)for(const e in t){const a=t[e];null!=a&&(r.set?r.set(e,a):r.append(e,a))}return r}_getLayerRequestOptions(e={}){const{parsedUrl:t,gdbVersion:a,dynamicDataSource:s}=this.layer;return{...e,query:r({gdbVersion:a,layer:s?JSON.stringify({source:s}):void 0,...t.query,f:\"json\",...this.layer.customParameters,...null==e?void 0:e.query}),responseType:\"json\"}}};e([i()],I.prototype,\"type\",void 0),e([i({constructOnly:!0})],I.prototype,\"layer\",void 0),e([i({readOnly:!0,dependsOn:[\"layer.parsedUrl\",\"layer.gdbVersion\",\"layer.dynamicDataSource\",\"layer.fieldsIndex\"]})],I.prototype,\"queryTask\",null),I=e([u(\"esri.layers.graphics.sources.FeatureLayerSource\")],I);var _=I;export default _;\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nimport t from\"../../../../core/has.js\";import{clone as r}from\"../../../../core/lang.js\";import{defaultPointSymbolJSON as e,defaultPolylineSymbolJSON as n,defaultPolygonSymbolJSON as o}from\"../../../../symbols/support/defaultsJSON.js\";function i(t){return{renderer:{type:\"simple\",symbol:\"esriGeometryPoint\"===t||\"esriGeometryMultipoint\"===t?e:\"esriGeometryPolyline\"===t?n:o}}}function s(r,e){if(t(\"csp-restrictions\"))return()=>({[e]:null,...r});try{let t=`this.${e} = null;`;for(const e in r){t+=`this${e.indexOf(\".\")?`[\"${e}\"]`:`.${e}`} = ${JSON.stringify(r[e])};`}const n=new Function(t);return()=>new n}catch(t){return()=>({[e]:null,...r})}}function u(t={}){return[{name:\"New Feature\",description:\"\",prototype:{attributes:r(t)}}]}export{s as createDefaultAttributesFunction,u as createDefaultTemplate,i as createDrawingInfo};\n"],"sourceRoot":""}