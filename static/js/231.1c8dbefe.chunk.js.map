{"version":3,"sources":["../node_modules/@arcgis/core/views/draw/support/Reshape.js"],"names":["f","e","t","s","this","graphic","mover","selected","type","x","b","G","dx","dy","S","w","M","added","k","removed","H","i","oldGraphic","vertices","E","I","removeVertex","R","g","reshapeGraphics","C","default","n","style","size","vertex","color","outline","outlineColor","width","hover","hoverSize","hoverColor","hoverOutlineColor","midpoints","midpoint","j","_handles","p","_graphicAttributes","esriSketchTool","_mover","_viewHandles","_totalDx","_totalDy","callbacks","onReshapeStart","onReshape","onReshapeStop","onMoveStart","onMove","onMoveStop","onGraphicClick","enableMidpoints","handleGraphics","layer","midpointGraphics","midpointSymbol","selectedHandles","view","_setup","add","d","_","on","_keyDownHandler","v","TOOL","m","refresh","_clearSelection","_resetGraphics","_reset","destroy","removeAll","get","_set","push","concat","length","includes","_removeVertex","_setupGraphics","_setupMover","_resetGraphicStateVars","cursor","removeMany","forEach","geometry","h","clone","pop","_createHandleGraphics","_createMidpointGraphics","_saveRelatedIndices","addMany","symbols","spatialReference","o","a","c","l","r","y","symbol","attributes","pathIndex","pointIndex","pointIndexStart","pointIndexEnd","map","relatedGraphicIndices","u","enableMoveAllGraphics","graphics","_onGraphicClickCallback","onGraphicMoveStart","_onGraphicMoveStartCallback","onGraphicMove","_onGraphicMoveCallback","onGraphicMoveStop","_onGraphicMoveStopCallback","onGraphicPointerOver","_onGraphicPointerOverCallback","onGraphicPointerOut","_onGraphicPointerOutCallback","viewEvent","stopPropagation","clearSelection","emit","_isMidpoint","button","_createHandleFromMidpoint","_emitVertexAddEvent","_isHandle","native","shiftKey","_removeFromSelection","_addToSelection","visible","_emitMoveStartEvent","_emitReshapeStartEvent","_emitMoveEvent","_syncGeometryAfterHandleMove","_emitReshapeEvent","_syncGraphicsWithGeometry","_emitMoveStopEvent","_emitReshapeStopEvent","paths","rings","_updateHandleGraphicLocations","_updateMidpointGraphicLocations","set","_isSelected","_updateHoverCursor","splice","coordinates","componentIndex","vertexIndex","Number","indexOf","_emitSelectEvent","_emitDeselectEvent","key","repeat","_removeHandles","_emitVertexRemoveEvent","onVertexSelect","onVertexDeselect","onVertexAdd","onVertexRemove","EventedAccessor","prototype","readOnly","dependsOn","value","V"],"mappings":"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","file":"static/js/231.1c8dbefe.chunk.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import\"../../../core/has.js\";import{unwrap as t,get as s}from\"../../../core/maybe.js\";import\"../../../core/Logger.js\";import\"../../../core/accessorSupport/ensureType.js\";import{property as i}from\"../../../core/accessorSupport/decorators/property.js\";import{subclass as o}from\"../../../core/accessorSupport/decorators/subclass.js\";import\"../../../core/urlUtils.js\";import\"../../../core/uuid.js\";import\"../../../portal/support/resourceExtension.js\";import r from\"../../../geometry/Point.js\";import{geometryToCoordinates as h,getMidpoint as a}from\"../../../geometry/support/coordsUtils.js\";import\"../../../geometry.js\";import c from\"../../../core/Evented.js\";import n from\"../../../symbols/SimpleMarkerSymbol.js\";import l from\"../../../Graphic.js\";import p from\"../../../core/Handles.js\";import{whenOnce as d,pausable as m}from\"../../../core/watchUtils.js\";import{ViewEventPriorities as v}from\"../../input/InputManager.js\";import{cloneMove as y}from\"./drawUtils.js\";import{addUniqueLayer as _}from\"./layerUtils.js\";import u from\"./GraphicMover.js\";import{settings as g}from\"./settings.js\";class f{constructor(e,t,s){this.graphic=e,this.mover=t,this.selected=s,this.type=\"reshape-start\"}}class x{constructor(e,t,s){this.graphic=e,this.mover=t,this.selected=s,this.type=\"reshape\"}}class b{constructor(e,t,s){this.graphic=e,this.mover=t,this.selected=s,this.type=\"reshape-stop\"}}class G{constructor(e,t,s){this.mover=e,this.dx=t,this.dy=s,this.type=\"move-start\"}}class S{constructor(e,t,s){this.mover=e,this.dx=t,this.dy=s,this.type=\"move\"}}class w{constructor(e,t,s){this.mover=e,this.dx=t,this.dy=s,this.type=\"move-stop\"}}class M{constructor(e){this.added=e,this.type=\"vertex-select\"}}class k{constructor(e){this.removed=e,this.type=\"vertex-deselect\"}}class H{constructor(e,t,s,i){this.added=e,this.graphic=t,this.oldGraphic=s,this.vertices=i,this.type=\"vertex-add\"}}class E{constructor(e,t,s,i){this.removed=e,this.graphic=t,this.oldGraphic=s,this.vertices=i,this.type=\"vertex-remove\"}}const I={removeVertex:[\"Backspace\",\"Delete\"]},R=g.reshapeGraphics,C={vertices:{default:new n({style:\"circle\",size:R.vertex.size,color:R.vertex.color,outline:{color:R.vertex.outlineColor,width:1}}),hover:new n({style:\"circle\",size:R.vertex.hoverSize,color:R.vertex.hoverColor,outline:{color:R.vertex.hoverOutlineColor,width:1}}),selected:new n({style:\"circle\",size:R.selected.size,color:R.selected.color,outline:{color:R.selected.outlineColor,width:1}})},midpoints:{default:new n({style:\"circle\",size:R.midpoint.size,color:R.midpoint.color,outline:{color:R.midpoint.outlineColor,width:1}}),hover:new n({style:\"circle\",size:R.midpoint.size,color:R.midpoint.color,outline:{color:R.midpoint.outlineColor,width:1}})}};let j=class extends c.EventedAccessor{constructor(e){super(e),this._handles=new p,this._graphicAttributes={esriSketchTool:\"box\"},this._mover=null,this._viewHandles=new p,this._totalDx=0,this._totalDy=0,this.callbacks={onReshapeStart(){},onReshape(){},onReshapeStop(){},onMoveStart(){},onMove(){},onMoveStop(){},onGraphicClick(){}},this.enableMidpoints=!0,this.graphic=null,this.handleGraphics=[],this.layer=null,this.midpointGraphics=[],this.midpointSymbol=new n({style:\"circle\",size:6,color:[200,200,200],outline:{color:[100,100,100],width:1}}),this.selectedHandles=[],this.type=\"reshape\",this.view=null}initialize(){this._setup(),this._handles.add([d(this,\"view.ready\",(()=>{const{layer:e,view:t}=this;_(t,e),this._viewHandles.add([t.on(\"key-down\",(e=>this._keyDownHandler(e)),v.TOOL)])})),m(this,\"graphic\",(()=>this.refresh())),m(this,\"layer\",((e,t)=>{t&&(this._clearSelection(),this._resetGraphics(t)),this.refresh()})),m(this,\"enableMidpoints\",(()=>{this.refresh()}))])}destroy(){this._reset(),this._mover&&this._mover.destroy(),this._mover=null,this._handles.removeAll(),this._handles=null,this._viewHandles.removeAll(),this._viewHandles=null}get state(){const e=!!this.get(\"view.ready\"),t=!(!this.get(\"graphic\")||!this.get(\"layer\"));return e&&t?\"active\":e?\"ready\":\"disabled\"}set symbols(e){const{midpoints:t=C.midpoints,vertices:s=C.vertices}=e||{};this._set(\"symbols\",{midpoints:t,vertices:s})}isUIGraphic(e){const t=[];return this.graphic&&t.push(this.graphic),t.concat(this.handleGraphics,this.midpointGraphics),t.length&&t.includes(e)}refresh(){this._reset(),this._setup()}reset(){this.graphic=null}clearSelection(){this._clearSelection()}removeSelectedHandles(){this.selectedHandles.length&&this._removeVertex(this.selectedHandles)}_setup(){this.graphic&&this.layer&&(this._setupGraphics(),this._setupMover())}_reset(){this._clearSelection(),this._resetGraphicStateVars(),this._resetGraphics(),this._mover&&this._mover.destroy(),this._mover=null,this.view.cursor=\"default\"}_resetGraphicStateVars(){this._totalDx=0,this._totalDy=0}_resetGraphics(e){const t=e||this.layer;t&&(t.removeMany(this.handleGraphics),t.removeMany(this.midpointGraphics)),this.handleGraphics.forEach((e=>e.destroy())),this.midpointGraphics.forEach((e=>e.destroy())),this._set(\"handleGraphics\",[]),this._set(\"midpointGraphics\",[]),this._set(\"selectedHandles\",[])}_setupGraphics(){const e=t(this.graphic.geometry),s=h(e.clone());if(\"polygon\"===e.type)for(const e of s){const t=e[e.length-1];e[0][0]===t[0]&&e[0][1]===t[1]&&e.length>2&&e.pop()}this._set(\"handleGraphics\",this._createHandleGraphics(s)),this.enableMidpoints&&this._set(\"midpointGraphics\",this._createMidpointGraphics(s)),this._saveRelatedIndices(this.handleGraphics),this.layer.addMany(this.midpointGraphics),this.layer.addMany(this.handleGraphics)}_createHandleGraphics(e){const{_graphicAttributes:t,symbols:s,view:{spatialReference:i}}=this,o=[];return null==e||e.forEach(((e,h)=>{e.forEach(((e,a)=>{var c;const[n,p]=e;o.push(new l({geometry:new r({x:n,y:p,spatialReference:i}),symbol:null==s||null==(c=s.vertices)?void 0:c.default,attributes:{...t,pathIndex:h,pointIndex:a}}))}))})),o}_createMidpointGraphics(e){const{_graphicAttributes:t,symbols:i,view:{spatialReference:o}}=this,h=[];return null==e||e.forEach(((e,c)=>{e.forEach(((n,p)=>{const[d,m]=n,v=e[p+1]?p+1:0;if(\"polygon\"===s(this.graphic.geometry,\"type\")||0!==v){const[s,n]=e[v],[y,_]=a([d,m],[s,n]);h.push(new l({geometry:new r({x:y,y:_,spatialReference:o}),symbol:i.midpoints.default,attributes:{...t,pathIndex:c,pointIndexStart:p,pointIndexEnd:v}}))}}))})),h}_saveRelatedIndices(e){if(!e)return;const t=e.map((({geometry:e})=>({x:e.x,y:e.y})));for(let s=0;s<t.length;s++){const i=[];for(let e=0;e<t.length;e++){if(s===e)continue;const o=t[s],r=t[e];o.x===r.x&&o.y===r.y&&i.push(e)}e[s].attributes.relatedGraphicIndices=i}}_setupMover(){this._mover=new u({enableMoveAllGraphics:!1,graphics:[].concat(this.handleGraphics,this.midpointGraphics,this.graphic),view:this.view,callbacks:{onGraphicClick:e=>this._onGraphicClickCallback(e),onGraphicMoveStart:e=>this._onGraphicMoveStartCallback(e),onGraphicMove:e=>this._onGraphicMoveCallback(e),onGraphicMoveStop:e=>this._onGraphicMoveStopCallback(e),onGraphicPointerOver:e=>this._onGraphicPointerOverCallback(e),onGraphicPointerOut:e=>this._onGraphicPointerOutCallback(e)}})}_onGraphicClickCallback(e){e.viewEvent.stopPropagation();const t=e.graphic;if(t===this.graphic)this.clearSelection(),this.emit(\"graphic-click\",e),this.callbacks.onGraphicClick&&this.callbacks.onGraphicClick(e);else if(this._isMidpoint(t)){if(2===e.viewEvent.button)return;const s=this.graphic.clone(),i=this._createHandleFromMidpoint(t);this.refresh(),this._emitVertexAddEvent([t],s,i)}else if(this._isHandle(t))if(e.viewEvent.stopPropagation(),2===e.viewEvent.button)this._removeVertex(t);else{e.viewEvent.native.shiftKey||this._clearSelection(),this.selectedHandles.includes(t)?this._removeFromSelection(t,!0):this._addToSelection(t)}}_onGraphicMoveStartCallback(e){const t=e.graphic;if(this._resetGraphicStateVars(),t===this.graphic){const{dx:t,dy:s}=e;return this.handleGraphics.forEach((e=>e.visible=!1)),this.midpointGraphics.forEach((e=>e.visible=!1)),this._clearSelection(),void this._emitMoveStartEvent(t,s)}if(this._isMidpoint(t)){this._clearSelection();const e=this.graphic.clone(),s=this._createHandleFromMidpoint(t);this._emitVertexAddEvent([t],e,s),this._addToSelection(t)}else this.selectedHandles.includes(t)||(this._clearSelection(),this._addToSelection(t));this._emitReshapeStartEvent(t)}_onGraphicMoveCallback(e){const{graphic:t,dx:s,dy:i}=e;this._totalDx+=s,this._totalDy+=i,t===this.graphic?this._emitMoveEvent(s,i):(this._syncGeometryAfterHandleMove(t,s,i),this._emitReshapeEvent(t))}_onGraphicMoveStopCallback(e){const{graphic:t,dx:s,dy:i}=e;if(this._totalDx+=s,this._totalDy+=i,t===this.graphic){for(const e of[].concat(this.handleGraphics,this.midpointGraphics))e.visible=!0;this._syncGraphicsWithGeometry(),this._emitMoveStopEvent()}else this._syncGeometryAfterHandleMove(t,s,i),this._isMidpoint(t)&&this.refresh(),this._emitReshapeStopEvent(t);this._resetGraphicStateVars()}_syncGraphicsWithGeometry(){const e=this.graphic.geometry,t=\"polyline\"===e.type?e.paths:e.rings;this._updateHandleGraphicLocations(t),this._updateMidpointGraphicLocations(t)}_updateHandleGraphicLocations(e){for(const t of this.handleGraphics){const{pathIndex:s,pointIndex:i}=t.attributes,[o,h]=e[s][i];t.set(\"geometry\",new r(o,h,this.view.spatialReference))}}_updateMidpointGraphicLocations(e){for(const t of this.midpointGraphics){const{pathIndex:s,pointIndexStart:i,pointIndexEnd:o}=t.attributes,[h,c]=e[s][i],[n,l]=e[s][o],[p,d]=a([h,c],[n,l]);t.geometry=new r({x:p,y:d,spatialReference:this.view.spatialReference})}}_syncGeometryAfterHandleMove(e,s,i){const o=t(this.graphic.geometry).clone(),r=\"polyline\"===o.type?o.paths:o.rings,{pathIndex:h,pointIndex:a}=e.attributes,{x:c,y:n}=e.geometry,l=r[h].length-1;if(r[h][a]=[c,n],\"polygon\"===o.type&&(0===a?r[h][l]=[c,n]:a===l&&(r[h][0]=[c,n])),this._isHandle(e)){const{relatedGraphicIndices:t}=e.attributes;for(const s of t){const t=this.handleGraphics[s],{pathIndex:i,pointIndex:o}=t.attributes;r[i][o]=[c,n],t.geometry=e.geometry}for(const t of this.selectedHandles)if(t!==e){const{pathIndex:e,pointIndex:h,relatedGraphicIndices:a}=t.attributes,c=y(t.geometry,s,i,this.view),n=r[e].length-1;r[e][h]=[c.x,c.y],t.geometry=c,\"polygon\"===o.type&&(0===h?r[e][n]=[c.x,c.y]:h===n&&(r[e][0]=[c.x,c.y]));for(const e of a){const t=this.handleGraphics[e],{pathIndex:s,pointIndex:i}=t.attributes;r[s][i]=[c.x,c.y],t.geometry=c}}this._updateMidpointGraphicLocations(r)}this.graphic.geometry=o}_onGraphicPointerOverCallback(e){const t=e.graphic;this._isHandle(t)&&!this._isSelected(t)&&(t.symbol=this.symbols.vertices.hover),this._updateHoverCursor(t)}_onGraphicPointerOutCallback(e){const t=e.graphic;this._isHandle(t)&&!this._isSelected(t)&&(t.symbol=this.symbols.vertices.default),this.view.cursor=\"default\"}_createHandleFromMidpoint(e){const{_graphicAttributes:s}=this,i=[],o=t(this.graphic.geometry).clone(),{pathIndex:r,pointIndexStart:h,pointIndexEnd:a}=e.attributes,{x:c,y:n}=e.geometry,l=0===a?h+1:a,p=\"polyline\"===o.type?o.paths:o.rings;return p[r].splice(l,0,[c,n]),e.attributes={...s,pathIndex:r,pointIndex:l,relatedGraphicIndices:[]},i.push({coordinates:p[r][l],componentIndex:r,vertexIndex:l}),this.graphic.geometry=o,i}_removeHandles(e){const s=t(this.graphic.geometry).clone(),i=\"polygon\"===s.type?s.rings:s.paths,o=[];e instanceof l&&(e=[e]);for(const t of e){const{x:e,y:s}=t.geometry;for(let t=0;t<i.length;t++){const r=i[t];for(let h=0;h<r.length;h++){const[a,c]=r[h];e===a&&s===c&&(o.push({coordinates:i[t][h],componentIndex:t,vertexIndex:h}),i[t].splice(Number(h),1))}}}if(\"polygon\"===s.type)for(const e of i){const[t,s]=e[0],[o,r]=e[e.length-1];(1===e.length||e.length<3&&t===o&&s===r)&&i.splice(i.indexOf(e),1),e.length>2&&(t!==o||s!==r)&&e.push(e[0])}else for(const e of i)1===e.length&&i.splice(i.indexOf(e),1);return this.graphic.geometry=s,o}_addToSelection(e){e instanceof l&&(e=[e]);for(const t of e)t.symbol=this.symbols.vertices.selected;this._set(\"selectedHandles\",this.selectedHandles.concat(e)),this._emitSelectEvent(e)}_removeFromSelection(e,t){const{vertices:s}=this.symbols,i=t?s.hover:s.default;e instanceof l&&(e=[e]);for(const t of e)this.selectedHandles.splice(this.selectedHandles.indexOf(t),1),this._set(\"selectedHandles\",this.selectedHandles),t.set(\"symbol\",i);this._emitDeselectEvent(e)}_clearSelection(){if(this.selectedHandles.length){const e=this.selectedHandles;for(const e of this.selectedHandles)e.set(\"symbol\",this.symbols.vertices.default);this._set(\"selectedHandles\",[]),this._emitDeselectEvent(e)}}_keyDownHandler(e){I.removeVertex.includes(e.key)&&!e.repeat&&this.selectedHandles.length&&this._removeVertex(this.selectedHandles)}_removeVertex(e){if(\"polygon\"===this.graphic.geometry.type&&this.handleGraphics.length<4||this.handleGraphics.length<3)return;const t=this.graphic.clone();e instanceof l&&(e=[e]);const s=this._removeHandles(e);this.refresh(),this._emitVertexRemoveEvent(e,t,s)}_isHandle(e){return this.handleGraphics.includes(e)}_isSelected(e){return this._isHandle(e)&&this.selectedHandles.includes(e)}_isMidpoint(e){return this.midpointGraphics.includes(e)}_updateHoverCursor(e){this.view.cursor=this._isMidpoint(e)?\"copy\":\"move\"}_emitMoveStartEvent(e,t){const s=new G(this.graphic,e,t);this.emit(\"move-start\",s),this.callbacks.onMoveStart&&this.callbacks.onMoveStart(s)}_emitMoveEvent(e,t){const s=new S(this.graphic,e,t);this.emit(\"move\",s),this.callbacks.onMove&&this.callbacks.onMove(s)}_emitMoveStopEvent(){const e=new w(this.graphic,this._totalDx,this._totalDy);this.emit(\"move-stop\",e),this.callbacks.onMoveStop&&this.callbacks.onMoveStop(e)}_emitReshapeStartEvent(e){const t=new f(this.graphic,e,this.selectedHandles);this.emit(\"reshape-start\",t),this.callbacks.onReshapeStart&&this.callbacks.onReshapeStart(t)}_emitReshapeEvent(e){const t=new x(this.graphic,e,this.selectedHandles);this.emit(\"reshape\",t),this.callbacks.onReshape&&this.callbacks.onReshape(t)}_emitReshapeStopEvent(e){const t=new b(this.graphic,e,this.selectedHandles);this.emit(\"reshape-stop\",t),this.callbacks.onReshapeStop&&this.callbacks.onReshapeStop(t)}_emitSelectEvent(e){const t=new M(e);this.emit(\"select\",t),this.callbacks.onVertexSelect&&this.callbacks.onVertexSelect(t)}_emitDeselectEvent(e){const t=new k(e);this.emit(\"deselect\",t),this.callbacks.onVertexDeselect&&this.callbacks.onVertexDeselect(t)}_emitVertexAddEvent(e,t,s){const i=new H(e,this.graphic,t,s);this.emit(\"vertex-add\",i),this.callbacks.onVertexAdd&&this.callbacks.onVertexAdd(i)}_emitVertexRemoveEvent(e,t,s){const i=new E(e,this.graphic,t,s);this.emit(\"vertex-remove\",i),this.callbacks.onVertexRemove&&this.callbacks.onVertexRemove(i)}};e([i()],j.prototype,\"callbacks\",void 0),e([i()],j.prototype,\"enableMidpoints\",void 0),e([i()],j.prototype,\"graphic\",void 0),e([i({readOnly:!0})],j.prototype,\"handleGraphics\",void 0),e([i()],j.prototype,\"layer\",void 0),e([i({readOnly:!0})],j.prototype,\"midpointGraphics\",void 0),e([i()],j.prototype,\"midpointSymbol\",void 0),e([i({readOnly:!0})],j.prototype,\"selectedHandles\",void 0),e([i({dependsOn:[\"view.ready\",\"graphic\",\"layer\"],readOnly:!0})],j.prototype,\"state\",null),e([i({value:C})],j.prototype,\"symbols\",null),e([i({readOnly:!0})],j.prototype,\"type\",void 0),e([i()],j.prototype,\"view\",void 0),j=e([o(\"esri.views.draw.support.Reshape\")],j);var V=j;export default V;\n"],"sourceRoot":""}