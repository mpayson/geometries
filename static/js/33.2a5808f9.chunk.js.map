{"version":3,"sources":["../node_modules/@arcgis/core/portal/support/resourceUtils.js","../node_modules/@arcgis/core/core/multiOriginJSONSupportUtils.js","../node_modules/@arcgis/core/core/accessorSupport/originUtils.js","../node_modules/@arcgis/core/webdoc/support/saveUtils.js","../node_modules/@arcgis/core/layers/mixins/SceneService.js"],"names":["u","t","a","r","load","s","o","itemUrl","start","n","num","sortOrder","c","sortField","l","query","signal","e","portal","_request","p","total","nextStart","resources","map","created","size","resource","Date","resourceFromPath","hasPath","portalItem","userItemUrl","path","i","d","m","h","FormData","append","access","method","body","deleteAll","lastIndexOf","slice","length","Blob","url","responseType","data","f","writtenProperties","forEach","target","newOrigin","oldOrigin","updateOrigin","propName","Set","paths","toKeep","delete","push","toUpdate","has","content","finish","error","add","toAdd","removeResource","catch","filter","errors","addResource","ok","update","O","getLogger","T","arguments","spatialReference","fullExtent","heightModelInfo","minScale","maxScale","version","major","Number","NaN","minor","versionString","copyright","sublayerTitleMode","title","layerId","_debouncedSaveOperations","_save","_saveAs","this","_readSpatialReference","fromJSON","store","indexCRS","geographicCRS","parseInt","substring","extent","Array","isArray","some","U","y","xmin","ymin","xmax","ymax","toString","split","w","name","S","I","x","_set","b","_get","j","_fetchRootPage","_updateExtentFromRootPage","_fetchRootNode","_updateExtentFromRootNode","Math","floor","rootIndex","nodesPerPage","parsedUrl","nodes","obb","center","halfSize","sqrt","zmin","zmax","hasZ","mbs","rootNode","test","_fetchFirstLayerId","_fetchServiceLayer","layers","id","ssl","replace","read","origin","validateLayer","beforeSave","typeKeywords","getTypeKeywords","indexOf","A","v","from","clone","getDefault","_ensureLoadBeforeSave","type","P","messages","blockedRelativeUrls","pendingOperations","write","_validateAgainstJSONSchema","_updateTypeKeywords","_signIn","user","addItem","item","folder","R","resourceReferences","g","message","details","validationOptions","ignoreUnsupported","enabled","E","validate","portalItemLayerType","join","failPolicy","concat","combined","json","origins","service","prototype","readOnly","_","source","String","isRequired","ignoreOrigin","N","dependsOn"],"mappings":"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","file":"static/js/33.2a5808f9.chunk.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nimport{get as e,isSome as t,isNone as r}from\"../../core/maybe.js\";import a from\"../../core/Error.js\";import{join as o,getPathExtension as s}from\"../../core/urlUtils.js\";import n from\"../../request.js\";async function u(t,r={},a){await t.load(a);const s=o(t.itemUrl,\"resources\"),{start:n=1,num:u=10,sortOrder:c=\"asc\",sortField:i=\"created\"}=r,l={query:{start:n,num:u,sortOrder:c,sortField:i},signal:e(a,\"signal\")},p=await t.portal._request(s,l);return{total:p.total,nextStart:p.nextStart,resources:p.resources.map((({created:e,size:r,resource:a})=>({created:new Date(e),size:r,resource:t.resourceFromPath(a)})))}}async function c(r,s,n,u){if(!r.hasPath())throw new a(`portal-item-resource-${s}:invalid-path`,\"Resource does not have a valid path\");await r.portalItem.load(u);const c=o(r.portalItem.userItemUrl,\"add\"===s?\"addResources\":\"updateResources\"),[i,l]=p(r.path),m=await d(n),h=new FormData;return i&&\".\"!==i&&h.append(\"resourcesPrefix\",i),h.append(\"fileName\",l),h.append(\"file\",m,l),h.append(\"f\",\"json\"),t(u)&&u.access&&h.append(\"access\",u.access),await r.portalItem.portal._request(c,{method:\"post\",body:h,signal:e(u,\"signal\")}),r}async function i(t,r,s){if(!r.hasPath())throw new a(\"portal-item-resources-remove:invalid-path\",\"Resource does not have a valid path\");await t.load(s);const n=o(t.userItemUrl,\"removeResources\");await t.portal._request(n,{method:\"post\",query:{resource:r.path},signal:e(s,\"signal\")}),r.portalItem=null}async function l(t,r){await t.load(r);const a=o(t.userItemUrl,\"removeResources\");return t.portal._request(a,{method:\"post\",query:{deleteAll:!0},signal:e(r,\"signal\")})}function p(e){const t=e.lastIndexOf(\"/\");return-1===t?[\".\",e]:[e.slice(0,t),e.slice(t+1)]}function m(e){const[t,a]=function(e){const t=s(e);if(r(t))return[e,\"\"];return[e.slice(0,e.length-t.length-1),`.${t}`]}(e),[o,n]=p(t);return[o,n,a]}async function d(e){if(e instanceof Blob)return e;return(await n(e.url,{responseType:\"blob\"})).data}function h(e,t){if(!e.hasPath())return null;const[r,,a]=m(e.path);return e.portalItem.resourceFromPath(o(r,t+a))}function f(e,t){if(!e.hasPath())return null;const[r,,a]=m(e.path);return e.portalItem.resourceFromPath(o(r,t+a))}export{c as addOrUpdateResource,d as contentToBlob,u as fetchResources,h as getSiblingOfSameType,f as getSiblingOfSameTypeI,l as removeAllResources,i as removeResource,m as splitPrefixFileNameAndExtension};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nfunction i(i){return i&&\"getAtOrigin\"in i&&\"originOf\"in i}export{i as isMultiOriginJSONMixin};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nimport{isMultiOriginJSONMixin as i}from\"../multiOriginJSONSupportUtils.js\";function r(r){r&&r.writtenProperties&&r.writtenProperties.forEach((r=>{const t=r.target;r.newOrigin&&r.oldOrigin!==r.newOrigin&&i(t)&&t.updateOrigin(r.propName,r.newOrigin)}))}export{r as updateOrigins};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nimport r from\"../../core/Error.js\";import{generateUUID as e}from\"../../core/uuid.js\";import{eachAlways as o,throwIfAborted as t}from\"../../core/promiseUtils.js\";import{result as s}from\"../../core/asyncUtils.js\";import{getSiblingOfSameTypeI as c}from\"../../portal/support/resourceUtils.js\";async function a(s,a,u){if(!a||!a.resources)return;const h=a.portalItem===s.portalItem?new Set(s.paths):new Set;s.paths.length=0,s.portalItem=a.portalItem;const i=new Set(a.resources.toKeep.map((r=>r.resource.path))),f=new Set,m=[];i.forEach((r=>{h.delete(r),s.paths.push(r)}));for(const r of a.resources.toUpdate)if(h.delete(r.resource.path),i.has(r.resource.path)||f.has(r.resource.path)){const{resource:o,content:t,finish:a,error:p}=r,h=c(o,e());s.paths.push(h.path),m.push(n({resource:h,content:t,finish:a,error:p},u))}else s.paths.push(r.resource.path),m.push(p(r,u)),f.add(r.resource.path);for(const r of a.resources.toAdd)m.push(n(r,u)),s.paths.push(r.resource.path);if(h.forEach((r=>{const e=a.portalItem.resourceFromPath(r);m.push(e.portalItem.removeResource(e).catch((()=>{})))})),0===m.length)return;const l=await o(m);t(u);const d=l.filter((r=>\"error\"in r)).map((r=>r.error));if(d.length>0)throw new r(\"save:resources\",\"Failed to save one or more resources\",{errors:d})}async function n(r,e){const o=await s(r.resource.portalItem.addResource(r.resource,r.content,e));if(!0!==o.ok)throw r.error&&r.error(o.error),o.error;r.finish&&r.finish(r.resource)}async function p(r,e){const o=await s(r.resource.update(r.content,e));if(!0!==o.ok)throw r.error(o.error),o.error;r.finish(r.resource)}export{a as saveResources};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import\"../../core/has.js\";import{isSome as t}from\"../../core/maybe.js\";import r from\"../../core/Logger.js\";import\"../../core/accessorSupport/ensureType.js\";import{property as o}from\"../../core/accessorSupport/decorators/property.js\";import{reader as i}from\"../../core/accessorSupport/decorators/reader.js\";import{subclass as s}from\"../../core/accessorSupport/decorators/subclass.js\";import{writer as a}from\"../../core/accessorSupport/decorators/writer.js\";import n from\"../../core/Error.js\";import{urlToObject as l,join as p}from\"../../core/urlUtils.js\";import\"../../core/uuid.js\";import\"../../portal/support/resourceExtension.js\";import{debounce as d,reject as c,all as u}from\"../../core/promiseUtils.js\";import m from\"../../geometry/SpatialReference.js\";import y from\"../../geometry/Extent.js\";import h from\"../../request.js\";import f from\"../../portal/Portal.js\";import v from\"../../portal/PortalItem.js\";import{updateOrigins as g}from\"../../core/accessorSupport/originUtils.js\";import{titleFromUrlAndName as w,parse as S,cleanTitle as I,sanitizeUrlWithLayerId as x,writeUrlWithLayerId as b,isArcGISUrl as j}from\"../support/arcgisLayerUrl.js\";import _ from\"../../geometry/HeightModelInfo.js\";import{saveResources as R}from\"../../webdoc/support/saveUtils.js\";import{url as N}from\"../support/commonProperties.js\";const O=r.getLogger(\"esri.layers.mixins.SceneService\"),T=r=>{let T=class extends r{constructor(){super(...arguments),this.spatialReference=null,this.fullExtent=null,this.heightModelInfo=null,this.minScale=0,this.maxScale=0,this.version={major:Number.NaN,minor:Number.NaN,versionString:\"\"},this.copyright=null,this.sublayerTitleMode=\"item-title\",this.title=null,this.layerId=null,this._debouncedSaveOperations=d((async(e,t,r)=>{switch(e){case 0:return this._save(t);case 1:return this._saveAs(r,t)}}))}readSpatialReference(e,t){return this._readSpatialReference(t)}_readSpatialReference(e){if(null!=e.spatialReference)return m.fromJSON(e.spatialReference);{const t=e.store,r=t.indexCRS||t.geographicCRS,o=r&&parseInt(r.substring(r.lastIndexOf(\"/\")+1,r.length),10);return null!=o?new m(o):null}}readFullExtent(e,t){const r=t.store,o=this._readSpatialReference(t);return null==o||null==r||null==r.extent||!Array.isArray(r.extent)||r.extent.some((e=>e<U))?null:new y({xmin:r.extent[0],ymin:r.extent[1],xmax:r.extent[2],ymax:r.extent[3],spatialReference:o})}readVersion(e,t){const r=t.store,o=null!=r.version?r.version.toString():\"\",i={major:Number.NaN,minor:Number.NaN,versionString:o},s=o.split(\".\");return s.length>=2&&(i.major=parseInt(s[0],10),i.minor=parseInt(s[1],10)),i}readTitlePortalItem(e){return\"item-title\"!==this.sublayerTitleMode?void 0:e}readTitleService(e,r){const o=this.portalItem&&this.portalItem.title;if(\"item-title\"===this.sublayerTitleMode)return w(this.url,r.name);let i=r.name;if(!i&&this.url){const e=S(this.url);t(e)&&(i=e.title)}return\"item-title-and-service-name\"===this.sublayerTitleMode&&o&&(i=o+\" - \"+i),I(i)}set url(e){const t=x(this,e,O);this._set(\"url\",t.url),null!=t.layerId&&this._set(\"layerId\",t.layerId)}writeUrl(e,t,r,o){b(this,e,\"layers\",t,o)}get parsedUrl(){const e=this._get(\"url\");if(!e)return null;const t=l(e);return null!=this.layerId&&j(t.path)&&(t.path=`${t.path}/layers/${this.layerId}`),t}async _verifyRootNodeAndUpdateExtent(e,t){if(e)try{return this._updateExtentFromRootPage(e,await this._fetchRootPage(e,t))}catch(e){}return this._updateExtentFromRootNode(await this._fetchRootNode(t))}async _fetchRootPage(e,t){if(!e)return c();const r=Math.floor(e.rootIndex/e.nodesPerPage),o=`${this.parsedUrl.path}/nodepages/${r}`;return(await h(o,{responseType:\"json\",signal:t})).data}_updateExtentFromRootPage(e,t){if(null==t||null==t.nodes)throw new n(\"sceneservice:invalid-node-page\",\"Inavlid node page.\");const r=t.nodes[e.rootIndex%e.nodesPerPage];if(null==r||null==r.obb||null==r.obb.center||null==r.obb.halfSize)throw new n(\"sceneservice:invalid-node-page\",\"Inavlid node page.\");if(r.obb.center[0]<U)return;const o=r.obb.halfSize,i=r.obb.center[2],s=Math.sqrt(o[0]*o[0]+o[1]*o[1]+o[2]*o[2]);this.fullExtent.zmin=i-s,this.fullExtent.zmax=i+s}_updateExtentFromRootNode(e){if(null==e||null==this.fullExtent||this.fullExtent.hasZ)return;if(!Array.isArray(e.mbs)||4!==e.mbs.length||e.mbs[0]<U)return;const t=e.mbs[2],r=e.mbs[3];this.fullExtent.zmin=t-r,this.fullExtent.zmax=t+r}async _fetchRootNode(e){if(!this.rootNode)return;const t=p(this.parsedUrl.path,this.rootNode);try{return(await h(t,{query:{f:\"json\"},responseType:\"json\",signal:e})).data}catch(e){throw new n(\"sceneservice:root-node-missing\",\"Root node missing.\",{error:e,url:t})}}async _fetchService(e){if(null==this.layerId&&/SceneServer\\/*$/i.test(this.url)){const t=await this._fetchFirstLayerId(e);null!=t&&(this.layerId=t)}return this._fetchServiceLayer(e)}async _fetchFirstLayerId(e){const t=await h(this.url,{query:{f:\"json\"},responseType:\"json\",signal:e});if(t.data&&Array.isArray(t.data.layers)&&t.data.layers.length>0)return t.data.layers[0].id}async _fetchServiceLayer(e){const t=await h(this.parsedUrl.path,{query:{f:\"json\"},responseType:\"json\",signal:e});t.ssl&&(this.url=this.url.replace(/^http:/i,\"https:\"));const r=t.data;this.read(r,{origin:\"service\",url:this.parsedUrl}),this.validateLayer(r)}async _ensureLoadBeforeSave(){await this.load(),\"beforeSave\"in this&&\"function\"==typeof this.beforeSave&&await this.beforeSave()}validateLayer(e){}_updateTypeKeywords(e,t,r){e.typeKeywords||(e.typeKeywords=[]);const o=t.getTypeKeywords();for(const t of o)e.typeKeywords.push(t);e.typeKeywords&&(e.typeKeywords=e.typeKeywords.filter(((e,t,r)=>r.indexOf(e)===t)),1===r&&(e.typeKeywords=e.typeKeywords.filter((e=>\"Hosted Service\"!==e))))}async _saveAs(e,t){const r={...A,...t};let o=v.from(e);o||(O.error(\"_saveAs(): requires a portal item parameter\"),await c(new n(\"sceneservice:portal-item-required\",\"_saveAs() requires a portal item to save to\"))),o.id&&(o=o.clone(),o.id=null);const i=o.portal||f.getDefault();await this._ensureLoadBeforeSave(),o.type=P,o.portal=i;const s={origin:\"portal-item\",url:null,messages:[],portal:i,portalItem:o,writtenProperties:[],blockedRelativeUrls:[],resources:{toAdd:[],toUpdate:[],toKeep:[],pendingOperations:[]}},a={layers:[this.write(null,s)]};return await u(s.resources.pendingOperations),await this._validateAgainstJSONSchema(a,s,r),o.url=this.url,o.title||(o.title=this.title),this._updateTypeKeywords(o,r,1),await i._signIn(),await i.user.addItem({item:o,folder:r&&r.folder,data:a}),await R(this.resourceReferences,s,null),this.portalItem=o,g(s),s.portalItem=o,o}async _save(e){const t={...A,...e};this.portalItem||(O.error(\"_save(): requires the .portalItem property to be set\"),await c(new n(\"sceneservice:portal-item-not-set\",\"Portal item to save to has not been set on this SceneService\"))),this.portalItem.type!==P&&(O.error(\"_save(): Non-matching portal item type. Got \"+this.portalItem.type+\", expected \"+P),await c(new n(\"sceneservice:portal-item-wrong-type\",`Portal item needs to have type \"${P}\"`))),await this._ensureLoadBeforeSave();const r={origin:\"portal-item\",url:this.portalItem.itemUrl&&l(this.portalItem.itemUrl),messages:[],portal:this.portalItem.portal||f.getDefault(),portalItem:this.portalItem,writtenProperties:[],blockedRelativeUrls:[],resources:{toAdd:[],toUpdate:[],toKeep:[],pendingOperations:[]}},o={layers:[this.write(null,r)]};return await u(r.resources.pendingOperations),await this._validateAgainstJSONSchema(o,r,t),this.portalItem.url=this.url,this.portalItem.title||(this.portalItem.title=this.title),this._updateTypeKeywords(this.portalItem,t,0),await this.portalItem.update({data:o}),await R(this.resourceReferences,r,null),g(r),this.portalItem}async _validateAgainstJSONSchema(e,t,r){let o=t.messages.filter((e=>\"error\"===e.type)).map((e=>new n(e.name,e.message,e.details)));if(r&&r.validationOptions.ignoreUnsupported&&(o=o.filter((e=>\"layer:unsupported\"!==e.name&&\"symbol:unsupported\"!==e.name&&\"symbol-layer:unsupported\"!==e.name&&\"property:unsupported\"!==e.name&&\"url:unsupported\"!==e.name&&\"scenemodification:unsupported\"!==e.name))),r.validationOptions.enabled||E){const t=(await import(\"../support/schemaValidator.js\")).validate(e,r.portalItemLayerType);if(t.length>0){const e=`Layer item did not validate:\\n${t.join(\"\\n\")}`;if(O.error(`_validateAgainstJSONSchema(): ${e}`),\"throw\"===r.validationOptions.failPolicy){const e=t.map((e=>new n(\"sceneservice:schema-validation\",e))).concat(o);throw new n(\"sceneservice-validate:error\",\"Failed to save layer item due to schema validation, see `details.errors`.\",{combined:e})}}}if(o.length>0)throw new n(\"sceneservice:save\",\"Failed to save SceneService due to unsupported or invalid content. See 'details.errors' for more detailed information\",{errors:o})}};return e([o({json:{origins:{service:{read:!1},\"portal-item\":{read:!1}}}})],T.prototype,\"id\",void 0),e([o({type:m})],T.prototype,\"spatialReference\",void 0),e([i(\"spatialReference\",[\"spatialReference\",\"store.indexCRS\",\"store.geographicCRS\"])],T.prototype,\"readSpatialReference\",null),e([o({type:y})],T.prototype,\"fullExtent\",void 0),e([i(\"fullExtent\",[\"store.extent\",\"spatialReference\",\"store.indexCRS\",\"store.geographicCRS\"])],T.prototype,\"readFullExtent\",null),e([o({readOnly:!0,type:_})],T.prototype,\"heightModelInfo\",void 0),e([o({type:Number,json:{name:\"layerDefinition.minScale\",write:!0,origins:{service:{read:{source:\"minScale\"},write:!1}}}})],T.prototype,\"minScale\",void 0),e([o({type:Number,json:{name:\"layerDefinition.maxScale\",write:!0,origins:{service:{read:{source:\"maxScale\"},write:!1}}}})],T.prototype,\"maxScale\",void 0),e([o({readOnly:!0})],T.prototype,\"version\",void 0),e([i(\"version\",[\"store.version\"])],T.prototype,\"readVersion\",null),e([o({type:String,json:{read:{source:\"copyrightText\"}}})],T.prototype,\"copyright\",void 0),e([o({type:String,json:{read:!1}})],T.prototype,\"sublayerTitleMode\",void 0),e([o({type:String})],T.prototype,\"title\",void 0),e([i(\"portal-item\",\"title\")],T.prototype,\"readTitlePortalItem\",null),e([i(\"service\",\"title\",[\"name\"])],T.prototype,\"readTitleService\",null),e([o({type:Number,json:{origins:{service:{read:{source:\"id\"}},\"portal-item\":{write:{target:\"id\",isRequired:!0,ignoreOrigin:!0},read:!1}}}})],T.prototype,\"layerId\",void 0),e([o(N)],T.prototype,\"url\",null),e([a(\"url\")],T.prototype,\"writeUrl\",null),e([o({dependsOn:[\"layerId\"]})],T.prototype,\"parsedUrl\",null),e([o({readOnly:!0})],T.prototype,\"store\",void 0),e([o({type:String,readOnly:!0,json:{read:{source:\"store.rootNode\"}}})],T.prototype,\"rootNode\",void 0),T=e([s(\"esri.layers.mixins.SceneService\")],T),T},U=-1e38,E=!1,P=\"Scene Service\",A={getTypeKeywords:()=>[],portalItemLayerType:\"unknown\",validationOptions:{enabled:!0,ignoreUnsupported:!1,failPolicy:\"throw\"}};export{P as SCENE_SERVICE_ITEM_TYPE,T as SceneService};\n"],"sourceRoot":""}