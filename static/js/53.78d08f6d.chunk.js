(this.webpackJsonpgeometries=this.webpackJsonpgeometries||[]).push([[53,12,33,59,65,70],{1040:function(e,t,r){"use strict";r.r(t);var a=r(10),n=r.n(a),i=r(9),o=r(21),s=r(12),c=r(2),u=r(3),l=r(34),p=r(61),d=r(55),b=r(5),y=r(6),f=r(0),h=(r(13),r(24)),v=r(4),O=r(14),j=r(15),m=r(1),g=r(63),w=r(8),x=r(23),S=r(11),k=r(19),I=(r(20),r(16)),F=r(44),_=r(62),E=r(40),T=r(318),R=r(200),M=r(243),D=r(795),L=r(787),A=r(809),C=r(866),P=r(802),N=r(379),q=r(50),z=r(42),V=r(276),U=r(81),B=r(211),G=r(135),Q=r(388),J=(r(813),r(823),r(832),r(862),r(873),r(874),r(861),r(870)),W=(r(869),r(790)),$=r(858),K=r(812),Z=r(277),H=r(826),X=r(246),Y=function(e){Object(b.a)(r,e);var t=Object(y.a)(r);function r(e){var a;return Object(c.a)(this,r),(a=t.call(this,e)).title="",a.id=-1,a.modelName=null,a.isEmpty=null,a.visible=!0,a.opacity=1,a}return Object(u.a)(r,[{key:"readTitle",value:function(e,t){return"string"==typeof t.alias?t.alias:"string"==typeof t.name?t.name:""}},{key:"readIdOnlyOnce",value:function(e){return-1!==this.id?this.id:"number"==typeof e?e:void 0}}]),r}(Object(X.a)(D.b));Object(f.a)([Object(m.b)({type:String,json:{origins:{"web-scene":{write:!0},"portal-item":{write:!0}}}})],Y.prototype,"title",void 0),Object(f.a)([Object(g.a)("service","title",["alias","name"])],Y.prototype,"readTitle",null),Object(f.a)([Object(m.b)()],Y.prototype,"layer",void 0),Object(f.a)([Object(m.b)({type:j.a,readOnly:!0,json:{read:!1,write:{ignoreOrigin:!0}}})],Y.prototype,"id",void 0),Object(f.a)([Object(g.a)("service","id")],Y.prototype,"readIdOnlyOnce",null),Object(f.a)([Object(m.b)(Object(L.h)(String))],Y.prototype,"modelName",void 0),Object(f.a)([Object(m.b)(Object(L.h)(Boolean))],Y.prototype,"isEmpty",void 0),Object(f.a)([Object(m.b)({type:Boolean,json:{name:"visibility",write:!0}})],Y.prototype,"visible",void 0),Object(f.a)([Object(m.b)({type:Number,json:{write:!0}})],Y.prototype,"opacity",void 0);var ee=Y=Object(f.a)([Object(w.a)("esri.layers.buildingSublayers.BuildingSublayer")],Y),te=r(1096),re=r(999),ae=Object($.a)(),ne=function(e){Object(b.a)(r,e);var t=Object(y.a)(r);function r(e){var a;return Object(c.a)(this,r),(a=t.call(this,e)).type="building-component",a.nodePages=null,a.materialDefinitions=null,a.textureSetDefinitions=null,a.geometryDefinitions=null,a.serviceUpdateTimeStamp=null,a.fields=null,a.associatedLayer=null,a.outFields=null,a.listMode="show",a.renderer=null,a.definitionExpression=null,a.popupEnabled=!0,a.popupTemplate=null,a.layerType="3d-object",a}return Object(u.a)(r,[{key:"parsedUrl",get:function(){return this.layer?{path:"".concat(this.layer.parsedUrl.path,"/sublayers/").concat(this.id),query:this.layer.parsedUrl.query}:null}},{key:"fieldsIndex",get:function(){return new W.a(this.fields)}},{key:"readAssociatedLayer",value:function(e,t){var r=this.layer.associatedFeatureServiceItem,a=t.associatedLayerID;return Object(v.i)(r)&&"number"==typeof a?new H.default({portalItem:r,layerId:a}):null}},{key:"objectIdField",get:function(){if(null!=this.fields){var e,t=Object(s.a)(this.fields);try{for(t.s();!(e=t.n()).done;){var r=e.value;if("oid"===r.type)return r.name}}catch(a){t.e(a)}finally{t.f()}}return null}},{key:"displayField",get:function(){return Object(v.i)(this.associatedLayer)?this.associatedLayer.displayField:null}},{key:"defaultPopupTemplate",get:function(){return this.createPopupTemplate()}},{key:"load",value:function(e){var t=Object(v.i)(e)?e.signal:null;return this.addResolvingPromise(this._fetchService(t)),Object(I.u)(this)}},{key:"createPopupTemplate",value:function(e){return Object(K.a)(this,e)}},{key:"_fetchService",value:function(){var e=Object(o.a)(n.a.mark((function e(t){var r;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(U.default)(this.parsedUrl.path,{query:{f:"json"},responseType:"json",signal:t});case 2:r=e.sent.data,this.read(r,{origin:"service",url:this.parsedUrl});case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getField",value:function(e){return this.fieldsIndex.get(e)}},{key:"getFieldDomain",value:function(e){var t=this.getField(e);return t&&t.domain?t.domain:null}},{key:"geometryType",get:function(){return"3d-object"===this.layerType?"mesh":"point"}},{key:"profile",get:function(){return"3d-object"===this.layerType?"mesh-pyramids":"points"}},{key:"capabilities",get:function(){var e=Object(v.i)(this.associatedLayer)&&this.associatedLayer.capabilities?this.associatedLayer.capabilities:te.a,t=e.query,r=e.data;return{query:t,data:{supportsZ:r.supportsZ,supportsM:r.supportsM,isVersioned:r.isVersioned}}}},{key:"createQuery",value:function(){var e=new Z.a;return"mesh"!==this.geometryType&&(e.returnGeometry=!0,e.returnZ=!0),e.where=this.definitionExpression||"1=1",e.sqlFormat="standard",e}},{key:"queryExtent",value:function(e,t){var r=this;return this._getAssociatedLayerForQuery().then((function(a){return a.queryExtent(e||r.createQuery(),t)}))}},{key:"queryFeatureCount",value:function(e,t){var r=this;return this._getAssociatedLayerForQuery().then((function(a){return a.queryFeatureCount(e||r.createQuery(),t)}))}},{key:"queryFeatures",value:function(e,t){var r=this;return this._getAssociatedLayerForQuery().then((function(a){return a.queryFeatures(e||r.createQuery(),t)})).then((function(e){if(e&&e.features){var t,a=Object(s.a)(e.features);try{for(a.s();!(t=a.n()).done;){var n=t.value;n.layer=r.layer,n.sourceLayer=r}}catch(i){a.e(i)}finally{a.f()}}return e}))}},{key:"queryObjectIds",value:function(e,t){var r=this;return this._getAssociatedLayerForQuery().then((function(a){return a.queryObjectIds(e||r.createQuery(),t)}))}},{key:"getFieldUsageInfo",value:function(e){return this.fieldsIndex.has(e)?{supportsLabelingInfo:!1,supportsRenderer:!1,supportsPopupTemplate:!1,supportsLayerQuery:!1}:{supportsLabelingInfo:!1,supportsRenderer:!0,supportsPopupTemplate:!0,supportsLayerQuery:Object(v.i)(this.associatedLayer)}}},{key:"_getAssociatedLayerForQuery",value:function(){var e=this.associatedLayer;return Object(v.i)(e)&&e.loaded?Object(I.u)(e):this._loadAssociatedLayerForQuery()}},{key:"_loadAssociatedLayerForQuery",value:function(){var e=Object(o.a)(n.a.mark((function e(){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.load();case 2:if(!Object(v.h)(this.associatedLayer)){e.next=4;break}throw new x.a("buildingscenelayer:query-not-available","BuildingSceneLayer component layer queries are not available without an associated feature layer",{layer:this});case 4:return e.prev=4,e.next=7,this.associatedLayer.load();case 7:e.next=12;break;case 9:throw e.prev=9,e.t0=e.catch(4),new x.a("buildingscenelayer:query-not-available","BuildingSceneLayer associated feature layer could not be loaded",{layer:this,error:e.t0});case 12:return e.abrupt("return",this.associatedLayer);case 13:case"end":return e.stop()}}),e,this,[[4,9]])})));return function(){return e.apply(this,arguments)}}()}]),r}(G.a.LoadableMixin(Object(B.b)(ee)));Object(f.a)([Object(m.b)({readOnly:!0,dependsOn:["layer","id"]})],ne.prototype,"parsedUrl",null),Object(f.a)([Object(m.b)({type:re.c,readOnly:!0})],ne.prototype,"nodePages",void 0),Object(f.a)([Object(m.b)({type:[re.b],readOnly:!0})],ne.prototype,"materialDefinitions",void 0),Object(f.a)([Object(m.b)({type:[re.d],readOnly:!0})],ne.prototype,"textureSetDefinitions",void 0),Object(f.a)([Object(m.b)({type:[re.a],readOnly:!0})],ne.prototype,"geometryDefinitions",void 0),Object(f.a)([Object(m.b)({readOnly:!0})],ne.prototype,"serviceUpdateTimeStamp",void 0),Object(f.a)([Object(m.b)({readOnly:!0})],ne.prototype,"store",void 0),Object(f.a)([Object(m.b)({type:String,readOnly:!0,json:{read:{source:"store.rootNode"}}})],ne.prototype,"rootNode",void 0),Object(f.a)([Object(m.b)({readOnly:!0})],ne.prototype,"attributeStorageInfo",void 0),Object(f.a)([Object(m.b)(ae.fields)],ne.prototype,"fields",void 0),Object(f.a)([Object(m.b)({readOnly:!0,dependsOn:["fields"]})],ne.prototype,"fieldsIndex",null),Object(f.a)([Object(m.b)({readOnly:!0,type:H.default})],ne.prototype,"associatedLayer",void 0),Object(f.a)([Object(g.a)("service","associatedLayer",["associatedLayerID"])],ne.prototype,"readAssociatedLayer",null),Object(f.a)([Object(m.b)(ae.outFields)],ne.prototype,"outFields",void 0),Object(f.a)([Object(m.b)({type:String,dependsOn:["fields"],readOnly:!0})],ne.prototype,"objectIdField",null),Object(f.a)([Object(m.b)({readOnly:!0,type:String,json:{read:!1},dependsOn:["associatedLayer.displayField"]})],ne.prototype,"displayField",null),Object(f.a)([Object(m.b)({readOnly:!0,type:_.a,aliasOf:"layer.fullExtent"})],ne.prototype,"fullExtent",void 0),Object(f.a)([Object(m.b)({readOnly:!0,type:F.a,aliasOf:"layer.spatialReference"})],ne.prototype,"spatialReference",void 0),Object(f.a)([Object(m.b)({readOnly:!0,aliasOf:"layer.version"})],ne.prototype,"version",void 0),Object(f.a)([Object(m.b)({readOnly:!0,type:Q.a,aliasOf:"layer.elevationInfo"})],ne.prototype,"elevationInfo",void 0),Object(f.a)([Object(m.b)({readOnly:!0,type:Number,aliasOf:"layer.minScale"})],ne.prototype,"minScale",void 0),Object(f.a)([Object(m.b)({readOnly:!0,type:Number,aliasOf:"layer.maxScale"})],ne.prototype,"maxScale",void 0),Object(f.a)([Object(m.b)({type:["hide","show"],json:{write:!0}})],ne.prototype,"listMode",void 0),Object(f.a)([Object(m.b)({types:J.b,json:{origins:{service:{read:{source:"drawingInfo.renderer"}}},name:"layerDefinition.drawingInfo.renderer",write:!0},value:null})],ne.prototype,"renderer",void 0),Object(f.a)([Object(m.b)({type:String,json:{origins:{service:{read:!1,write:!1}},read:{source:"layerDefinition.definitionExpression"},write:{target:"layerDefinition.definitionExpression"}}})],ne.prototype,"definitionExpression",void 0),Object(f.a)([Object(m.b)(L.g)],ne.prototype,"popupEnabled",void 0),Object(f.a)([Object(m.b)({type:V.a,json:{read:{source:"popupInfo"},write:{target:"popupInfo"}}})],ne.prototype,"popupTemplate",void 0),Object(f.a)([Object(m.b)({readOnly:!0,type:String,json:{origins:{service:{read:{source:"store.normalReferenceFrame"}}},read:!1}})],ne.prototype,"normalReferenceFrame",void 0),Object(f.a)([Object(m.b)({readOnly:!0,json:{read:!1},dependsOn:["fields","title"]})],ne.prototype,"defaultPopupTemplate",null),Object(f.a)([Object(m.b)({json:{write:!1}}),Object(z.a)(new q.a({"3DObject":"3d-object",Point:"point"}))],ne.prototype,"layerType",void 0),Object(f.a)([Object(m.b)({dependsOn:["layerType"]})],ne.prototype,"geometryType",null),Object(f.a)([Object(m.b)({dependsOn:["layerType"]})],ne.prototype,"profile",null),Object(f.a)([Object(m.b)({readOnly:!0,json:{read:!1},dependsOn:["associatedLayer.capabilities"]})],ne.prototype,"capabilities",null);var ie,oe=ne=Object(f.a)([Object(w.a)("esri.layers.buildingSublayers.BuildingComponentSublayer")],ne),se=r(175),ce={type:E.a,readOnly:!0,json:{origins:{service:{read:{source:"sublayers",reader:ue}}},read:!1}};function ue(e,t,r){if(e&&Array.isArray(e))return new E.a(e.map((function(e){var t=function(e){return"group"===e.layerType?pe:oe}(e);if(t){var a=new t;return a.read(e,r),a}r&&r.messages&&e&&r.messages.push(new se.a("building-scene-layer:unsupported-sublayer-type","Building scene sublayer of type '"+(e.type||"unknown")+"' are not supported",{definition:e,context:r}))})))}var le,pe=ie=function(e){Object(b.a)(r,e);var t=Object(y.a)(r);function r(e){var a;return Object(c.a)(this,r),(a=t.call(this,e)).type="building-group",a.listMode="show",a.sublayers=null,a}return Object(u.a)(r,[{key:"loadAll",value:function(){var e=this;return Object(T.b)(this,(function(t){return ie.forEachSublayer(e.sublayers,(function(e){"building-group"!==e.type&&t(e)}))}))}}]),r}(ee);Object(f.a)([Object(m.b)({type:["hide","show","hide-children"],json:{write:!0}})],pe.prototype,"listMode",void 0),Object(f.a)([Object(m.b)(ce)],pe.prototype,"sublayers",void 0),pe=ie=Object(f.a)([Object(w.a)("esri.layers.buildingSublayers.BuildingGroupSublayer")],pe),(le=pe||(pe={})).sublayersProperty=ce,le.readSublayers=ue,le.forEachSublayer=function e(t,r){t.forEach((function(t){r(t),"building-group"===t.type&&e(t.sublayers,r)}))};var de=pe,be=r(977),ye=r(28),fe=function(e){Object(b.a)(r,e);var t=Object(y.a)(r);function r(){var e;return Object(c.a)(this,r),(e=t.apply(this,arguments)).type=null,e}return r}(ye.a);Object(f.a)([Object(m.b)({type:String,readOnly:!0,json:{write:!0}})],fe.prototype,"type",void 0);var he,ve=fe=Object(f.a)([Object(w.a)("esri.layers.support.BuildingFilterAuthoringInfo")],fe),Oe=he=function(e){Object(b.a)(r,e);var t=Object(y.a)(r);function r(){var e;return Object(c.a)(this,r),(e=t.apply(this,arguments)).filterType=null,e.filterValues=null,e}return Object(u.a)(r,[{key:"clone",value:function(){return new he({filterType:this.filterType,filterValues:Object(h.a)(this.filterValues)})}}]),r}(ye.a);Object(f.a)([Object(m.b)({type:String,json:{write:!0}})],Oe.prototype,"filterType",void 0),Object(f.a)([Object(m.b)({type:[String],json:{write:!0}})],Oe.prototype,"filterValues",void 0);var je,me=Oe=he=Object(f.a)([Object(w.a)("esri.layers.support.BuildingFilterAuthoringInfoType")],Oe),ge=E.a.ofType(me),we=je=function(e){Object(b.a)(r,e);var t=Object(y.a)(r);function r(){return Object(c.a)(this,r),t.apply(this,arguments)}return Object(u.a)(r,[{key:"clone",value:function(){return new je({filterTypes:Object(h.a)(this.filterTypes)})}}]),r}(ye.a);Object(f.a)([Object(m.b)({type:ge,json:{write:!0}})],we.prototype,"filterTypes",void 0);var xe,Se=we=je=Object(f.a)([Object(w.a)("esri.layers.support.BuildingFilterAuthoringInfoBlock")],we),ke=E.a.ofType(Se),Ie=xe=function(e){Object(b.a)(r,e);var t=Object(y.a)(r);function r(){var e;return Object(c.a)(this,r),(e=t.apply(this,arguments)).type="checkbox",e}return Object(u.a)(r,[{key:"clone",value:function(){return new xe({filterBlocks:Object(h.a)(this.filterBlocks)})}}]),r}(ve);Object(f.a)([Object(m.b)({type:["checkbox"]})],Ie.prototype,"type",void 0),Object(f.a)([Object(m.b)({type:ke,json:{write:!0}})],Ie.prototype,"filterBlocks",void 0);var Fe=Ie=xe=Object(f.a)([Object(w.a)("esri.layers.support.BuildingFilterAuthoringInfoCheckbox")],Ie),_e=function(e){Object(b.a)(r,e);var t=Object(y.a)(r);function r(){return Object(c.a)(this,r),t.apply(this,arguments)}return r}(ye.a);Object(f.a)([Object(m.b)({readOnly:!0,json:{read:!1}})],_e.prototype,"type",void 0);var Ee,Te=_e=Object(f.a)([Object(w.a)("esri.layers.support.BuildingFilterMode")],_e),Re=Ee=function(e){Object(b.a)(r,e);var t=Object(y.a)(r);function r(){var e;return Object(c.a)(this,r),(e=t.apply(this,arguments)).type="solid",e}return Object(u.a)(r,[{key:"clone",value:function(){return new Ee}}]),r}(Te);Object(f.a)([Object(m.b)({type:["solid"],readOnly:!0,json:{write:!0}})],Re.prototype,"type",void 0);var Me,De=Re=Ee=Object(f.a)([Object(w.a)("esri.layers.support.BuildingFilterModeSolid")],Re),Le=r(336),Ae=Me=function(e){Object(b.a)(r,e);var t=Object(y.a)(r);function r(){var e;return Object(c.a)(this,r),(e=t.apply(this,arguments)).type="wire-frame",e.edges=null,e}return Object(u.a)(r,[{key:"clone",value:function(){return new Me({edges:Object(h.a)(this.edges)})}}]),r}(Te);Object(f.a)([Object(z.a)({wireFrame:"wire-frame"})],Ae.prototype,"type",void 0),Object(f.a)([Object(m.b)(Le.a)],Ae.prototype,"edges",void 0);var Ce,Pe=Ae=Me=Object(f.a)([Object(w.a)("esri.layers.support.BuildingFilterModeWireFrame")],Ae),Ne=Ce=function(e){Object(b.a)(r,e);var t=Object(y.a)(r);function r(){var e;return Object(c.a)(this,r),(e=t.apply(this,arguments)).type="x-ray",e}return Object(u.a)(r,[{key:"clone",value:function(){return new Ce}}]),r}(Te);Object(f.a)([Object(m.b)({type:["x-ray"],readOnly:!0,json:{write:!0}})],Ne.prototype,"type",void 0);var qe,ze=Ne=Ce=Object(f.a)([Object(w.a)("esri.layers.support.BuildingFilterModeXRay")],Ne),Ve={nonNullable:!0,types:{key:"type",base:Te,typeMap:{solid:De,"wire-frame":Pe,"x-ray":ze}},json:{read:function(e){switch(e&&e.type){case"solid":return De.fromJSON(e);case"wireFrame":return Pe.fromJSON(e);case"x-ray":return ze.fromJSON(e);default:return}},write:{enabled:!0,isRequired:!0}}},Ue=qe=function(e){Object(b.a)(r,e);var t=Object(y.a)(r);function r(){var e;return Object(c.a)(this,r),(e=t.apply(this,arguments)).filterExpression=null,e.filterMode=new De,e.title="",e}return Object(u.a)(r,[{key:"clone",value:function(){return new qe({filterExpression:this.filterExpression,filterMode:Object(h.a)(this.filterMode),title:this.title})}}]),r}(ye.a);Object(f.a)([Object(m.b)({type:String,json:{write:{enabled:!0,isRequired:!0}}})],Ue.prototype,"filterExpression",void 0),Object(f.a)([Object(m.b)(Ve)],Ue.prototype,"filterMode",void 0),Object(f.a)([Object(m.b)({type:String,json:{write:{enabled:!0,isRequired:!0}}})],Ue.prototype,"title",void 0);var Be,Ge=Ue=qe=Object(f.a)([Object(w.a)("esri.layers.support.BuildingFilterBlock")],Ue),Qe=E.a.ofType(Ge),Je=Be=function(e){Object(b.a)(r,e);var t=Object(y.a)(r);function r(){var e;return Object(c.a)(this,r),(e=t.apply(this,arguments)).description=null,e.filterBlocks=null,e.id=Object(k.a)(),e.name=null,e}return Object(u.a)(r,[{key:"clone",value:function(){return new Be({description:this.description,filterBlocks:Object(h.a)(this.filterBlocks),id:this.id,name:this.name,filterAuthoringInfo:Object(h.a)(this.filterAuthoringInfo)})}}]),r}(ye.a);Object(f.a)([Object(m.b)({type:String,json:{write:!0}})],Je.prototype,"description",void 0),Object(f.a)([Object(m.b)({type:Qe,json:{write:{enabled:!0,isRequired:!0}}})],Je.prototype,"filterBlocks",void 0),Object(f.a)([Object(m.b)({types:{key:"type",base:ve,typeMap:{checkbox:Fe}},json:{read:function(e){switch(e&&e.type){case"checkbox":return Fe.fromJSON(e);default:return null}},write:!0}})],Je.prototype,"filterAuthoringInfo",void 0),Object(f.a)([Object(m.b)({type:String,constructOnly:!0,json:{write:{enabled:!0,isRequired:!0}}})],Je.prototype,"id",void 0),Object(f.a)([Object(m.b)({type:String,json:{write:{enabled:!0,isRequired:!0}}})],Je.prototype,"name",void 0);var We=Je=Be=Object(f.a)([Object(w.a)("esri.layers.support.BuildingFilter")],Je),$e=O.a.getLogger("esri.layers.support.BuildingSummaryStatistics"),Ke=function(e){Object(b.a)(r,e);var t=Object(y.a)(r);function r(){var e;return Object(c.a)(this,r),(e=t.apply(this,arguments)).fieldName=null,e.modelName=null,e.label=null,e.min=null,e.max=null,e.mostFrequentValues=null,e.subLayerIds=null,e}return r}(ye.a);Object(f.a)([Object(m.b)({type:String})],Ke.prototype,"fieldName",void 0),Object(f.a)([Object(m.b)({type:String})],Ke.prototype,"modelName",void 0),Object(f.a)([Object(m.b)({type:String})],Ke.prototype,"label",void 0),Object(f.a)([Object(m.b)({type:Number})],Ke.prototype,"min",void 0),Object(f.a)([Object(m.b)({type:Number})],Ke.prototype,"max",void 0),Object(f.a)([Object(m.b)({json:{read:function(e){return Array.isArray(e)&&(e.every((function(e){return"string"==typeof e}))||e.every((function(e){return"number"==typeof e})))?e.slice():null}}})],Ke.prototype,"mostFrequentValues",void 0),Object(f.a)([Object(m.b)({type:[Number]})],Ke.prototype,"subLayerIds",void 0),Ke=Object(f.a)([Object(w.a)("esri.layers.support.BuildingFieldStatistics")],Ke);var Ze=function(e){Object(b.a)(r,e);var t=Object(y.a)(r);function r(){var e;return Object(c.a)(this,r),(e=t.apply(this,arguments)).url=null,e}return Object(u.a)(r,[{key:"fields",get:function(){return this.loaded||"loading"===this.loadStatus?this._get("fields"):($e.error("building summary statistics are not loaded"),null)}},{key:"load",value:function(e){var t=Object(v.i)(e)?e.signal:null;return this.addResolvingPromise(this._fetchService(t)),Object(I.u)(this)}},{key:"_fetchService",value:function(){var e=Object(o.a)(n.a.mark((function e(t){var r;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(U.default)(this.url,{query:{f:"json"},responseType:"json",signal:t});case 2:r=e.sent.data,this.read(r,{origin:"service"});case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),r}(G.a.LoadableMixin(Object(B.b)(ye.a)));Object(f.a)([Object(m.b)({constructOnly:!0,type:String})],Ze.prototype,"url",void 0),Object(f.a)([Object(m.b)({readOnly:!0,type:[Ke],json:{read:{source:"summary"}}})],Ze.prototype,"fields",null);var He=Ze=Object(f.a)([Object(w.a)("esri.layers.support.BuildingSummaryStatistics")],Ze),Xe=r(1097),Ye=O.a.getLogger("esri.layers.BuildingSceneLayer"),et=E.a.ofType(We),tt=Object(h.a)(de.sublayersProperty);tt.json.origins["web-scene"]={type:[oe],write:{enabled:!0,overridePolicy:function(){return{enabled:!1}}}},tt.json.origins["portal-item"]={type:[oe],write:{enabled:!0,overridePolicy:function(){return{enabled:!1}}}};var rt=function(e){Object(b.a)(r,e);var t=Object(y.a)(r);function r(e){var a;return Object(c.a)(this,r),(a=t.call(this,e)).operationalLayerType="BuildingSceneLayer",a.allSublayers=new R.a({root:Object(l.a)(a),rootCollectionNames:["sublayers"],getChildrenFunction:function(e){return"building-group"===e.type?e.sublayers:null}}),a.sublayers=null,a.sublayerOverrides=null,a.filters=new et,a.activeFilterId=null,a.summaryStatistics=null,a.outFields=null,a.type="building-scene",a}return Object(u.a)(r,[{key:"normalizeCtorArgs",value:function(e){return"string"==typeof e?{url:e}:e}},{key:"destroy",value:function(){this.allSublayers.destroy()}},{key:"readSublayers",value:function(e,t,r){var a=this,n=de.readSublayers(e,t,r);return de.forEachSublayer(n,(function(e){return e.layer=a})),this.sublayerOverrides&&(this.applySublayerOverrides(n,this.sublayerOverrides),this.sublayerOverrides=null),n}},{key:"applySublayerOverrides",value:function(e,t){var r=t.overrides,a=t.context;de.forEachSublayer(e,(function(e){return e.read(r.get(e.id),a)}))}},{key:"readSublayerOverrides",value:function(e,t){var r,a=new Map,n=Object(s.a)(e);try{for(n.s();!(r=n.n()).done;){var i=r.value;null!=i&&"object"==typeof i&&"number"==typeof i.id?a.set(i.id,i):t.messages.push(new x.a("building-scene-layer:invalid-sublayer-override","Invalid value for sublayer override. Not an object or no id specified.",{value:i}))}}catch(o){n.e(o)}finally{n.f()}return{overrides:a,context:t}}},{key:"writeSublayerOverrides",value:function(e,t,r){var a=[];de.forEachSublayer(this.sublayers,(function(e){var t=e.write({},r);Object.keys(t).length>1&&a.push(t)})),a.length>0&&(t.sublayers=a)}},{key:"writeUnappliedOverrides",value:function(e,t){t.sublayers=[],e.overrides.forEach((function(e){t.sublayers.push(Object(h.a)(e))}))}},{key:"write",value:function(e,t){return e=Object(p.a)(Object(d.a)(r.prototype),"write",this).call(this,e,t),!t||"web-scene"!==t.origin&&"portal-item"!==t.origin||(this.sublayers?this.writeSublayerOverrides(this.sublayers,e,t):this.sublayerOverrides&&this.writeUnappliedOverrides(this.sublayerOverrides,e)),e}},{key:"read",value:function(e,t){if(Object(p.a)(Object(d.a)(r.prototype),"read",this).call(this,e,t),t&&("web-scene"===t.origin||"portal-item"===t.origin)&&null!=e&&Array.isArray(e.sublayers)){var a=this.readSublayerOverrides(e.sublayers,t);this.sublayers?this.applySublayerOverrides(this.sublayers,a):this.sublayerOverrides=a}}},{key:"readSummaryStatistics",value:function(e,t){if("string"==typeof t.statisticsHRef){var r=Object(S.x)(this.parsedUrl.path,t.statisticsHRef);return new He({url:r})}return null}},{key:"elevationInfo",set:function(e){this._set("elevationInfo",e),this._validateElevationInfo()}},{key:"load",value:function(e){var t=this,r=Object(v.i)(e)?e.signal:null,a=this.loadFromPortal({supportedTypes:["Scene Service"]},e).catch((function(){})).then((function(){return t._fetchService(r)})).then((function(){return t._fetchAssociatedFeatureService(r)}));return this.addResolvingPromise(a),Object(I.u)(this)}},{key:"loadAll",value:function(){var e=this;return Object(T.a)(this,(function(t){de.forEachSublayer(e.sublayers,(function(e){"building-group"!==e.type&&t(e)})),e.summaryStatistics&&t(e.summaryStatistics)}))}},{key:"saveAs",value:function(){var e=Object(o.a)(n.a.mark((function e(t,r){var a=this;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._debouncedSaveOperations(1,Object(i.a)(Object(i.a)({},r),{},{getTypeKeywords:function(){return a._getTypeKeywords()},portalItemLayerType:"building-scene"}),t));case 1:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"save",value:function(){var e=Object(o.a)(n.a.mark((function e(){var t,r=this;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={getTypeKeywords:function(){return r._getTypeKeywords()},portalItemLayerType:"building-scene"},e.abrupt("return",this._debouncedSaveOperations(0,t));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"validateLayer",value:function(e){if(!e.layerType||"Building"!==e.layerType)throw new x.a("buildingscenelayer:layer-type-not-supported","BuildingSceneLayer does not support this layer type",{layerType:e.layerType})}},{key:"_getTypeKeywords",value:function(){return["Building"]}},{key:"_validateElevationInfo",value:function(){var e=this.elevationInfo;e&&("absolute-height"!==e.mode&&Ye.warn(".elevationInfo=","Building scene layers only support absolute-height elevation mode"),e.featureExpressionInfo&&"0"!==e.featureExpressionInfo.expression&&Ye.warn(".elevationInfo=","Building scene layers do not support featureExpressionInfo"))}},{key:"_fetchAssociatedFeatureService",value:function(){var e=Object(o.a)(n.a.mark((function e(t){var r;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new Xe.a(this.parsedUrl,this.portalItem,t),e.prev=1,e.next=4,r.fetchPortalItem();case 4:this.associatedFeatureServiceItem=e.sent,e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),Ye.warn("Associated feature service item could not be loaded",e.t0);case 10:case"end":return e.stop()}}),e,this,[[1,7]])})));return function(t){return e.apply(this,arguments)}}()}]),r}(Object(be.a)(Object(C.a)(Object(A.a)(Object(P.a)(Object(N.a)(Object(D.a)(M.a)))))));Object(f.a)([Object(m.b)({type:["BuildingSceneLayer"]})],rt.prototype,"operationalLayerType",void 0),Object(f.a)([Object(m.b)({readOnly:!0})],rt.prototype,"allSublayers",void 0),Object(f.a)([Object(m.b)(tt)],rt.prototype,"sublayers",void 0),Object(f.a)([Object(g.a)("service","sublayers")],rt.prototype,"readSublayers",null),Object(f.a)([Object(m.b)({type:et,nonNullable:!0,json:{write:!0}})],rt.prototype,"filters",void 0),Object(f.a)([Object(m.b)({type:String,json:{write:!0}})],rt.prototype,"activeFilterId",void 0),Object(f.a)([Object(m.b)({readOnly:!0,type:He})],rt.prototype,"summaryStatistics",void 0),Object(f.a)([Object(g.a)("summaryStatistics",["statisticsHRef"])],rt.prototype,"readSummaryStatistics",null),Object(f.a)([Object(m.b)({type:[String],json:{read:!1}})],rt.prototype,"outFields",void 0),Object(f.a)([Object(m.b)(Object(L.h)(_.a))],rt.prototype,"fullExtent",void 0),Object(f.a)([Object(m.b)({type:["show","hide","hide-children"]})],rt.prototype,"listMode",void 0),Object(f.a)([Object(m.b)(Object(L.h)(F.a))],rt.prototype,"spatialReference",void 0),Object(f.a)([Object(m.b)(L.b)],rt.prototype,"elevationInfo",null),Object(f.a)([Object(m.b)({json:{read:!1},readOnly:!0})],rt.prototype,"type",void 0),Object(f.a)([Object(m.b)()],rt.prototype,"associatedFeatureServiceItem",void 0);var at=rt=Object(f.a)([Object(w.a)("esri.layers.BuildingSceneLayer")],rt);t.default=at},1096:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var a={attachment:{supportsContentType:!1,supportsExifInfo:!1,supportsKeywords:!1,supportsName:!1,supportsSize:!1},data:{isVersioned:!1,supportsAttachment:!1,supportsM:!1,supportsZ:!1},editing:{supportsDeleteByAnonymous:!1,supportsDeleteByOthers:!1,supportsGeometryUpdate:!1,supportsGlobalId:!1,supportsRollbackOnFailure:!1,supportsUpdateByAnonymous:!1,supportsUpdateByOthers:!1,supportsUpdateWithoutM:!1,supportsUploadWithItemId:!1},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:!1,supportsDelete:!1,supportsEditing:!1,supportsChangeTracking:!1,supportsQuery:!1,supportsQueryAttachments:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:!1,supportsExceedsLimitStatistics:!1},queryRelated:{supportsCount:!1,supportsOrderBy:!1,supportsPagination:!1},query:{maxRecordCount:0,maxRecordCountFactor:0,standardMaxRecordCount:0,supportsCacheHint:!1,supportsCentroid:!1,supportsDisjointSpatialRelationship:!1,supportsDistance:!1,supportsDistinct:!1,supportsExtent:!1,supportsFormatPBF:!1,supportsGeometryProperties:!1,supportsHavingClause:!1,supportsHistoricMoment:!1,supportsMaxRecordCountFactor:!1,supportsOrderBy:!1,supportsPagination:!1,supportsPercentileStatistics:!1,supportsQuantization:!1,supportsQuantizationEditMode:!1,supportsQueryByOthers:!1,supportsQueryGeometry:!1,supportsResultType:!1,supportsSqlExpression:!1,supportsStandardizedQueriesOnly:!1,supportsStatistics:!1,tileMaxRecordCount:0}}},1097:function(e,t,r){"use strict";r.d(t,"a",(function(){return h}));var a=r(32),n=r(10),i=r.n(n),o=r(21),s=r(2),c=r(3),u=r(4),l=r(16),p=r(104),d=r(81),b=r(124),y=r(384),f=r(826),h=function(){function e(t,r,a){Object(s.a)(this,e),this.parsedUrl=t,this.portalItem=r,this.signal=a,this.rootDocument=null;var n=this.parsedUrl.path.match(/^(.*)\/SceneServer\/layers\/([\d]*)\/?$/i);n&&(this.urlParts={root:n[1],layerId:parseInt(n[2],10)})}return Object(c.a)(e,[{key:"fetch",value:function(){var e=Object(o.a)(i.a.mark((function e(){var t,r,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.urlParts){e.next=2;break}return e.abrupt("return",null);case 2:if(null==(t=this.portalItem)){e.next=6;break}e.t0=t,e.next=9;break;case 6:return e.next=8,this.portalItemFromServiceItemId();case 8:e.t0=e.sent;case 9:if(r=e.t0,!Object(u.h)(r)){e.next=12;break}return e.abrupt("return",this.loadFromUrl());case 12:return e.next=14,this.findAndLoadRelatedPortalItem(r);case 14:return a=e.sent,e.abrupt("return",Object(u.h)(a)?null:this.loadFeatureLayerFromPortalItem(a));case 16:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"fetchPortalItem",value:function(){var e=Object(o.a)(i.a.mark((function e(){var t,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.urlParts){e.next=2;break}return e.abrupt("return",null);case 2:if(null==(t=this.portalItem)){e.next=6;break}e.t0=t,e.next=9;break;case 6:return e.next=8,this.portalItemFromServiceItemId();case 8:e.t0=e.sent;case 9:return r=e.t0,e.abrupt("return",Object(u.h)(r)?null:this.findAndLoadRelatedPortalItem(r));case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"fetchRootDocument",value:function(){var e=Object(o.a)(i.a.mark((function e(){var t,r,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Object(u.i)(this.rootDocument)){e.next=2;break}return e.abrupt("return",this.rootDocument);case 2:if(!Object(u.h)(this.urlParts)){e.next=4;break}return e.abrupt("return",(this.rootDocument={},{}));case 4:return t={query:{f:"json"},responseType:"json",authMode:"no-prompt",signal:this.signal},r="".concat(this.urlParts.root,"/SceneServer"),e.prev=5,e.next=8,Object(d.default)(r,t);case 8:a=e.sent,this.rootDocument=a.data,e.next=15;break;case 12:e.prev=12,e.t0=e.catch(5),this.rootDocument={};case 15:return e.abrupt("return",this.rootDocument);case 16:case"end":return e.stop()}}),e,this,[[5,12]])})));return function(){return e.apply(this,arguments)}}()},{key:"fetchServiceOwningPortalUrl",value:function(){var e=Object(o.a)(i.a.mark((function e(){var t,r,a,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==(r=null==(t=p.b)?void 0:t.findServerInfo(this.parsedUrl.path))||!r.owningSystemUrl){e.next=3;break}return e.abrupt("return",r.owningSystemUrl);case 3:return a=this.parsedUrl.path.replace(/(.*\/rest)\/.*/i,"$1")+"/info",e.prev=4,e.next=7,Object(d.default)(a,{query:{f:"json"},responseType:"json",signal:this.signal});case 7:if(!(n=e.sent.data.owningSystemUrl)){e.next=10;break}return e.abrupt("return",n);case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(4),Object(l.v)(e.t0);case 15:return e.abrupt("return",null);case 16:case"end":return e.stop()}}),e,this,[[4,12]])})));return function(){return e.apply(this,arguments)}}()},{key:"findAndLoadRelatedPortalItem",value:function(){var e=Object(o.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.fetchRelatedItems({relationshipType:"Service2Service",direction:"reverse"},{signal:this.signal});case 3:if(e.t0=e.sent.find((function(e){return"Feature Service"===e.type})),e.t0){e.next=6;break}e.t0=null;case 6:return e.abrupt("return",e.t0);case 9:return e.prev=9,e.t1=e.catch(0),e.abrupt("return",(Object(l.v)(e.t1),null));case 12:case"end":return e.stop()}}),e,this,[[0,9]])})));return function(t){return e.apply(this,arguments)}}()},{key:"loadFeatureLayerFromPortalItem",value:function(){var e=Object(o.a)(i.a.mark((function e(t){var r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.load({signal:this.signal});case 2:return e.next=4,this.findMatchingAssociatedSublayerUrl(t.url);case 4:return r=e.sent,e.abrupt("return",new f.default({url:r,portalItem:t}).load({signal:this.signal}));case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"loadFromUrl",value:function(){var e=Object(o.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.findMatchingAssociatedSublayerUrl("".concat(this.urlParts.root,"/FeatureServer"));case 2:return t=e.sent,e.abrupt("return",new f.default({url:t}).load({signal:this.signal}));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"findMatchingAssociatedSublayerUrl",value:function(){var e=Object(o.a)(i.a.mark((function e(t){var r,n,o,s,c,u,p,b,y,f,h,v;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.replace(/^(.*FeatureServer)(\/[\d]*\/?)?$/i,"$1"),n={query:{f:"json"},responseType:"json",authMode:"no-prompt",signal:this.signal},o=this.urlParts.layerId,s=this.fetchRootDocument(),c=Object(d.default)(r,n),e.next=7,Object(l.b)([c,s]);case 7:if(u=e.sent,p=Object(a.a)(u,2),b=p[0],y=p[1],f=y&&y.layers,h=b.data&&b.data.layers,Array.isArray(h)){e.next=15;break}throw new Error("expected layers array");case 15:if(!Array.isArray(f)){e.next=25;break}v=0;case 17:if(!(v<Math.min(f.length,h.length))){e.next=23;break}if(f[v].id!==o){e.next=20;break}return e.abrupt("return","".concat(r,"/").concat(h[v].id));case 20:v++,e.next=17;break;case 23:e.next=27;break;case 25:if(!(o<h.length)){e.next=27;break}return e.abrupt("return","".concat(r,"/").concat(h[o].id));case 27:throw new Error("could not find matching associated sublayer");case 28:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"portalItemFromServiceItemId",value:function(){var e=Object(o.a)(i.a.mark((function e(){var t,r,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetchRootDocument();case 2:if(t=e.sent.serviceItemId){e.next=5;break}return e.abrupt("return",null);case 5:return r=new y.default({id:t}),e.next=8,this.fetchServiceOwningPortalUrl();case 8:return a=e.sent,Object(u.i)(a)&&(r.portal=new b.a({url:a})),e.prev=10,e.abrupt("return",r.load({signal:this.signal}));case 14:return e.prev=14,e.t0=e.catch(10),e.abrupt("return",(Object(l.v)(e.t0),null));case 17:case"end":return e.stop()}}),e,this,[[10,14]])})));return function(){return e.apply(this,arguments)}}()}]),e}()},790:function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var a=r(12),n=r(2),i=r(3);function o(e){return"date"===e.type||"esriFieldTypeDate"===e.type}function s(e){return e.toLowerCase().trim()}var c=function(){function e(t){if(Object(n.a)(this,e),this.fields=t,this._fieldsMap=new Map,this._dateFieldsSet=new Set,this.dateFields=[],t){var r,i=[],c=Object(a.a)(t);try{for(c.s();!(r=c.n()).done;){var u=r.value,l=u&&u.name;if(l){var p=s(l);this._fieldsMap.set(l,u),this._fieldsMap.set(p,u),i.push(p),o(u)&&(this.dateFields.push(u),this._dateFieldsSet.add(u))}}}catch(d){c.e(d)}finally{c.f()}i.sort(),this.uid=i.join(",")}}return Object(i.a)(e,[{key:"destroy",value:function(){this._fieldsMap.clear()}},{key:"has",value:function(e){return null!=this.get(e)}},{key:"get",value:function(e){return null!=e?this._fieldsMap.get(e)||this._fieldsMap.get(s(e)):void 0}},{key:"isDateField",value:function(e){return this._dateFieldsSet.has(this.get(e))}},{key:"normalizeFieldName",value:function(e){var t=this.get(e);if(t)return t.name}}]),e}()},792:function(e,t,r){"use strict";r.d(t,"a",(function(){return d})),r.d(t,"b",(function(){return y})),r.d(t,"c",(function(){return h})),r.d(t,"d",(function(){return f})),r.d(t,"e",(function(){return b}));r(13);var a=r(4),n=r(110),i=r(150),o=r(118),s=r(231),c=r(798),u=o.a.fromJSON(c.a),l=n.a.fromJSON(c.c),p=i.a.fromJSON(c.b),d=s.a.fromJSON(c.d);function b(e){if(Object(a.h)(e))return null;switch(e.type){case"mesh":return null;case"point":case"multipoint":return u;case"polyline":return l;case"polygon":case"extent":return p}return null}var y=o.a.fromJSON(c.e),f=n.a.fromJSON(c.g),h=i.a.fromJSON(c.f)},793:function(e,t,r){"use strict";var a,n=r(2),i=r(3),o=r(5),s=r(6),c=r(0),u=(r(13),r(24)),l=(r(14),r(15),r(1)),p=r(50),d=r(63),b=r(8),y=r(47),f=(r(11),r(19),r(20),r(28)),h=r(149),v=r(805),O=a=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(){var e;return Object(n.a)(this,r),(e=t.apply(this,arguments)).expression=null,e.title=null,e.value=null,e}return Object(i.a)(r,[{key:"readExpression",value:function(e,t){return t.value?Object(v.a)(t.value):e}},{key:"writeExpression",value:function(e,t,r){null!=this.value&&(e=Object(v.a)(this.value)),t[r]=e}},{key:"clone",value:function(){return new a({expression:this.expression,title:this.title,value:this.value})}}]),r}(f.a);Object(c.a)([Object(l.b)({type:String,json:{write:{allowNull:!0}}})],O.prototype,"expression",void 0),Object(c.a)([Object(l.b)({type:String,json:{write:!0,origins:{"web-scene":{write:!1}}}})],O.prototype,"title",void 0),Object(c.a)([Object(l.b)({json:{read:!1,write:!1}})],O.prototype,"value",void 0),Object(c.a)([Object(d.a)("expression",["expression","value"])],O.prototype,"readExpression",null),Object(c.a)([Object(y.a)("expression")],O.prototype,"writeExpression",null);var j,m=O=a=Object(c.a)([Object(b.a)("esri.layers.support.LabelExpressionInfo")],O),g=r(792),w=new p.a({esriServerPointLabelPlacementAboveCenter:"above-center",esriServerPointLabelPlacementAboveLeft:"above-left",esriServerPointLabelPlacementAboveRight:"above-right",esriServerPointLabelPlacementBelowCenter:"below-center",esriServerPointLabelPlacementBelowLeft:"below-left",esriServerPointLabelPlacementBelowRight:"below-right",esriServerPointLabelPlacementCenterCenter:"center-center",esriServerPointLabelPlacementCenterLeft:"center-left",esriServerPointLabelPlacementCenterRight:"center-right",esriServerLinePlacementAboveAfter:"above-after",esriServerLinePlacementAboveAlong:"above-along",esriServerLinePlacementAboveBefore:"above-before",esriServerLinePlacementAboveStart:"above-start",esriServerLinePlacementAboveEnd:"above-end",esriServerLinePlacementBelowAfter:"below-after",esriServerLinePlacementBelowAlong:"below-along",esriServerLinePlacementBelowBefore:"below-before",esriServerLinePlacementBelowStart:"below-start",esriServerLinePlacementBelowEnd:"below-end",esriServerLinePlacementCenterAfter:"center-after",esriServerLinePlacementCenterAlong:"center-along",esriServerLinePlacementCenterBefore:"center-before",esriServerLinePlacementCenterStart:"center-start",esriServerLinePlacementCenterEnd:"center-end",esriServerPolygonPlacementAlwaysHorizontal:"always-horizontal"},{ignoreUnknown:!0});function x(e){return!e||"service"!==e.origin&&!(e.layer&&"map-image"===e.layer.type)}var S=j=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var a;return Object(n.a)(this,r),(a=t.call(this,e)).type="label",a.name=null,a.deconflictionStrategy="static",a.labelExpression=null,a.labelExpressionInfo=null,a.labelPlacement=null,a.maxScale=0,a.minScale=0,a.symbol=g.a,a.useCodedValues=void 0,a.where=null,a}return Object(i.a)(r,[{key:"readLabelExpression",value:function(e,t){var r=t.labelExpressionInfo;if(!r||!r.value&&!r.expression)return e}},{key:"writeLabelExpression",value:function(e,t,r,a){if(this.labelExpressionInfo&&(x(a)||a&&"service"===a.origin))if(null!=this.labelExpressionInfo.value)e=Object(v.f)(this.labelExpressionInfo.value);else if(null!=this.labelExpressionInfo.expression){var n=Object(v.e)(this.labelExpressionInfo.expression);n&&(e="["+n+"]")}null!=e&&(t[r]=e)}},{key:"writeLabelExpressionInfo",value:function(e,t,r,a){if(null==e&&null!=this.labelExpression&&x(a))e=new m({expression:this.getLabelExpressionArcade()});else if(!e)return;var n=e.toJSON(a);n.expression&&(t[r]=n)}},{key:"writeMaxScale",value:function(e,t){(e||this.minScale)&&(t.maxScale=e)}},{key:"writeMinScale",value:function(e,t){(e||this.maxScale)&&(t.minScale=e)}},{key:"getLabelExpression",value:function(){return Object(v.b)(this)}},{key:"getLabelExpressionArcade",value:function(){return Object(v.c)(this)}},{key:"getLabelExpressionSingleField",value:function(){return Object(v.d)(this)}},{key:"hash",value:function(){return JSON.stringify(this)}},{key:"clone",value:function(){return new j({deconflictionStrategy:this.deconflictionStrategy,labelExpression:this.labelExpression,labelExpressionInfo:Object(u.a)(this.labelExpressionInfo),labelPlacement:this.labelPlacement,maxScale:this.maxScale,minScale:this.minScale,name:this.name,symbol:Object(u.a)(this.symbol),where:this.where,useCodedValues:this.useCodedValues})}}],[{key:"evaluateWhere",value:function(e,t){var r=function(e,t,r){switch(t){case"=":return e==r;case"<>":return e!=r;case">":return e>r;case">=":return e>=r;case"<":return e<r;case"<=":return e<=r}return!1};try{if(null==e)return!0;var a=e.split(" ");if(3===a.length)return r(t[a[0]],a[1],a[2]);if(7===a.length){var n=r(t[a[0]],a[1],a[2]),i=a[3],o=r(t[a[4]],a[5],a[6]);switch(i){case"AND":return n&&o;case"OR":return n||o}}return!1}catch(t){console.log("Error.: can't parse = "+e)}}}]),r}(f.a);Object(c.a)([Object(l.b)({type:String,json:{write:!0}})],S.prototype,"name",void 0),Object(c.a)([Object(l.b)({type:String,json:{write:!0,default:"static",origins:{"web-scene":{write:!1}}}})],S.prototype,"deconflictionStrategy",void 0),Object(c.a)([Object(l.b)({type:String,json:{write:{allowNull:!0}}})],S.prototype,"labelExpression",void 0),Object(c.a)([Object(d.a)("labelExpression")],S.prototype,"readLabelExpression",null),Object(c.a)([Object(y.a)("labelExpression")],S.prototype,"writeLabelExpression",null),Object(c.a)([Object(l.b)({type:m,json:{write:{overridePolicy:function(e,t,r){return x(r)?{allowNull:!0}:{enabled:!1}}}}})],S.prototype,"labelExpressionInfo",void 0),Object(c.a)([Object(y.a)("labelExpressionInfo")],S.prototype,"writeLabelExpressionInfo",null),Object(c.a)([Object(l.b)({type:w.apiValues,json:{type:w.jsonValues,read:w.read,write:w.write}})],S.prototype,"labelPlacement",void 0),Object(c.a)([Object(l.b)({type:Number})],S.prototype,"maxScale",void 0),Object(c.a)([Object(y.a)("maxScale")],S.prototype,"writeMaxScale",null),Object(c.a)([Object(l.b)({type:Number})],S.prototype,"minScale",void 0),Object(c.a)([Object(y.a)("minScale")],S.prototype,"writeMinScale",null),Object(c.a)([Object(l.b)({types:h.d,json:{origins:{"web-scene":{types:h.g,write:h.j,default:null}},write:h.j,default:null}})],S.prototype,"symbol",void 0),Object(c.a)([Object(l.b)({type:Boolean,json:{write:!0}})],S.prototype,"useCodedValues",void 0),Object(c.a)([Object(l.b)({type:String,json:{write:!0}})],S.prototype,"where",void 0);var k=S=j=Object(c.a)([Object(b.a)("esri.layers.support.LabelClass")],S);t.a=k},794:function(e,t,r){"use strict";function a(e){return e&&"esri.renderers.visualVariables.SizeVariable"===e.declaredClass}function n(e){return null!=e&&!isNaN(e)&&isFinite(e)}function i(e){return e.valueExpression?"expression":e.field&&"string"==typeof e.field?"field":"unknown"}function o(e,t){var r=t||i(e),a=e.valueUnit||"unknown";return"unknown"===r?"constant":e.stops?"stops":null!=e.minSize&&null!=e.maxSize&&null!=e.minDataValue&&null!=e.maxDataValue?"clamped-linear":"unknown"===a?null!=e.minSize&&null!=e.minDataValue?e.minSize&&e.minDataValue?"proportional":"additive":"identity":"real-world-size"}r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return o})),r.d(t,"c",(function(){return a})),r.d(t,"d",(function(){return n}))},797:function(e,t,r){"use strict";var a,n=r(2),i=r(3),o=r(5),s=r(6),c=r(0),u=(r(13),r(14),r(15),r(1)),l=r(8),p=(r(11),r(19),r(20),r(28)),d=r(173),b=a=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var a;return Object(n.a)(this,r),(a=t.call(this,e)).value=0,a.unit="milliseconds",a}return Object(i.a)(r,[{key:"toMilliseconds",value:function(){return this.value*d.b[this.unit]}},{key:"clone",value:function(){return new a({value:this.value,unit:this.unit})}}]),r}(p.a);Object(c.a)([Object(u.b)({type:Number,json:{write:!0},nonNullable:!0})],b.prototype,"value",void 0),Object(c.a)([Object(u.b)({type:d.d.apiValues,json:{type:d.d.jsonValues,read:d.d.read,write:d.d.write},nonNullable:!0})],b.prototype,"unit",void 0);var y=b=a=Object(c.a)([Object(l.a)("esri.TimeInterval")],b);t.a=y},798:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return o})),r.d(t,"c",(function(){return i})),r.d(t,"d",(function(){return s})),r.d(t,"e",(function(){return c})),r.d(t,"f",(function(){return l})),r.d(t,"g",(function(){return u}));var a=[252,146,31,255],n={type:"esriSMS",style:"esriSMSCircle",size:6,color:a,outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[153,153,153,255]}},i={type:"esriSLS",style:"esriSLSSolid",width:.75,color:a},o={type:"esriSFS",style:"esriSFSSolid",color:[252,146,31,196],outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[255,255,255,191]}},s={type:"esriTS",color:[255,255,255,255],font:{family:"arial-unicode-ms",size:10,weight:"bold"},horizontalAlignment:"center",kerning:!0,haloColor:[0,0,0,255],haloSize:1,rotated:!1,text:"",xoffset:0,yoffset:0,angle:0},c={type:"esriSMS",style:"esriSMSCircle",color:[0,0,0,255],outline:null,size:10.5},u={type:"esriSLS",style:"esriSLSSolid",color:[0,0,0,255],width:1.5},l={type:"esriSFS",style:"esriSFSSolid",color:[0,0,0,255],outline:null}},800:function(e,t,r){"use strict";var a=r(2),n=r(5),i=r(6),o=r(0),s=(r(13),r(14),r(15),r(1)),c=r(8),u=(r(11),r(19),r(20),function(e){Object(n.a)(r,e);var t=Object(i.a)(r);function r(){var e;return Object(a.a)(this,r),(e=t.apply(this,arguments)).type=null,e}return r}(r(28).a));Object(o.a)([Object(s.b)({type:["selection","cluster"],readOnly:!0,json:{read:!1,write:!0}})],u.prototype,"type",void 0);var l=u=Object(o.a)([Object(c.a)("esri.layers.support.FeatureReduction")],u);t.a=l},801:function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var a=r(2),n=r(3),i=r(5),o=r(6),s=r(0),c=(r(13),r(14),r(15),r(1)),u=r(8),l=(r(11),r(19),r(20),function(e){var t=function(e){Object(i.a)(r,e);var t=Object(o.a)(r);function r(){var e;return Object(a.a)(this,r),(e=t.apply(this,arguments)).refreshInterval=0,e}return Object(n.a)(r,[{key:"refresh",value:function(){this.emit("refresh")}}]),r}(e);return Object(s.a)([Object(c.b)({type:Number,cast:function(e){return e>=.1?e:e<=0?0:.1},json:{write:!0,origins:{"web-document":{write:!0}}}})],t.prototype,"refreshInterval",void 0),t=Object(s.a)([Object(u.a)("esri.layers.mixins.RefreshableLayer")],t)})},804:function(e,t,r){"use strict";r.d(t,"a",(function(){return v})),r.d(t,"b",(function(){return f})),r.d(t,"c",(function(){return h}));var a=r(26),n=r(12),i=r(4),o=r(98),s=r(33),c=r(40),u=["esri.Color","esri.portal.Portal","esri.symbols.support.Symbol3DAnchorPosition2D","esri.symbols.support.Symbol3DAnchorPosition3D"];function l(e){return e instanceof s.a}function p(e){return e instanceof c.a?Object.keys(e.items):l(e)?Object(o.a)(e).keys():e?Object.keys(e):[]}function d(e,t){return e instanceof c.a?e.items[t]:e[t]}function b(e){return e?e.declaredClass:null}function y(e,t){var r=e.diff;if(r&&"function"==typeof r)return r(e,t);var o=p(e),s=p(t);if(0!==o.length||0!==s.length){if(!o.length||!s.length||function(e,t){return!(!Array.isArray(e)||!Array.isArray(t))&&e.length!==t.length}(e,t))return{type:"complete",oldValue:e,newValue:t};var c,f=s.filter((function(e){return-1===o.indexOf(e)})),h=o.filter((function(e){return-1===s.indexOf(e)})),v=o.filter((function(r){return s.indexOf(r)>-1&&d(e,r)!==d(t,r)})).concat(f,h).sort(),O=b(e);if(O&&u.indexOf(O)>-1&&v.length)return{type:"complete",oldValue:e,newValue:t};var j,m=l(e)&&l(t),g=Object(n.a)(v);try{for(g.s();!(j=g.n()).done;){var w=j.value,x=d(e,w),S=d(t,w),k=void 0;(m||"function"!=typeof x&&"function"!=typeof S)&&x!==S&&(null==x&&null==S||(k=r&&r[w]&&"function"==typeof r[w]?r[w](x,S):"object"==typeof x&&"object"==typeof S&&b(x)===b(S)?y(x,S):{type:"complete",oldValue:x,newValue:S},Object(i.i)(k)&&(Object(i.i)(c)?c.diff[w]=k:c={type:"partial",diff:Object(a.a)({},w,k)})))}}catch(I){g.e(I)}finally{g.f()}return c}}function f(e,t){if(Object(i.h)(e))return!1;var r,a=t.split("."),o=e,s=Object(n.a)(a);try{for(s.s();!(r=s.n()).done;){var c=r.value;if("complete"===o.type)return!0;if("partial"!==o.type)return!1;var u=o.diff[c];if(!u)return!1;o=u}}catch(l){s.e(l)}finally{s.f()}return!0}function h(e,t){var r,a=Object(n.a)(t);try{for(a.s();!(r=a.n()).done;){if(f(e,r.value))return!0}}catch(i){a.e(i)}finally{a.f()}return!1}function v(e,t){if("function"!=typeof e&&"function"!=typeof t&&(e||t))return!e||!t||"object"==typeof e&&"object"==typeof t&&b(e)!==b(t)?{type:"complete",oldValue:e,newValue:t}:y(e,t)}},805:function(e,t,r){"use strict";r.d(t,"a",(function(){return d})),r.d(t,"b",(function(){return u})),r.d(t,"c",(function(){return l})),r.d(t,"d",(function(){return p})),r.d(t,"e",(function(){return v})),r.d(t,"f",(function(){return c}));var a=r(108),n=new RegExp("__begin__","ig"),i=new RegExp("__end__","ig"),o=new RegExp("^__begin__","i"),s=new RegExp("__end__$","i");function c(e){return e.replace(new RegExp("\\{","g"),"[").replace(new RegExp("\\}","g"),"]")}function u(e){var t={expression:"",type:"none"};return e.labelExpressionInfo?e.labelExpressionInfo.value?(t.expression=e.labelExpressionInfo.value,t.type="conventional"):e.labelExpressionInfo.expression&&(t.expression=e.labelExpressionInfo.expression,t.type="arcade"):null!=e.labelExpression&&(t.expression=function(e){return e.replace(new RegExp("\\[","g"),"{").replace(new RegExp("\\]","g"),"}")}(e.labelExpression),t.type="conventional"),t}function l(e){var t=u(e);if(!t)return null;switch(t.type){case"conventional":return d(t.expression);case"arcade":return t.expression}return null}function p(e){var t=u(e);if(!t)return null;switch(t.type){case"conventional":return function(e){var t=e.match(b);return t&&t[1].trim()||null}(t.expression);case"arcade":return v(t.expression)}return null}function d(e){var t;return e?(t=Object(a.c)(e,(function(e){return'__begin__$feature["'+e+'"]__end__'})),t=o.test(t)?t.replace(o,""):'"'+t,t=(t=s.test(t)?t.replace(s,""):t+'"').replace(n,'" + ').replace(i,' + "')):t='""',t}var b=/^\s*\{([^}]+)\}\s*$/i;var y=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])([\w\s]+)(\2)\]));?\s*$/i,f=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])([\w\s]+)(\2)\]));?\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])(\1|\3)(\5)\s*\));?\s*$/i,h=/^\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])([\w\s]+)(\1)\s*\));?\s*$/i;function v(e){if(!e)return null;var t=y.exec(e)||f.exec(e);return t?t[1]||t[3]:(t=h.exec(e))?t[2]:null}},806:function(e,t,r){"use strict";r.d(t,"a",(function(){return c})),r.d(t,"b",(function(){return u})),r.d(t,"c",(function(){return l}));var a=r(32),n=r(12),i=r(2),o=r(3),s=r(129),c=-3,u=function(){function e(t,r,a){Object(i.a)(this,e),this._namespace=t,this._storage=r,this._removeFunc=!1,this._hit=0,this._miss=0,this._storage.register(this),this._namespace+=":",a&&(this._storage.registerRemoveFunc(this._namespace,a),this._removeFunc=!0)}return Object(o.a)(e,[{key:"namespace",get:function(){return this._namespace.slice(0,-1)}},{key:"hitRate",get:function(){return this._hit/(this._hit+this._miss)}},{key:"size",get:function(){return this._storage.size}},{key:"maxSize",get:function(){return this._storage.maxSize}},{key:"resetHitRate",value:function(){this._hit=this._miss=0}},{key:"destroy",value:function(){this._storage.clear(this._namespace),this._removeFunc&&this._storage.deregisterRemoveFunc(this._namespace),this._storage.deregister(this)}},{key:"put",value:function(e,t,r){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;this._storage.put(this._namespace+e,t,r,a)}},{key:"get",value:function(e){var t=this._storage.get(this._namespace+e);return void 0===t?++this._miss:++this._hit,t}},{key:"pop",value:function(e){var t=this._storage.pop(this._namespace+e);return void 0===t?++this._miss:++this._hit,t}},{key:"updateSize",value:function(e,t,r){this._storage.updateSize(this._namespace+e,t,r)}},{key:"clear",value:function(){this._storage.clear(this._namespace)}},{key:"clearAll",value:function(){this._storage.clearAll()}},{key:"getStats",value:function(){return this._storage.getStats()}},{key:"resetStats",value:function(){this._storage.resetStats()}}]),e}(),l=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10485760;Object(i.a)(this,e),this._maxSize=t,this._db=new Map,this._size=0,this._hit=0,this._miss=0,this._removeFuncs=[],this._users=new s.a}return Object(o.a)(e,[{key:"register",value:function(e){this._users.push(e)}},{key:"deregister",value:function(e){this._users.removeUnordered(e)}},{key:"registerRemoveFunc",value:function(e,t){this._removeFuncs.push([e,t])}},{key:"deregisterRemoveFunc",value:function(e){this._removeFuncs=this._removeFuncs.filter((function(t){return t[0]!==e}))}},{key:"size",get:function(){return this._size}},{key:"maxSize",get:function(){return this._maxSize},set:function(e){this._maxSize=Math.max(e,0),this._checkSizeLimit()}},{key:"put",value:function(e,t,r,a){var n=this._db.get(e);if(n&&(this._size-=n.size,this._db.delete(e),n.entry!==t&&this._notifyRemoved(e,n.entry)),r>this._maxSize)this._notifyRemoved(e,t);else if(void 0!==t)if(!r||r<0)console.warn("Refusing to cache entry with invalid size "+r);else{var i=1+Math.max(a,-3)- -3;this._db.set(e,{entry:t,size:r,lifetime:i,lives:i}),this._size+=r,this._checkSizeLimit()}else console.warn("Refusing to cache undefined entry ")}},{key:"updateSize",value:function(e,t,r){var a=this._db.get(e);a&&a.entry===t&&(this._size-=a.size,r>this._maxSize?this._notifyRemoved(e,t):(a.size=r,this._size+=r,this._checkSizeLimit()))}},{key:"pop",value:function(e){var t=this._db.get(e);if(t)return this._size-=t.size,this._db.delete(e),++this._hit,t.entry;++this._miss}},{key:"get",value:function(e){var t=this._db.get(e);if(void 0!==t)return this._db.delete(e),t.lives=t.lifetime,this._db.set(e,t),++this._hit,t.entry;++this._miss}},{key:"getStats",value:function(){var e=this,t={Size:Math.round(this._size/1048576)+"/"+Math.round(this._maxSize/1048576)+"MB","Hit rate":Math.round(100*this._getHitRate())+"%",Entries:this._db.size.toString()},r={},a=new Array;this._db.forEach((function(t,n){var i=t.lifetime;a[i]=(a[i]||0)+t.size,e._users.forAll((function(e){var a=e.namespace;if(n.startsWith(a)){var i=r[a]||0;r[a]=i+t.size}}))}));var n={};this._users.forAll((function(e){var t=e.namespace;if(!isNaN(e.hitRate)&&e.hitRate>0){var a=r[t]||0;r[t]=a,n[t]=Math.round(100*e.hitRate)+"%"}else n[t]="0%"}));var i=Object.keys(r);i.forEach((function(t){return r[t]=r[t]/e._size*100})),i.sort((function(e,t){return r[t]-r[e]})),i.forEach((function(e){return t[e]=Math.round(r[e])+"% / "+n[e]}));for(var o=a.length-1;o>=0;--o){var s=a[o];s&&(t["Priority "+(o+-3-1)]=Math.round(s/this.size*100)+"%")}return t}},{key:"resetStats",value:function(){this._hit=this._miss=0,this._users.forAll((function(e){return e.resetHitRate()}))}},{key:"clear",value:function(e){var t=this;this._db.forEach((function(r,a){a.startsWith(e)&&(t._size-=r.size,t._db.delete(a),t._notifyRemoved(a,r.entry))}))}},{key:"clearAll",value:function(){var e=this;this._db.forEach((function(t,r){return e._notifyRemoved(r,t.entry)})),this._size=0,this._db.clear()}},{key:"_getHitRate",value:function(){return this._hit/(this._hit+this._miss)}},{key:"_notifyRemoved",value:function(e,t){this._removeFuncs.forEach((function(r){e.startsWith(r[0])&&r[1](t)}))}},{key:"_checkSizeLimit",value:function(){if(!(this._size<=this._maxSize)){var e,t=Object(n.a)(this._db);try{for(t.s();!(e=t.n()).done;){var r=Object(a.a)(e.value,2),i=r[0],o=r[1];if(this._db.delete(i),o.lives<=1?(this._size-=o.size,this._notifyRemoved(i,o.entry)):(--o.lives,this._db.set(i,o)),this._size<=.9*this.maxSize)return}}catch(s){t.e(s)}finally{t.f()}}}}]),e}()},807:function(e,t,r){"use strict";var a,n=r(2),i=r(3),o=r(5),s=r(6),c=r(0),u=(r(13),r(24)),l=(r(14),r(15),r(1)),p=r(63),d=r(8),b=r(47),y=(r(11),r(19),r(20),r(28)),f=r(173),h=r(304),v=r(797),O=a=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var a;return Object(n.a)(this,r),(a=t.call(this,e)).respectsDaylightSaving=!1,a.timezone=null,a}return Object(i.a)(r,[{key:"readRespectsDaylightSaving",value:function(e,t){return void 0!==t.respectsDaylightSaving?t.respectsDaylightSaving:void 0!==t.respectDaylightSaving&&t.respectDaylightSaving}},{key:"clone",value:function(){var e=this.respectsDaylightSaving,t=this.timezone;return new a({respectsDaylightSaving:e,timezone:t})}}]),r}(y.a);Object(c.a)([Object(l.b)({type:Boolean,json:{write:!0}})],O.prototype,"respectsDaylightSaving",void 0),Object(c.a)([Object(p.a)("respectsDaylightSaving",["respectsDaylightSaving","respectDaylightSaving"])],O.prototype,"readRespectsDaylightSaving",null),Object(c.a)([Object(l.b)({type:String,json:{read:{source:"timeZone"},write:{target:"timeZone"}}})],O.prototype,"timezone",void 0);var j,m=O=a=Object(c.a)([Object(d.a)("esri.layers.support.TimeReference")],O),g=j=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var a;return Object(n.a)(this,r),(a=t.call(this,e)).cumulative=!1,a.endField=null,a.fullTimeExtent=null,a.hasLiveData=!1,a.interval=null,a.startField=null,a.timeReference=null,a.trackIdField=null,a.useTime=!0,a}return Object(i.a)(r,[{key:"readFullTimeExtent",value:function(e,t){if(!t.timeExtent||!Array.isArray(t.timeExtent)||2!==t.timeExtent.length)return null;var r=new Date(t.timeExtent[0]),a=new Date(t.timeExtent[1]);return new h.a({start:r,end:a})}},{key:"writeFullTimeExtent",value:function(e,t){e&&e.start&&e.end?t.timeExtent=[e.start.getTime(),e.end.getTime()]:t.timeExtent=null}},{key:"readInterval",value:function(e,t){return t.timeInterval&&t.timeIntervalUnits?new v.a({value:t.timeInterval,unit:f.d.fromJSON(t.timeIntervalUnits)}):t.defaultTimeInterval&&t.defaultTimeIntervalUnits?new v.a({value:t.defaultTimeInterval,unit:f.d.fromJSON(t.defaultTimeIntervalUnits)}):null}},{key:"writeInterval",value:function(e,t){if(e){var r=e.toJSON();t.timeInterval=r.value,t.timeIntervalUnits=r.unit}else t.timeInterval=null,t.timeIntervalUnits=null}},{key:"clone",value:function(){var e=this.cumulative,t=this.endField,r=this.hasLiveData,a=this.interval,n=this.startField,i=this.timeReference,o=this.fullTimeExtent,s=this.trackIdField,c=this.useTime;return new j({cumulative:e,endField:t,hasLiveData:r,interval:a,startField:n,timeReference:Object(u.a)(i),fullTimeExtent:Object(u.a)(o),trackIdField:s,useTime:c})}}]),r}(y.a);Object(c.a)([Object(l.b)({type:Boolean,json:{read:{source:"exportOptions.timeDataCumulative"},write:{target:"exportOptions.timeDataCumulative"}}})],g.prototype,"cumulative",void 0),Object(c.a)([Object(l.b)({type:String,json:{read:{source:"endTimeField"},write:{target:"endTimeField",allowNull:!0}}})],g.prototype,"endField",void 0),Object(c.a)([Object(l.b)({type:h.a,json:{write:{enabled:!0,allowNull:!0}}})],g.prototype,"fullTimeExtent",void 0),Object(c.a)([Object(p.a)("fullTimeExtent",["timeExtent"])],g.prototype,"readFullTimeExtent",null),Object(c.a)([Object(b.a)("fullTimeExtent")],g.prototype,"writeFullTimeExtent",null),Object(c.a)([Object(l.b)({type:Boolean,json:{write:!0}})],g.prototype,"hasLiveData",void 0),Object(c.a)([Object(l.b)({type:v.a,json:{write:{enabled:!0,allowNull:!0}}})],g.prototype,"interval",void 0),Object(c.a)([Object(p.a)("interval",["timeInterval","timeIntervalUnits","defaultTimeInterval","defaultTimeIntervalUnits"])],g.prototype,"readInterval",null),Object(c.a)([Object(b.a)("interval")],g.prototype,"writeInterval",null),Object(c.a)([Object(l.b)({type:String,json:{read:{source:"startTimeField"},write:{target:"startTimeField",allowNull:!0}}})],g.prototype,"startField",void 0),Object(c.a)([Object(l.b)({type:m,json:{write:{enabled:!0,allowNull:!0}}})],g.prototype,"timeReference",void 0),Object(c.a)([Object(l.b)({type:String,json:{write:{enabled:!0,allowNull:!0}}})],g.prototype,"trackIdField",void 0),Object(c.a)([Object(l.b)({type:Boolean,json:{read:{source:"exportOptions.useTime"},write:{target:"exportOptions.useTime"}}})],g.prototype,"useTime",void 0);var w=g=j=Object(c.a)([Object(d.a)("esri.layers.support.TimeInfo")],g);t.a=w},812:function(e,t,r){"use strict";r.d(t,"a",(function(){return p}));var a=r(157),n=(r(130),r(213)),i=(r(308),r(309)),o=r(214),s=r(215),c=(r(216),r(178),r(276)),u=["oid","global-id"],l=["oid","global-id","guid"];function p(e,t){var r=e.displayField,i=e.editFieldsInfo,o=e.fields,u=e.objectIdField,l=e.title;if(!o)return null;var p=v({editFieldsInfo:i,fields:o,objectIdField:u},t);if(!p.length)return null;var d=function(e){var t=Object(a.l)(e),r=e.titleBase;return t?"".concat(r,": {").concat(t.trim(),"}"):r}({titleBase:l,fields:o,displayField:r}),b=[new s.a,new n.a];return new c.a({title:d,content:b,fieldInfos:p})}var d=[/^fnode_$/i,/^tnode_$/i,/^lpoly_$/i,/^rpoly_$/i,/^poly_$/i,/^subclass$/i,/^subclass_$/i,/^rings_ok$/i,/^rings_nok$/i,/shape/i,/perimeter/i,/objectid/i,/_i$/i],b=function(e,t){var r=t.editFieldsInfo,a=t.objectIdField,n=t.visibleFieldNames;return n?n.has(e.name):!f(e.name,r)&&(!a||e.name!==a)&&!(u.indexOf(e.type)>-1)&&!d.some((function(t){return t.test(e.name)}))};function y(e,t){return"oid"===e.type?-1:"oid"===t.type?1:j(e)?-1:j(t)?1:(e.alias||e.name).toLocaleLowerCase().localeCompare((t.alias||t.name).toLocaleLowerCase())}function f(e,t){if(!e||!t)return!1;var r=t.creationDateField,a=t.creatorField,n=t.editDateField,i=t.editorField;return-1!==[r&&r.toLowerCase(),a&&a.toLowerCase(),n&&n.toLowerCase(),i&&i.toLowerCase()].indexOf(e.toLowerCase())}function h(e,t){return e.editable&&-1===l.indexOf(e.type)&&!f(e.name,t)}function v(e,t){var r=e.editFieldsInfo,a=e.fields,n=e.objectIdField;return function(e,t){var r=e;return t&&(e=e.filter((function(e){return-1===t.indexOf(e.type)}))),e===r&&(e=e.slice()),e.sort(y),e}(a,(null==t?void 0:t.ignoreFieldTypes)||m).map((function(e){return new o.a({fieldName:e.name,isEditable:h(e,r),label:e.alias,format:O(e),visible:b(e,{editFieldsInfo:r,objectIdField:n,visibleFieldNames:null==t?void 0:t.visibleFieldNames})})}))}function O(e){switch(e.type){case"small-integer":case"integer":case"single":return new i.a({digitSeparator:!0,places:0});case"double":return new i.a({digitSeparator:!0,places:2});case"date":return new i.a({dateFormat:"long-month-day-year"});default:return null}}function j(e){return"name"===(e.name&&e.name.toLowerCase())||("name"===(e.alias&&e.alias.toLowerCase())||void 0)}var m=["geometry","blob","raster","guid","xml"]},816:function(e,t,r){"use strict";var a=r(2),n=r(3),i=r(5),o=r(6),s=r(0),c=(r(13),r(24)),u=(r(14),r(15),r(1)),l=r(50),p=r(8),d=r(47),b=(r(11),r(19),r(20),r(28)),y=new l.a({esriFeatureEditToolAutoCompletePolygon:"auto-complete-polygon",esriFeatureEditToolCircle:"circle",esriFeatureEditToolEllipse:"ellipse",esriFeatureEditToolFreehand:"freehand",esriFeatureEditToolLine:"line",esriFeatureEditToolNone:"none",esriFeatureEditToolPoint:"point",esriFeatureEditToolPolygon:"polygon",esriFeatureEditToolRectangle:"rectangle",esriFeatureEditToolArrow:"arrow",esriFeatureEditToolTriangle:"triangle",esriFeatureEditToolLeftArrow:"left-arrow",esriFeatureEditToolRightArrow:"right-arrow",esriFeatureEditToolUpArrow:"up-arrow",esriFeatureEditToolDownArrow:"down-arrow"}),f=function(e){Object(i.a)(r,e);var t=Object(o.a)(r);function r(e){var n;return Object(a.a)(this,r),(n=t.call(this,e)).name=null,n.description=null,n.drawingTool=null,n.prototype=null,n.thumbnail=null,n}return Object(n.a)(r,[{key:"writeDrawingTool",value:function(e,t){t.drawingTool=y.toJSON(e)}},{key:"writePrototype",value:function(e,t){t.prototype=Object(c.c)(Object(c.a)(e),!0)}},{key:"writeThumbnail",value:function(e,t){t.thumbnail=Object(c.c)(Object(c.a)(e))}}]),r}(b.a);Object(s.a)([Object(u.b)({json:{write:!0}})],f.prototype,"name",void 0),Object(s.a)([Object(u.b)({json:{write:!0}})],f.prototype,"description",void 0),Object(s.a)([Object(u.b)({json:{read:y.read,write:y.write}})],f.prototype,"drawingTool",void 0),Object(s.a)([Object(d.a)("drawingTool")],f.prototype,"writeDrawingTool",null),Object(s.a)([Object(u.b)({json:{write:!0}})],f.prototype,"prototype",void 0),Object(s.a)([Object(d.a)("prototype")],f.prototype,"writePrototype",null),Object(s.a)([Object(u.b)({json:{write:!0}})],f.prototype,"thumbnail",void 0),Object(s.a)([Object(d.a)("thumbnail")],f.prototype,"writeThumbnail",null);var h=f=Object(s.a)([Object(p.a)("esri.layers.support.FeatureTemplate")],f);t.a=h},817:function(e,t,r){"use strict";var a,n=r(2),i=r(3),o=r(5),s=r(6),c=r(0),u=(r(13),r(14),r(15),r(1)),l=r(8),p=(r(11),r(19),r(20),r(800)),d=a=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var a;return Object(n.a)(this,r),(a=t.call(this,e)).type="selection",a}return Object(i.a)(r,[{key:"clone",value:function(){return new a}}]),r}(p.a);Object(c.a)([Object(u.b)({type:["selection"]})],d.prototype,"type",void 0);var b=d=a=Object(c.a)([Object(l.a)("esri.layers.support.FeatureReductionSelection")],d);t.a=b},818:function(e,t,r){"use strict";var a,n=r(2),i=r(3),o=r(5),s=r(6),c=r(0),u=(r(13),r(24)),l=(r(14),r(15),r(1)),p=r(8),d=(r(11),r(19),r(20),r(28)),b=r(276),y=r(36),f=r(787),h=a=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(){var e;return Object(n.a)(this,r),(e=t.apply(this,arguments)).statisticType=null,e.onStatisticField=null,e.onStatisticValueExpression=null,e}return Object(i.a)(r,[{key:"clone",value:function(){return new a({statisticType:this.statisticType,onStatisticField:this.onStatisticField,onStatisticValueExpression:this.onStatisticValueExpression})}}]),r}(d.a);Object(c.a)([Object(l.b)({type:String,json:{write:!0}})],h.prototype,"statisticType",void 0),Object(c.a)([Object(l.b)({type:String,json:{write:!0}})],h.prototype,"onStatisticField",void 0),Object(c.a)([Object(l.b)({type:String,json:{write:!0}})],h.prototype,"onStatisticValueExpression",void 0);var v,O=h=a=Object(c.a)([Object(p.a)("esri.layers.support.OutStatistic")],h),j=v=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(){var e;return Object(n.a)(this,r),(e=t.apply(this,arguments)).name=null,e}return Object(i.a)(r,[{key:"clone",value:function(){return new v({name:this.name,outStatistic:this.outStatistic.clone()})}}]),r}(d.a);Object(c.a)([Object(l.b)({type:String,json:{write:!0}})],j.prototype,"name",void 0),Object(c.a)([Object(l.b)({type:O,json:{write:!0}})],j.prototype,"outStatistic",void 0);var m,g=j=v=Object(c.a)([Object(p.a)("esri.layers.support.AggregateField")],j),w=r(793),x=m=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var a;return Object(n.a)(this,r),(a=t.call(this,e)).type="cluster",a.clusterRadius=Object(y.j)("80px"),a.clusterMinSize=Object(y.j)("12px"),a.clusterMaxSize=Object(y.j)("50px"),a.popupEnabled=!0,a.popupTemplate=null,a.labelingInfo=null,a.labelsVisible=!0,a.fields=null,a}return Object(i.a)(r,[{key:"clone",value:function(){return new m({clusterRadius:this.clusterRadius,clusterMinSize:this.clusterMinSize,clusterMaxSize:this.clusterMaxSize,labelingInfo:Object(u.a)(this.labelingInfo),labelsVisible:this.labelsVisible,fields:Object(u.a)(this.fields),popupEnabled:this.popupEnabled,popupTemplate:Object(u.a)(this.popupTemplate)})}}]),r}(d.a);Object(c.a)([Object(l.b)({type:["cluster"],readOnly:!0,json:{write:!0}})],x.prototype,"type",void 0),Object(c.a)([Object(l.b)({type:Number,cast:function(e){return"auto"===e?e:Object(y.j)(e)},json:{write:!0}})],x.prototype,"clusterRadius",void 0),Object(c.a)([Object(l.b)({type:Number,cast:y.j,json:{write:!0}})],x.prototype,"clusterMinSize",void 0),Object(c.a)([Object(l.b)({type:Number,cast:y.j,json:{write:!0}})],x.prototype,"clusterMaxSize",void 0),Object(c.a)([Object(l.b)(f.g)],x.prototype,"popupEnabled",void 0),Object(c.a)([Object(l.b)({type:b.a,json:{read:{source:"popupInfo"},write:{target:"popupInfo"}}})],x.prototype,"popupTemplate",void 0),Object(c.a)([Object(l.b)({type:[w.a],json:{read:{source:"drawingInfo.labelingInfo"},write:{target:"drawingInfo.labelingInfo"}}})],x.prototype,"labelingInfo",void 0),Object(c.a)([Object(l.b)(f.c)],x.prototype,"labelsVisible",void 0),Object(c.a)([Object(l.b)({type:[g],json:{write:!0}})],x.prototype,"fields",void 0);var S=x=m=Object(c.a)([Object(p.a)("esri.layers.support.FeatureReductionCluster")],x);t.a=S},820:function(e,t,r){"use strict";r.d(t,"a",(function(){return S})),r.d(t,"b",(function(){return h})),r.d(t,"c",(function(){return v})),r.d(t,"d",(function(){return O})),r.d(t,"e",(function(){return j})),r.d(t,"f",(function(){return w})),r.d(t,"g",(function(){return f}));var a=r(12),n=r(32),i=r(174),o=r(4),s=r(14),c=r(52),u=r(75),l=r(305),p=r(794),d=s.a.getLogger("esri.renderers.visualVariables.support.visualVariableUtils"),b=new u.a,y=Math.PI,f=/^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i;function h(e,t,r){var a="visualVariables"in e&&e.visualVariables?e.visualVariables.filter((function(e){return"color"===e.type}))[0]:e;if(a)if("esri.renderers.visualVariables.ColorVariable"===a.declaredClass){var n="number"==typeof t,i=n?null:t,s=i&&i.attributes,u=n?t:null,l=a.field,p=a.cache,b=p.ipData,y=p.hasExpression,f=a.cache.compiledFunc;if(!l&&!y){var h=a.stops;return h&&h[0]&&h[0].color}if("number"!=typeof u)if(y){if(!Object(o.i)(r)||!Object(o.i)(r.arcade))return void d.error("Use of arcade expressions requires an arcade context");var v={viewingMode:r.viewingMode,scale:r.scale,spatialReference:r.spatialReference},O=r.arcade.arcadeUtils,j=O.getViewInfo(v),m=O.createExecContext(i,j);if(!f){var g=O.createSyntaxTree(a.valueExpression);f=O.createFunction(g),a.cache.compiledFunc=f}u=O.executeFunction(f,m)}else s&&(u=s[l]);var w=a.normalizationField,S=s?parseFloat(s[w]):void 0;if(null!=u&&(!w||n||!isNaN(S)&&0!==S)){isNaN(S)||n||(u/=S);var k=x(u,b);if(k){var I=k[0],F=k[1],_=I===F?a.stops[I].color:c.a.blendColors(a.stops[I].color,a.stops[F].color,k[2],Object(o.i)(r)?r.color:void 0);return new c.a(_)}}}else d.warn("The visualVariable should be an instance of esri.renderers.visualVariables.ColorVariable")}function v(e,t,r){var a="visualVariables"in e&&e.visualVariables?e.visualVariables.filter((function(e){return"opacity"===e.type}))[0]:e;if(a)if("esri.renderers.visualVariables.OpacityVariable"===a.declaredClass){var n="number"==typeof t,i=n?null:t,s=i&&i.attributes,c=n?t:null,u=a.field,l=a.cache,p=l.ipData,b=l.hasExpression,y=a.cache.compiledFunc;if(!u&&!b){var f=a.stops;return f&&f[0]&&f[0].opacity}if("number"!=typeof c)if(b){if(Object(o.h)(r)||Object(o.h)(r.arcade))return void d.error("Use of arcade expressions requires an arcade context");var h={viewingMode:r.viewingMode,scale:r.scale,spatialReference:r.spatialReference},v=r.arcade.arcadeUtils,O=v.getViewInfo(h),j=v.createExecContext(i,O);if(!y){var m=v.createSyntaxTree(a.valueExpression);y=v.createFunction(m),a.cache.compiledFunc=y}c=v.executeFunction(y,j)}else s&&(c=s[u]);var g=a.normalizationField,w=s?parseFloat(s[g]):void 0;if(null!=c&&(!g||n||!isNaN(w)&&0!==w)){isNaN(w)||n||(c/=w);var S=x(c,p);if(S){var k=S[0],I=S[1];if(k===I)return a.stops[k].opacity;var F=a.stops[k].opacity;return F+(a.stops[I].opacity-F)*S[2]}}}else d.warn("The visualVariable should be an instance of esri.renderers.visualVariables.OpacityVariable")}function O(e,t,r){var a="visualVariables"in e&&e.visualVariables?e.visualVariables.filter((function(e){return"rotation"===e.type}))[0]:e;if(a){if("esri.renderers.visualVariables.RotationVariable"===a.declaredClass){var n=a.axis||"heading",i="heading"===n&&"arithmetic"===a.rotationType?90:0,s="heading"===n&&"arithmetic"===a.rotationType?-1:1,c="number"==typeof t?null:t,u=c&&c.attributes,l=a.field,p=a.cache.hasExpression,b=a.cache.compiledFunc,y=0;if(!l&&!p)return y;if(p){if(Object(o.h)(r)||Object(o.h)(r.arcade))return void d.error("Use of arcade expressions requires an arcade context");var f={viewingMode:r.viewingMode,scale:r.scale,spatialReference:r.spatialReference},h=r.arcade.arcadeUtils,v=h.getViewInfo(f),O=h.createExecContext(c,v);if(!b){var j=h.createSyntaxTree(a.valueExpression);b=h.createFunction(j),a.cache.compiledFunc=b}y=h.executeFunction(b,O)}else u&&(y=u[l]||0);return y="number"!=typeof y||isNaN(y)?null:i+s*y}d.warn("The visualVariable should be an instance of esri.renderers.visualVariables.RotationVariable")}}function j(e,t,r){var a="visualVariables"in e&&e.visualVariables?e.visualVariables.filter((function(e){return"size"===e.type}))[0]:e;if(a){if("esri.renderers.visualVariables.SizeVariable"===a.declaredClass){var i=function(e,t,r,a,i){switch(t.transformationType){case"additive":return function(e,t,r,a){return e+(m(t.minSize,r,a)||t.minDataValue)}(e,t,r,a);case"constant":return function(e,t,r){var a=e.stops,n=a&&a.length&&a[0].size;return null==n&&(n=e.minSize),m(n,t,r)}(t,r,a);case"clamped-linear":return function(e,t,r,a){var n=(e-t.minDataValue)/(t.maxDataValue-t.minDataValue),i=m(t.minSize,r,a),s=m(t.maxSize,r,a),c=Object(o.i)(a)?a.shape:void 0;if(e<=t.minDataValue)return i;if(e>=t.maxDataValue)return s;if("area"===t.scaleBy&&c){var u="circle"===c,l=u?y*Math.pow(i/2,2):i*i,p=l+n*((u?y*Math.pow(s/2,2):s*s)-l);return u?2*Math.sqrt(p/y):Math.sqrt(p)}return i+n*(s-i)}(e,t,r,a);case"proportional":return function(e,t,r,a){var n=Object(o.i)(a)?a.shape:void 0,i=e/t.minDataValue,s=m(t.minSize,r,a),c=m(t.maxSize,r,a);return g("circle"===n?2*Math.sqrt(i*Math.pow(s/2,2)):"square"===n||"diamond"===n||"image"===n?Math.sqrt(i*Math.pow(s,2)):i*s,s,c)}(e,t,r,a);case"stops":return function(e,t,r,a,i){var o=x(e,i),s=Object(n.a)(o,3),c=s[0],u=s[1],l=s[2];if(c===u)return m(t.stops[c].size,r,a);var p=m(t.stops[c].size,r,a);return p+(m(t.stops[u].size,r,a)-p)*l}(e,t,r,a,i);case"real-world-size":return function(e,t,r,a){var n=(Object(o.i)(a)&&a.resolution?a.resolution:1)*l.a[t.valueUnit],i=m(t.minSize,r,a),s=m(t.maxSize,r,a),c=t.valueRepresentation;return g("area"===c?2*Math.sqrt(e/y)/n:"radius"===c||"distance"===c?2*e/n:e/n,i,s)}(e,t,r,a);case"identity":return e;case"unknown":return null}}(function(e,t,r){var a="number"==typeof t,n=a?null:t,i=n&&n.attributes,s=a?t:null,c=e.cache.isScaleDriven,u=e.cache.compiledFunc;if(c){var l=Object(o.i)(r)?r.scale:void 0,b=Object(o.i)(r)?r.view:void 0;s=null==l||"3d"===b?function(e){var t=null,r=null,a=e.stops;return a?(t=a[0].value,r=a[a.length-1].value):(t=e.minDataValue||0,r=e.maxDataValue||0),(t+r)/2}(e):l}else if(!a)switch(e.inputValueType){case"expression":if(Object(o.h)(r)||Object(o.h)(r.arcade))return void d.error("Use of arcade expressions requires an arcade context");var y={viewingMode:r.viewingMode,scale:r.scale,spatialReference:r.spatialReference},f=r.arcade.arcadeUtils,h=f.getViewInfo(y),v=f.createExecContext(n,h);if(!u){var O=f.createSyntaxTree(e.valueExpression);u=f.createFunction(O),e.cache.compiledFunc=u}s=f.executeFunction(u,v);break;case"field":i&&(s=i[e.field]);break;case"unknown":s=null}if(!Object(p.d)(s))return null;if(a||!e.normalizationField)return s;var j=i?parseFloat(i[e.normalizationField]):null;return Object(p.d)(j)&&0!==j?s/j:null}(a,t,r),a,t,r,a.cache.ipData);return null==i||isNaN(i)?0:i}d.warn("The visualVariable should be an instance of esri.renderers.visualVariables.SizeVariable")}}function m(e,t,r){return null==e?null:Object(p.c)(e)?j(e,t,r):Object(p.d)(e)?e:null}function g(e,t,r){return Object(p.d)(r)&&e>r?r:Object(p.d)(t)&&e<t?t:e}function w(e,t,r){if(!(e.cache.isScaleDriven&&"3d"===r||t))return null;var a={scale:t,view:r},n=m(e.minSize,b,a),i=m(e.maxSize,b,a);if(null!=n||null!=i){if(n>i){var o=i;i=n,n=o}return{minSize:n,maxSize:i}}}function x(e,t){if(t){var r=0,a=t.length-1;return t.some((function(t,n){return e<t?(a=n,!0):(r=n,!1)})),[r,a,(e-t[r])/(t[a]-t[r])]}}function S(e,t,r){var n,o=["proportional","proportional","proportional"],s=Object(a.a)(e);try{for(s.s();!(n=s.n()).done;){var c=n.value,u=c.useSymbolValue?"symbol-value":j(c,t,r);switch(c.axis){case"width":o[0]=u;break;case"depth":o[1]=u;break;case"height":o[2]=u;break;case"width-and-depth":o[0]=u,o[1]=u;break;case"all":case void 0:case null:o[0]=u,o[1]=u,o[2]=u;break;default:Object(i.a)(c.axis)}}}catch(l){s.e(l)}finally{s.f()}return o}},825:function(e,t,r){"use strict";r.d(t,"a",(function(){return h}));var a=r(2),n=r(3),i=r(5),o=r(6),s=r(0),c=(r(13),r(14),r(15),r(1)),u=r(63),l=r(8),p=(r(11),r(19),r(20),r(157)),d=r(173),b=r(304),y=r(797),f=r(807);var h=function(e){var t=function(e){Object(i.a)(r,e);var t=Object(o.a)(r);function r(){var e;return Object(a.a)(this,r),(e=t.apply(this,arguments)).timeExtent=null,e.timeOffset=null,e.useViewTime=!0,e}return Object(n.a)(r,[{key:"readOffset",value:function(e,t){var r=t.timeInfo.exportOptions;if(!r)return null;var a=r.timeOffset,n=d.d.fromJSON(r.timeOffsetUnits);return a&&n?new y.a({value:a,unit:n}):null}},{key:"timeInfo",set:function(e){Object(p.k)(e,this.fields),this._set("timeInfo",e)}}]),r}(e);return Object(s.a)([Object(c.b)({type:b.a,json:{write:!1}})],t.prototype,"timeExtent",void 0),Object(s.a)([Object(c.b)({type:y.a})],t.prototype,"timeOffset",void 0),Object(s.a)([Object(u.a)("service","timeOffset",["timeInfo.exportOptions"])],t.prototype,"readOffset",null),Object(s.a)([Object(c.b)({value:null,type:f.a,json:{write:!0,origins:{"web-document":{read:!1,write:!1}}}})],t.prototype,"timeInfo",null),Object(s.a)([Object(c.b)({type:Boolean,json:{read:{source:"timeAnimation"},write:{target:"timeAnimation"},origins:{"web-scene":{read:!1,write:!1}}}})],t.prototype,"useViewTime",void 0),t=Object(s.a)([Object(l.a)("esri.layers.mixins.TemporalLayer")],t),t}},826:function(e,t,r){"use strict";r.r(t);var a,n=r(12),i=r(10),o=r.n(i),s=r(21),c=r(9),u=r(2),l=r(3),p=r(61),d=r(55),b=r(5),y=r(6),f=r(0),h=r(13),v=r(99),O=r(4),j=r(14),m=r(1),g=r(73),w=r(50),x=r(63),S=r(232),k=r(8),I=r(47),F=r(23),_=r(11),E=(r(19),r(20),r(16)),T=r(44),R=r(62),M=r(40),D=r(157),L=r(276),A=r(81),C=r(149),P=r(56),N=r(243),q=r(795),z=r(385),V=r(233),U=r(787),B=r(809),G=(r(813),r(823),r(832)),Q=(r(862),r(873),r(874),r(861)),J=r(870),W=r(869),$=r(790),K=r(24),Z=r(28),H=r(15),X=a=function(e){Object(b.a)(r,e);var t=Object(y.a)(r);function r(e){var a;return Object(u.a)(this,r),(a=t.call(this,e)).expression=null,a.name=null,a.returnType="boolean",a.title=null,a}return Object(l.a)(r,[{key:"clone",value:function(){return new a({name:this.name,title:this.title,expression:this.expression,returnType:this.returnType})}}]),r}(Z.a);Object(f.a)([Object(m.b)({type:String,json:{write:!0}})],X.prototype,"expression",void 0),Object(f.a)([Object(m.b)({type:String,json:{write:!0}})],X.prototype,"name",void 0),Object(f.a)([Object(m.b)({type:["boolean"],json:{write:!0}})],X.prototype,"returnType",void 0),Object(f.a)([Object(m.b)({type:String,json:{write:!0}})],X.prototype,"title",void 0);var Y,ee=X=a=Object(f.a)([Object(k.a)("esri.form.ExpressionInfo")],X),te=function(e){Object(b.a)(r,e);var t=Object(y.a)(r);function r(e){var a;return Object(u.a)(this,r),(a=t.call(this,e)).type=null,a}return r}(function(e){var t=function(e){Object(b.a)(r,e);var t=Object(y.a)(r);function r(){var e;return Object(u.a)(this,r),(e=t.apply(this,arguments)).description=null,e.label=null,e.visibilityExpression=null,e}return r}(e);return Object(f.a)([Object(m.b)({type:String,json:{write:!0}})],t.prototype,"description",void 0),Object(f.a)([Object(m.b)({type:String,json:{write:!0}})],t.prototype,"label",void 0),Object(f.a)([Object(m.b)({type:String,json:{write:!0}})],t.prototype,"visibilityExpression",void 0),t=Object(f.a)([Object(k.a)("esri.form.elements.ElementMixin")],t),t}(Z.a));Object(f.a)([Object(m.b)()],te.prototype,"type",void 0),te=Object(f.a)([Object(k.a)("esri.form.elements.Element")],te);var re=Y=function(e){Object(b.a)(r,e);var t=Object(y.a)(r);function r(e){var a;return Object(u.a)(this,r),(a=t.call(this,e)).type=null,a}return Object(l.a)(r,[{key:"clone",value:function(){return new Y({type:this.type})}}]),r}(Z.a);Object(f.a)([Object(m.b)({type:["attachment","audio","document","image","signature","video"],json:{write:!0}})],re.prototype,"type",void 0);var ae,ne=re=Y=Object(f.a)([Object(k.a)("esri.form.elements.inputs.AttachmentInput")],re),ie=ae=function(e){Object(b.a)(r,e);var t=Object(y.a)(r);function r(e){var a;return Object(u.a)(this,r),(a=t.call(this,e)).attachmentKeyword=null,a.editable=!0,a.input=null,a.type="attachment",a}return Object(l.a)(r,[{key:"clone",value:function(){return new ae({attachmentKeyword:this.attachmentKeyword,description:this.description,editable:this.editable,input:this.input,label:this.label,visibilityExpression:this.visibilityExpression})}}]),r}(te);Object(f.a)([Object(m.b)({type:String,json:{write:!0}})],ie.prototype,"attachmentKeyword",void 0),Object(f.a)([Object(m.b)({type:Boolean,json:{default:!0,write:!0}})],ie.prototype,"editable",void 0),Object(f.a)([Object(m.b)({type:ne,json:{read:{source:"inputType"},write:{target:"inputType"}}})],ie.prototype,"input",void 0),Object(f.a)([Object(m.b)({type:["attachment"],json:{read:!1,write:!0}})],ie.prototype,"type",void 0);var oe=ie=ae=Object(f.a)([Object(k.a)("esri.form.elements.AttachmentElement")],ie),se=r(212),ce=function(e){Object(b.a)(r,e);var t=Object(y.a)(r);function r(e){var a;return Object(u.a)(this,r),(a=t.call(this,e)).type=null,a}return r}(Z.a);Object(f.a)([Object(m.b)()],ce.prototype,"type",void 0);var ue,le=ce=Object(f.a)([Object(k.a)("esri.form.elements.inputs.Input")],ce),pe=ue=function(e){Object(b.a)(r,e);var t=Object(y.a)(r);function r(e){var a;return Object(u.a)(this,r),(a=t.call(this,e)).type="barcode-scanner",a}return Object(l.a)(r,[{key:"clone",value:function(){return new ue}}]),r}(le);Object(f.a)([Object(m.b)({type:["barcode-scanner"],json:{read:!1,write:!0}})],pe.prototype,"type",void 0);var de,be=pe=ue=Object(f.a)([Object(k.a)("esri.form.elements.inputs.BarcodeScannerInput")],pe),ye=de=function(e){Object(b.a)(r,e);var t=Object(y.a)(r);function r(e){var a;return Object(u.a)(this,r),(a=t.call(this,e)).type="combo-box",a}return Object(l.a)(r,[{key:"clone",value:function(){return new de}}]),r}(le);Object(f.a)([Object(m.b)({type:["combo-box"],json:{read:!1,write:!0}})],ye.prototype,"type",void 0);var fe,he=ye=de=Object(f.a)([Object(k.a)("esri.form.elements.inputs.ComboBoxInput")],ye);function ve(e){return null!=e?new Date(e):null}function Oe(e){return e?e.getTime():null}var je=fe=function(e){Object(b.a)(r,e);var t=Object(y.a)(r);function r(e){var a;return Object(u.a)(this,r),(a=t.call(this,e)).includeTime=!1,a.max=null,a.min=null,a.type="datetime-picker",a}return Object(l.a)(r,[{key:"readMax",value:function(e,t){return ve(t.max)}},{key:"writeMax",value:function(e,t){t.max=Oe(e)}},{key:"readMin",value:function(e,t){return ve(t.min)}},{key:"writeMin",value:function(e,t){t.min=Oe(e)}},{key:"clone",value:function(){return new fe({includeTime:this.includeTime,max:this.max,min:this.min,type:this.type})}}]),r}(le);Object(f.a)([Object(m.b)({type:Boolean,json:{write:!0,default:!1}})],je.prototype,"includeTime",void 0),Object(f.a)([Object(m.b)({type:Date,json:{type:Number,write:!0}})],je.prototype,"max",void 0),Object(f.a)([Object(x.a)("max")],je.prototype,"readMax",null),Object(f.a)([Object(I.a)("max")],je.prototype,"writeMax",null),Object(f.a)([Object(m.b)({type:Date,json:{type:Number,write:!0}})],je.prototype,"min",void 0),Object(f.a)([Object(x.a)("min")],je.prototype,"readMin",null),Object(f.a)([Object(I.a)("min")],je.prototype,"writeMin",null),Object(f.a)([Object(m.b)({type:["datetime-picker"],json:{read:!1,write:!0}})],je.prototype,"type",void 0);var me,ge=je=fe=Object(f.a)([Object(k.a)("esri.form.elements.inputs.DateTimePickerInput")],je),we=me=function(e){Object(b.a)(r,e);var t=Object(y.a)(r);function r(e){var a;return Object(u.a)(this,r),(a=t.call(this,e)).type="radio-buttons",a}return Object(l.a)(r,[{key:"clone",value:function(){return new me}}]),r}(le);Object(f.a)([Object(m.b)({type:["radio-buttons"],json:{read:!1,write:!0}})],we.prototype,"type",void 0);var xe,Se=we=me=Object(f.a)([Object(k.a)("esri.form.elements.inputs.RadioButtonsInput")],we),ke=xe=function(e){Object(b.a)(r,e);var t=Object(y.a)(r);function r(e){var a;return Object(u.a)(this,r),(a=t.call(this,e)).maxLength=null,a.minLength=0,a.type=null,a}return Object(l.a)(r,[{key:"clone",value:function(){return new xe({maxLength:this.maxLength,minLength:this.minLength,type:this.type})}}]),r}(le);Object(f.a)([Object(m.b)({type:Number,json:{write:!0}})],ke.prototype,"maxLength",void 0),Object(f.a)([Object(m.b)({type:Number,json:{default:0,write:!0}})],ke.prototype,"minLength",void 0),Object(f.a)([Object(m.b)()],ke.prototype,"type",void 0);var Ie=ke=xe=Object(f.a)([Object(k.a)("esri.form.elements.inputs.support.TextInput")],ke),Fe=function(e){Object(b.a)(r,e);var t=Object(y.a)(r);function r(e){var a;return Object(u.a)(this,r),(a=t.call(this,e)).type="text-area",a}return r}(Ie);Object(f.a)([Object(m.b)({type:["text-area"],json:{read:!1,write:!0}})],Fe.prototype,"type",void 0);var _e=Fe=Object(f.a)([Object(k.a)("esri.form.elements.inputs.TextAreaInput")],Fe),Ee=function(e){Object(b.a)(r,e);var t=Object(y.a)(r);function r(e){var a;return Object(u.a)(this,r),(a=t.call(this,e)).type="text-box",a}return r}(Ie);Object(f.a)([Object(m.b)({type:["text-box"],json:{read:!1,write:!0}})],Ee.prototype,"type",void 0);var Te,Re={base:le,key:"type",typeMap:{"barcode-scanner":be,"combo-box":he,"datetime-picker":ge,"radio-buttons":Se,"text-area":_e,"text-box":Ee=Object(f.a)([Object(k.a)("esri.form.elements.inputs.TextBoxInput")],Ee)}},Me=Te=function(e){Object(b.a)(r,e);var t=Object(y.a)(r);function r(e){var a;return Object(u.a)(this,r),(a=t.call(this,e)).domain=null,a.editable=!0,a.fieldName=null,a.hint=null,a.input=null,a.requiredExpression=null,a.type="field",a}return Object(l.a)(r,[{key:"clone",value:function(){return new Te({description:this.description,domain:this.domain,editable:this.editable,fieldName:this.fieldName,hint:this.hint,input:this.input,label:this.label,requiredExpression:this.requiredExpression,visibilityExpression:this.visibilityExpression})}}]),r}(te);Object(f.a)([Object(m.b)({types:se.d,json:{read:{reader:se.b},write:!0}})],Me.prototype,"domain",void 0),Object(f.a)([Object(m.b)({type:Boolean,json:{default:!0,write:!0}})],Me.prototype,"editable",void 0),Object(f.a)([Object(m.b)({type:String,json:{write:!0}})],Me.prototype,"fieldName",void 0),Object(f.a)([Object(m.b)({type:String,json:{write:!0}})],Me.prototype,"hint",void 0),Object(f.a)([Object(m.b)({types:Re,json:{read:{source:"inputType"},write:{target:"inputType"}}})],Me.prototype,"input",void 0),Object(f.a)([Object(m.b)({type:String,json:{write:!0}})],Me.prototype,"requiredExpression",void 0),Object(f.a)([Object(m.b)({type:String,json:{read:!1,write:!0}})],Me.prototype,"type",void 0);var De,Le=Me=Te=Object(f.a)([Object(k.a)("esri.form.elements.FieldElement")],Me),Ae=r(389),Ce=De=function(e){Object(b.a)(r,e);var t=Object(y.a)(r);function r(e){var a;return Object(u.a)(this,r),(a=t.call(this,e)).displayCount=null,a.displayType="list",a.editable=!0,a.orderByFields=null,a.relationshipId=null,a.type="relationship",a}return Object(l.a)(r,[{key:"clone",value:function(){return new De({description:this.description,displayCount:this.displayCount,displayType:this.displayType,editable:this.editable,label:this.label,orderByFields:Object(K.a)(this.orderByFields),relationshipId:this.relationshipId,visibilityExpression:this.visibilityExpression})}}]),r}(te);Object(f.a)([Object(m.b)({type:Number,json:{write:!0}})],Ce.prototype,"displayCount",void 0),Object(f.a)([Object(m.b)({type:["list"],json:{write:!0}})],Ce.prototype,"displayType",void 0),Object(f.a)([Object(m.b)({type:Boolean,json:{default:!0,write:!0}})],Ce.prototype,"editable",void 0),Object(f.a)([Object(m.b)({type:[Ae.a],json:{write:!0}})],Ce.prototype,"orderByFields",void 0),Object(f.a)([Object(m.b)({type:Number,json:{write:!0}})],Ce.prototype,"relationshipId",void 0),Object(f.a)([Object(m.b)({type:["relationship"],json:{read:!1,write:!0}})],Ce.prototype,"type",void 0);var Pe,Ne=Ce=De=Object(f.a)([Object(k.a)("esri.form.elements.RelationshipElement")],Ce);function qe(e){return{typesWithGroup:{base:te,key:"type",typeMap:{attachment:oe,field:Le,group:e,relationship:Ne}},typesWithoutGroup:{base:te,key:"type",typeMap:{attachment:oe,field:Le,relationship:Ne}}}}function ze(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!e)return null;var a=r?t.typesWithGroup.typeMap:t.typesWithoutGroup.typeMap;return e.filter((function(e){return a[e.type]})).map((function(e){return a[e.type].fromJSON(e)}))}function Ve(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!e)return null;var a=r?t.typesWithGroup.typeMap:t.typesWithoutGroup.typeMap;return e.filter((function(e){return a[e.type]})).map((function(e){return e.toJSON()}))}function Ue(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return e?e.map((function(e){return Object(H.k)(r?t.typesWithGroup:t.typesWithoutGroup,e)})):null}var Be=Pe=function(e){Object(b.a)(r,e);var t=Object(y.a)(r);function r(e){var a;return Object(u.a)(this,r),(a=t.call(this,e)).elements=null,a.initialState="expanded",a.type="group",a}return Object(l.a)(r,[{key:"castElements",value:function(e){return Ue(e,Qe,!1)}},{key:"readElements",value:function(e,t){return ze(t.formElements,Qe,!1)}},{key:"writeElements",value:function(e,t){t.formElements=Ve(e,Qe,!1)}},{key:"clone",value:function(){return new Pe({description:this.description,elements:Object(K.a)(this.elements),initialState:this.initialState,label:this.label,visibilityExpression:this.visibilityExpression})}}]),r}(te);Object(f.a)([Object(m.b)({json:{write:!0}})],Be.prototype,"elements",void 0),Object(f.a)([Object(g.a)("elements")],Be.prototype,"castElements",null),Object(f.a)([Object(x.a)("elements",["formElements"])],Be.prototype,"readElements",null),Object(f.a)([Object(I.a)("elements")],Be.prototype,"writeElements",null),Object(f.a)([Object(m.b)({type:["collapsed","expanded"],json:{default:"expanded",write:!0}})],Be.prototype,"initialState",void 0),Object(f.a)([Object(m.b)({type:String,json:{read:!1,write:!0}})],Be.prototype,"type",void 0);var Ge,Qe=qe(Be=Pe=Object(f.a)([Object(k.a)("esri.form.elements.GroupElement")],Be)),Je=qe(Be),We=Ge=function(e){Object(b.a)(r,e);var t=Object(y.a)(r);function r(e){var a;return Object(u.a)(this,r),(a=t.call(this,e)).description=null,a.elements=null,a.expressionInfos=null,a.title=null,a}return Object(l.a)(r,[{key:"castElements",value:function(e){return Ue(e,Je)}},{key:"readElements",value:function(e,t){return ze(t.formElements,Je)}},{key:"writeElements",value:function(e,t){t.formElements=Ve(e,Je)}},{key:"clone",value:function(){return new Ge({description:this.description,expressionInfos:Object(K.a)(this.expressionInfos),elements:Object(K.a)(this.elements),title:this.title})}}]),r}(Z.a);Object(f.a)([Object(m.b)({type:String,json:{write:!0}})],We.prototype,"description",void 0),Object(f.a)([Object(m.b)({json:{write:!0}})],We.prototype,"elements",void 0),Object(f.a)([Object(g.a)("elements")],We.prototype,"castElements",null),Object(f.a)([Object(x.a)("elements",["formElements"])],We.prototype,"readElements",null),Object(f.a)([Object(I.a)("elements")],We.prototype,"writeElements",null),Object(f.a)([Object(m.b)({type:[ee],json:{write:!0}})],We.prototype,"expressionInfos",void 0),Object(f.a)([Object(m.b)({type:String,json:{write:!0}})],We.prototype,"title",void 0);var $e=We=Ge=Object(f.a)([Object(k.a)("esri.form.FormTemplate")],We),Ke=r(362);var Ze,He=r(82),Xe=r(197),Ye=(r(77),r(211)),et=r(135),tt=r(75),rt=r(383),at=r(311),nt=r(390),it=0,ot=j.a.getLogger("esri.layers.graphics.sources.MemorySource"),st=function(e){Object(b.a)(r,e);var t=Object(y.a)(r);function r(e){var a;return Object(u.a)(this,r),(a=t.call(this,e))._idToClientGraphic=null,a.type="memory",a}return Object(l.a)(r,[{key:"load",value:function(e){var t=Object(O.i)(e)?e.signal:null;return this.addResolvingPromise(this._startWorker(t)),Object(E.u)(this)}},{key:"destroy",value:function(){var e;null==(e=this._connection)||e.close(),this._connection=null}},{key:"workerGeometryType",get:function(){var e=this.layer&&this.layer.geometryType;return e?this._geometryTypeRequiresClientGraphicMapping(e)?"polygon":e:null}},{key:"applyEdits",value:function(e){var t=this;return this.load().then((function(){return t._applyEdits(e)}))}},{key:"openPorts",value:function(){var e=this;return this.load().then((function(){return e._connection.openPorts()}))}},{key:"queryFeatures",value:function(){var e=Object(s.a)(o.a.mark((function e(t){var r,a,i,s,c,u,l,p,d,b=arguments;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=b.length>1&&void 0!==b[1]?b[1]:{},e.next=3,this.load(r);case 3:return e.next=5,this._connection.invoke("queryFeatures",t?t.toJSON():null,r);case 5:if(a=e.sent,Object(nt.a)(t,this.layer.spatialReference,a),i=Ke.default.fromJSON(a),this._requiresClientGraphicMapping()){e.next=10;break}return e.abrupt("return",i);case 10:s=this.layer.objectIdField,c=Object(n.a)(i.features);try{for(c.s();!(u=c.n()).done;)l=u.value,p=l.attributes[s],(d=this._idToClientGraphic.get(p))&&(l.geometry=d.geometry)}catch(o){c.e(o)}finally{c.f()}return e.abrupt("return",(i.geometryType=this.layer.geometryType,i));case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"queryFeaturesJSON",value:function(){var e=Object(s.a)(o.a.mark((function e(t){var r,a,n=arguments;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.length>1&&void 0!==n[1]?n[1]:{},!this._requiresClientGraphicMapping()){e.next=3;break}return e.abrupt("return",Object(E.t)(new F.a("query-features-json:unsupported","Cannot query in JSON format for client only geometry types (mesh and extent)")));case 3:return e.next=5,this.load(r);case 5:return e.next=7,this._connection.invoke("queryFeatures",t?t.toJSON():null,r);case 7:return a=e.sent,e.abrupt("return",(Object(nt.a)(t,this.layer.spatialReference,a),a));case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"queryFeatureCount",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.load(r).then((function(){return t._connection.invoke("queryFeatureCount",e?e.toJSON():null,r)}))}},{key:"queryObjectIds",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.load(r).then((function(){return t._connection.invoke("queryObjectIds",e?e.toJSON():null,r)}))}},{key:"queryExtent",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.load(r).then((function(){return t._connection.invoke("queryExtent",e?e.toJSON():null,r)})).then((function(e){return{count:e.count,extent:R.a.fromJSON(e.extent)}}))}},{key:"_applyEdits",value:function(e){var t=this;if(!this._connection)throw new F.a("feature-layer-source:edit-failure","Memory source not loaded");var r=this.layer.objectIdField,a=null,i=[],o=[],s=function(e){return"objectId"in e&&null!=e.objectId?e.objectId:"attributes"in e&&null!=e.attributes[r]?e.attributes[r]:null};if(e.addFeatures&&(a=this._prepareAddFeatures(e.addFeatures)),e.deleteFeatures){var c,u=Object(n.a)(e.deleteFeatures);try{for(u.s();!(c=u.n()).done;){var l=s(c.value);null!=l&&i.push(l)}}catch(h){u.e(h)}finally{u.f()}}var p=e.updateFeatures&&this._idToClientGraphic?new Map:null;if(e.updateFeatures){var d,b=Object(n.a)(e.updateFeatures);try{for(b.s();!(d=b.n()).done;){var y=d.value;if(o.push(this._serializeFeature(y)),p){var f=s(y);null!=f&&p.set(f,y)}}}catch(h){b.e(h)}finally{b.f()}}return Object(at.b)(a?a.features:null,o,this.layer.spatialReference),this._connection.invoke("applyEdits",{adds:a?a.features:[],updates:o,deletes:i}).then((function(e){var r=e.fullExtent,i=e.featureEditResults;if(t.fullExtent=r,a&&a.finish(i.uidToObjectId),t._idToClientGraphic){if(p){var o,s=Object(n.a)(i.updateResults);try{for(s.s();!(o=s.n()).done;){var c=o.value;if(c.success){var u=p.get(c.objectId);null!=u&&t._addIdToClientGraphic(u)}}}catch(h){s.e(h)}finally{s.f()}}var l,d=Object(n.a)(i.deleteResults);try{for(d.s();!(l=d.n()).done;){var b=l.value;b.success&&t._idToClientGraphic.delete(b.objectId)}}catch(h){d.e(h)}finally{d.f()}}return t._createEditsResult(i)}))}},{key:"_createEditsResult",value:function(e){return{addFeatureResults:e.addResults?e.addResults.map(this._createFeatureEditResult,this):[],updateFeatureResults:e.updateResults?e.updateResults.map(this._createFeatureEditResult,this):[],deleteFeatureResults:e.deleteResults?e.deleteResults.map(this._createFeatureEditResult,this):[],addAttachmentResults:[],updateAttachmentResults:[],deleteAttachmentResults:[]}}},{key:"_createFeatureEditResult",value:function(e){var t=!0===e.success?null:e.error||{code:void 0,description:void 0};return{objectId:e.objectId,globalId:e.globalId,error:t?new F.a("feature-layer-source:edit-failure",t.description,{code:t.code}):null}}},{key:"_prepareAddFeatures",value:function(e){for(var t=new Map,r=new Array(e.length),a=null,n=0;n<e.length;n++){var i=e[n],o=this._serializeFeature(i);!a&&Object(O.i)(i.geometry)&&(a=i.geometry.type),r[n]=o,t.set("".concat(o.uid),i)}var s=this;return{features:r,inferredGeometryType:a,finish:function(e){var r=s.sourceJSON.objectIdField;for(var a in e){var n=e[a],i=t.get(a);i&&(i.attributes||(i.attributes={}),-1===n?delete i.attributes[r]:i.attributes[r]=n,s._addIdToClientGraphic(i))}}}}},{key:"_addIdToClientGraphic",value:function(e){if(this._idToClientGraphic){var t=this.sourceJSON.objectIdField,r=e.attributes&&e.attributes[t];null!=r&&this._idToClientGraphic.set(r,e)}}},{key:"_requiresClientGraphicMapping",value:function(){var e=this.layer.geometryType||this.sourceJSON.geometryType;return this._geometryTypeRequiresClientGraphicMapping(e)}},{key:"_geometryRequiresClientGraphicMapping",value:function(e){return this._geometryTypeRequiresClientGraphicMapping(e.type)}},{key:"_geometryTypeRequiresClientGraphicMapping",value:function(e){return"mesh"===e||"multipatch"===e||"extent"===e}},{key:"_serializeFeature",value:function(e){var t=e.attributes,r=this._geometryForSerialization(e),a=(it++).toString();return r?{uid:a,geometry:r.toJSON(),attributes:t}:{uid:a,attributes:t}}},{key:"_geometryForSerialization",value:function(e){var t=e.geometry;return Object(O.h)(t)?null:this._geometryRequiresClientGraphicMapping(t)?t.extent?He.a.fromExtent(t.extent):null:t}},{key:"_startWorker",value:function(){var e=Object(s.a)(o.a.mark((function e(t){var r,a,i,s,c,u,l,p,d,b,y,f,v,O,j;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(rt.b)("MemorySourceWorker",{strategy:Object(h.a)("feature-layers-workers")?"dedicated":"local",signal:t});case 2:return this._connection=e.sent,r=this.layer,a=r.fields,i=r.spatialReference,s=r.objectIdField,c=r.hasM,u=r.hasZ,l=r.timeInfo,p="defaults"===this.layer.originOf("spatialReference"),d=this._prepareAddFeatures(this.items),this.on("before-changes",(function(e){ot.error("Source modifications will not propagate after layer has been loaded. Please use .applyEdits() instead"),e.preventDefault()})),b={features:d.features,fields:a&&a.map((function(e){return e.toJSON()})),geometryType:Xe.c.toJSON(this.workerGeometryType),hasM:c,hasZ:u,objectIdField:s,spatialReference:p?null:i&&i.toJSON(),timeInfo:l?l.toJSON():null},e.next=8,this._connection.invoke("load",b,{signal:t});case 8:y=e.sent,f=Object(n.a)(y.warnings);try{for(f.s();!(v=f.n()).done;)O=v.value,ot.warn(O.message,{layer:this.layer,warning:O})}catch(o){f.e(o)}finally{f.f()}y.featureErrors.length&&ot.warn("Encountered ".concat(y.featureErrors.length," validation errors while loading features"),y.featureErrors),j=y.layerDefinition,this._geometryTypeRequiresClientGraphicMapping(d.inferredGeometryType)&&(j.geometryType=Xe.c.toJSON(d.inferredGeometryType)),"mesh"!==j.geometryType&&"mesh"!==this.layer.geometryType||(j.hasZ=!0),this.sourceJSON=j,this._requiresClientGraphicMapping()&&(this._idToClientGraphic=new Map),d.finish(y.assignedObjectIds);case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),r}(et.a.LoadableMixin(Object(Ye.b)(M.a)));Object(f.a)([(Ze={Type:tt.a,ensureType:Object(H.m)(tt.a)},function(e,t){e[t]=Ze})],st.prototype,"itemType",void 0),Object(f.a)([Object(m.b)()],st.prototype,"type",void 0),Object(f.a)([Object(m.b)({constructOnly:!0})],st.prototype,"layer",void 0),Object(f.a)([Object(m.b)({readOnly:!0,dependsOn:["layer.geometryType"]})],st.prototype,"workerGeometryType",null),Object(f.a)([Object(m.b)()],st.prototype,"sourceJSON",void 0);var ct,ut=st=Object(f.a)([Object(k.a)("esri.layers.graphics.sources.MemorySource")],st),lt=r(866),pt=r(380),dt=r(845),bt=r(802),yt=r(801),ft=r(379),ht=r(807),vt=r(825),Ot=ct=function(e){Object(b.a)(r,e);var t=Object(y.a)(r);function r(e){return Object(u.a)(this,r),t.call(this,e)}return Object(l.a)(r,[{key:"clone",value:function(){var e=this.name,t=this.fields,r=this.isAscending,a=this.isUnique,n=this.description;return new ct({name:e,fields:t,isAscending:r,isUnique:a,description:n})}}]),r}(Z.a);Object(f.a)([Object(m.b)({constructOnly:!0})],Ot.prototype,"name",void 0),Object(f.a)([Object(m.b)({constructOnly:!0})],Ot.prototype,"fields",void 0),Object(f.a)([Object(m.b)({constructOnly:!0})],Ot.prototype,"isAscending",void 0),Object(f.a)([Object(m.b)({constructOnly:!0})],Ot.prototype,"isUnique",void 0),Object(f.a)([Object(m.b)({constructOnly:!0})],Ot.prototype,"description",void 0);Ot=ct=Object(f.a)([Object(k.a)("esri.layers.support.FeatureIndex")],Ot);var jt=r(800),mt=r(793),gt=r(818),wt=r(817),xt=r(871),St=r(816),kt=r(836),It=r(858),Ft=r(863),_t=new w.a({esriRelCardinalityOneToOne:"one-to-one",esriRelCardinalityOneToMany:"one-to-many",esriRelCardinalityManyToMany:"many-to-many"}),Et=new w.a({esriRelRoleOrigin:"origin",esriRelRoleDestination:"destination"}),Tt=function(e){Object(b.a)(r,e);var t=Object(y.a)(r);function r(e){var a;return Object(u.a)(this,r),(a=t.call(this,e)).cardinality=null,a.composite=null,a.id=null,a.keyField=null,a.keyFieldInRelationshipTable=null,a.name=null,a.relatedTableId=null,a.relationshipTableId=null,a.role=null,a}return r}(Z.a);Object(f.a)([Object(m.b)({json:{read:_t.read,write:_t.write}})],Tt.prototype,"cardinality",void 0),Object(f.a)([Object(m.b)({json:{read:!0,write:!0}})],Tt.prototype,"composite",void 0),Object(f.a)([Object(m.b)({json:{read:!0,write:!0}})],Tt.prototype,"id",void 0),Object(f.a)([Object(m.b)({json:{read:!0,write:!0}})],Tt.prototype,"keyField",void 0),Object(f.a)([Object(m.b)({json:{read:!0,write:!0}})],Tt.prototype,"keyFieldInRelationshipTable",void 0),Object(f.a)([Object(m.b)({json:{read:!0,write:!0}})],Tt.prototype,"name",void 0),Object(f.a)([Object(m.b)({json:{read:!0,write:!0}})],Tt.prototype,"relatedTableId",void 0),Object(f.a)([Object(m.b)({json:{read:!0,write:!0}})],Tt.prototype,"relationshipTableId",void 0),Object(f.a)([Object(m.b)({json:{read:Et.read,write:Et.write}})],Tt.prototype,"role",void 0);var Rt=Tt=Object(f.a)([Object(k.a)("esri.layers.support.Relationship")],Tt),Mt=r(234),Dt=r(835),Lt=r(812),At=r(284),Ct=r(277),Pt=r(363),Nt=new w.a({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch"}),qt={name:"supportsName",size:"supportsSize",contentType:"supportsContentType",keywords:"supportsKeywords",exifInfo:"supportsExifInfo"},zt="FeatureLayer",Vt=j.a.getLogger("esri.layers.FeatureLayer");function Ut(e){return e&&e instanceof M.a}function Bt(e,t,r){return!!(e&&e.hasOwnProperty(t)?e[t]:r)}function Gt(e,t,r){return e&&e.hasOwnProperty(t)?e[t]:r}var Qt=Object(It.a)();function Jt(e,t,r){var a=!(null==r||!r.writeLayerSchema);return{enabled:a,ignoreOrigin:a}}var Wt=function(e){Object(b.a)(a,e);var t=Object(y.a)(a);function a(){var e;Object(u.a)(this,a);for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return(e=t.call.apply(t,[this].concat(n)))._handles=new P.a,e.capabilities=null,e.charts=null,e.copyright=null,e.displayField=null,e.definitionExpression=null,e.dynamicDataSource=null,e.editFieldsInfo=null,e.editingEnabled=!0,e.editingInfo=null,e.elevationInfo=null,e.featureReduction=null,e.fields=null,e.formTemplate=null,e.fullExtent=null,e.gdbVersion=null,e.geometryProperties=null,e.geometryType=null,e.hasM=void 0,e.hasZ=void 0,e.heightModelInfo=null,e.historicMoment=null,e.isTable=!1,e.labelsVisible=!0,e.labelingInfo=null,e.layerId=void 0,e.legendEnabled=!0,e.minScale=0,e.maxScale=0,e.globalIdField=null,e.objectIdField=null,e.outFields=null,e.path=null,e.popupEnabled=!0,e.popupTemplate=null,e.relationships=null,e.sourceJSON=null,e.returnM=void 0,e.returnZ=void 0,e.screenSizePerspectiveEnabled=!0,e.serviceDefinitionExpression=null,e.spatialReference=T.a.WGS84,e.templates=null,e.timeInfo=null,e.title=null,e.sublayerTitleMode="item-title",e.trackIdField=null,e.type="feature",e.typeIdField=null,e.types=null,e.indexes=new(M.a.ofType(Ot)),e.userIsAdmin=!1,e.version=void 0,e.visible=!0,e}return Object(l.a)(a,[{key:"destroy",value:function(){var e;null==(e=this.source)||e.destroy(),this._handles&&(this._handles.destroy(),this._handles=null)}},{key:"normalizeCtorArgs",value:function(e,t){return"string"==typeof e?Object(c.a)({url:e},t):e}},{key:"load",value:function(e){var t=this,r=Object(O.i)(e)?e.signal:null;if(!(this.portalItem&&this.portalItem.loaded&&this.source)){var a=this.loadFromPortal({supportedTypes:["Feature Service","Feature Collection"]},e).catch((function(e){return e})).then(Object(s.a)(o.a.mark((function e(){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.url||null!=t.layerId||!/FeatureServer|MapServer\/*$/i.test(t.url)){e.next=5;break}return e.next=3,t._fetchFirstLayerId(r);case 3:null!=(a=e.sent)&&(t.layerId=a);case 5:if(t.url||t._hasMemorySource()){e.next=7;break}throw new F.a("feature-layer:missing-url-or-source","Feature layer must be created with either a url or a source");case 7:return e.t0=t,e.next=10,t.createGraphicsSource(r);case 10:return e.t1=e.sent,e.abrupt("return",e.t0._initLayerProperties.call(e.t0,e.t1));case 12:case"end":return e.stop()}}),e)}))));return this.addResolvingPromise(a),Object(E.u)(this)}this.addResolvingPromise(this.createGraphicsSource(r).then((function(e){return t._initLayerProperties(e)})))}},{key:"readCapabilities",value:function(e,t){return t=t.layerDefinition||t,{attachment:this._readAttachmentCapabilities(t.attachmentProperties),data:this._readDataCapabilities(t),metadata:this._readMetadataCapabilities(t),operations:this._readOperationsCapabilities(t.capabilities||e,t),query:this._readQueryCapabilities(t),queryRelated:this._readQueryRelatedCapabilities(t),editing:this._readEditingCapabilities(t)}}},{key:"createQueryVersion",get:function(){return this.definitionExpression,this.dynamicDataSource,this.timeExtent,this.timeOffset,this.geometryType,this.gdbVersion,this.historicMoment,this.returnZ,this.capabilities,this.returnM,(this._get("createQueryVersion")||0)+1}},{key:"readEditingEnabled",value:function(e,t){return this._readEditingEnabled(t,!1)}},{key:"readEditingEnabledFromWebMap",value:function(e,t,r){return this._readEditingEnabled(t,!0,r)}},{key:"writeEditingEnabled",value:function(e,t){this._writeEditingEnabled(e,t,!1)}},{key:"writeEditingEnabledToWebMap",value:function(e,t,r,a){this._writeEditingEnabled(e,t,!0,a)}},{key:"readEditingInfo",value:function(e,t){var r=t.editingInfo;return r?{lastEditDate:null!=r.lastEditDate?new Date(r.lastEditDate):null}:null}},{key:"readFeatureReduction",value:function(e,t){return Object(xt.a)(e,t)}},{key:"writeWebSceneFeatureReduction",value:function(e,t,r,a){Object(xt.c)(e,t,"layerDefinition.featureReduction",a)}},{key:"fieldsIndex",get:function(){return new $.a(this.fields||[])}},{key:"readIsTable",value:function(e,t){return"Table"===(t=t&&t.layerDefinition||t).type||!t.geometryType}},{key:"writeIsTable",value:function(e,t,r,a){null!=a&&a.writeLayerSchema&&Object(v.c)(r,e?"Table":"Feature Layer",t)}},{key:"readMinScale",value:function(e,t){return t.effectiveMinScale||e||0}},{key:"readMaxScale",value:function(e,t){return t.effectiveMaxScale||e||0}},{key:"readGlobalIdFieldFromService",value:function(e,t){if((t=t.layerDefinition||t).globalIdField)return t.globalIdField;if(t.fields){var r,a=Object(n.a)(t.fields);try{for(a.s();!(r=a.n()).done;){var i=r.value;if("esriFieldTypeGlobalID"===i.type)return i.name}}catch(o){a.e(o)}finally{a.f()}}}},{key:"readObjectIdFieldFromService",value:function(e,t){if((t=t.layerDefinition||t).objectIdField)return t.objectIdField;if(t.fields){var r,a=Object(n.a)(t.fields);try{for(a.s();!(r=a.n()).done;){var i=r.value;if("esriFieldTypeOID"===i.type)return i.name}}catch(o){a.e(o)}finally{a.f()}}}},{key:"parsedUrl",get:function(){var e=this.url?Object(_.I)(this.url):null;return null!=e&&(null!=this.dynamicDataSource?e.path=Object(_.x)(e.path,"dynamicLayer"):null!=this.layerId&&(e.path=Object(_.x)(e.path,this.layerId.toString()))),e}},{key:"defaultPopupTemplate",get:function(){return this.createPopupTemplate()}},{key:"renderer",set:function(e){Object(D.j)(e,this.fields),this._set("renderer",e)}},{key:"readRenderer",value:function(e,t,r){var a=(t=t.layerDefinition||t).drawingInfo&&t.drawingInfo.renderer||void 0;if(a){var n=Object(W.b)(a,t,r)||void 0;return n||Vt.error("Failed to create renderer",{rendererDefinition:t.drawingInfo.renderer,layer:this,context:r}),n}if(t.defaultSymbol)return t.types&&t.types.length?new G.a({defaultSymbol:$t(t.defaultSymbol,t,r),field:t.typeIdField,uniqueValueInfos:t.types.map((function(e){return{id:e.id,symbol:$t(e.symbol,e,r)}}))}):new Q.a({symbol:$t(t.defaultSymbol,t,r)})}},{key:"source",set:function(e){var t=this._get("source");t!==e&&(Ut(t)&&this._resetMemorySource(t),Ut(e)&&this._initMemorySource(e),this._set("source",e))}},{key:"castSource",value:function(e){return e?Array.isArray(e)||e instanceof M.a?new ut({layer:this,items:e}):e:null}},{key:"readSource",value:function(e,t){var r=Ke.default.fromJSON(t.featureSet);return new ut({layer:this,items:r&&r.features||[]})}},{key:"readServiceDefinitionExpression",value:function(e,t){return t.definitionQuery||t.definitionExpression}},{key:"readTemplates",value:function(e,t){var r=t.editFieldsInfo,a=r&&r.creatorField,n=r&&r.editorField;return e=e&&e.map((function(e){return St.a.fromJSON(e)})),this._fixTemplates(e,a),this._fixTemplates(e,n),e}},{key:"readTitle",value:function(e,t){var r=t.layerDefinition&&t.layerDefinition.name||t.name,a=t.title||t.layerDefinition&&t.layerDefinition.title;if(r){var n=this.portalItem&&this.portalItem.title;if("item-title"===this.sublayerTitleMode)return this.url?Object(z.h)(this.url,r):r;var i=r;if(!i&&this.url){var o=Object(z.e)(this.url);Object(O.i)(o)&&(i=o.title)}if(!i)return;return"item-title-and-service-name"===this.sublayerTitleMode&&n&&n!==i&&(i=n+" - "+i),Object(z.a)(i)}if("item-title"===this.sublayerTitleMode&&a)return a}},{key:"readTitleFromWebMap",value:function(e,t){return t.title||t.layerDefinition&&t.layerDefinition.name}},{key:"readTypeIdField",value:function(e,t){var r=(t=t.layerDefinition||t).typeIdField;if(r){var a=Object(D.n)(t.fields,r);a&&(r=a.name)}return r}},{key:"readTypes",value:function(e,t){var r=this;e=(t=t.layerDefinition||t).types;var a=t.editFieldsInfo,n=a&&a.creatorField,i=a&&a.editorField;return e&&e.map((function(e){return e=kt.a.fromJSON(e),r._fixTemplates(e.templates,n),r._fixTemplates(e.templates,i),e}))}},{key:"url",set:function(e){var t=Object(z.g)(this,e,Vt);this._set("url",t.url),null!=t.layerId&&this._set("layerId",t.layerId)}},{key:"writeUrl",value:function(e,t,r,a){Object(z.i)(this,e,null,t,a)}},{key:"readVersion",value:function(e,t){return t.currentVersion?t.currentVersion:t.hasOwnProperty("capabilities")||t.hasOwnProperty("drawingInfo")||t.hasOwnProperty("hasAttachments")||t.hasOwnProperty("htmlPopupType")||t.hasOwnProperty("relationships")||t.hasOwnProperty("timeInfo")||t.hasOwnProperty("typeIdField")||t.hasOwnProperty("types")?10:9.3}},{key:"readVisible",value:function(e,t){return t.layerDefinition&&null!=t.layerDefinition.defaultVisibility?!!t.layerDefinition.defaultVisibility:null!=t.visibility?!!t.visibility:void 0}},{key:"addAttachment",value:function(e,t){var r=this;return this.load().then((function(){return r._checkAttachmentSupport(e)})).then((function(){if(!("addAttachment"in r.source))throw new F.a(zt,"Layer source does not support addAttachment capability");return r.source.addAttachment(e,t)}))}},{key:"updateAttachment",value:function(e,t,r){var a=this;return this.load().then((function(){return a._checkAttachmentSupport(e)})).then((function(){if(!("updateAttachment"in a.source))throw new F.a(zt,"Layer source does not support updateAttachment capability");return a.source.updateAttachment(e,t,r)}))}},{key:"applyEdits",value:function(){var e=Object(s.a)(o.a.mark((function e(t,a){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.e(37).then(r.bind(null,1284));case 2:return n=e.sent,e.next=5,this.load();case 5:return e.abrupt("return",n.applyEdits(this,this.source,t,a));case 6:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"on",value:function(e,t){return Object(p.a)(Object(d.a)(a.prototype),"on",this).call(this,e,t)}},{key:"createPopupTemplate",value:function(e){return Object(Lt.a)(this,e)}},{key:"createGraphicsSource",value:function(){var e=Object(s.a)(o.a.mark((function e(t){var a,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._hasMemorySource()){e.next=2;break}return e.abrupt("return",(this.emit("graphics-source-create",{graphicsSource:this.source}),this.source.load({signal:t})));case 2:return e.next=4,r.e(139).then(r.bind(null,1285));case 4:return a=e.sent,Object(E.w)(t),e.next=8,new a.default({layer:this}).load({signal:t});case 8:return n=e.sent,e.abrupt("return",(this.emit("graphics-source-create",{graphicsSource:n}),n));case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"createQuery",value:function(){var e=new Ct.a,t=this.get("capabilities.data");e.dynamicDataSource=this.dynamicDataSource,e.gdbVersion=this.gdbVersion,e.historicMoment=this.historicMoment,e.returnGeometry=!0,t&&(t.supportsZ&&null!=this.returnZ&&(e.returnZ=this.returnZ),t.supportsM&&null!=this.returnM&&(e.returnM=this.returnM)),e.outFields=["*"],e.where=this.definitionExpression||"1=1";var r=this.timeOffset,a=this.timeExtent;return e.timeExtent=null!=r&&null!=a?a.offset(-r.value,r.unit):a||null,e.multipatchOption="multipatch"===this.geometryType?"xyFootprint":null,e}},{key:"deleteAttachments",value:function(e,t){var r=this;return this.load().then((function(){return r._checkAttachmentSupport(e)})).then((function(){if(!("deleteAttachments"in r.source))throw new F.a(zt,"Layer source does not support deleteAttachments capability");return r.source.deleteAttachments(e,t)}))}},{key:"fetchRecomputedExtents",value:function(e){var t=this;return this.load({signal:null==e?void 0:e.signal}).then((function(){if(t.source.fetchRecomputedExtents)return t.source.fetchRecomputedExtents(e);throw new F.a(zt,"Layer source does not support fetchUpdates capability")}))}},{key:"getFeatureType",value:function(e){var t=this.typeIdField,r=this.types;if(!t||!e)return null;var a=e.attributes?e.attributes[t]:void 0;if(null==a)return null;var n=null;return r.some((function(e){var t=e.id;return null!=t&&(t.toString()===a.toString()&&(n=e),!!n)})),n}},{key:"getFieldDomain",value:function(e,t){var r=t&&t.feature,a=this.getFeatureType(r);if(a){var n=a.domains&&a.domains[e];if(n&&"inherited"!==n.type)return n}return this._getLayerDomain(e)}},{key:"getField",value:function(e){return this.fieldsIndex.get(e)}},{key:"queryAttachments",value:function(e,t){var r=this;return e=At.a.from(e),this.load().then((function(){if(!r.get("capabilities.data.supportsAttachment"))throw new F.a(zt,"this layer doesn't support attachments");var t=e,a=t.attachmentTypes,n=t.objectIds,i=t.globalIds,o=t.num,s=t.size,c=t.start,u=t.where;if(!r.get("capabilities.operations.supportsQueryAttachments")){var l=n&&n.length>1,p=a&&a.length,d=i&&i.length,b=s&&s.length;if(l||p||d||b||o||c||u)throw new F.a(zt,"when 'supportsQueryAttachments' is false, only objectIds of length 1 are supported",e)}if(!(n&&n.length||u))throw new F.a(zt,"'objectIds' or 'where' are required to perform attachment query",e);if(!("queryAttachments"in r.source))throw new F.a(zt,"Layer source does not support queryAttachments capability",e);return r.source.queryAttachments(e)}))}},{key:"queryFeatures",value:function(e,t){var r=this;return this.load().then((function(){return r.source.queryFeatures(Ct.a.from(e)||r.createQuery(),t)})).then((function(e){if(e&&e.features){var t,a=Object(n.a)(e.features);try{for(a.s();!(t=a.n()).done;){var i=t.value;i.layer=i.sourceLayer=r}}catch(o){a.e(o)}finally{a.f()}}return e}))}},{key:"queryObjectIds",value:function(e,t){var r=this;return this.load().then((function(){if(r.source.queryObjectIds)return r.source.queryObjectIds(Ct.a.from(e)||r.createQuery(),t);throw new F.a(zt,"Layer source does not support queryObjectIds capability")}))}},{key:"queryFeatureCount",value:function(e,t){var r=this;return this.load().then((function(){if(r.source.queryFeatureCount)return r.source.queryFeatureCount(Ct.a.from(e)||r.createQuery(),t);throw new F.a(zt,"Layer source does not support queryFeatureCount capability")}))}},{key:"queryExtent",value:function(e,t){var r=this;return this.load().then((function(){if(r.source.queryExtent)return r.source.queryExtent(Ct.a.from(e)||r.createQuery(),t);throw new F.a(zt,"Layer source does not support queryExtent capability")}))}},{key:"queryRelatedFeatures",value:function(e,t){var r=this;return this.load().then((function(){if("queryRelatedFeatures"in r.source)return r.source.queryRelatedFeatures(Pt.a.from(e),t);throw new F.a(zt,"Layer source does not support queryRelatedFeatures capability")}))}},{key:"queryRelatedFeaturesCount",value:function(e,t){var r=this;return this.load().then((function(){if("queryRelatedFeaturesCount"in r.source)return r.source.queryRelatedFeaturesCount(Pt.a.from(e),t);throw new F.a(zt,"Layer source does not support queryRelatedFeaturesCount capability")}))}},{key:"read",value:function(e,t){var r=e.featureCollection;if(r){var n=r.layers;n&&1===n.length&&(Object(p.a)(Object(d.a)(a.prototype),"read",this).call(this,n[0],t),null!=r.showLegend&&Object(p.a)(Object(d.a)(a.prototype),"read",this).call(this,{showLegend:r.showLegend},t))}Object(p.a)(Object(d.a)(a.prototype),"read",this).call(this,e,t),t&&"service"===t.origin&&this.revert(["objectIdField","fields","timeInfo","spatialReference"],"service")}},{key:"write",value:function(e,t){var r,n,i=(t=Object(c.a)(Object(c.a)({},t),{},{writeLayerSchema:null!=(r=null==(n=t)?void 0:n.writeLayerSchema)?r:this._hasMemorySource()})).origin,o=t.layerContainerType,s=t.messages;if(this.isTable){if("web-scene"===i||"web-map"===i&&"tables"!==o)return s&&s.push(new F.a("layer:unsupported","Layer (".concat(this.title,", ").concat(this.id,") of type '").concat(this.declaredClass,"' using a Table source cannot be written to web scenes and web maps"),{layer:this})),null;if(this._hasMemorySource())return s&&s.push(new F.a("layer:unsupported","Layer (".concat(this.title,", ").concat(this.id,") of type '").concat(this.declaredClass,"' using an in-memory Table source cannot be written to web scenes and web maps"),{layer:this})),null}else if(this.loaded&&"web-map"===i&&"tables"===o)return s&&s.push(new F.a("layer:unsupported","Layer (".concat(this.title,", ").concat(this.id,") of type '").concat(this.declaredClass,"' using a non-table source cannot be written to tables in web maps"),{layer:this})),null;return Object(p.a)(Object(d.a)(a.prototype),"write",this).call(this,e,t)}},{key:"_readEditingEnabled",value:function(e,t,r){var a,n=null==(a=e.layerDefinition)?void 0:a.capabilities;return n?this._hasEditingCapability(n):(n=e.capabilities,!(t&&"web-map"===(null==r?void 0:r.origin)&&!this._hasMemorySource()&&n)||this._hasEditingCapability(n))}},{key:"_hasEditingCapability",value:function(e){return e.toLowerCase().split(",").map((function(e){return e.trim()})).includes("editing")}},{key:"_writeEditingEnabled",value:function(e,t,r,a){e||(Object(v.c)("layerDefinition.capabilities","Query",t),!r||null!=a&&a.writeLayerSchema||(t.capabilities="Query"))}},{key:"_checkAttachmentSupport",value:function(e){var t=e.attributes,r=this.objectIdField;return this.get("capabilities.data.supportsAttachment")?e?t?t[r]?void 0:Object(E.t)(new F.a(zt,"feature is missing the identifying attribute ".concat(r))):Object(E.t)(new F.a(zt,"'attributes' are required on a feature to query attachments")):Object(E.t)(new F.a(zt,"A feature is required to add/delete/update attachments")):Object(E.t)(new F.a(zt,"this layer doesn't support attachments"))}},{key:"_getLayerDomain",value:function(e){var t=this.fieldsIndex.get(e);return t?t.domain:null}},{key:"_fetchFirstLayerId",value:function(e){return Object(A.default)(this.url,{query:Object(c.a)({f:"json"},this.customParameters),responseType:"json",signal:e}).then((function(e){var t=e.data;if(t)return Array.isArray(t.layers)&&t.layers.length>0?t.layers[0].id:Array.isArray(t.tables)&&t.tables.length>0?t.tables[0].id:void 0}))}},{key:"_initLayerProperties",value:function(){var e=Object(s.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(this._set("source",t),t.sourceJSON&&(this.sourceJSON=t.sourceJSON,this.read(t.sourceJSON,{origin:"service",url:this.parsedUrl})),this._verifySource(),this._verifyFields(),Object(D.j)(this.renderer,this.fields),Object(D.k)(this.timeInfo,this.fields),Object(Dt.a)(this,{origin:"service"})));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_verifyFields",value:function(){var e=this.parsedUrl&&this.parsedUrl.path||"undefined";this.objectIdField||console.log("FeatureLayer: 'objectIdField' property is not defined (url: "+e+")"),this.isTable||this._hasMemorySource()||-1!==e.search(/\/FeatureServer\//i)||this.fields&&this.fields.some((function(e){return"geometry"===e.type}))||console.log("FeatureLayer: unable to find field of type 'geometry' in the layer 'fields' list. If you are using a map service layer, features will not have geometry (url: "+e+")")}},{key:"_fixTemplates",value:function(e,t){e&&e.forEach((function(e){var r=e.prototype&&e.prototype.attributes;r&&t&&delete r[t]}))}},{key:"_verifySource",value:function(){if(this._hasMemorySource()){if(this.url)throw new F.a("feature-layer:mixed-source-and-url","FeatureLayer cannot be created with both an in-memory source and a url")}else if(!this.url)throw new F.a("feature-layer:source-or-url-required","FeatureLayer requires either a url, a valid portal item or a source")}},{key:"_initMemorySource",value:function(e){var t=this;e.forEach((function(e){e.layer=t,e.sourceLayer=t})),this._handles.add([e.on("after-add",(function(e){e.item.layer=t,e.item.sourceLayer=t})),e.on("after-remove",(function(e){e.item.layer=null,e.item.sourceLayer=null}))],"fl-source")}},{key:"_resetMemorySource",value:function(e){e.forEach((function(e){e.layer=null,e.sourceLayer=null})),this._handles.remove("fl-source")}},{key:"_hasMemorySource",value:function(){return!(this.url||!this.source)}},{key:"_readAttachmentCapabilities",value:function(e){var t={supportsName:!1,supportsSize:!1,supportsContentType:!1,supportsKeywords:!1,supportsExifInfo:!1};return e&&Array.isArray(e)&&e.forEach((function(e){var r=qt[e.name];r&&(t[r]=!!e.isEnabled)})),t}},{key:"_readDataCapabilities",value:function(e){return{isVersioned:Bt(e,"isDataVersioned",!1),supportsAttachment:Bt(e,"hasAttachments",!1),supportsM:Bt(e,"hasM",!1),supportsZ:Bt(e,"hasZ",!1)}}},{key:"_readMetadataCapabilities",value:function(e){return{supportsAdvancedFieldProperties:Bt(e,"supportsFieldDescriptionProperty",!1)}}},{key:"_readOperationsCapabilities",value:function(e,t){var r=e?e.toLowerCase().split(",").map((function(e){return e.trim()})):[],a=-1!==r.indexOf("editing"),n=a&&-1!==r.indexOf("create"),i=a&&-1!==r.indexOf("delete"),o=a&&-1!==r.indexOf("update"),s=-1!==r.indexOf("changetracking");return a&&!(n||i||o)&&(n=i=o=!0),{supportsCalculate:Bt(t,"supportsCalculate",!1),supportsTruncate:Bt(t,"supportsTruncate",!1),supportsValidateSql:Bt(t,"supportsValidateSql",!1),supportsAdd:n,supportsDelete:i,supportsEditing:a,supportsChangeTracking:s,supportsQuery:-1!==r.indexOf("query"),supportsQueryAttachments:Bt(t.advancedQueryCapabilities,"supportsQueryAttachments",!1),supportsResizeAttachments:Bt(t,"supportsAttachmentsResizing",!1),supportsSync:-1!==r.indexOf("sync"),supportsUpdate:o,supportsExceedsLimitStatistics:Bt(t,"supportsExceedsLimitStatistics",!1)}}},{key:"_readQueryCapabilities",value:function(e){var t=e.advancedQueryCapabilities,r=e.ownershipBasedAccessControlForFeatures,a=e.archivingInfo,n=(e.supportedQueryFormats||"").split(",").reduce((function(e,t){var r=t.toLowerCase().trim();return r&&e.add(r),e}),new Set);return{supportsStatistics:Bt(t,"supportsStatistics",e.supportsStatistics),supportsPercentileStatistics:Bt(t,"supportsPercentileStatistics",!1),supportsCentroid:Bt(t,"supportsReturningGeometryCentroid",!1),supportsDistance:Bt(t,"supportsQueryWithDistance",!1),supportsDistinct:Bt(t,"supportsDistinct",e.supportsAdvancedQueries),supportsExtent:Bt(t,"supportsReturningQueryExtent",!1),supportsGeometryProperties:Bt(t,"supportsReturningGeometryProperties",!1),supportsHavingClause:Bt(t,"supportsHavingClause",!1),supportsOrderBy:Bt(t,"supportsOrderBy",e.supportsAdvancedQueries),supportsPagination:Bt(t,"supportsPagination",!1),supportsQuantization:Bt(e,"supportsCoordinatesQuantization",!1),supportsQuantizationEditMode:Bt(e,"supportsQuantizationEditMode",!1),supportsQueryGeometry:Bt(e,"supportsReturningQueryGeometry",!1),supportsResultType:Bt(t,"supportsQueryWithResultType",!1),supportsMaxRecordCountFactor:Bt(t,"supportsMaxRecordCountFactor",!1),supportsSqlExpression:Bt(t,"supportsSqlExpression",!1),supportsStandardizedQueriesOnly:Bt(e,"useStandardizedQueries",!1),supportsQueryByOthers:Bt(r,"allowOthersToQuery",!0),supportsHistoricMoment:Bt(a,"supportsQueryWithHistoricMoment",!1),supportsFormatPBF:n.has("pbf"),supportsDisjointSpatialRelationship:Bt(t,"supportsDisjointSpatialRel",!1),supportsCacheHint:Bt(t,"supportsQueryWithCacheHint",!1),maxRecordCountFactor:Gt(e,"maxRecordCountFactor",void 0),maxRecordCount:Gt(e,"maxRecordCount",void 0),standardMaxRecordCount:Gt(e,"standardMaxRecordCount",void 0),tileMaxRecordCount:Gt(e,"tileMaxRecordCount",void 0)}}},{key:"_readQueryRelatedCapabilities",value:function(e){var t=e.advancedQueryCapabilities,r=Bt(t,"supportsAdvancedQueryRelated",!1);return{supportsPagination:Bt(t,"supportsQueryRelatedPagination",!1),supportsCount:r,supportsOrderBy:r}}},{key:"_readEditingCapabilities",value:function(e){var t=e.ownershipBasedAccessControlForFeatures;return{supportsGeometryUpdate:Bt(e,"allowGeometryUpdates",!0),supportsGlobalId:Bt(e,"supportsApplyEditsWithGlobalIds",!1),supportsRollbackOnFailure:Bt(e,"supportsRollbackOnFailureParameter",!1),supportsUpdateWithoutM:Bt(e,"allowUpdateWithoutMValues",!1),supportsUploadWithItemId:Bt(e,"supportsAttachmentsByUploadId",!1),supportsDeleteByAnonymous:Bt(t,"allowAnonymousToDelete",!0),supportsDeleteByOthers:Bt(t,"allowOthersToDelete",!0),supportsUpdateByAnonymous:Bt(t,"allowAnonymousToUpdate",!0),supportsUpdateByOthers:Bt(t,"allowOthersToUpdate",!0)}}}]),a}(Object(pt.a)(Object(vt.a)(Object(ft.a)(Object(yt.a)(Object(lt.a)(Object(B.a)(Object(bt.a)(Object(q.a)(Object(dt.a)(N.a))))))))));Object(f.a)([Object(m.b)({readOnly:!0,json:{read:!1}})],Wt.prototype,"capabilities",void 0),Object(f.a)([Object(x.a)("service","capabilities",["advancedQueryCapabilities","allowGeometryUpdates","allowUpdateWithoutMValues","archivingInfo","capabilities","hasAttachments","hasM","hasZ","maxRecordCount","maxRecordCountFactor","ownershipBasedAccessControlForFeatures","standardMaxRecordCount","supportedQueryFormats","supportsAdvancedQueries","supportsApplyEditsWithGlobalIds","supportsAttachmentsByUploadId","supportsAttachmentsResizing","supportsCalculate","supportsCoordinatesQuantization","supportsExceedsLimitStatistics","supportsFieldDescriptionProperty","supportsQuantizationEditMode","supportsRollbackOnFailureParameter","supportsStatistics","supportsTruncate","supportsValidateSql","tileMaxRecordCount","useStandardizedQueries"])],Wt.prototype,"readCapabilities",null),Object(f.a)([Object(m.b)({json:{origins:{"portal-item":{write:!0},"web-map":{write:!0}}}})],Wt.prototype,"charts",void 0),Object(f.a)([Object(m.b)({readOnly:!0,dependsOn:["definitionExpression","dynamicDataSource","timeExtent","timeOffset","geometryType","gdbVersion","historicMoment","returnZ","capabilities","returnM"]})],Wt.prototype,"createQueryVersion",null),Object(f.a)([Object(m.b)({type:String,json:{read:{source:"layerDefinition.copyrightText"},origins:{service:{read:{source:"copyrightText"}}}}})],Wt.prototype,"copyright",void 0),Object(f.a)([Object(m.b)({type:String,json:{read:{source:"layerDefinition.displayField"},origins:{service:{read:{source:"displayField"}}}}})],Wt.prototype,"displayField",void 0),Object(f.a)([Object(m.b)({type:String,json:{origins:{service:{read:!1,write:!1}},read:{source:"layerDefinition.definitionExpression"},write:{target:"layerDefinition.definitionExpression"}}})],Wt.prototype,"definitionExpression",void 0),Object(f.a)([Object(m.b)({types:C.i,readOnly:!0})],Wt.prototype,"defaultSymbol",void 0),Object(f.a)([Object(m.b)({type:Mt.a})],Wt.prototype,"dynamicDataSource",void 0),Object(f.a)([Object(m.b)({readOnly:!0})],Wt.prototype,"editFieldsInfo",void 0),Object(f.a)([Object(m.b)({type:Boolean})],Wt.prototype,"editingEnabled",void 0),Object(f.a)([Object(x.a)(["portal-item","web-scene"],"editingEnabled",["layerDefinition.capabilities"])],Wt.prototype,"readEditingEnabled",null),Object(f.a)([Object(x.a)("web-map","editingEnabled",["capabilities","layerDefinition.capabilities"])],Wt.prototype,"readEditingEnabledFromWebMap",null),Object(f.a)([Object(I.a)(["portal-item","web-scene"],"editingEnabled",{"layerDefinition.capabilities":{type:String}})],Wt.prototype,"writeEditingEnabled",null),Object(f.a)([Object(I.a)("web-map","editingEnabled",{capabilities:{type:String},"layerDefinition.capabilities":{type:String}})],Wt.prototype,"writeEditingEnabledToWebMap",null),Object(f.a)([Object(m.b)({readOnly:!0})],Wt.prototype,"editingInfo",void 0),Object(f.a)([Object(x.a)("editingInfo")],Wt.prototype,"readEditingInfo",null),Object(f.a)([Object(m.b)(U.b)],Wt.prototype,"elevationInfo",void 0),Object(f.a)([Object(m.b)({types:{key:"type",base:jt.a,typeMap:{selection:wt.a,cluster:gt.a}},json:{write:{target:"layerDefinition.featureReduction"}}})],Wt.prototype,"featureReduction",void 0),Object(f.a)([Object(x.a)("featureReduction",["layerDefinition.featureReduction"])],Wt.prototype,"readFeatureReduction",null),Object(f.a)([Object(I.a)("web-scene","featureReduction",{"layerDefinition.featureReduction":{types:xt.b}})],Wt.prototype,"writeWebSceneFeatureReduction",null),Object(f.a)([Object(m.b)(Object(c.a)(Object(c.a)({},Qt.fields),{},{json:{read:{source:"layerDefinition.fields"},origins:{service:{read:!0},"web-map":{write:{target:"layerDefinition.fields",overridePolicy:Jt}}}}}))],Wt.prototype,"fields",void 0),Object(f.a)([Object(m.b)({readOnly:!0,dependsOn:["fields"]})],Wt.prototype,"fieldsIndex",null),Object(f.a)([Object(m.b)({type:$e,json:{name:"formInfo",write:!0,origins:{"web-scene":{read:!1,write:!1}}}})],Wt.prototype,"formTemplate",void 0),Object(f.a)([Object(m.b)({type:R.a,json:{origins:{service:{read:{source:"extent"}}},read:{source:"layerDefinition.extent"}}})],Wt.prototype,"fullExtent",void 0),Object(f.a)([Object(m.b)()],Wt.prototype,"gdbVersion",void 0),Object(f.a)([Object(m.b)({readOnly:!0})],Wt.prototype,"geometryProperties",void 0),Object(f.a)([Object(m.b)({type:["point","polygon","polyline","multipoint","multipatch","mesh"],json:{origins:{service:{read:Nt.read},"web-map":{write:{target:"layerDefinition.geometryType",overridePolicy:Jt,writer:function(e,t,r){var a=e?Nt.toJSON(e):null;a&&Object(v.c)(r,a,t)}}}},read:{source:"layerDefinition.geometryType",reader:Nt.read}}})],Wt.prototype,"geometryType",void 0),Object(f.a)([Object(m.b)({type:Boolean,json:{origins:{service:{read:!0}},read:{source:"layerDefinition.hasM"}}})],Wt.prototype,"hasM",void 0),Object(f.a)([Object(m.b)({type:Boolean,json:{origins:{service:{read:!0}},read:{source:"layerDefinition.hasZ"}}})],Wt.prototype,"hasZ",void 0),Object(f.a)([Object(m.b)({readOnly:!0,type:V.a})],Wt.prototype,"heightModelInfo",void 0),Object(f.a)([Object(m.b)({type:Date})],Wt.prototype,"historicMoment",void 0),Object(f.a)([Object(m.b)({json:{origins:{service:{read:!1},"portal-item":{read:!1}}}})],Wt.prototype,"id",void 0),Object(f.a)([Object(m.b)({readOnly:!0,json:{origins:{"web-map":{write:{target:"layerDefinition.type"}}}}})],Wt.prototype,"isTable",void 0),Object(f.a)([Object(x.a)("service","isTable",["type","geometryType"]),Object(x.a)("isTable",["layerDefinition.type","layerDefinition.geometryType"])],Wt.prototype,"readIsTable",null),Object(f.a)([Object(I.a)("web-map","isTable")],Wt.prototype,"writeIsTable",null),Object(f.a)([Object(m.b)(U.c)],Wt.prototype,"labelsVisible",void 0),Object(f.a)([Object(m.b)({type:[mt.a],json:{origins:{service:{read:{source:"drawingInfo.labelingInfo",reader:Ft.a},write:{target:"drawingInfo.labelingInfo",enabled:!1}}},read:{source:"layerDefinition.drawingInfo.labelingInfo",reader:Ft.a},write:{target:"layerDefinition.drawingInfo.labelingInfo"}}})],Wt.prototype,"labelingInfo",void 0),Object(f.a)([Object(m.b)(U.f)],Wt.prototype,"opacity",void 0),Object(f.a)([Object(m.b)({type:Number,json:{origins:{service:{read:{source:"id"}}},read:!1}})],Wt.prototype,"layerId",void 0),Object(f.a)([Object(m.b)(U.d)],Wt.prototype,"legendEnabled",void 0),Object(f.a)([Object(m.b)({type:["show","hide"]})],Wt.prototype,"listMode",void 0),Object(f.a)([Object(m.b)({type:Number,json:{origins:{service:{write:{enabled:!1}}},read:{source:"layerDefinition.minScale"},write:{target:"layerDefinition.minScale"}}})],Wt.prototype,"minScale",void 0),Object(f.a)([Object(x.a)("service","minScale",["minScale","effectiveMinScale"])],Wt.prototype,"readMinScale",null),Object(f.a)([Object(m.b)({type:Number,json:{origins:{service:{write:{enabled:!1}}},read:{source:"layerDefinition.maxScale"},write:{target:"layerDefinition.maxScale"}}})],Wt.prototype,"maxScale",void 0),Object(f.a)([Object(x.a)("service","maxScale",["maxScale","effectiveMaxScale"])],Wt.prototype,"readMaxScale",null),Object(f.a)([Object(m.b)({type:String})],Wt.prototype,"globalIdField",void 0),Object(f.a)([Object(x.a)("globalIdField",["layerDefinition.globalIdField","layerDefinition.fields"]),Object(x.a)("service","globalIdField",["globalIdField","fields"])],Wt.prototype,"readGlobalIdFieldFromService",null),Object(f.a)([Object(m.b)({type:String,json:{origins:{"web-map":{write:{target:"layerDefinition.objectIdField",overridePolicy:Jt}}}}})],Wt.prototype,"objectIdField",void 0),Object(f.a)([Object(x.a)("objectIdField",["layerDefinition.objectIdField","layerDefinition.fields"]),Object(x.a)("service","objectIdField",["objectIdField","fields"])],Wt.prototype,"readObjectIdFieldFromService",null),Object(f.a)([Object(m.b)({value:"ArcGISFeatureLayer",type:["ArcGISFeatureLayer"]})],Wt.prototype,"operationalLayerType",void 0),Object(f.a)([Object(m.b)(Qt.outFields)],Wt.prototype,"outFields",void 0),Object(f.a)([Object(m.b)({readOnly:!0,dependsOn:["layerId","dynamicDataSource"]})],Wt.prototype,"parsedUrl",null),Object(f.a)([Object(m.b)({type:String,json:{origins:{"web-scene":{read:!0,write:!0}},read:!1}})],Wt.prototype,"path",void 0),Object(f.a)([Object(m.b)(U.g)],Wt.prototype,"popupEnabled",void 0),Object(f.a)([Object(m.b)({type:L.a,json:{read:{source:"popupInfo"},write:{target:"popupInfo"}}})],Wt.prototype,"popupTemplate",void 0),Object(f.a)([Object(m.b)({readOnly:!0,dependsOn:["fields","title"]})],Wt.prototype,"defaultPopupTemplate",null),Object(f.a)([Object(m.b)({type:[Rt],readOnly:!0})],Wt.prototype,"relationships",void 0),Object(f.a)([Object(m.b)({types:J.a,json:{origins:{service:{write:{target:"drawingInfo.renderer",enabled:!1}},"web-scene":{types:J.b,write:{target:"layerDefinition.drawingInfo.renderer",writer:W.c}}},write:{target:"layerDefinition.drawingInfo.renderer",overridePolicy:function(e,t,r){return{ignoreOrigin:null==r?void 0:r.writeLayerSchema}},writer:W.c}}})],Wt.prototype,"renderer",null),Object(f.a)([Object(x.a)("service","renderer",["drawingInfo.renderer","defaultSymbol"]),Object(x.a)("renderer",["layerDefinition.drawingInfo.renderer","layerDefinition.defaultSymbol"])],Wt.prototype,"readRenderer",null),Object(f.a)([Object(m.b)()],Wt.prototype,"sourceJSON",void 0),Object(f.a)([Object(m.b)({type:Boolean})],Wt.prototype,"returnM",void 0),Object(f.a)([Object(m.b)({type:Boolean})],Wt.prototype,"returnZ",void 0),Object(f.a)([Object(m.b)(U.i)],Wt.prototype,"screenSizePerspectiveEnabled",void 0),Object(f.a)([Object(m.b)()],Wt.prototype,"source",null),Object(f.a)([Object(g.a)("source")],Wt.prototype,"castSource",null),Object(f.a)([Object(x.a)("portal-item","source",["featureSet"]),Object(x.a)("web-map","source",["featureSet"])],Wt.prototype,"readSource",null),Object(f.a)([Object(m.b)({readOnly:!0})],Wt.prototype,"serviceDefinitionExpression",void 0),Object(f.a)([Object(x.a)("service","serviceDefinitionExpression",["definitionQuery","definitionExpression"])],Wt.prototype,"readServiceDefinitionExpression",null),Object(f.a)([Object(m.b)({type:T.a,json:{origins:{service:{read:{source:"extent.spatialReference"}}},read:{source:"layerDefinition.extent.spatialReference"}}})],Wt.prototype,"spatialReference",void 0),Object(f.a)([Object(m.b)({type:[St.a]})],Wt.prototype,"templates",void 0),Object(f.a)([Object(x.a)("templates",["editFieldsInfo","creatorField","editorField","templates"])],Wt.prototype,"readTemplates",null),Object(f.a)([Object(m.b)({type:ht.a})],Wt.prototype,"timeInfo",void 0),Object(f.a)([Object(m.b)()],Wt.prototype,"title",void 0),Object(f.a)([Object(x.a)("service","title",["name"]),Object(x.a)("portal-item","title",["layerDefinition.title","layerDefinition.name","title"])],Wt.prototype,"readTitle",null),Object(f.a)([Object(x.a)("web-map","title",["layerDefinition.name","title"])],Wt.prototype,"readTitleFromWebMap",null),Object(f.a)([Object(m.b)({type:String})],Wt.prototype,"sublayerTitleMode",void 0),Object(f.a)([Object(m.b)({type:String,json:{read:{source:"timeInfo.trackIdField"}}})],Wt.prototype,"trackIdField",void 0),Object(f.a)([Object(m.b)({json:{read:!1}})],Wt.prototype,"type",void 0),Object(f.a)([Object(m.b)({type:String})],Wt.prototype,"typeIdField",void 0),Object(f.a)([Object(x.a)("service","typeIdField"),Object(x.a)("typeIdField",["layerDefinition.typeIdField"])],Wt.prototype,"readTypeIdField",null),Object(f.a)([Object(m.b)({type:[kt.a]})],Wt.prototype,"types",void 0),Object(f.a)([Object(x.a)("service","types",["types"]),Object(x.a)("types",["layerDefinition.types"])],Wt.prototype,"readTypes",null),Object(f.a)([Object(m.b)({readOnly:!0,json:{write:!1}})],Wt.prototype,"serverGens",void 0),Object(f.a)([Object(m.b)({type:M.a.ofType(Ot),readOnly:!0})],Wt.prototype,"indexes",void 0),Object(f.a)([Object(m.b)(U.j)],Wt.prototype,"url",null),Object(f.a)([Object(I.a)("url")],Wt.prototype,"writeUrl",null),Object(f.a)([Object(m.b)({readOnly:!0})],Wt.prototype,"userIsAdmin",void 0),Object(f.a)([Object(m.b)({json:{origins:{service:{read:!0}},read:!1}})],Wt.prototype,"version",void 0),Object(f.a)([Object(x.a)("service","version",["currentVersion","capabilities","drawingInfo","hasAttachments","htmlPopupType","relationships","timeInfo","typeIdField","types"])],Wt.prototype,"readVersion",null),Object(f.a)([Object(m.b)({type:Boolean,json:{origins:{"portal-item":{write:{target:"layerDefinition.defaultVisibility"}}}}})],Wt.prototype,"visible",void 0),Object(f.a)([Object(x.a)("portal-item","visible",["visibility","layerDefinition.defaultVisibility"])],Wt.prototype,"readVisible",null),Wt=Object(f.a)([Object(k.a)("esri.layers.FeatureLayer")],Wt);var $t=Object(S.b)({types:C.a}),Kt=Wt;t.default=Kt},835:function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var a=r(10),n=r.n(a),i=r(21),o=r(175),s=r(16),c=r(278);function u(e,t,r){return l.apply(this,arguments)}function l(){return(l=Object(i.a)(n.a.mark((function e(t,r,a){var i,u,l;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(i=t&&t.getAtOrigin&&t.getAtOrigin("renderer",r.origin))||"unique-value"!==i.type||!i.styleOrigin){e.next=6;break}return e.next=4,Object(c.c)(i.populateFromStyle());case 4:u=e.sent,Object(s.w)(a),!1===u.ok&&(l=u.error,r&&r.messages&&r.messages.push(new o.a("renderer:style-reference","Failed to create unique value renderer from style reference: ".concat(l.message),{error:l,context:r})),t.clear("renderer",r.origin));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},836:function(e,t,r){"use strict";var a=r(2),n=r(3),i=r(5),o=r(6),s=r(0),c=(r(13),r(24)),u=(r(14),r(15),r(1)),l=r(63),p=r(8),d=r(47),b=(r(11),r(19),r(20),r(28)),y=r(282),f=r(280),h=r(281),v=(r(212),r(816)),O=function(e){Object(i.a)(r,e);var t=Object(o.a)(r);function r(e){var n;return Object(a.a)(this,r),(n=t.call(this,e)).id=null,n.name=null,n.domains=null,n.templates=null,n}return Object(n.a)(r,[{key:"readDomains",value:function(e){var t={};for(var r in e)if(e.hasOwnProperty(r)){var a=e[r];switch(a.type){case"range":t[r]=h.a.fromJSON(a);break;case"codedValue":t[r]=y.a.fromJSON(a);break;case"inherited":t[r]=f.a.fromJSON(a)}}return t}},{key:"writeDomains",value:function(e,t){var r={};for(var a in e)e.hasOwnProperty(a)&&(r[a]=e[a]&&e[a].toJSON());Object(c.c)(r),t.domains=r}},{key:"readTemplates",value:function(e){return e&&e.map((function(e){return new v.a(e)}))}},{key:"writeTemplates",value:function(e,t){t.templates=e&&e.map((function(e){return e.toJSON()}))}}]),r}(b.a);Object(s.a)([Object(u.b)({json:{write:!0}})],O.prototype,"id",void 0),Object(s.a)([Object(u.b)({json:{write:!0}})],O.prototype,"name",void 0),Object(s.a)([Object(u.b)({json:{write:!0}})],O.prototype,"domains",void 0),Object(s.a)([Object(l.a)("domains")],O.prototype,"readDomains",null),Object(s.a)([Object(d.a)("domains")],O.prototype,"writeDomains",null),Object(s.a)([Object(u.b)({json:{write:!0}})],O.prototype,"templates",void 0),Object(s.a)([Object(l.a)("templates")],O.prototype,"readTemplates",null),Object(s.a)([Object(d.a)("templates")],O.prototype,"writeTemplates",null);var j=O=Object(s.a)([Object(p.a)("esri.layers.support.FeatureType")],O);t.a=j},845:function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var a=r(2),n=r(5),i=r(6),o=r(0),s=(r(13),r(14),r(15),r(1)),c=r(8),u=(r(11),r(19),r(20),function(e){var t=function(e){Object(n.a)(r,e);var t=Object(i.a)(r);function r(){var e;return Object(a.a)(this,r),(e=t.apply(this,arguments)).customParameters=null,e}return r}(e);return Object(o.a)([Object(s.b)({json:{write:!0,origins:{"web-scene":{write:!1}}}})],t.prototype,"customParameters",void 0),t=Object(o.a)([Object(c.a)("esri.layers.mixins.CustomParametersMixin")],t)})},858:function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var a=r(12),n=r(14),i=r(157),o=r(245),s=n.a.getLogger("esri.layers.support.fieldProperties");function c(){return{fields:{type:[o.a],value:null},outFields:{type:[String],dependsOn:["fields"],json:{read:!1},set:function(e){this._userOutFields=e,this.notifyChange("outFields")},get:function(){var e=this._userOutFields;if(!e||!e.length)return null;if(e.includes("*"))return["*"];if(!this.fields)return e;var t,r=Object(a.a)(e);try{for(r.s();!(t=r.n()).done;){var n=t.value;Object(i.p)(this.fields,n)||s.error("field-attributes-layer:invalid-field","Invalid field ".concat(n," found in outFields"),{layer:this,outFields:e})}}catch(o){r.e(o)}finally{r.f()}return Object(i.i)(this.fields,e)}}}}},863:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var a=r(793),n=/\[([^\[\]]+)\]/gi;function i(e,t,r){var i=this;return e?e.map((function(e){var o=new a.a;if(o.read(e,r),o.labelExpression){var s=t.fields||t.layerDefinition&&t.layerDefinition.fields||i.fields;o.labelExpression=o.labelExpression.replace(n,(function(e,t){return"[".concat(function(e,t){if(!t)return e;for(var r=e.toLowerCase(),a=0;a<t.length;a++){var n=t[a].name;if(n.toLowerCase()===r)return n}return e}(t,s),"]")}))}return o})):null}},871:function(e,t,r){"use strict";r.d(t,"a",(function(){return u})),r.d(t,"b",(function(){return c})),r.d(t,"c",(function(){return l}));var a=r(99),n=r(23),i=r(800),o=r(818),s=r(817),c={key:"type",base:i.a,typeMap:{selection:s.a}};function u(e,t){var r=(t=t.layerDefinition||t).featureReduction;if(r)switch(r.type){case"selection":return s.a.fromJSON(r);case"cluster":return o.a.fromJSON(r)}return null}function l(e,t,r,i){var o=function(e,t,r){return e?"selection"!==e.type?(r.messages&&r.messages.push(new n.a("featureReduction:unsupported","FeatureReduction of type '".concat(e.declaredClass,"' are not supported in scenes."),{featureReduction:e,context:r})),null):e.write(t,r):null}(e,{},i);o&&Object(a.c)(r,o,t)}},963:function(e,t,r){"use strict";r.r(t),r.d(t,"addOrUpdateResource",(function(){return b})),r.d(t,"contentToBlob",(function(){return g})),r.d(t,"fetchResources",(function(){return p})),r.d(t,"getSiblingOfSameType",(function(){return x})),r.d(t,"getSiblingOfSameTypeI",(function(){return S})),r.d(t,"removeAllResources",(function(){return v})),r.d(t,"removeResource",(function(){return f})),r.d(t,"splitPrefixFileNameAndExtension",(function(){return m}));var a=r(10),n=r.n(a),i=r(32),o=r(21),s=r(4),c=r(23),u=r(11),l=r(81);function p(e){return d.apply(this,arguments)}function d(){return(d=Object(o.a)(n.a.mark((function e(t){var r,a,i,o,c,l,p,d,b,y,f,h,v=arguments;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=v.length>1&&void 0!==v[1]?v[1]:{},a=v.length>2?v[2]:void 0,e.next=4,t.load(a);case 4:return i=Object(u.x)(t.itemUrl,"resources"),o=r.start,c=void 0===o?1:o,l=r.num,p=void 0===l?10:l,d=r.sortOrder,b=void 0===d?"asc":d,y=r.sortField,f={query:{start:c,num:p,sortOrder:b,sortField:void 0===y?"created":y},signal:Object(s.g)(a,"signal")},e.next=16,t.portal._request(i,f);case 16:return h=e.sent,e.abrupt("return",{total:h.total,nextStart:h.nextStart,resources:h.resources.map((function(e){var r=e.created,a=e.size,n=e.resource;return{created:new Date(r),size:a,resource:t.resourceFromPath(n)}}))});case 18:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function b(e,t,r,a){return y.apply(this,arguments)}function y(){return(y=Object(o.a)(n.a.mark((function e(t,r,a,o){var l,p,d,b,y,f,h;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.hasPath()){e.next=2;break}throw new c.a("portal-item-resource-".concat(r,":invalid-path"),"Resource does not have a valid path");case 2:return e.next=4,t.portalItem.load(o);case 4:return l=Object(u.x)(t.portalItem.userItemUrl,"add"===r?"addResources":"updateResources"),p=j(t.path),d=Object(i.a)(p,2),b=d[0],y=d[1],e.next=11,g(a);case 11:return f=e.sent,h=new FormData,b&&"."!==b&&h.append("resourcesPrefix",b),h.append("fileName",y),h.append("file",f,y),h.append("f","json"),Object(s.i)(o)&&o.access&&h.append("access",o.access),e.next=20,t.portalItem.portal._request(l,{method:"post",body:h,signal:Object(s.g)(o,"signal")});case 20:return e.abrupt("return",t);case 21:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function f(e,t,r){return h.apply(this,arguments)}function h(){return(h=Object(o.a)(n.a.mark((function e(t,r,a){var i;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.hasPath()){e.next=2;break}throw new c.a("portal-item-resources-remove:invalid-path","Resource does not have a valid path");case 2:return e.next=4,t.load(a);case 4:return i=Object(u.x)(t.userItemUrl,"removeResources"),e.next=7,t.portal._request(i,{method:"post",query:{resource:r.path},signal:Object(s.g)(a,"signal")});case 7:r.portalItem=null;case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function v(e,t){return O.apply(this,arguments)}function O(){return(O=Object(o.a)(n.a.mark((function e(t,r){var a;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.load(r);case 2:return a=Object(u.x)(t.userItemUrl,"removeResources"),e.abrupt("return",t.portal._request(a,{method:"post",query:{deleteAll:!0},signal:Object(s.g)(r,"signal")}));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function j(e){var t=e.lastIndexOf("/");return-1===t?[".",e]:[e.slice(0,t),e.slice(t+1)]}function m(e){var t=function(e){var t=Object(u.n)(e);return Object(s.h)(t)?[e,""]:[e.slice(0,e.length-t.length-1),".".concat(t)]}(e),r=Object(i.a)(t,2),a=r[0],n=r[1],o=j(a),c=Object(i.a)(o,2);return[c[0],c[1],n]}function g(e){return w.apply(this,arguments)}function w(){return(w=Object(o.a)(n.a.mark((function e(t){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t instanceof Blob)){e.next=2;break}return e.abrupt("return",t);case 2:return e.next=4,Object(l.default)(t.url,{responseType:"blob"});case 4:return e.abrupt("return",e.sent.data);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function x(e,t){if(!e.hasPath())return null;var r=m(e.path),a=Object(i.a)(r,3),n=a[0],o=a[2];return e.portalItem.resourceFromPath(Object(u.x)(n,t+o))}function S(e,t){if(!e.hasPath())return null;var r=m(e.path),a=Object(i.a)(r,3),n=a[0],o=a[2];return e.portalItem.resourceFromPath(Object(u.x)(n,t+o))}},970:function(e,t,r){"use strict";function a(e){return e&&"getAtOrigin"in e&&"originOf"in e}r.d(t,"a",(function(){return a}))},977:function(e,t,r){"use strict";r.d(t,"a",(function(){return U}));var a=r(9),n=r(12),i=r(10),o=r.n(i),s=r(21),c=r(2),u=r(3),l=r(5),p=r(6),d=r(0),b=(r(13),r(4)),y=r(14),f=(r(15),r(1)),h=r(63),v=r(8),O=r(47),j=r(23),m=r(11),g=r(19),w=(r(20),r(16)),x=r(44),S=r(62),k=r(81),I=r(124),F=r(384),_=r(970);function E(e){e&&e.writtenProperties&&e.writtenProperties.forEach((function(e){var t=e.target;e.newOrigin&&e.oldOrigin!==e.newOrigin&&Object(_.a)(t)&&t.updateOrigin(e.propName,e.newOrigin)}))}var T=r(385),R=r(233),M=r(278),D=r(963);function L(e,t,r){return A.apply(this,arguments)}function A(){return(A=Object(s.a)(o.a.mark((function e(t,r,a){var i,s,c,u,l,p,d,b,y,f,h,v,O,m,x,S,k;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r&&r.resources){e.next=2;break}return e.abrupt("return");case 2:i=r.portalItem===t.portalItem?new Set(t.paths):new Set,t.paths.length=0,t.portalItem=r.portalItem,s=new Set(r.resources.toKeep.map((function(e){return e.resource.path}))),c=new Set,u=[],s.forEach((function(e){i.delete(e),t.paths.push(e)})),l=Object(n.a)(r.resources.toUpdate);try{for(l.s();!(p=l.n()).done;)d=p.value,i.delete(d.resource.path),s.has(d.resource.path)||c.has(d.resource.path)?(b=d.resource,y=d.content,f=d.finish,h=d.error,v=Object(D.getSiblingOfSameTypeI)(b,Object(g.a)()),t.paths.push(v.path),u.push(C({resource:v,content:y,finish:f,error:h},a))):(t.paths.push(d.resource.path),u.push(N(d,a)),c.add(d.resource.path))}catch(o){l.e(o)}finally{l.f()}O=Object(n.a)(r.resources.toAdd);try{for(O.s();!(m=O.n()).done;)x=m.value,u.push(C(x,a)),t.paths.push(x.resource.path)}catch(o){O.e(o)}finally{O.f()}if(i.forEach((function(e){var t=r.portalItem.resourceFromPath(e);u.push(t.portalItem.removeResource(t).catch((function(){})))})),0!==u.length){e.next=12;break}return e.abrupt("return");case 12:return e.next=14,Object(w.j)(u);case 14:if(S=e.sent,Object(w.w)(a),!((k=S.filter((function(e){return"error"in e})).map((function(e){return e.error}))).length>0)){e.next=19;break}throw new j.a("save:resources","Failed to save one or more resources",{errors:k});case 19:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function C(e,t){return P.apply(this,arguments)}function P(){return(P=Object(s.a)(o.a.mark((function e(t,r){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(M.c)(t.resource.portalItem.addResource(t.resource,t.content,r));case 2:if(!0===(a=e.sent).ok){e.next=5;break}throw t.error&&t.error(a.error),a.error;case 5:t.finish&&t.finish(t.resource);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function N(e,t){return q.apply(this,arguments)}function q(){return(q=Object(s.a)(o.a.mark((function e(t,r){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(M.c)(t.resource.update(t.content,r));case 2:if(!0===(a=e.sent).ok){e.next=5;break}throw t.error(a.error),a.error;case 5:t.finish(t.resource);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var z=r(787),V=y.a.getLogger("esri.layers.mixins.SceneService"),U=function(e){var t=function(e){Object(l.a)(i,e);var t=Object(p.a)(i);function i(){var e;return Object(c.a)(this,i),(e=t.apply(this,arguments)).spatialReference=null,e.fullExtent=null,e.heightModelInfo=null,e.minScale=0,e.maxScale=0,e.version={major:Number.NaN,minor:Number.NaN,versionString:""},e.copyright=null,e.sublayerTitleMode="item-title",e.title=null,e.layerId=null,e._debouncedSaveOperations=Object(w.i)(function(){var t=Object(s.a)(o.a.mark((function t(r,a,n){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=r,t.next=0===t.t0?3:1===t.t0?4:5;break;case 3:return t.abrupt("return",e._save(a));case 4:return t.abrupt("return",e._saveAs(n,a));case 5:case"end":return t.stop()}}),t)})));return function(e,r,a){return t.apply(this,arguments)}}()),e}return Object(u.a)(i,[{key:"readSpatialReference",value:function(e,t){return this._readSpatialReference(t)}},{key:"_readSpatialReference",value:function(e){if(null!=e.spatialReference)return x.a.fromJSON(e.spatialReference);var t=e.store,r=t.indexCRS||t.geographicCRS,a=r&&parseInt(r.substring(r.lastIndexOf("/")+1,r.length),10);return null!=a?new x.a(a):null}},{key:"readFullExtent",value:function(e,t){var r=t.store,a=this._readSpatialReference(t);return null==a||null==r||null==r.extent||!Array.isArray(r.extent)||r.extent.some((function(e){return e<B}))?null:new S.a({xmin:r.extent[0],ymin:r.extent[1],xmax:r.extent[2],ymax:r.extent[3],spatialReference:a})}},{key:"readVersion",value:function(e,t){var r=t.store,a=null!=r.version?r.version.toString():"",n={major:Number.NaN,minor:Number.NaN,versionString:a},i=a.split(".");return i.length>=2&&(n.major=parseInt(i[0],10),n.minor=parseInt(i[1],10)),n}},{key:"readTitlePortalItem",value:function(e){return"item-title"!==this.sublayerTitleMode?void 0:e}},{key:"readTitleService",value:function(e,t){var r=this.portalItem&&this.portalItem.title;if("item-title"===this.sublayerTitleMode)return Object(T.h)(this.url,t.name);var a=t.name;if(!a&&this.url){var n=Object(T.e)(this.url);Object(b.i)(n)&&(a=n.title)}return"item-title-and-service-name"===this.sublayerTitleMode&&r&&(a=r+" - "+a),Object(T.a)(a)}},{key:"url",set:function(e){var t=Object(T.g)(this,e,V);this._set("url",t.url),null!=t.layerId&&this._set("layerId",t.layerId)}},{key:"writeUrl",value:function(e,t,r,a){Object(T.i)(this,e,"layers",t,a)}},{key:"parsedUrl",get:function(){var e=this._get("url");if(!e)return null;var t=Object(m.I)(e);return null!=this.layerId&&Object(T.b)(t.path)&&(t.path="".concat(t.path,"/layers/").concat(this.layerId)),t}},{key:"_verifyRootNodeAndUpdateExtent",value:function(){var e=Object(s.a)(o.a.mark((function e(t,r){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=12;break}return e.prev=1,e.t0=this,e.t1=t,e.next=6,this._fetchRootPage(t,r);case 6:return e.t2=e.sent,e.abrupt("return",e.t0._updateExtentFromRootPage.call(e.t0,e.t1,e.t2));case 10:e.prev=10,e.t3=e.catch(1);case 12:return e.t4=this,e.next=15,this._fetchRootNode(r);case 15:return e.t5=e.sent,e.abrupt("return",e.t4._updateExtentFromRootNode.call(e.t4,e.t5));case 17:case"end":return e.stop()}}),e,this,[[1,10]])})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_fetchRootPage",value:function(){var e=Object(s.a)(o.a.mark((function e(t,r){var a,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",Object(w.t)());case 2:return a=Math.floor(t.rootIndex/t.nodesPerPage),n="".concat(this.parsedUrl.path,"/nodepages/").concat(a),e.next=5,Object(k.default)(n,{responseType:"json",signal:r});case 5:return e.abrupt("return",e.sent.data);case 6:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_updateExtentFromRootPage",value:function(e,t){if(null==t||null==t.nodes)throw new j.a("sceneservice:invalid-node-page","Inavlid node page.");var r=t.nodes[e.rootIndex%e.nodesPerPage];if(null==r||null==r.obb||null==r.obb.center||null==r.obb.halfSize)throw new j.a("sceneservice:invalid-node-page","Inavlid node page.");if(!(r.obb.center[0]<B)){var a=r.obb.halfSize,n=r.obb.center[2],i=Math.sqrt(a[0]*a[0]+a[1]*a[1]+a[2]*a[2]);this.fullExtent.zmin=n-i,this.fullExtent.zmax=n+i}}},{key:"_updateExtentFromRootNode",value:function(e){if(null!=e&&null!=this.fullExtent&&!this.fullExtent.hasZ&&Array.isArray(e.mbs)&&4===e.mbs.length&&!(e.mbs[0]<B)){var t=e.mbs[2],r=e.mbs[3];this.fullExtent.zmin=t-r,this.fullExtent.zmax=t+r}}},{key:"_fetchRootNode",value:function(){var e=Object(s.a)(o.a.mark((function e(t){var r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.rootNode){e.next=2;break}return e.abrupt("return");case 2:return r=Object(m.x)(this.parsedUrl.path,this.rootNode),e.prev=3,e.next=6,Object(k.default)(r,{query:{f:"json"},responseType:"json",signal:t});case 6:return e.abrupt("return",e.sent.data);case 9:throw e.prev=9,e.t0=e.catch(3),new j.a("sceneservice:root-node-missing","Root node missing.",{error:e.t0,url:r});case 12:case"end":return e.stop()}}),e,this,[[3,9]])})));return function(t){return e.apply(this,arguments)}}()},{key:"_fetchService",value:function(){var e=Object(s.a)(o.a.mark((function e(t){var r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=this.layerId||!/SceneServer\/*$/i.test(this.url)){e.next=5;break}return e.next=3,this._fetchFirstLayerId(t);case 3:null!=(r=e.sent)&&(this.layerId=r);case 5:return e.abrupt("return",this._fetchServiceLayer(t));case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_fetchFirstLayerId",value:function(){var e=Object(s.a)(o.a.mark((function e(t){var r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(k.default)(this.url,{query:{f:"json"},responseType:"json",signal:t});case 2:if(!((r=e.sent).data&&Array.isArray(r.data.layers)&&r.data.layers.length>0)){e.next=5;break}return e.abrupt("return",r.data.layers[0].id);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_fetchServiceLayer",value:function(){var e=Object(s.a)(o.a.mark((function e(t){var r,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(k.default)(this.parsedUrl.path,{query:{f:"json"},responseType:"json",signal:t});case 2:(r=e.sent).ssl&&(this.url=this.url.replace(/^http:/i,"https:")),a=r.data,this.read(a,{origin:"service",url:this.parsedUrl}),this.validateLayer(a);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_ensureLoadBeforeSave",value:function(){var e=Object(s.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.load();case 2:if(e.t0="beforeSave"in this&&"function"==typeof this.beforeSave,!e.t0){e.next=6;break}return e.next=6,this.beforeSave();case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"validateLayer",value:function(e){}},{key:"_updateTypeKeywords",value:function(e,t,r){e.typeKeywords||(e.typeKeywords=[]);var a,i=t.getTypeKeywords(),o=Object(n.a)(i);try{for(o.s();!(a=o.n()).done;){var s=a.value;e.typeKeywords.push(s)}}catch(c){o.e(c)}finally{o.f()}e.typeKeywords&&(e.typeKeywords=e.typeKeywords.filter((function(e,t,r){return r.indexOf(e)===t})),1===r&&(e.typeKeywords=e.typeKeywords.filter((function(e){return"Hosted Service"!==e}))))}},{key:"_saveAs",value:function(){var e=Object(s.a)(o.a.mark((function e(t,r){var n,i,s,c,u;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=Object(a.a)(Object(a.a)({},J),r),i=F.default.from(t),e.t0=i,e.t0){e.next=7;break}return V.error("_saveAs(): requires a portal item parameter"),e.next=7,Object(w.t)(new j.a("sceneservice:portal-item-required","_saveAs() requires a portal item to save to"));case 7:return i.id&&((i=i.clone()).id=null),s=i.portal||I.a.getDefault(),e.next=11,this._ensureLoadBeforeSave();case 11:return i.type=Q,i.portal=s,c={origin:"portal-item",url:null,messages:[],portal:s,portalItem:i,writtenProperties:[],blockedRelativeUrls:[],resources:{toAdd:[],toUpdate:[],toKeep:[],pendingOperations:[]}},u={layers:[this.write(null,c)]},e.next=16,Object(w.b)(c.resources.pendingOperations);case 16:return e.next=18,this._validateAgainstJSONSchema(u,c,n);case 18:return i.url=this.url,i.title||(i.title=this.title),this._updateTypeKeywords(i,n,1),e.next=23,s._signIn();case 23:return e.next=25,s.user.addItem({item:i,folder:n&&n.folder,data:u});case 25:return e.next=27,L(this.resourceReferences,c,null);case 27:return this.portalItem=i,E(c),c.portalItem=i,e.abrupt("return",i);case 31:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_save",value:function(){var e=Object(s.a)(o.a.mark((function e(t){var r,n,i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Object(a.a)(Object(a.a)({},J),t),e.t0=this.portalItem,e.t0){e.next=6;break}return V.error("_save(): requires the .portalItem property to be set"),e.next=6,Object(w.t)(new j.a("sceneservice:portal-item-not-set","Portal item to save to has not been set on this SceneService"));case 6:if(e.t1=this.portalItem.type!==Q,!e.t1){e.next=11;break}return V.error("_save(): Non-matching portal item type. Got "+this.portalItem.type+", expected "+Q),e.next=11,Object(w.t)(new j.a("sceneservice:portal-item-wrong-type",'Portal item needs to have type "'.concat(Q,'"')));case 11:return e.next=13,this._ensureLoadBeforeSave();case 13:return n={origin:"portal-item",url:this.portalItem.itemUrl&&Object(m.I)(this.portalItem.itemUrl),messages:[],portal:this.portalItem.portal||I.a.getDefault(),portalItem:this.portalItem,writtenProperties:[],blockedRelativeUrls:[],resources:{toAdd:[],toUpdate:[],toKeep:[],pendingOperations:[]}},i={layers:[this.write(null,n)]},e.next=16,Object(w.b)(n.resources.pendingOperations);case 16:return e.next=18,this._validateAgainstJSONSchema(i,n,r);case 18:return this.portalItem.url=this.url,this.portalItem.title||(this.portalItem.title=this.title),this._updateTypeKeywords(this.portalItem,r,0),e.next=23,this.portalItem.update({data:i});case 23:return e.next=25,L(this.resourceReferences,n,null);case 25:return E(n),e.abrupt("return",this.portalItem);case 27:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_validateAgainstJSONSchema",value:function(){var e=Object(s.a)(o.a.mark((function e(t,a,n){var i,s,c,u;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=a.messages.filter((function(e){return"error"===e.type})).map((function(e){return new j.a(e.name,e.message,e.details)})),n&&n.validationOptions.ignoreUnsupported&&(i=i.filter((function(e){return"layer:unsupported"!==e.name&&"symbol:unsupported"!==e.name&&"symbol-layer:unsupported"!==e.name&&"property:unsupported"!==e.name&&"url:unsupported"!==e.name&&"scenemodification:unsupported"!==e.name}))),!n.validationOptions.enabled&&!G){e.next=10;break}return e.next=4,r.e(205).then(r.bind(null,1295));case 4:if(!((s=e.sent.validate(t,n.portalItemLayerType)).length>0)){e.next=10;break}if(c="Layer item did not validate:\n".concat(s.join("\n")),V.error("_validateAgainstJSONSchema(): ".concat(c)),"throw"!==n.validationOptions.failPolicy){e.next=10;break}throw u=s.map((function(e){return new j.a("sceneservice:schema-validation",e)})).concat(i),new j.a("sceneservice-validate:error","Failed to save layer item due to schema validation, see `details.errors`.",{combined:u});case 10:if(!(i.length>0)){e.next=12;break}throw new j.a("sceneservice:save","Failed to save SceneService due to unsupported or invalid content. See 'details.errors' for more detailed information",{errors:i});case 12:case"end":return e.stop()}}),e)})));return function(t,r,a){return e.apply(this,arguments)}}()}]),i}(e);return Object(d.a)([Object(f.b)({json:{origins:{service:{read:!1},"portal-item":{read:!1}}}})],t.prototype,"id",void 0),Object(d.a)([Object(f.b)({type:x.a})],t.prototype,"spatialReference",void 0),Object(d.a)([Object(h.a)("spatialReference",["spatialReference","store.indexCRS","store.geographicCRS"])],t.prototype,"readSpatialReference",null),Object(d.a)([Object(f.b)({type:S.a})],t.prototype,"fullExtent",void 0),Object(d.a)([Object(h.a)("fullExtent",["store.extent","spatialReference","store.indexCRS","store.geographicCRS"])],t.prototype,"readFullExtent",null),Object(d.a)([Object(f.b)({readOnly:!0,type:R.a})],t.prototype,"heightModelInfo",void 0),Object(d.a)([Object(f.b)({type:Number,json:{name:"layerDefinition.minScale",write:!0,origins:{service:{read:{source:"minScale"},write:!1}}}})],t.prototype,"minScale",void 0),Object(d.a)([Object(f.b)({type:Number,json:{name:"layerDefinition.maxScale",write:!0,origins:{service:{read:{source:"maxScale"},write:!1}}}})],t.prototype,"maxScale",void 0),Object(d.a)([Object(f.b)({readOnly:!0})],t.prototype,"version",void 0),Object(d.a)([Object(h.a)("version",["store.version"])],t.prototype,"readVersion",null),Object(d.a)([Object(f.b)({type:String,json:{read:{source:"copyrightText"}}})],t.prototype,"copyright",void 0),Object(d.a)([Object(f.b)({type:String,json:{read:!1}})],t.prototype,"sublayerTitleMode",void 0),Object(d.a)([Object(f.b)({type:String})],t.prototype,"title",void 0),Object(d.a)([Object(h.a)("portal-item","title")],t.prototype,"readTitlePortalItem",null),Object(d.a)([Object(h.a)("service","title",["name"])],t.prototype,"readTitleService",null),Object(d.a)([Object(f.b)({type:Number,json:{origins:{service:{read:{source:"id"}},"portal-item":{write:{target:"id",isRequired:!0,ignoreOrigin:!0},read:!1}}}})],t.prototype,"layerId",void 0),Object(d.a)([Object(f.b)(z.j)],t.prototype,"url",null),Object(d.a)([Object(O.a)("url")],t.prototype,"writeUrl",null),Object(d.a)([Object(f.b)({dependsOn:["layerId"]})],t.prototype,"parsedUrl",null),Object(d.a)([Object(f.b)({readOnly:!0})],t.prototype,"store",void 0),Object(d.a)([Object(f.b)({type:String,readOnly:!0,json:{read:{source:"store.rootNode"}}})],t.prototype,"rootNode",void 0),t=Object(d.a)([Object(v.a)("esri.layers.mixins.SceneService")],t),t},B=-1e38,G=!1,Q="Scene Service",J={getTypeKeywords:function(){return[]},portalItemLayerType:"unknown",validationOptions:{enabled:!0,ignoreUnsupported:!1,failPolicy:"throw"}}},999:function(e,t,r){"use strict";r.d(t,"a",(function(){return m})),r.d(t,"b",(function(){return y})),r.d(t,"c",(function(){return p})),r.d(t,"d",(function(){return h}));var a=r(2),n=r(5),i=r(6),o=r(0),s=(r(13),r(14),r(15),r(1)),c=r(42),u=r(8),l=(r(11),r(19),r(20),r(28)),p=function(e){Object(n.a)(r,e);var t=Object(i.a)(r);function r(){var e;return Object(a.a)(this,r),(e=t.apply(this,arguments)).nodesPerPage=null,e.rootIndex=0,e.lodSelectionMetricType=null,e}return r}(l.a);Object(o.a)([Object(s.b)({type:Number})],p.prototype,"nodesPerPage",void 0),Object(o.a)([Object(s.b)({type:Number})],p.prototype,"rootIndex",void 0),Object(o.a)([Object(s.b)({type:String})],p.prototype,"lodSelectionMetricType",void 0),p=Object(o.a)([Object(u.a)("esri.layer.support.I3SNodePageDefinition")],p);var d=function(e){Object(n.a)(r,e);var t=Object(i.a)(r);function r(){var e;return Object(a.a)(this,r),(e=t.apply(this,arguments)).factor=1,e}return r}(l.a);Object(o.a)([Object(s.b)({type:Number,json:{read:{source:"textureSetDefinitionId"}}})],d.prototype,"id",void 0),Object(o.a)([Object(s.b)({type:Number})],d.prototype,"factor",void 0),d=Object(o.a)([Object(u.a)("esri.layer.support.I3SMaterialTexture")],d);var b=function(e){Object(n.a)(r,e);var t=Object(i.a)(r);function r(){var e;return Object(a.a)(this,r),(e=t.apply(this,arguments)).baseColorFactor=[1,1,1,1],e.baseColorTexture=null,e.metallicRoughnessTexture=null,e.metallicFactor=1,e.roughnessFactor=1,e}return r}(l.a);Object(o.a)([Object(s.b)({type:[Number]})],b.prototype,"baseColorFactor",void 0),Object(o.a)([Object(s.b)({type:d})],b.prototype,"baseColorTexture",void 0),Object(o.a)([Object(s.b)({type:d})],b.prototype,"metallicRoughnessTexture",void 0),Object(o.a)([Object(s.b)({type:Number})],b.prototype,"metallicFactor",void 0),Object(o.a)([Object(s.b)({type:Number})],b.prototype,"roughnessFactor",void 0),b=Object(o.a)([Object(u.a)("esri.layer.support.I3SMaterialPBRMetallicRoughness")],b);var y=function(e){Object(n.a)(r,e);var t=Object(i.a)(r);function r(){var e;return Object(a.a)(this,r),(e=t.apply(this,arguments)).alphaMode="opaque",e.alphaCutoff=.25,e.doubleSided=!1,e.cullFace="none",e.normalTexture=null,e.occlusionTexture=null,e.emissiveTexture=null,e.emissiveFactor=null,e.pbrMetallicRoughness=null,e}return r}(l.a);Object(o.a)([Object(c.a)({opaque:"opaque",mask:"mask",blend:"blend"})],y.prototype,"alphaMode",void 0),Object(o.a)([Object(s.b)({type:Number})],y.prototype,"alphaCutoff",void 0),Object(o.a)([Object(s.b)({type:Boolean})],y.prototype,"doubleSided",void 0),Object(o.a)([Object(c.a)({none:"none",back:"back",front:"front"})],y.prototype,"cullFace",void 0),Object(o.a)([Object(s.b)({type:d})],y.prototype,"normalTexture",void 0),Object(o.a)([Object(s.b)({type:d})],y.prototype,"occlusionTexture",void 0),Object(o.a)([Object(s.b)({type:d})],y.prototype,"emissiveTexture",void 0),Object(o.a)([Object(s.b)({type:[Number]})],y.prototype,"emissiveFactor",void 0),Object(o.a)([Object(s.b)({type:b})],y.prototype,"pbrMetallicRoughness",void 0),y=Object(o.a)([Object(u.a)("esri.layer.support.I3SMaterialDefinition")],y);var f=function(e){Object(n.a)(r,e);var t=Object(i.a)(r);function r(){return Object(a.a)(this,r),t.apply(this,arguments)}return r}(l.a);Object(o.a)([Object(s.b)({type:String,json:{read:{source:["name","index"],reader:function(e,t){return null!=e?e:"".concat(t.index)}}}})],f.prototype,"name",void 0),Object(o.a)([Object(c.a)({jpg:"jpg",png:"png",dds:"dds","ktx-etc2":"ktx-etc2"})],f.prototype,"format",void 0),f=Object(o.a)([Object(u.a)("esri.layer.support.I3STextureFormat")],f);var h=function(e){Object(n.a)(r,e);var t=Object(i.a)(r);function r(){var e;return Object(a.a)(this,r),(e=t.apply(this,arguments)).atlas=!1,e}return r}(l.a);Object(o.a)([Object(s.b)({type:[f]})],h.prototype,"formats",void 0),Object(o.a)([Object(s.b)({type:Boolean})],h.prototype,"atlas",void 0),h=Object(o.a)([Object(u.a)("esri.layer.support.I3STextureSetDefinition")],h);var v=function(e){Object(n.a)(r,e);var t=Object(i.a)(r);function r(){return Object(a.a)(this,r),t.apply(this,arguments)}return r}(l.a);Object(o.a)([Object(c.a)({Float32:"Float32",UInt64:"UInt64",UInt32:"UInt32",UInt16:"UInt16",UInt8:"UInt8"})],v.prototype,"type",void 0),Object(o.a)([Object(s.b)({type:Number})],v.prototype,"component",void 0),v=Object(o.a)([Object(u.a)("esri.layer.support.I3SGeometryAttribute")],v);var O=function(e){Object(n.a)(r,e);var t=Object(i.a)(r);function r(){return Object(a.a)(this,r),t.apply(this,arguments)}return r}(l.a);Object(o.a)([Object(c.a)({draco:"draco"})],O.prototype,"encoding",void 0),Object(o.a)([Object(s.b)({type:[String]})],O.prototype,"attributes",void 0),O=Object(o.a)([Object(u.a)("esri.layer.support.I3SGeometryCompressedAttributes")],O);var j=function(e){Object(n.a)(r,e);var t=Object(i.a)(r);function r(){var e;return Object(a.a)(this,r),(e=t.apply(this,arguments)).offset=0,e}return r}(l.a);Object(o.a)([Object(s.b)({type:Number})],j.prototype,"offset",void 0),Object(o.a)([Object(s.b)({type:v})],j.prototype,"position",void 0),Object(o.a)([Object(s.b)({type:v})],j.prototype,"normal",void 0),Object(o.a)([Object(s.b)({type:v})],j.prototype,"uv0",void 0),Object(o.a)([Object(s.b)({type:v})],j.prototype,"color",void 0),Object(o.a)([Object(s.b)({type:v})],j.prototype,"uvRegion",void 0),Object(o.a)([Object(s.b)({type:v})],j.prototype,"featureId",void 0),Object(o.a)([Object(s.b)({type:v})],j.prototype,"faceRange",void 0),Object(o.a)([Object(s.b)({type:O})],j.prototype,"compressedAttributes",void 0),j=Object(o.a)([Object(u.a)("esri.layer.support.I3SGeometryBuffer")],j);var m=function(e){Object(n.a)(r,e);var t=Object(i.a)(r);function r(){return Object(a.a)(this,r),t.apply(this,arguments)}return r}(l.a);Object(o.a)([Object(c.a)({triangle:"triangle"})],m.prototype,"topology",void 0),Object(o.a)([Object(s.b)()],m.prototype,"geometryBuffers",void 0),m=Object(o.a)([Object(u.a)("esri.layer.support.I3SGeometryDefinition")],m)}}]);
//# sourceMappingURL=53.78d08f6d.chunk.js.map