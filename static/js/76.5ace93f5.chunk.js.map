{"version":3,"sources":["../node_modules/@arcgis/core/layers/support/ExportImageParameters.js","../node_modules/@arcgis/core/views/2d/layers/MapImageLayerView2D.js","../node_modules/@arcgis/core/views/layers/MapImageLayerView.js","../node_modules/@arcgis/core/layers/support/commonProperties.js","../node_modules/@arcgis/core/renderers/support/clickToleranceUtils.js","../node_modules/@arcgis/core/views/support/drapedUtils.js","../node_modules/@arcgis/core/layers/support/sublayerUtils.js","../node_modules/@arcgis/core/views/layers/support/popupUtils.js"],"names":["o","visible","definitionExpression","labelingInfo","labelsVisible","opacity","minScale","maxScale","renderer","source","y","arguments","_scale","view","this","layer","hasDynamicLayers","e","visibleSublayers","map","toExportImageJSON","length","JSON","stringify","l","serviceSublayers","_get","_set","handles","remove","add","allSublayers","on","notifyChange","propertyName","id","join","filter","reduce","s","scale","layers","layerDefs","dynamicLayers","timeExtent","dpi","imageFormat","imageTransparency","gdbVersion","sublayers","forEach","r","i","a","t","unshift","some","format","transparent","readOnly","dependsOn","prototype","type","Number","n","c","getLogger","_exportImageVersion","strategy","update","catch","error","imageMaxWidth","imageMaxHeight","version","_bitmapContainer","d","container","addChild","u","fetchSource","fetchImage","bind","requestUpdate","imageRotationSupported","imageNormalizationSupported","hidpi","imageParameters","p","destroy","removeChild","removeAllChildren","h","updating","updateRequested","timestamp","refreshTimestamp","get","popupEnabled","m","defaultPopupTemplateEnabled","push","sublayer","popupTemplate","toArray","f","load","createQuery","event","createFetchPopupFeaturesQueryGeometry","geometry","outFields","_loadArcadeModules","arcadeUtils","hasGeometryOperations","maxAllowableOffset","width","queryFeatures","features","value","isEmpty","g","Boolean","json","origins","read","reader","screenSizePerspective","originOf","store","set","write","ignoreOrigin","target","writer","name","disablePopup","enabled","String","isRequired","service","default","origin","drawingInfo","transparency","layerDefinition","timeInfo","useViewTime","intersection","timeOffset","offset","unit","equals","xoffset","Math","max","abs","yoffset","stops","size","pointerType","maxSize","minSize","floor","visualVariables","symbol","uniqueValueInfos","classBreakInfos","resolution","overlayPixelSizeInMapUnits","basemapSpatialReference","spatialReference","x","xmin","min","ymin","xmax","ymax","toMap","intersects","flatten","originIdOf","mapLayerId","slice","reverse","getRequiredFields","fields","lastEditInfoEnabled","objectIdField","typeIdField","globalIdField","relationships","includes","indexOf","keyField","defaultPopupTemplate"],"mappings":"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","file":"static/js/76.5ace93f5.chunk.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import\"../../core/has.js\";import\"../../core/Logger.js\";import\"../../core/accessorSupport/ensureType.js\";import{property as s}from\"../../core/accessorSupport/decorators/property.js\";import{subclass as r}from\"../../core/accessorSupport/decorators/subclass.js\";import\"../../core/urlUtils.js\";import\"../../core/uuid.js\";import\"../../portal/support/resourceExtension.js\";import i from\"../../core/Accessor.js\";import{combinedViewLayerTimeExtentProperty as a}from\"./commonProperties.js\";import{HandleOwnerMixin as t}from\"../../core/HandleOwner.js\";import{isExportDynamic as l}from\"./sublayerUtils.js\";import n from\"../../views/View.js\";const o={visible:\"visibleSublayers\",definitionExpression:\"layerDefs\",labelingInfo:\"hasDynamicLayers\",labelsVisible:\"hasDynamicLayers\",opacity:\"hasDynamicLayers\",minScale:\"visibleSublayers\",maxScale:\"visibleSublayers\",renderer:\"hasDynamicLayers\",source:\"hasDynamicLayers\"};let y=class extends(t(i)){constructor(){super(...arguments),this._scale=null,this.view=null}destroy(){this.layer=this.view=null}get dynamicLayers(){if(!this.hasDynamicLayers)return null;const e=this.visibleSublayers.map((e=>e.toExportImageJSON()));return e.length?JSON.stringify(e):null}get hasDynamicLayers(){return this.layer&&l(this.visibleSublayers,this.layer.serviceSublayers,this.layer)}set layer(e){this._get(\"layer\")!==e&&(this._set(\"layer\",e),this.handles.remove(\"layer\"),e&&this.handles.add([e.allSublayers.on(\"change\",(()=>this.notifyChange(\"visibleSublayers\"))),e.on(\"sublayer-update\",(e=>this.notifyChange(o[e.propertyName])))],\"layer\"))}get layers(){const e=this.visibleSublayers;return e?e.length?\"show:\"+e.map((e=>e.id)).join(\",\"):\"show:-1\":null}get layerDefs(){const e=this.visibleSublayers.filter((e=>null!=e.definitionExpression));return e.length?JSON.stringify(e.reduce(((e,s)=>(e[s.id]=s.definitionExpression,e)),{})):null}get scale(){return null!=this._scale?this._scale:this.view&&this.view.scale||0}set scale(e){this.view||(this._scale=e,this.notifyChange(\"scale\"))}get version(){const e=this;e.layers,e.layerDefs,e.dynamicLayers,e.timeExtent;const s=e.layer;return s&&(s.dpi,s.imageFormat,s.imageTransparency,s.gdbVersion),(this._get(\"version\")||0)+1}set version(e){this._set(\"version\",e)}get visibleSublayers(){const e=[];if(!this.layer)return e;const s=this.layer.sublayers,r=s=>{const i=this.scale,a=0===i,t=0===s.minScale||i<=s.minScale,l=0===s.maxScale||i>=s.maxScale;s.visible&&(a||t&&l)&&(s.sublayers?s.sublayers.forEach(r):e.unshift(s))};s&&s.forEach(r);const i=this._get(\"visibleSublayers\");return!i||i.length!==e.length||i.some(((s,r)=>e[r]!==s))?e:i}toJSON(){const e=this.layer;let s={dpi:e.dpi,format:e.imageFormat,transparent:e.imageTransparency,gdbVersion:e.gdbVersion||null};return this.hasDynamicLayers&&this.dynamicLayers?s.dynamicLayers=this.dynamicLayers:s={...s,layers:this.layers,layerDefs:this.layerDefs},s}};e([s({readOnly:!0,dependsOn:[\"hasDynamicLayers\",\"visibleSublayers\"]})],y.prototype,\"dynamicLayers\",null),e([s({readOnly:!0,dependsOn:[\"visibleSublayers\",\"layer.serviceSublayers\",\"layer.capabilities\"]})],y.prototype,\"hasDynamicLayers\",null),e([s()],y.prototype,\"layer\",null),e([s({readOnly:!0,dependsOn:[\"visibleSublayers\"]})],y.prototype,\"layers\",null),e([s({readOnly:!0,dependsOn:[\"visibleSublayers\"]})],y.prototype,\"layerDefs\",null),e([s({type:Number,dependsOn:[\"view.scale\"]})],y.prototype,\"scale\",null),e([s(a)],y.prototype,\"timeExtent\",void 0),e([s({dependsOn:[\"layers\",\"layerDefs\",\"dynamicLayers\",\"layer.dpi\",\"layer.imageFormat\",\"layer.imageTransparency\",\"layer.gdbVersion\",\"timeExtent\"]})],y.prototype,\"version\",null),e([s({type:n})],y.prototype,\"view\",void 0),e([s({readOnly:!0,dependsOn:[\"layer.sublayers\",\"scale\"]})],y.prototype,\"visibleSublayers\",null),y=e([r(\"esri.layers.mixins.ExportImageParameters\")],y);export{y as ExportImageParameters};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import\"../../../core/has.js\";import t from\"../../../core/Logger.js\";import\"../../../core/accessorSupport/ensureType.js\";import{property as r}from\"../../../core/accessorSupport/decorators/property.js\";import{subclass as i}from\"../../../core/accessorSupport/decorators/subclass.js\";import\"../../../core/urlUtils.js\";import\"../../../core/uuid.js\";import\"../../../portal/support/resourceExtension.js\";import{isAbortError as s}from\"../../../core/promiseUtils.js\";import{init as a}from\"../../../core/watchUtils.js\";import{RefreshableLayerView as o}from\"../../layers/RefreshableLayerView.js\";import{ExportImageParameters as p}from\"../../../layers/support/ExportImageParameters.js\";import m from\"../../layers/LayerView.js\";import{createQueryGeometry as h}from\"../../support/drapedUtils.js\";import{MapImageLayerView as n}from\"../../layers/MapImageLayerView.js\";import{BitmapContainer as d}from\"../engine/BitmapContainer.js\";import{LayerView2DMixin as g}from\"./LayerView2D.js\";import u from\"./support/ExportStrategy.js\";const c=t.getLogger(\"esri.views.2d.layers.MapImageLayerView2D\");let l=class extends(n(o(g(m)))){constructor(){super(...arguments),this._exportImageVersion=-1}hitTest(){return null}update(e){this.strategy.update(e).catch((e=>{s(e)||c.error(e)}))}attach(){const{imageMaxWidth:e,imageMaxHeight:t,version:r}=this.layer,i=r>=10.3,s=r>=10;this._bitmapContainer=new d,this.container.addChild(this._bitmapContainer),this.strategy=new u({container:this._bitmapContainer,fetchSource:this.fetchImage.bind(this),requestUpdate:this.requestUpdate.bind(this),imageMaxWidth:e,imageMaxHeight:t,imageRotationSupported:i,imageNormalizationSupported:s,hidpi:!0}),this.imageParameters=new p({view:this.view,layer:this.layer}),this.handles.add(a(this.imageParameters,\"version\",(e=>{this._exportImageVersion!==e&&(this._exportImageVersion=e,this.requestUpdate())})),\"mapimagelayerview-update\")}detach(){this.strategy.destroy(),this.handles.remove(\"mapimagelayerview-update\"),this.imageParameters.destroy(),this.imageParameters=null,this._exportImageVersion=-1,this.container.removeChild(this._bitmapContainer),this._bitmapContainer.removeAllChildren()}moveStart(){}viewChange(){}moveEnd(){this.requestUpdate()}createFetchPopupFeaturesQueryGeometry(e,t){return h(e,t,this.view)}async doRefresh(){this.requestUpdate()}isUpdating(){return this.strategy.updating||this.updateRequested}fetchImage(e,t,r,i){return this.layer.fetchImage(e,t,r,{timeExtent:this.imageParameters.timeExtent,timestamp:this.refreshTimestamp,...i})}};e([r()],l.prototype,\"strategy\",void 0),e([r({dependsOn:[\"strategy.updating\"]})],l.prototype,\"updating\",void 0),l=e([i(\"esri.views.2d.layers.MapImageLayerView2D\")],l);var y=l;export default y;\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import\"../../core/has.js\";import{isSome as r}from\"../../core/maybe.js\";import\"../../core/Logger.js\";import\"../../core/accessorSupport/ensureType.js\";import{property as t}from\"../../core/accessorSupport/decorators/property.js\";import{subclass as s}from\"../../core/accessorSupport/decorators/subclass.js\";import o from\"../../core/Error.js\";import\"../../core/urlUtils.js\";import\"../../core/uuid.js\";import\"../../portal/support/resourceExtension.js\";import{reject as a,all as p,eachAlways as i}from\"../../core/promiseUtils.js\";import{loadArcade as u}from\"../../support/arcadeOnDemand.js\";import{calculateTolerance as c}from\"../../renderers/support/clickToleranceUtils.js\";import{getRequiredFields as l,getFetchPopupTemplate as m}from\"./support/popupUtils.js\";const n=n=>{let d=class extends n{async fetchPopupFeatures(e,t){const{layer:s}=this;if(!e)return a(new o(\"mapimagelayerview:fetchPopupFeatures\",\"Nothing to fetch without area\",{layer:s}));const u=this.get(\"view.scale\"),n=[],d=async e=>{const s=0===e.minScale||u<=e.minScale,o=0===e.maxScale||u>=e.maxScale;if(e.visible&&s&&o)if(e.sublayers)e.sublayers.forEach(d);else if(e.popupEnabled){const s=m(e,{...t,defaultPopupTemplateEnabled:!1});r(s)&&n.push({sublayer:e,popupTemplate:s})}},y=s.sublayers.toArray().map(d);await p(y);const f=n.map((async({sublayer:s,popupTemplate:o})=>{await s.load().catch((()=>{}));const a=s.createQuery(),p=r(t)?t.event:null,i=c({renderer:s.renderer,event:p}),u=this.createFetchPopupFeaturesQueryGeometry(e,i);a.geometry=u,a.outFields=await l(s,o);const m=await this._loadArcadeModules(o);m&&m.arcadeUtils.hasGeometryOperations(o)||(a.maxAllowableOffset=u.width/i);return(await s.queryFeatures(a)).features}));return(await i(f)).reduce(((e,r)=>r.value?[...e,...r.value]:e),[]).filter((e=>null!=e))}canResume(){var e,r;return!!super.canResume()&&(null==(e=this.imageParameters)||null==(r=e.timeExtent)||!r.isEmpty)}_loadArcadeModules(e){if(e.get(\"expressionInfos.length\"))return u()}};return e([t()],d.prototype,\"imageParameters\",void 0),e([t()],d.prototype,\"layer\",void 0),e([t({dependsOn:[\"imageParameters.timeExtent\"]})],d.prototype,\"suspended\",void 0),d=e([s(\"esri.views.layers.MapImageLayerView\")],d),d};export{n as MapImageLayerView};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nimport{getProperties as e}from\"../../core/accessorSupport/utils.js\";import{w as i}from\"../../chunks/persistableUrlUtils.js\";import{willPropertyWrite as r}from\"../../core/accessorSupport/write.js\";import{transparencyToOpacity as n}from\"../../webdoc/support/opacityUtils.js\";import t from\"../../TimeExtent.js\";import o from\"../../symbols/support/ElevationInfo.js\";const s={type:Boolean,value:!0,json:{origins:{\"web-scene\":{read:{source:[\"id\",\"url\",\"layerType\"],reader(i,r){if(null!=r.screenSizePerspective||\"defaults\"!==this.originOf(\"screenSizePerspectiveEnabled\"))return r.screenSizePerspective;e(this).store.set(\"screenSizePerspectiveEnabled\",!1,0)}},write:{ignoreOrigin:!0,target:\"screenSizePerspective\",writer(e,i,n,t){(\"defaults\"===this.originOf(\"screenSizePerspectiveEnabled\")&&e||r(this,\"screenSizePerspectiveEnabled\",{},t))&&(i[n]=e)}}}}}},a={type:Boolean,value:!0,json:{name:\"disablePopup\",read:{reader:(e,i)=>!i.disablePopup},write:{enabled:!0,writer(e,i,r){i[r]=!e}}}},l={type:Boolean,value:!0,json:{name:\"showLabels\",write:!0}},p={type:String,json:{origins:{\"portal-item\":{write:!1}},write:{isRequired:!0,ignoreOrigin:!0,writer:i}}},c={type:Boolean,value:!0,json:{origins:{service:{read:{enabled:!1}}},name:\"showLegend\",write:!0}},d={value:null,type:o,json:{origins:{service:{name:\"elevationInfo\",write:!0}},name:\"layerDefinition.elevationInfo\",write:!0}};function f(e){return{type:e,readOnly:!0,json:{origins:{service:{read:!0}},read:!1}}}const u={type:Number,json:{origins:{\"web-document\":{default:1,write:!0,read:!0},\"portal-item\":{write:!0}}}},y={...u,json:{...u.json,origins:{\"web-document\":{...u.json.origins[\"web-document\"],write:{enabled:!0,target:{opacity:{type:Number},\"layerDefinition.drawingInfo.transparency\":{type:Number}}}}},read:{source:[\"layerDefinition.drawingInfo.transparency\",\"drawingInfo.transparency\"],reader:(e,i,r)=>r&&\"service\"!==r.origin||!i.drawingInfo||void 0===i.drawingInfo.transparency?i.layerDefinition&&i.layerDefinition.drawingInfo&&void 0!==i.layerDefinition.drawingInfo.transparency?n(i.layerDefinition.drawingInfo.transparency):void 0:n(i.drawingInfo.transparency)}}},m={type:t,dependsOn:[\"view.timeExtent\",\"layer.timeExtent\",\"layer.timeInfo\",\"layer.timeOffset\",\"layer.timeOffset.value\",\"layer.timeOffset.unit\",\"layer.useViewTime\"],readOnly:!0,get(){var e,i;if(null==(e=this.layer)||!e.timeInfo)return null;const r=null==(i=this.view)?void 0:i.timeExtent,n=this.layer.timeExtent,t=this.layer.useViewTime?r&&n?r.intersection(n):r||n:n;if(!t||t.isEmpty)return t;const o=this.layer.timeOffset,s=o?t.offset(-o.value,o.unit):t,a=this._get(\"timeExtent\");return s.equals(a)?a:s}};export{m as combinedViewLayerTimeExtentProperty,d as elevationInfo,l as labelsVisible,c as legendEnabled,u as opacity,y as opacityDrawingInfo,a as popupEnabled,f as readOnlyService,s as screenSizePerspectiveEnabled,p as url};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nfunction t(t,e){return e?\"xoffset\"in e&&e.xoffset?Math.max(t,Math.abs(e.xoffset)):\"yoffset\"in e&&e.yoffset?Math.max(t,Math.abs(e.yoffset||0)):t:t}function e(t,e){return\"number\"==typeof t?t:t&&t.stops&&t.stops.length?function(t){let e=0,n=0;for(let r=0;r<t.length;r++){const s=t[r].size;\"number\"==typeof s&&(e+=s,n++)}return e/n}(t.stops):e}function n(n){const r=n&&n.renderer,s=\"touch\"===(n&&n.event&&n.event.pointerType)?9:6;if(!r)return s;const o=\"visualVariables\"in r?function(t,n){if(!n)return t;const r=n.filter((t=>\"size\"===t.type)).map((n=>{const{maxSize:r,minSize:s}=n;return(e(r,t)+e(s,t))/2}));let s=0;const o=r.length;if(0===o)return t;for(let t=0;t<o;t++)s+=r[t];const f=Math.floor(s/o);return Math.max(f,t)}(s,r.visualVariables):s;if(\"simple\"===r.type)return t(o,r.symbol);if(\"unique-value\"===r.type){let e=o;return r.uniqueValueInfos.forEach((n=>{e=t(e,n.symbol)})),e}if(\"class-breaks\"===r.type){let e=o;return r.classBreakInfos.forEach((n=>{e=t(e,n.symbol)})),e}return r.type,o}export{n as calculateTolerance};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nimport{isSome as e,isNone as t}from\"../../core/maybe.js\";import r from\"../../geometry/Extent.js\";import\"../../geometry.js\";import{getMetersPerUnitForSR as n}from\"../../core/unitUtils.js\";import{calculateTolerance as i}from\"../../renderers/support/clickToleranceUtils.js\";function a(t,i,a,o=new r){let s;if(\"2d\"===a.type)s=i*a.resolution;else if(\"3d\"===a.type){const r=a.overlayPixelSizeInMapUnits(t),o=a.basemapSpatialReference;s=e(o)&&!o.equals(a.spatialReference)?n(o)/n(a.spatialReference):i*r}const m=t.x-s,p=t.y-s,c=t.x+s,l=t.y+s,{spatialReference:f}=a;return o.xmin=Math.min(m,c),o.ymin=Math.min(p,l),o.xmax=Math.max(m,c),o.ymax=Math.max(p,l),o.spatialReference=f,o}function o(e,r,n){const o=n.toMap(e);if(t(o))return!1;return a(o,i(),n,s).intersects(r)}const s=new r;export{a as createQueryGeometry,o as intersectsDrapedGeometry};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nfunction e(e,n,i){if(n.flatten((({sublayers:e})=>e)).length!==e.length)return!0;return!!e.some((e=>e.originIdOf(\"minScale\")>i||e.originIdOf(\"maxScale\")>i||e.originIdOf(\"renderer\")>i||e.originIdOf(\"labelingInfo\")>i||e.originIdOf(\"opacity\")>i||e.originIdOf(\"labelsVisible\")>i||e.originIdOf(\"source\")>i))||!r(e,n)}function n(e,n,i){return!!e.some((e=>{const n=e.source;return!(!n||\"map-layer\"===n.type&&n.mapLayerId===e.id&&(!n.gdbVersion||n.gdbVersion===i.gdbVersion))||e.originIdOf(\"renderer\")>2||e.originIdOf(\"labelingInfo\")>2||e.originIdOf(\"opacity\")>2||e.originIdOf(\"labelsVisible\")>2}))||!r(e,n)}function r(e,n){if(!e||!e.length)return!0;const r=n.slice().reverse().flatten((({sublayers:e})=>e&&e.toArray().reverse())).map((e=>e.id)).toArray();if(e.length>r.length)return!1;let i=0;const o=r.length;for(const{id:n}of e){for(;i<o&&r[i]!==n;)i++;if(i>=o)return!1}return!0}function i(e){return!!e&&e.some((e=>null!=e.minScale||e.layerDefinition&&null!=e.layerDefinition.minScale))}export{n as isExportDynamic,i as isSublayerOverhaul,e as shouldWriteSublayerStructure};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nimport{isSome as e}from\"../../../core/maybe.js\";import{getFeatureEditFields as p,fixFields as l,hasField as t}from\"../../../layers/support/fieldUtils.js\";async function i(i,d=i.popupTemplate){if(!e(d))return[];const o=await d.getRequiredFields(i.fields),{lastEditInfoEnabled:s}=d,{objectIdField:u,typeIdField:a,globalIdField:n,relationships:f}=i;if(o.includes(\"*\"))return[\"*\"];const r=s?await p(i):[],m=l(i.fields,[...o,...r]);return a&&m.push(a),m&&u&&t(i.fields,u)&&-1===m.indexOf(u)&&m.push(u),m&&n&&t(i.fields,n)&&-1===m.indexOf(n)&&m.push(n),f&&f.forEach((e=>{const{keyField:p}=e;m&&p&&t(i.fields,p)&&-1===m.indexOf(p)&&m.push(p)})),m}function d(p,l){return p.popupTemplate?p.popupTemplate:e(l)&&l.defaultPopupTemplateEnabled&&e(p.defaultPopupTemplate)?p.defaultPopupTemplate:null}export{d as getFetchPopupTemplate,i as getRequiredFields};\n"],"sourceRoot":""}