(this.webpackJsonpgeometries=this.webpackJsonpgeometries||[]).push([[56],{1024:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return a}));var a=new(r(50).a)({none:"none",standardDeviation:"standard-deviation",histogramEqualization:"histogram-equalization",minMax:"min-max",percentClip:"percent-clip",sigmoid:"sigmoid"}),n={0:"none",3:"standardDeviation",4:"histogramEqualization",5:"minMax",6:"percentClip",9:"sigmoid"}},1025:function(e,t,r){"use strict";var a,n=r(2),i=r(3),o=r(5),s=r(6),l=r(0),c=(r(13),r(24)),u=(r(14),r(15)),f=r(1),p=r(8),d=(r(11),r(19),r(20),r(28)),h=a=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var a;return Object(n.a)(this,r),(a=t.call(this,e)).variableName=null,a.dimensionName=null,a.values=[],a.isSlice=!1,a}return Object(i.a)(r,[{key:"clone",value:function(){return new a({variableName:this.variableName,dimensionName:this.dimensionName,values:Object(c.a)(this.values),isSlice:this.isSlice})}}]),r}(d.a);Object(l.a)([Object(f.b)({type:String,json:{write:!0}})],h.prototype,"variableName",void 0),Object(l.a)([Object(f.b)({type:String,json:{write:!0}})],h.prototype,"dimensionName",void 0),Object(l.a)([Object(f.b)({type:u.p.array(u.p.oneOf([u.p.native(Number),u.p.array(u.p.native(Number))])),json:{write:!0}})],h.prototype,"values",void 0),Object(l.a)([Object(f.b)({type:Boolean,json:{write:!0}})],h.prototype,"isSlice",void 0);var b=h=a=Object(l.a)([Object(p.a)("esri.layers.support.DimensionalDefinition")],h);t.a=b},1041:function(e,t,r){"use strict";r.r(t);var a=r(10),n=r.n(a),i=r(21),o=r(9),s=r(2),l=r(3),c=r(61),u=r(55),f=r(5),p=r(6),d=r(0),h=(r(13),r(4)),b=r(14),y=r(15),v=r(1),m=r(50),g=r(42),j=r(63),w=r(8),I=r(23),x=r(11),M=(r(19),r(20),r(16)),O=r(276),k=r(243),S=r(795),A=r(787),T=r(809),C=r(971),D=r(245),L=r(380),z=r(802),R=r(801),_=r(379),N=r(812),B=r(35),H=r(46),P=r(44),E=r(62),U=(r(77),r(81)),F=r(385),Z=r(382),G=r(1025),J=r(1098),V=r(1104),W=r(1057),q=b.a.getLogger("esri.layers.mixins.ImageryTileMixin"),K=r(37),X=r(362),Q=r(924),Y=r(28),$=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){var e;return Object(s.a)(this,r),(e=t.apply(this,arguments)).blockWidth=void 0,e.blockHeight=void 0,e.compression=null,e.origin=null,e.firstPyramidLevel=null,e.maximumPyramidLevel=null,e.pyramidScalingFactor=2,e.pyramidBlockWidth=null,e.pyramidBlockHeight=null,e.isVirtualTileInfo=!1,e.tileInfo=null,e.blockBoundary=null,e}return r}(Y.a);Object(d.a)([Object(v.b)({type:Number,json:{write:!0}})],$.prototype,"blockWidth",void 0),Object(d.a)([Object(v.b)({type:Number,json:{write:!0}})],$.prototype,"blockHeight",void 0),Object(d.a)([Object(v.b)({type:String,json:{write:!0}})],$.prototype,"compression",void 0),Object(d.a)([Object(v.b)({type:K.a,json:{write:!0}})],$.prototype,"origin",void 0),Object(d.a)([Object(v.b)({type:Number,json:{write:!0}})],$.prototype,"firstPyramidLevel",void 0),Object(d.a)([Object(v.b)({type:Number,json:{write:!0}})],$.prototype,"maximumPyramidLevel",void 0),Object(d.a)([Object(v.b)()],$.prototype,"pyramidScalingFactor",void 0),Object(d.a)([Object(v.b)({type:Number,json:{write:!0}})],$.prototype,"pyramidBlockWidth",void 0),Object(d.a)([Object(v.b)({type:Number,json:{write:!0}})],$.prototype,"pyramidBlockHeight",void 0),Object(d.a)([Object(v.b)({type:Boolean,json:{write:!0}})],$.prototype,"isVirtualTileInfo",void 0),Object(d.a)([Object(v.b)({json:{write:!0}})],$.prototype,"tileInfo",void 0),Object(d.a)([Object(v.b)()],$.prototype,"blockBoundary",void 0);var ee=$=Object(d.a)([Object(w.a)("esri.layers.support.RasterStorageInfo")],$),te=r(211),re=r(1010),ae=r(915),ne=r(969),ie=r(1106),oe=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){var e;return Object(s.a)(this,r),(e=t.apply(this,arguments)).rasterJobHandler=null,e.datasetName=null,e.datasetFormat=null,e.rasterInfo=null,e.ioConfig={sampling:"closest"},e}return Object(l.a)(r,[{key:"init",value:function(){var e=Object(i.a)(n.a.mark((function e(){var t;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Object(ne.c)(),this.addResolvingPromise(t),e.next=4,this.when();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"normalizeCtorArgs",value:function(e){return e&&e.ioConfig&&(e=Object(o.a)(Object(o.a)({},e),{},{ioConfig:Object(o.a)({resolution:null,bandIds:null,sampling:"closest",tileInfo:Z.a.create()},e.ioConfig)})),e}},{key:"url",set:function(e){this._set("url",Object(F.f)(e,b.a.getLogger(this.declaredClass)))}},{key:"open",value:function(){var e=Object(i.a)(n.a.mark((function e(t){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new I.a("BaseRaster:open-not-implemented","open() is not implemented");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"fetchTile",value:function(){var e=Object(i.a)(n.a.mark((function e(t,r,a){var i,s,l,c,u,f,p=arguments;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=p.length>3&&void 0!==p[3]?p[3]:{},l=i.tileInfo,c=l.lodAt(t),u=new K.a({x:c.resolution,y:c.resolution,spatialReference:l.spatialReference}),f=this.getTileExtent(u,r,a,l),e.abrupt("return",(null!=(s=i.multidimensionalDefinition)&&s.length&&Object(h.i)(this.rasterInfo.multidimensionalInfo)&&null==i.sliceId&&(i=Object(o.a)(Object(o.a)({},i),{},{sliceId:this.getSliceIndex(i.multidimensionalDefinition)||0})),this.fetchPixels(f,l.size[0],l.size[1],i)));case 3:case"end":return e.stop()}}),e,this)})));return function(t,r,a){return e.apply(this,arguments)}}()},{key:"identify",value:function(){var e=Object(i.a)(n.a.mark((function e(t){var r,a,i,o,s,l,c,u,f,p,d,b,y,v,m,g,j,w=arguments;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=w.length>1&&void 0!==w[1]?w[1]:{},a=this.rasterInfo,i=a.spatialReference,o=a.extent,s=r.datumTransformation,l=Object(ne.e)(t,i,s),o.intersects(l)){e.next=4;break}return e.abrupt("return",{location:l,value:null});case 4:if(c=0,!r.srcResolution){e.next=9;break}c=Object(ne.g)(r.srcResolution,this.rasterInfo,this.ioConfig.sampling).pyramidLevel,e.next=14;break;case 9:return e.next=11,this.computeBestPyramidLevelForLocation(t,r);case 11:if(null!=(c=e.sent)){e.next=14;break}return e.abrupt("return",{location:l,value:null});case 14:if(null!==(u=this.identifyPixelLocation(l,c,null))){e.next=17;break}return e.abrupt("return",{location:l,value:null});case 17:return f=u.row,p=u.col,d=u.rowOffset,b=u.colOffset,y=Object(ie.d)(this.url,r.sliceId),v="".concat(c,"/").concat(f,"/").concat(p),m=Object(ie.c)(y,null,v),Object(h.i)(m)||(m=this.fetchRawTile(c,f,p,r),Object(ie.e)(y,null,v,m)),e.next=22,m;case 22:if((g=e.sent)&&g.pixels&&g.pixels.length>0){e.next=25;break}return e.abrupt("return",{location:l,value:null});case 25:return j=d*this.rasterInfo.storageInfo.blockHeight+b,e.abrupt("return",{location:l,value:!g.mask||g.mask[j]?g.pixels.map((function(e){return e[j]})):null,pyramidLevel:c});case 27:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"fetchPixels",value:function(){var e=Object(i.a)(n.a.mark((function e(t,r,a){var i,o,s,l,c,u,f,p,d,b,y,v,m,g,j,w,I,x,M,O,k,S,A,T,C,D,L,z=arguments;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=z.length>3&&void 0!==z[3]?z[3]:{},o=t.clone().normalize(),t=o[0],s=this.rasterInfo.spatialReference,l=!t.spatialReference.equals(s),c=i.datumTransformation,u=new K.a({x:(t.xmax-t.xmin)/r,y:(t.ymax-t.ymin)/a,spatialReference:t.spatialReference}),f=i.srcResolution||(l?Object(ne.f)(u,s,t,c):u)){e.next=6;break}return e.abrupt("return",null);case 6:if(p=Object(ne.g)(f,this.rasterInfo,this.ioConfig.sampling),d=p.pyramidLevel,b=p.pyramidResolution,!p.excessiveReading){e.next=9;break}return e.abrupt("return",null);case 9:if(y=this.rasterInfo.storageInfo,v=l?Object(ne.d)(t,s,c):t,(m=Object(h.o)(this.rasterInfo.transform))&&(v=m.inverseTransform(v)),null!=v){e.next=14;break}return e.abrupt("return",null);case 14:if(g={x:Math.floor((v.xmin-y.origin.x)/b.x+.1),y:Math.floor((y.origin.y-v.ymax)/b.y+.1)},j=Math.ceil((v.xmax-v.xmin)/b.x-.1),w=Math.ceil((v.ymax-v.ymin)/b.y-.1),!(j/r>8||w/a>8)){e.next=17;break}return e.abrupt("return",null);case 17:return e.next=19,this.fetchRawPixels(d,g,{width:j,height:w},i);case 19:if(I=e.sent){e.next=22;break}return e.abrupt("return",null);case 22:if(x=d>0?y.pyramidBlockWidth:y.blockWidth,M=d>0?y.pyramidBlockHeight:y.blockHeight,l||1!==I.pixelBlocks.length||x!==r||M!==a||f.x!==u.x||f.y!==u.y){e.next=25;break}return e.abrupt("return",{extent:t,srcExtent:v,pixelBlock:I.pixelBlocks[0],transformGrid:null});case 25:if(O=Object(ne.b)(t,I.extent,u,c,m),S=!i.requestRawData,A={rows:O.spacing[0],cols:O.spacing[1]},T=I.pixelBlocks,C=I.mosaicSize,D=I.isPartiallyFilled,!this.rasterJobHandler){e.next=33;break}return e.next=30,this.rasterJobHandler.mosaicAndTransform({srcPixelBlocks:T,srcMosaicSize:C,destDimension:S?{width:r,height:a}:null,coefs:S?O.coefficients:null,sampleSpacing:S?A:null,interpolation:i.interpolation},i);case 30:k=e.sent,e.next=35;break;case 33:L=Object(ae.i)(T,C),k=S?Object(ae.a)(L,{width:r,height:a},O.coefficients,A,i.interpolation):L;case 35:return e.abrupt("return",{srcExtent:v,pixelBlock:k,transformGrid:O,extent:t,isPartiallyFilled:D});case 36:case"end":return e.stop()}}),e,this)})));return function(t,r,a){return e.apply(this,arguments)}}()},{key:"fetchRawPixels",value:function(){var e=Object(i.a)(n.a.mark((function e(t,r,a,i){var o,s,l,c,u,f,p,d,h,b,y,v,m,g,j,w,I,x,O,k,S,A,T,C,D,L,z,R,_,N;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=this.rasterInfo.storageInfo,s=o.origin,l=o.blockBoundary,c=t>0?this.rasterInfo.storageInfo.pyramidBlockWidth:this.rasterInfo.storageInfo.blockWidth,u=t>0?this.rasterInfo.storageInfo.pyramidBlockHeight:this.rasterInfo.storageInfo.blockHeight,f=r.x,p=r.y,d=a.width,h=a.height,i.buffer&&(f-=i.buffer.cols,p-=i.buffer.rows,d+=2*i.buffer.cols,h+=2*i.buffer.rows),b=Math.floor(f/c),y=Math.floor(p/u),v=Math.floor((f+d-1)/c),m=Math.floor((p+h-1)/u),g=l[t]){e.next=6;break}return e.abrupt("return",null);case 6:if(j=g.minRow,w=g.minCol,I=g.maxCol,x=g.maxRow,!(m<j||v<w||y>x||b>I)){e.next=9;break}return e.abrupt("return",null);case 9:for(O=[],S=!1,A=y;A<=m;A++)for(T=b;T<=v;T++)A>=j&&T>=w&&x>=A&&I>=T?(k=this._fetchRawTile(t,A,T,i),this.ioConfig.allowPartialFill&&(k=Object(M.c)((function(e){k.then((function(t){return e(t)})).catch((function(){S=!0,e(null)}))}))),O.push(k)):O.push(null);if(0!==O.length){e.next=14;break}return e.abrupt("return",null);case 14:return e.next=16,Object(M.b)(O);case 16:return C=e.sent,D={height:(m-y+1)*c,width:(v-b+1)*u},L=this.rasterInfo,z=L.nativePixelSize,R=L.spatialReference,_=z.x*Math.pow(2,t),N=z.y*Math.pow(2,t),e.abrupt("return",{extent:new E.a({xmin:s.x+b*c*_,xmax:s.x+(v+1)*c*_,ymin:s.y-(m+1)*u*N,ymax:s.y-y*u*N,spatialReference:R}),pixelBlocks:C,mosaicSize:D,isPartiallyFilled:S});case 24:case"end":return e.stop()}}),e,this)})));return function(t,r,a,n){return e.apply(this,arguments)}}()},{key:"fetchRawTile",value:function(){var e=Object(i.a)(n.a.mark((function e(t,r,a,i){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new I.a("BaseRaster:read-not-implemented","fetchRawTile() is not implemented");case 1:case"end":return e.stop()}}),e)})));return function(t,r,a,n){return e.apply(this,arguments)}}()},{key:"computeExtent",value:function(e){return Object(ne.d)(this.rasterInfo.extent,e)}},{key:"decodePixelBlock",value:function(e,t){return!this.rasterJobHandler||t.useCanvas?Object(re.a)(e,t):this.rasterJobHandler.decode({data:e,options:t})}},{key:"request",value:function(){var e=Object(i.a)(n.a.mark((function e(t,r,a){var i,s,l,c,u,f,p;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l=this.ioConfig.customFetchParameters,c=r.range,u=r.query,f=r.headers,a=null!=(i=null!=(s=a)?s:r.retryCount)?i:this.ioConfig.retryCount,p=c?{Range:"bytes=".concat(c.from,"-").concat(c.to)}:null,e.prev=3,e.next=6,Object(U.default)(t,Object(o.a)(Object(o.a)({},r),{},{query:Object(o.a)(Object(o.a)({},u),l),headers:Object(o.a)(Object(o.a)({},f),p)}));case 6:return e.abrupt("return",e.sent);case 9:if(e.prev=9,e.t0=e.catch(3),!(a>0)){e.next=13;break}return e.abrupt("return",(a--,this.request(t,r,a)));case 13:throw e.t0;case 14:case"end":return e.stop()}}),e,this,[[3,9]])})));return function(t,r,a){return e.apply(this,arguments)}}()},{key:"getSliceIndex",value:function(e){var t=this,r=this.rasterInfo.multidimensionalInfo;if(!Object(h.i)(r)||null==e||!e.length)return null;for(var a=0,n=e[0].variableName,i=function(i){var o=r.variables[i],s=o.dimensions;if(o.name!==n)return a+=s.map((function(e){return t._getDimensionValuesCount(e)})).reduce((function(e,t){return e+t})),"break";for(var l=s.map((function(e){return t._getDimensionValuesCount(e)})),c=s.length,u=function(r){var n=e.filter((function(e){return e.dimensionName===s[r].name}))[0];if(null==n)return{v:{v:null}};var i=Array.isArray(n.values[0])?n.values[0][0]:n.values[0],o=t._getIndexFromDimensions(i,s[r]);if(-1===o)return{v:{v:null}};l.shift(),a+=r===c-1?o:o*l.reduce((function(e,t){return e+t}))},f=0;f<c;f++){var p=u(f);if("object"===typeof p)return p.v}},o=0;o<r.variables.length;o++){var s=i(o);if("break"===s)break;if("object"===typeof s)return s.v}return a}},{key:"updateTileInfo",value:function(){var e=this.rasterInfo,t=e.storageInfo,r=e.spatialReference,a=e.extent,n=e.pixelSize;if(!t.tileInfo){for(var i=[],o=t.maximumPyramidLevel||0,s=Math.max(n.x,n.y),l=1/.0254*96*s,c=0;c<=o;c++)i.push({level:o-c,resolution:s,scale:l}),s*=2,l*=2;var u=new K.a({x:a.xmin,y:a.ymax,spatialReference:r});t.tileInfo=new Z.a({origin:u,size:[t.blockWidth,t.blockHeight],spatialReference:r,lods:i}),t.isVirtualTileInfo=!0}}},{key:"createRemoteDatasetStorageInfo",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:512,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:512,a=arguments.length>3?arguments[3]:void 0,n=e.width,i=e.height,o=e.nativeExtent,s=e.pixelSize,l=e.spatialReference,c=new K.a({x:o.xmin,y:o.ymax,spatialReference:l});null==a&&(a=Math.max(0,Math.round(Math.log(Math.max(n,i))/Math.LN2-8)));var u=this._computeBlockBoundary(o,s,a,512,512);e.storageInfo=new ee({blockWidth:t,blockHeight:r,pyramidBlockWidth:t,pyramidBlockHeight:r,origin:c,firstPyramidLevel:1,maximumPyramidLevel:a,blockBoundary:u})}},{key:"computeBestPyramidLevelForLocation",value:function(){var e=Object(i.a)(n.a.mark((function e(t){var r=arguments;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.length>1&&void 0!==r[1]?r[1]:{},e.abrupt("return",0);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"identifyPixelLocation",value:function(e,t,r){var a=this.rasterInfo,n=a.spatialReference,i=a.pixelSize,o=a.extent,s=this.rasterInfo.storageInfo,l=s.blockWidth,c=s.blockHeight,u=s.maximumPyramidLevel,f=s.pyramidScalingFactor,p=s.origin,d=Object(ne.e)(e,n,r);if(!o.intersects(d))return null;if(t<0||t>u)return null;var h=Math.pow(f,t),b=h*i.x,y=h*i.y,v=(p.y-d.y)/y/c,m=(d.x-p.x)/b/l,g=Math.min(c-1,Math.floor((v-Math.floor(v))*c)),j=Math.min(l-1,Math.floor((m-Math.floor(m))*l));return{pyramidLevel:t,row:Math.floor(v),col:Math.floor(m),rowOffset:g,colOffset:j,srcLocation:d}}},{key:"getTileExtent",value:function(e,t,r,a){var n=a.origin,i=a.spatialReference,o=a.size[0],s=a.size[1],l=n.x+r*o*e.x,c=l+o*e.x,u=n.y-t*s*e.y,f=u-s*e.y;return new E.a({xmin:l,xmax:c,ymin:f,ymax:u,spatialReference:i})}},{key:"_computeBlockBoundary",value:function(e,t,r,a,n){var i=t.x,o=t.y,s=e.xmin,l=e.ymax,c=[{minCol:Math.floor((e.xmin-s+.1*i)/a/i),maxCol:Math.floor((e.xmax-s-.1*i)/a/i),minRow:Math.floor((l-e.ymax+.1*o)/n/o),maxRow:Math.floor((l-e.ymin-.1*o)/n/o)}];if(r>0)for(var u=0;u<r;u++)i*=2,o*=2,c.push({minCol:Math.floor((e.xmin-s+.1*i)/a/i),maxCol:Math.floor((e.xmax-s-.1*i)/a/i),minRow:Math.floor((l-e.ymax+.1*o)/n/i),maxRow:Math.floor((l-e.ymin-.1*o)/n/i)});return c}},{key:"_fetchRawTile",value:function(e,t,r,a){var n=this.rasterInfo.storageInfo.blockBoundary[e];if(!n)return Object(M.u)(null);var i=n.minRow,s=n.minCol,l=n.maxCol,c=n.maxRow;if(t<i||r<s||t>c||r>l)return Object(M.u)(null);var u=Object(ie.d)(this.url,a.sliceId),f="".concat(e,"/").concat(t,"/").concat(r),p=Object(ie.c)(u,a.registryId,f);if(!Object(h.i)(p)){var d=Object(M.d)();p=this.fetchRawTile(e,t,r,Object(o.a)(Object(o.a)({},a),{},{signal:d.signal})),Object(ie.e)(u,a.registryId,f,p,d),p.catch((function(){Object(ie.b)(u,a.registryId,f)}))}return a.signal&&Object(M.r)(a,(function(){Object(ie.a)(u,a.registryId,f)})),p}},{key:"_getIndexFromDimensions",value:function(e,t){var r=t.extent,a=t.interval,n=t.unit,i=t.values;if(null!=i&&i.length)return Array.isArray(i[0])?i.findIndex((function(t){return t[0]<=e&&t[1]>=e})):i.indexOf(e);if(e>r[1])return-1;var o=r[0],s=-1;if("ISO8601"===n){var l;switch((null==(l=t.intervalUnit)?void 0:l.toLowerCase())||"seconds"){case"seconds":s=Math.round((e-o)/1e3/a);break;case"minutes":s=Math.round((e-o)/6e4/a);break;case"hours":s=Math.round((e-o)/36e5/a);break;case"days":s=Math.round((e-o)/864e5/a);break;case"years":s=Math.round((new Date(e).getUTCFullYear()-new Date(o).getUTCFullYear())/a);break;case"decades":s=Math.round((new Date(e).getUTCFullYear()-new Date(o).getUTCFullYear())/10/a)}return s}return Math.round((e-o)/a)}},{key:"_getDimensionValuesCount",value:function(e){var t=e.extent,r=e.interval,a=e.unit,n=e.values,i=(null==n?void 0:n.length)||0;if(i)return i;var o=t[0];if(0===i&&"ISO8601"===a){var s;switch((null==(s=e.intervalUnit)?void 0:s.toLowerCase())||"seconds"){case"seconds":i=Math.round((t[1]-t[0])/1e3/r);break;case"minutes":i=Math.round((t[1]-t[0])/6e4/r);break;case"hours":i=Math.round((t[1]-t[0])/36e5/r);break;case"days":i=Math.round((t[1]-t[0])/864e5/r);break;case"years":i=Math.round((new Date(t[1]).getUTCFullYear()-new Date(o).getUTCFullYear())/r);break;case"decades":i=Math.round((new Date(t[1]).getUTCFullYear()-new Date(o).getUTCFullYear())/10/r)}return i}return Math.round((t[1]-t[0])/r)}}]),r}(Object(te.b)(Y.a));Object(d.a)([Object(v.b)(A.j)],oe.prototype,"url",null),Object(d.a)([Object(v.b)({type:String,json:{write:!0}})],oe.prototype,"datasetName",void 0),Object(d.a)([Object(v.b)({type:String,json:{write:!0}})],oe.prototype,"datasetFormat",void 0),Object(d.a)([Object(v.b)()],oe.prototype,"rasterInfo",void 0),Object(d.a)([Object(v.b)()],oe.prototype,"ioConfig",void 0),Object(d.a)([Object(v.b)()],oe.prototype,"sourceJSON",void 0);var se=oe=Object(d.a)([Object(w.a)("esri.layers.support.rasterDatasets.BaseRaster")],oe),le=r(1018),ce=function(){function e(){Object(s.a)(this,e)}return Object(l.a)(e,null,[{key:"supportedVersions",get:function(){return[5]}},{key:"parse",value:function(e){var t=new DataView(e),r=3&t.getUint8(0);if(3!==r)return{header:{version:r},recordSet:null};var a,n=t.getUint32(4,!0),i=t.getUint16(8,!0),o=t.getUint16(10,!0),s={version:r,recordCount:n,headerByteCount:i,recordByteCount:o},l=32,c=[],u=[];if(3===r){for(;13!==t.getUint8(l);)a=String.fromCharCode(t.getUint8(l+11)).trim(),c.push({name:Object(le.a)(new Uint8Array(e,l,11)),type:a,typeName:["String","Date","Double","Boolean","String","Integer"][["C","D","F","L","M","N"].indexOf(a)],length:t.getUint8(l+16)}),l+=32;if(l+=1,c.length>0)for(var f=function(){var r=[];32===t.getUint8(l)?(l+=1,c.forEach((function(t){if("C"===t.type)r.push(Object(le.a)(new Uint8Array(e,l,t.length)).trim());else if("N"===t.type)r.push(parseInt(String.fromCharCode.apply(null,new Uint8Array(e,l,t.length)).trim(),10));else if("F"===t.type)r.push(parseFloat(String.fromCharCode.apply(null,new Uint8Array(e,l,t.length)).trim()));else if("D"===t.type){var a=String.fromCharCode.apply(null,new Uint8Array(e,l,t.length)).trim();r.push(new Date(parseInt(a.substring(0,4),10),parseInt(a.substring(4,6),10)-1,parseInt(a.substring(6,8),10)))}l+=t.length})),u.push(r)):l+=o};u.length<n&&e.byteLength-l>o;)f()}var p=function(e){var t=e.fields,r=e.records,a=t.some((function(e){return"oid"===e.name.toLowerCase()}))?"OBJECTID":"OID",n=[{name:a,type:"esriFieldTypeOID",alias:"OID"}].concat(t.map((function(e){return{name:e.name,type:"esriFieldType"+e.typeName,alias:e.name}}))),i=n.map((function(e){return e.name})),o=[],s=0,l=0;return r.forEach((function(e){var t={};for(t[a]=s++,l=1;l<i.length;l++)t[i[l]]=e[l-1];o.push({attributes:t})})),{displayFieldName:"",fields:n,features:o}}({fields:c,records:u});return{header:s,fields:c,records:u,recordSet:p}}}]),e}(),ue=new Map;ue.set("int16","esriFieldTypeSmallInteger"),ue.set("int32","esriFieldTypeInteger"),ue.set("int64","esriFieldTypeInteger"),ue.set("float32","esriFieldTypeSingle"),ue.set("float64","esriFieldTypeDouble"),ue.set("text","esriFieldTypeString");var fe=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){var e;return Object(s.a)(this,r),(e=t.apply(this,arguments)).storageInfo=null,e.datasetFormat="CRF",e}return Object(l.a)(r,[{key:"open",value:function(){var e=Object(i.a)(n.a.mark((function e(t){var r,a,i,o,s,l;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.init();case 2:return e.next=4,this.request(this.url+"/conf.json",{signal:null==t?void 0:t.signal});case 4:if(r=e.sent,a=r.data,this._validateHeader(a)){e.next=8;break}throw new I.a("cloudraster:open","Invalid or unsupported conf.json.");case 8:if(this.datasetName=this.url.slice(this.url.lastIndexOf("/")+1),i=this._parseHeader(a),o=i.storageInfo,"thematic"!==(s=i.rasterInfo).dataType){e.next=15;break}return e.next=13,this._fetchAuxiliaryInformation();case 13:l=e.sent,s.attributeTable=l;case 15:this._set("storageInfo",o),this._set("rasterInfo",s),this.ioConfig.retryCount=this.ioConfig.retryCount||0;case 16:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"fetchRawTile",value:function(){var e=Object(i.a)(n.a.mark((function e(t,r,a){var i,o,s,l,c,u,f,p,d=arguments;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=d.length>3&&void 0!==d[3]?d[3]:{},!((o=this.rasterInfo.storageInfo.maximumPyramidLevel-t)<0)){e.next=4;break}return e.abrupt("return",null);case 4:return s=this._buildCacheFilePath(o,r,a,i.multidimensionalDefinition),l=this._getIndexRecordFromBundle(r,a),e.next=8,this.request(s,{range:{from:0,to:this.storageInfo.headerSize-1},responseType:"array-buffer",signal:i.signal});case 8:if(c=e.sent){e.next=11;break}return e.abrupt("return",null);case 11:if(u=new Uint8Array(c.data),0!==(f=this._getTileEndAndContentType(u,l)).recordSize){e.next=14;break}return e.abrupt("return",null);case 14:return e.next=16,this.request(s,{range:{from:f.position,to:f.position+f.recordSize},responseType:"array-buffer",signal:i.signal});case 16:return p=e.sent,e.abrupt("return",p?this.decodePixelBlock(p.data,{width:this.rasterInfo.storageInfo.tileInfo.size[0],height:this.rasterInfo.storageInfo.tileInfo.size[1],planes:null,pixelType:null}):null);case 18:case"end":return e.stop()}}),e,this)})));return function(t,r,a){return e.apply(this,arguments)}}()},{key:"_validateHeader",value:function(e){return e&&"RasterInfo"===e.type&&!["origin","extent","geodataXform","LODInfos","blockWidth","blockHeight","bandCount","pixelType","pixelSizeX","pixelSizeY","format","packetSize"].some((function(t){return!e[t]}))}},{key:"_parseHeader",value:function(e){var t,r,a,n,i,o=["u1","u2","u4","u8","s8","u16","s16","u32","s32","f32","f64"][e.pixelType],s=e.bandCount,l=e.histograms,c=e.colormap,u=e.blockWidth,f=e.blockHeight,p=e.firstPyramidLevel,d=e.maximumPyramidLevel,h=e.statistics&&e.statistics.map((function(e){return{min:e.min,max:e.max,avg:e.mean,stddev:e.standardDeviation,median:e.median,mode:e.mode}})),b=new P.a(e.extent.spatialReference||e.geodataXform.spatialReference),y=new E.a({xmin:e.extent.xmin,ymin:e.extent.ymin,xmax:e.extent.xmax,ymax:e.extent.ymax,spatialReference:b}),v=new K.a({x:e.pixelSizeX,y:e.pixelSizeY,spatialReference:b}),m=null!=(t=e.properties)?t:{},g=e.format.toLowerCase().replace("cache/",""),j=new K.a(e.origin.x,e.origin.y,b);if(c&&c.colors)for(r=[],a=0;a<c.colors.length;a++)n=c.colors[a],i=c.values?c.values[a]:a,r.push([i,255&n,n<<16>>>24,n<<8>>>24,n>>>24]);var w=e.LODInfos,I=[];for(a=0;a<w.levels.length;a++)I.push({level:w.levels[a],resolution:w.resolutions[a],scale:96/.0254*w.resolutions[a]});var x=new Z.a({dpi:96,lods:I,format:g,origin:j,size:[u,f],spatialReference:b}),M={recordSize:8,packetSize:e.packetSize,headerSize:e.packetSize*e.packetSize*8+64},O=Math.round((y.xmax-y.xmin)/v.x),k=Math.round((y.ymax-y.ymin)/v.y),S=[{maxCol:Math.ceil(O/u)-1,maxRow:Math.ceil(k/f)-1,minCol:0,minRow:0}],A=2;if(d>0)for(a=0;a<d;a++)S.push({maxCol:Math.ceil(O/A/u)-1,maxRow:Math.ceil(k/A/f)-1,minCol:0,minRow:0}),A*=2;var T=e.mdInfo;return{storageInfo:M,rasterInfo:new Q.a({width:O,height:k,pixelType:o,bandCount:s,extent:y,spatialReference:b,pixelSize:v,keyProperties:m,statistics:h,histograms:l,multidimensionalInfo:T,colormap:r,storageInfo:new ee({blockWidth:u,blockHeight:f,pyramidBlockWidth:u,pyramidBlockHeight:f,origin:j,tileInfo:x,firstPyramidLevel:p,maximumPyramidLevel:d,blockBoundary:S})})}}},{key:"_fetchAuxiliaryInformation",value:function(){var e=Object(i.a)(n.a.mark((function e(t){var r,a,i,o,s,l,c;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.request(this.url+"/conf.vat.json",{signal:t}).then((function(e){return e.data})).catch((function(){return null})),a=this.request(this.url+"/conf.vat.dbf",{responseType:"array-buffer",signal:t}).then((function(e){return e.data})).catch((function(){return null})),e.next=4,Object(M.b)([r,a]);case 4:return(i=e.sent)[0]&&(s=i[0].fields,l=i[0].values,s&&l&&(s=s.map((function(e){return{type:"OID"===e.name?"esriFieldTypeOID":ue.get(e.type),name:e.name,alias:e.alias||e.name}})),c=l.map((function(e){return{attributes:e}})),s&&l&&(o={fields:s,features:c}))),!o&&i[1]&&(o=ce.parse(i[1]).recordSet),e.abrupt("return",X.default.fromJSON(o));case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_buildCacheFilePath",value:function(e,t,r,a){var n=this.storageInfo.packetSize,i=Math.floor(t/n)*n,o=Math.floor(r/n)*n,s="R"+this._toHexString4(i)+"C"+this._toHexString4(o),l="L";l+=e>=10?e.toString():"0"+e.toString();var c=this.rasterInfo.multidimensionalInfo,u=null==a?void 0:a[0];if(!Object(h.i)(c)||!u)return"".concat(this.url,"/_alllayers/").concat(l,"/").concat(s,".bundle");for(var f=c.variables.filter((function(e){return e.name===u.variableName}))[0].dimensions[0].values.indexOf(u.values[0]).toString(16),p=4-f.length,d=0;d<p;d++)f="0"+f;return f="S"+f,"".concat(this.url,"/_alllayers/").concat(u.variableName,"/").concat(f,"/").concat(l,"/").concat(s,".bundle")}},{key:"_getIndexRecordFromBundle",value:function(e,t){var r=this.storageInfo.packetSize,a=r*(e%r)+t%r;if(a<0)throw"Invalid level / row / col";return 20+a*this.storageInfo.recordSize+44}},{key:"_getTileEndAndContentType",value:function(e,t){var r,a=e.subarray(t,t+8),n=0;for(r=0;r<5;r++)n|=(255&a[r])<<8*r;var i=0xffffffffff&n;for(n=0,r=5;r<8;r++)n|=(255&a[r])<<8*(r-5);return{position:i,recordSize:0xffffffffff&n}}},{key:"_toHexString4",value:function(e){var t=e.toString(16);if(4!==t.length)for(var r=4-t.length;r-- >0;)t="0"+t;return t}}]),r}(se);Object(d.a)([Object(v.b)({readOnly:!0})],fe.prototype,"storageInfo",void 0),Object(d.a)([Object(v.b)({type:String,json:{write:!0}})],fe.prototype,"datasetFormat",void 0);var pe=fe=Object(d.a)([Object(w.a)("esri.layers.support.rasterDatasets.CloudRaster")],fe),de=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){var e;return Object(s.a)(this,r),(e=t.apply(this,arguments)).datasetFormat="MEMORY",e}return Object(l.a)(r,[{key:"open",value:function(){var e=Object(i.a)(n.a.mark((function e(t){var r,a,i,o,s,l,c,u,f,p,d,h,b,y,v,m;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.init();case 2:return a=this.data,i=a.pixelBlock,o=a.statistics,s=a.histograms,l=a.name,c=a.keyProperties,u=a.nativeExtent,f=a.transform,p=i.width,d=i.height,h=i.pixelType,b=this.data.extent||new E.a({xmin:-.5,ymin:.5,xmax:p-.5,ymax:d-.5,spatialReference:new P.a({wkid:3857})}),y=null!=(r=this.data.isPseudoSpatialReference)?r:!this.data.extent,v={x:b.width/p,y:b.height/d},m=new Q.a({width:p,height:d,pixelType:h,extent:b,nativeExtent:u,transform:f,pixelSize:v,spatialReference:b.spatialReference,bandCount:3,keyProperties:c||{},statistics:o,isPseudoSpatialReference:y,histograms:s}),this.createRemoteDatasetStorageInfo(m,512,512),this._set("rasterInfo",m),this.updateTileInfo(),e.next=8,this._buildInMemoryRaster(i,{width:512,height:512},t);case 8:this.datasetName=l,this.url="/InMemory/"+l;case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"fetchRawTile",value:function(e,t,r){var a=this._pixelBlockTiles.get("".concat(e,"/").concat(t,"/").concat(r));return Object(M.u)(a)}},{key:"_buildInMemoryRaster",value:function(){var e=Object(i.a)(n.a.mark((function e(t,r,a){var i,o,s,l,c,u,f,p;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=this.rasterInfo.storageInfo.maximumPyramidLevel,o=this.rasterJobHandler?this.rasterJobHandler.split({pixelBlock:t,tileSize:r,maximumPyramidLevel:i},a):Object(M.u)(Object(ae.m)(t,r,i)),s=Object(h.i)(this.rasterInfo.statistics),l=Object(h.i)(this.rasterInfo.histograms),c=s&&l?Object(M.u)({statistics:null,histograms:null}):this.rasterJobHandler?this.rasterJobHandler.estimateStatisticsHistograms({pixelBlock:t},a):Object(M.u)(Object(ae.f)(t)),e.next=7,Object(M.j)([o,c]);case 7:if((u=e.sent)[0].value||!u[1].value){e.next=10;break}throw new I.a("inmemory-raster:open","failed to build in memory raster");case 10:this._pixelBlockTiles=u[0].value,s||(this.rasterInfo.statistics=null==(f=u[1].value)?void 0:f.statistics),l&&(this.rasterInfo.histograms=null==(p=u[1].value)?void 0:p.histograms);case 12:case"end":return e.stop()}}),e,this)})));return function(t,r,a){return e.apply(this,arguments)}}()}]),r}(se);Object(d.a)([Object(v.b)({type:String,json:{write:!0}})],de.prototype,"datasetFormat",void 0),Object(d.a)([Object(v.b)()],de.prototype,"data",void 0);var he=de=Object(d.a)([Object(w.a)("esri.layers.support.rasterDatasets.InMemoryRaster")],de),be=r(32);function ye(e,t,r){var a=t.x,n=t.y;if(r<2)return{x:e[0]+a*e[2]+n*e[4],y:e[1]+a*e[3]+n*e[5]};if(2===r){var i=a*a,o=n*n,s=a*n;return{x:e[0]+a*e[2]+n*e[4]+i*e[6]+s*e[8]+o*e[10],y:e[1]+a*e[3]+n*e[5]+i*e[7]+s*e[9]+o*e[11]}}var l=a*a,c=n*n,u=a*n,f=l*a,p=l*n,d=a*c,h=n*c;return{x:e[0]+a*e[2]+n*e[4]+l*e[6]+u*e[8]+c*e[10]+f*e[12]+p*e[14]+d*e[16]+h*e[18],y:e[1]+a*e[3]+n*e[5]+l*e[7]+u*e[9]+c*e[11]+f*e[13]+p*e[15]+d*e[17]+h*e[19]}}function ve(e,t,r){var a=t.xmin,n=t.ymin,i=t.xmax,o=t.ymax,s=t.spatialReference,l=[];if(r<2)l.push({x:a,y:o}),l.push({x:i,y:o}),l.push({x:a,y:n}),l.push({x:i,y:n});else{for(var c=10,u=0;u<c;u++)l.push({x:a,y:n+(o-n)*u/(c-1)}),l.push({x:i,y:n+(o-n)*u/(c-1)});c=8;for(var f=1;f<=c;f++)l.push({x:a+(i-a)*f/c,y:n}),l.push({x:a+(i-a)*f/c,y:o})}var p=(l=l.map((function(t){return ye(e,t,r)}))).map((function(e){return e.x})),d=l.map((function(e){return e.y}));return new E.a({xmin:Math.min.apply(null,p),xmax:Math.max.apply(null,p),ymin:Math.min.apply(null,d),ymax:Math.max.apply(null,d),spatialReference:s})}var me=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){var e;return Object(s.a)(this,r),(e=t.apply(this,arguments)).polynomialOrder=1,e}return Object(l.a)(r,[{key:"inverseCoefficients",get:function(){var e=this._get("inverseCoefficients"),t=this._get("forwardCoefficients");return!e&&t&&this.polynomialOrder<2&&(e=function(e){var t=Object(be.a)(e,6),r=t[0],a=t[1],n=t[2],i=t[3],o=t[4],s=t[5],l=n*s-o*i,c=o*i-n*s;return[(o*a-r*s)/l,(n*a-r*i)/c,s/l,i/c,-o/l,-n/c]}(t)),e},set:function(e){this._set("inverseCoefficients",e)}},{key:"forwardTransform",value:function(e){if("point"===e.type){var t=ye(this.forwardCoefficients,e,this.polynomialOrder);return new K.a({x:t.x,y:t.y,spatialReference:e.spatialReference})}return ve(this.forwardCoefficients,e,this.polynomialOrder)}},{key:"inverseTransform",value:function(e){if("point"===e.type){var t=ye(this.inverseCoefficients,e,this.polynomialOrder);return new K.a({x:t.x,y:t.y,spatialReference:e.spatialReference})}return ve(this.inverseCoefficients,e,this.polynomialOrder)}}]),r}(Y.a);Object(d.a)([Object(v.b)({json:{write:!0}})],me.prototype,"polynomialOrder",void 0),Object(d.a)([Object(v.b)({json:{write:!0}})],me.prototype,"forwardCoefficients",void 0),Object(d.a)([Object(v.b)({dependsOn:["forwardCoefficients"],json:{write:!0}})],me.prototype,"inverseCoefficients",null);var ge=me=Object(d.a)([Object(w.a)("esri.layers.support.rasterTransforms.PolynomialTransform")],me);function je(e,t){if(!e||!t)return[];var r=t;t.indexOf("/")>-1?(r=t.slice(0,t.indexOf("/")),t=t.slice(t.indexOf("/")+1)):t="";var a=[];if(t){for(var n=je(e,r),i=0;i<n.length;i++)je(n[i],t).forEach((function(e){return a.push(e)}));return a}var o=e.getElementsByTagNameNS("*",r);if(!o||0===o.length)return[];for(var s=0;s<o.length;s++)a.push(o[s]||o.item[s]);return a}function we(e,t){if(!e||!t)return null;var r=t;t.indexOf("/")>-1?(r=t.slice(0,t.indexOf("/")),t=t.slice(t.indexOf("/")+1)):t="";var a=je(e,r);return a.length>0?t?we(a[0],t):a[0]:null}function Ie(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=r?we(e,r):e;return a?(t=a.textContent||a.nodeValue)?t.trim():null:null}function xe(e,t){return function(e,t){for(var r,a=je(e,t),n=[],i=0;i<a.length;i++)(r=a[i].textContent||a[i].nodeValue)&&""!==(r=r.trim())&&n.push(r);return n}(e,t).map((function(e){return Number(e)}))}function Me(e,t){var r=Ie(e,t);return Number(r)}function Oe(e,t){var r,a=null==e||null==(r=e.nodeName)?void 0:r.toLowerCase(),n=t.toLowerCase();return a.slice(a.lastIndexOf(":")+1)===n}function ke(e,t){if(!e||!t)return null;for(var r=[],a=0;a<e.length;a++)r.push(e[a]),r.push(t[a]);return r}function Se(e){if(!e)return null;var t=Number(e);if(!isNaN(t)&&0!==t)return new P.a({wkid:t});var r=e.replace(/\]/g,"[").replace(/\"/g,"").split("[").map((function(e){return e.trim()})).filter((function(e){return""!==e})),a=r[r.length-1].split(",");return"EPSG"!==a[0]||(t=Number(a[1]),isNaN(t)||0===t)?new P.a({wkt:e}):new P.a({wkid:t})}function Ae(e){var t;if("pamdataset"!==(null==e||null==(t=e.documentElement.tagName)?void 0:t.toLowerCase()))return{};var r={spatialReference:null,transform:null,metadata:{},rasterBands:[],statistics:null,histograms:null};e.documentElement.childNodes.forEach((function(e){if(1===e.nodeType)if(Oe(e,"SRS")){if(!r.spatialReference){var t=Ie(e);r.spatialReference=Se(t)}}else if(Oe(e,"Metadata"))if("xml:ESRI"===e.getAttribute("domain")){var a=function(e){var t,r=we(e,"GeodataXform"),a=Se(Me(r,"SpatialReference/WKID")||Ie(r,"SpatialReference/WKT"));if("typens:PolynomialXform"!==r.getAttribute("xsi:type"))return{spatialReference:a,transform:null};var n=null!=(t=Me(r,"PolynomialOrder"))?t:1,i=xe(r,"CoeffX/Double"),o=xe(r,"CoeffY/Double"),s=xe(r,"InverseCoeffX/Double"),l=xe(r,"InverseCoeffY/Double"),c=ke(i,o),u=ke(s,l);return{spatialReference:a,transform:new ge({polynomialOrder:n,forwardCoefficients:c,inverseCoefficients:u})}}(e),n=a.spatialReference,i=a.transform;r.transform=i,r.spatialReference||(r.spatialReference=n)}else je(e,"MDI").forEach((function(e){return r.metadata[e.getAttribute("key")]=Ie(e)}));else if(Oe(e,"PAMRasterBand")){var o=function(e){var t,r,a,n,i,o=Me(e,"NoDataValue"),s=we(e,"Histograms/HistItem"),l=Me(s,"HistMin"),c=Me(s,"HistMax"),u=Me(s,"BucketCount"),f=null==(t=Ie(s,"HistCounts"))?void 0:t.split("|").map((function(e){return Number(e)}));je(e,"Metadata/MDI").forEach((function(e){var t,o=Number(null!=(t=e.textContent)?t:e.nodeValue);switch(e.getAttribute("key").toUpperCase()){case"STATISTICS_MINIMUM":r=o;break;case"STATISTICS_MAXIMUM":a=o;break;case"STATISTICS_MEAN":n=o;break;case"STATISTICS_STDDEV":i=o}}));var p=Me(e,"Metadata/SourceBandIndex");return{noDataValue:o,histogram:null!=f&&f.length&&null!=r&&null!=a?{min:l,max:c,size:u||f.length,counts:f}:null,sourceBandIndex:p,statistics:null!=r&&null!=a?{min:r,max:a,avg:n,stddev:i}:null}}(e);null!=o.sourceBandIndex&&null==r.rasterBands[o.sourceBandIndex]?r.rasterBands[o.sourceBandIndex]=o:r.rasterBands.push(o)}}));var a=r.rasterBands;if(a){var n=!!a[0].statistics;r.statistics=n?a.map((function(e){return e.statistics})):null;var i=!!a[0].histogram;r.histograms=i?a.map((function(e){return e.histogram})):null}return r}var Te=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){return Object(s.a)(this,r),t.apply(this,arguments)}return Object(l.a)(r,[{key:"open",value:function(){var e=Object(i.a)(n.a.mark((function e(t){var r,a,i,o,s,l,c,u,f,p,d,h,b;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.init();case 2:return e.next=4,this._fetchData(t);case 4:return r=e.sent,e.next=7,this._fetchAuxiliaryData(t);case 7:return a=e.sent,i=a.spatialReference,o=a.statistics,s=a.histograms,l=a.transform,(c=!i)&&(i=new P.a({wkid:3857})),null!=s&&s.length&&null==o&&(o=Object(ae.e)(s)),u=r.width,f=r.height,p=new E.a({xmin:-.5,ymin:.5-f,xmax:u-.5,ymax:.5,spatialReference:i}),d=l?l.forwardTransform(p):p,!0,l&&(h=l.forwardCoefficients,h&&0===h[1]&&0===h[2]&&(l=null,p=d)),b=new he({data:{extent:d,nativeExtent:p,transform:l,pixelBlock:r,statistics:o,histograms:s,keyProperties:{DateType:"Processed"},isPseudoSpatialReference:c}}),e.next=22,b.open();case 22:this._set("rasterInfo",b.rasterInfo),this._inMemoryRaster=b;case 24:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"fetchRawTile",value:function(e,t,r){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return this._inMemoryRaster.fetchRawTile(e,t,r,a)}},{key:"_fetchData",value:function(){var e=Object(i.a)(n.a.mark((function e(t){var r,a,i;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.request(this.url,{responseType:"array-buffer",signal:null==t?void 0:t.signal});case 2:if(r=e.sent,a=r.data,"JPG"===(i=Object(re.b)(a).toUpperCase())||"PNG"===i||"GIF"===i||"BMP"===i){e.next=7;break}throw new I.a("image-aux-raster:open","the data is not a supported format");case 7:return this._set("datasetFormat",i),e.next=10,this.decodePixelBlock(a,{format:"jpg",width:1,height:1,useCanvas:!0});case 10:return e.abrupt("return",e.sent);case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_fetchAuxiliaryData",value:function(){var e=Object(i.a)(n.a.mark((function e(t){var r,a,i,o,s,l,c,u,f,p,d;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=Object(h.o)(null==t?void 0:t.signal),o=null!=(r=this.ioConfig.skipExtensions)?r:[],s=o.indexOf("aux.xml")>-1?null:this.request(this.url+".aux.xml",{responseType:"xml",signal:i}),l=this.datasetFormat,c="JPG"===l?"jgw":"PNG"===l?"pgw":"BMP"===l?"bpw":null,u=o.indexOf(c)>-1?null:this.request(this.url.slice(0,this.url.lastIndexOf("."))+"."+c,{responseType:"text",signal:i}),e.next=8,Object(M.j)([s,u]);case 8:if(f=e.sent,null==i||!i.aborted){e.next=11;break}throw Object(M.e)();case 11:return(p=Ae(null==(a=f[0].value)?void 0:a.data)).transform||(d=f[1].value?f[1].value.data.split("\n").slice(0,6).map((function(e){return Number(e)})):null,p.transform=6===(null==d?void 0:d.length)?new ge({forwardCoefficients:[d[4],d[5],d[0],-d[1],d[2],-d[3]]}):null),e.abrupt("return",p);case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),r}(se);Object(d.a)([Object(v.b)({type:String,json:{write:!0}})],Te.prototype,"datasetFormat",void 0);var Ce=Te=Object(d.a)([Object(w.a)("esri.layers.support.rasterDatasets.ImageAuxRaster")],Te),De=r(944),Le=r(920),ze=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){var e;return Object(s.a)(this,r),(e=t.apply(this,arguments))._levelOffset=0,e._slices=null,e._tilemapCache=null,e.datasetFormat="RasterTileServer",e}return Object(l.a)(r,[{key:"open",value:function(){var e=Object(i.a)(n.a.mark((function e(t){var r,a,i,o,s,l,c,u,f,p,d,b,y,v,m,g,j,w,M,O,k,S,A,T;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.init();case 2:if(r=t&&t.signal,!this.sourceJSON){e.next=7;break}e.t0={data:this.sourceJSON},e.next=10;break;case 7:return e.next=9,this.request(this.url,{query:{f:"json"},signal:r});case 9:e.t0=e.sent;case 10:if((a=e.t0).ssl&&(this.url=this.url.replace(/^http:/i,"https:")),i=a.data,this.sourceJSON=i,o=["jpg","jpeg","png","png8","png24","png32","mixed"],this.tileType=i.cacheType,null==this.tileType&&(o.indexOf(i.tileInfo.format.toLowerCase())>-1?this.tileType="Map":"lerc"===i.tileInfo.format.toLowerCase()?this.tileType="Elevation":this.tileType="Raster"),i){e.next=17;break}throw new I.a("imageserverraster:open","cannot initialize tiled image service, missing service info");case 17:if(i.tileInfo){e.next=19;break}throw new I.a("imageserverraster:open","use ImageryLayer to open non-tiled image services");case 19:return this.datasetName=i.name.slice(i.name.indexOf("/")+1),e.next=22,this._fetchRasterInfo({signal:r});case 22:if(s=e.sent,Object(h.i)(s)){e.next=25;break}throw new I.a("image-server-raster:open","cannot initialize image service");case 25:if(l="Map"===this.tileType?Object(De.a)(i.tileInfo,i):Z.a.fromJSON(i.tileInfo),c=s.extent,u=s.pixelSize,f=.5/s.width*u.x,b=l.lodAt(Math.max.apply(null,l.lods.map((function(e){return e.level})))),"Map"!==this.tileType&&0!==i.maxScale&&("Raster"===this.tileType?(p=l.lods.filter((function(e){return e.resolution===u.x}))[0])||(p=l.lods[l.lods.length-1]):(p=l.lods.filter((function(e){return Math.abs(e.scale-i.maxScale)<f}))[0])||(p=l.lods.filter((function(e){return e.scale>i.maxScale})).sort((function(e,t){return e.scale>t.scale?1:-1}))[0]),u.x=u.y=p.resolution,s.width=Math.ceil((c.xmax-c.xmin)/u.x-.1),s.height=Math.ceil((c.ymax-c.ymin)/u.y-.1)),p||(p=b),y=l.lodAt(Math.min.apply(null,l.lods.map((function(e){return e.level})))),"Map"===this.tileType?this._levelOffset=l.lods[0].level:0!==i.minScale&&"Elevation"===this.tileType&&(d=l.lods.filter((function(e){return Math.abs(e.scale-i.minScale)<f}))[0],this._levelOffset=d.level-y.level),d||(d=y),v=Math.max(u.x,u.y),(Math.abs(u.x-u.y)>f||!l.lods.some((function(e){return Math.abs(e.resolution-v)<f})))&&(u.x=u.y=p.resolution,s.width=Math.ceil((c.xmax-c.xmin)/u.x-.1),s.height=Math.ceil((c.ymax-c.ymin)/u.y-.1)),m=p.level-d.level,g=Object(be.a)(l.size,2),j=g[0],w=g[1],M=l.origin,O=u.x,k=u.y,S=[{minCol:Math.floor((c.xmin-M.x+.1*O)/j/O),maxCol:Math.floor((c.xmax-M.x-.1*O)/j/O),minRow:Math.floor((M.y-c.ymax+.1*k)/w/k),maxRow:Math.floor((M.y-c.ymin-.1*k)/w/k)}],m>0)for(A=0;A<m;A++)O*=2,k*=2,S.push({minCol:Math.floor((c.xmin-M.x+.1*O)/j/O),maxCol:Math.floor((c.xmax-M.x-.1*O)/j/O),minRow:Math.floor((M.y-c.ymax+.1*k)/w/O),maxRow:Math.floor((M.y-c.ymin-.1*k)/w/O)});s.storageInfo=new ee({blockWidth:l.size[0],blockHeight:l.size[1],pyramidBlockWidth:l.size[0],pyramidBlockHeight:l.size[1],compression:l.format,origin:l.origin,firstPyramidLevel:1,maximumPyramidLevel:m,tileInfo:l,blockBoundary:S}),this._set("rasterInfo",s),i.capabilities.toLowerCase().indexOf("tilemap")>-1&&(T={tileInfo:s.storageInfo.tileInfo,parsedUrl:Object(x.I)(this.url),url:this.url,tileServers:[],type:"tile"},this._tilemapCache=new Le.a({layer:T}));case 38:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"fetchRawTile",value:function(){var e=Object(i.a)(n.a.mark((function e(t,r,a){var i,o,s,l,c,u,f,p,d,h,b,y,v,m,g,j,w,I,x,M,O,k,S,A,T=arguments;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=T.length>3&&void 0!==T[3]?T[3]:{},o=this.rasterInfo,s=o.storageInfo,l=o.extent,c=o.pixelSize,u=s.maximumPyramidLevel-t+this._levelOffset,f="".concat(this.url,"/tile/").concat(u,"/").concat(r,"/").concat(a),p=this._slices?{sliceId:i.sliceId||0}:null,e.next=10,this.request(f,{query:p,responseType:"array-buffer",signal:i.signal});case 10:if(d=e.sent,h=d.data){e.next=14;break}return e.abrupt("return",null);case 14:return e.next=16,this.decodePixelBlock(h,{width:s.tileInfo.size[0],height:s.tileInfo.size[1],planes:null,pixelType:null,isPoint:"Elevation"===this.tileType});case 16:if(b=e.sent,y=s.blockBoundary[t],!("jpg"!==s.compression||a>y.minCol&&a<y.maxCol&&r>y.minRow&&r<y.maxRow)){e.next=20;break}return e.abrupt("return",b);case 20:return v=s.origin,m=s.blockWidth,g=s.blockHeight,j=Math.pow(2,t),w=Math.round((l.xmin-v.x)/(c.x*j))%m,I=Math.round((l.xmax-v.x)/(c.x*j))%m,x=Math.round((v.y-l.ymax)/(c.x*j))%g,M=Math.round((v.y-l.ymin)/(c.x*j))%g,O=a===y.minCol?w:0,k=r===y.minRow?x:0,S=a===y.maxCol?I:m,A=r===y.maxRow?M:g,e.abrupt("return",(Object(ae.l)(b,{x:O,y:k},{width:S-O,height:A-k}),b));case 22:case"end":return e.stop()}}),e,this)})));return function(t,r,a){return e.apply(this,arguments)}}()},{key:"getSliceIndex",value:function(e){if(null==e||!e.length||!this._slices)return null;for(var t=e,r=0;r<this._slices.length;r++){var a=this._slices[r].multidimensionalDefinition;if(a.length===t.length&&!a.some((function(e){var r=t.filter((function(t){return e.variableName===t.variableName&&t.dimensionName===e.dimensionName}))[0];return!r||(Array.isArray(e.values[0])?e.values[0][0]:e.values[0])!==(Array.isArray(r.values[0])?r.values[0][0]:r.values[0])})))return r}return null}},{key:"fetchVariableStatisticsHistograms",value:function(){var e=Object(i.a)(n.a.mark((function e(t,r){var a,i,o;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=this.request(this.url+"/statistics",{query:{variable:t,f:"json"},signal:r}).then((function(e){var t;return null==(t=e.data)?void 0:t.statistics})),i=this.request(this.url+"/histograms",{query:{variable:t,f:"json"},signal:r}).then((function(e){var t;return null==(t=e.data)?void 0:t.histograms})),e.next=4,Object(M.b)([a,i]);case 4:return o=e.sent,e.abrupt("return",(o[0]&&o[0].forEach((function(e){e.avg=e.mean,e.stddev=e.standardDeviation})),{statistics:o[0]||null,histograms:o[1]||null}));case 6:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"computeBestPyramidLevelForLocation",value:function(){var e=Object(i.a)(n.a.mark((function e(t){var r,a,i,o,s,l,c=arguments;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=c.length>1&&void 0!==c[1]?c[1]:{},this._tilemapCache){e.next=3;break}return e.abrupt("return",0);case 3:if(null!==(a=this.identifyPixelLocation(t,0,r.datumTransformation))){e.next=6;break}return e.abrupt("return",null);case 6:i=0,o=this.rasterInfo.storageInfo.maximumPyramidLevel,s=o-i+this._levelOffset,l=a.srcLocation;case 10:if(!(s>=0)){e.next=25;break}return e.prev=11,e.next=14,this._tilemapCache.fetchAvailability(s,a.row,a.col,r);case 14:if(e.t0=e.sent,"available"!==e.t0){e.next=17;break}return e.abrupt("break",25);case 17:e.next=21;break;case 19:e.prev=19,e.t1=e.catch(11);case 21:if(s--,i++,null!==(a=this.identifyPixelLocation(l,i,r.datumTransformation))){e.next=23;break}return e.abrupt("return",null);case 23:e.next=10;break;case 25:return e.abrupt("return",-1===s||null==a?null:i);case 26:case"end":return e.stop()}}),e,this,[[11,19]])})));return function(t){return e.apply(this,arguments)}}()},{key:"_fetchRasterInfo",value:function(){var e=Object(i.a)(n.a.mark((function e(t){var r,a,i,o,s,l,c,u,f,p,d,h,b=this;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.sourceJSON,a=Math.ceil((r.extent.xmax-r.extent.xmin)/r.pixelSizeX-.1),i=Math.ceil((r.extent.ymax-r.extent.ymin)/r.pixelSizeY-.1),o=P.a.fromJSON(r.spatialReference||r.extent.spatialReference),"Map"!==this.tileType){e.next=3;break}return e.abrupt("return",new Q.a({width:a,height:i,bandCount:3,extent:E.a.fromJSON(r.extent),spatialReference:o,pixelSize:new K.a({x:r.pixelSizeX,y:r.pixelSizeY,spatialReference:o}),pixelType:"u8",statistics:null,keyProperties:{DataType:"processed"}}));case 3:return s=t.slice,l=t.signal,c=!!r.hasRasterAttributeTable&&this.request(this.url+"/rasterAttributeTable",{query:{slice:s,f:"json"},signal:l}).then((function(e){return X.default.fromJSON(e.data)})).catch((function(){return null})),u=!!r.hasColormap&&this.request(this.url+"/colormap",{query:{slice:s,f:"json"},signal:l}).then((function(e){var t;return null==(t=e.data)?void 0:t.colormap})),f=!!r.hasHistograms&&this.request(this.url+"/histograms",{query:{slice:s,f:"json"},signal:l}).then((function(e){var t;return null==(t=e.data)?void 0:t.histograms})),p=this.request(this.url+"/keyProperties",{query:{f:"json"},signal:l}).then((function(e){return e.data})).catch((function(){})),d=!!r.hasMultidimensions&&this._fetchMultidimensionalInfo(),h=!!r.hasMultidimensions&&this.request(this.url+"/slices",{query:{f:"json"},signal:l}).then((function(e){return e.data&&e.data.slices})).catch((function(){})),e.abrupt("return",Object(M.b)([c,u,f,p,d,h]).then((function(e){var t=null;if(r.minValues&&r.minValues.length===r.bandCount){t=[];for(var n=0;n<r.minValues.length;n++)t.push({min:r.minValues[n],max:r.maxValues[n],avg:r.meanValues[n],stddev:r.stdvValues[n]})}return b._slices=e[5]||null,new Q.a({width:a,height:i,bandCount:r.bandCount,extent:E.a.fromJSON(r.extent),spatialReference:o,pixelSize:new K.a({x:r.pixelSizeX,y:r.pixelSizeY,spatialReference:o}),pixelType:r.pixelType.toLowerCase(),statistics:t,attributeTable:e[0]||null,colormap:e[1]||null,histograms:e[2]||null,keyProperties:e[3]||{},multidimensionalInfo:e[4]||null})})));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_fetchMultidimensionalInfo",value:function(){var e=Object(i.a)(n.a.mark((function e(t){var r,a;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.request(this.url+"/multidimensionalInfo",{query:{f:"json"},signal:t}).then((function(e){var t;return null==(t=e.data)?void 0:t.multidimensionalInfo}));case 2:return a=e.sent,e.abrupt("return",(null!=(r=a.variables)&&r.length&&a.variables.forEach((function(e){var t;null!=(t=e.statistics)&&t.length&&e.statistics.forEach((function(e){e.avg=e.mean,e.stddev=e.standardDeviation}))})),a));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),r}(se);Object(d.a)([Object(v.b)({type:String,json:{write:!0}})],ze.prototype,"datasetFormat",void 0),Object(d.a)([Object(v.b)()],ze.prototype,"tileType",void 0);var Re=ze=Object(d.a)([Object(w.a)("esri.layers.support.rasterDatasets.ImageServerRaster")],ze),_e=r(900),Ne=r(968),Be=new Map;Be.set("Int8","s8"),Be.set("UInt8","u8"),Be.set("Int16","s16"),Be.set("UInt16","u16"),Be.set("Int32","s32"),Be.set("UInt32","u32"),Be.set("Float32","f32"),Be.set("Float64","f32"),Be.set("Double64","f32");var He=new Map;He.set("lerc",".lrc"),He.set("none",".til"),He.set("deflate",".pzp"),He.set("jpeg",".jzp");var Pe=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){var e;return Object(s.a)(this,r),(e=t.apply(this,arguments))._files=null,e._storageIndex=null,e.datasetFormat="MRF",e}return Object(l.a)(r,[{key:"open",value:function(){var e=Object(i.a)(n.a.mark((function e(t){var r,a,i,o,s,l,c,u,f,p,d,b,y,v,m,g,j,w,I,x,M,O,k,S;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.init();case 2:return this.datasetName=this.url.slice(this.url.lastIndexOf("/")+1),a=t?Object(h.o)(t.signal):null,e.next=6,this.request(this.url,{responseType:"xml",signal:a});case 6:if(i=e.sent,o=this._parseHeader(i.data),s=o.rasterInfo,l=o.files,-1!==(null==(r=this.ioConfig.skipExtensions)?void 0:r.indexOf("aux.xml"))){e.next=15;break}return e.next=13,this._fetchAuxiliaryData(t);case 13:null!=(c=e.sent)&&(s.statistics=null!=(u=c.statistics)?u:s.statistics,s.histograms=c.histograms,c.histograms&&!Object(h.i)(s.statistics)&&(s.statistics=Object(ae.e)(c.histograms)));case 15:return this._set("rasterInfo",s),this._files=l,e.next=18,this.request(l.index,{responseType:"array-buffer",signal:a});case 18:for(f=e.sent,this._storageIndex=this._parseIndex(f.data),b=0,y=-1,v=this.rasterInfo.storageInfo,m=v.blockWidth,g=v.blockHeight,j=v.compression,w=this.rasterInfo.storageInfo.pyramidScalingFactor,I=this.rasterInfo,x=I.width,M=I.height,O=I.bandCount,k=[],S="none"===j?1:O;b<this._storageIndex.length;)y++,p=Math.ceil(x/m/Math.pow(w,y)),d=Math.ceil(M/g/Math.pow(w,y)),b+=p*d*S*4,k.push({maxRow:d,maxCol:p,minCol:0,minRow:0});this.rasterInfo.storageInfo.blockBoundary=k,y>0&&(this.rasterInfo.storageInfo.firstPyramidLevel=1,this.rasterInfo.storageInfo.maximumPyramidLevel=y),this.updateTileInfo();case 24:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"fetchRawTile",value:function(){var e=Object(i.a)(n.a.mark((function e(t,r,a){var i,o,s,l,c,u,f,p,d,h,b,y,v,m,g,j,w,I,x,O,k,S,A,T,C,D,L,z,R=arguments;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=R.length>3&&void 0!==R[3]?R[3]:{},o=this.rasterInfo.storageInfo,s=o.blockWidth,l=o.blockHeight,c=o.blockBoundary,u=o.compression,!(!(f=c[t])||f.maxRow<r||f.maxCol<a||f.minRow>r||f.minCol>a)){e.next=4;break}return e.abrupt("return",null);case 4:if(p=this.rasterInfo,d=p.bandCount,h=p.pixelType,b=this._getTileLocation(t,r,a),y=b.ranges,v=b.actualTileWidth,m=b.actualTileHeight,y&&0!==y.length){e.next=7;break}return e.abrupt("return",null);case 7:if(0!==y[0].from||0!==y[0].to){e.next=10;break}return g=new Uint8Array(s*l),e.abrupt("return",new _e.a({width:s,height:l,pixels:null,mask:g,validPixelCount:0}));case 10:for(j=this.ioConfig.bandIds,w="none"===u?1:d,I=[],x=0,x=0;x<w;x++)(!j||j.indexOf[x]>-1)&&I.push(this.request(this._files.data,{range:{from:y[x].from,to:y[x].to},responseType:"array-buffer",signal:i.signal}));return e.next=15,Object(M.b)(I);case 15:for(O=e.sent,k=O.map((function(e){return e.data.byteLength})).reduce((function(e,t){return e+t})),S=new Uint8Array(k),A=0,x=0;x<w;x++)S.set(new Uint8Array(O[x].data),A),A+=O[x].data.byteLength;return T="lerc"===this.rasterInfo.storageInfo.compression?"lerc":"bip",e.next=23,this.decodePixelBlock(S.buffer,{width:s,height:l,format:T,pixelType:h});case 23:if(C=e.sent,D=0,L=0,v!==s||m!==l)if(z=C.mask)for(x=0;x<l;x++)if(L=x*s,x<m)for(D=v;D<s;D++)z[L+D]=0;else for(D=0;D<s;D++)z[L+D]=0;else for(z=new Uint8Array(s*l),C.mask=z,x=0;x<m;x++)for(L=x*s,D=0;D<v;D++)z[L+D]=1;return e.abrupt("return",C);case 27:case"end":return e.stop()}}),e,this)})));return function(t,r,a){return e.apply(this,arguments)}}()},{key:"_parseIndex",value:function(e){if(e.byteLength%16>0)throw"invalid array buffer must be multiples of 16";var t,r,a,n,i,o;if(Ne.a){for(r=new Uint8Array(e),n=new ArrayBuffer(e.byteLength),a=new Uint8Array(n),i=0;i<e.byteLength/4;i++)for(o=0;o<4;o++)a[4*i+o]=r[4*i+3-o];t=new Uint32Array(n)}else t=new Uint32Array(e);return t}},{key:"_getTileLocation",value:function(e,t,r){var a,n,i,o=this.rasterInfo.storageInfo,s=o.blockWidth,l=o.blockHeight,c=o.pyramidScalingFactor,u=o.compression,f=this.rasterInfo,p=f.width,d=f.height,h=f.bandCount,b="none"===u?1:h,y=0,v=0;for(i=0;i<e;i++)v=Math.pow(c,i),y+=(a=Math.ceil(p/s/v))*(n=Math.ceil(d/l/v));v=Math.pow(c,e),a=Math.ceil(p/s/v),n=Math.ceil(d/l/v),y+=t*a+r,y*=4*b;for(var m=this._storageIndex.subarray(y,y+4*b),g=0,j=0,w=[],I=0;I<b;I++)j=(g=m[4*I+0]*Math.pow(2,32)+m[4*I+1])+m[4*I+2]*Math.pow(2,32)+m[4*I+3],w.push({from:g,to:j});return{ranges:w,actualTileWidth:r<a-1?s:Math.ceil(p/v)-s*(a-1),actualTileHeight:t<n-1?l:Math.ceil(d/v)-l*(n-1)}}},{key:"_parseHeader",value:function(e){var t=we(e,"MRF_META/Raster");if(!t)throw new I.a("mrf:open","not a valid MRF format");var r=we(t,"Size"),a=parseInt(r.getAttribute("x"),10),n=parseInt(r.getAttribute("y"),10),i=parseInt(r.getAttribute("c"),10),o=(Ie(t,"Compression")||"none").toLowerCase();if(!o||-1===["none","lerc"].indexOf(o))throw new I.a("mrf:open","currently does not support compression "+o);var s=Ie(t,"DataType")||"UInt8",l=Be.get(s);if(null==l)throw new I.a("mrf:open","currently does not support pixel type "+s);var c,u,f=we(t,"PageSize"),p=parseInt(f.getAttribute("x"),10),d=parseInt(f.getAttribute("y"),10),h=we(t,"DataValues");if(h&&(null!=(u=h.getAttribute("NoData"))&&(c=u.trim().split(" ").map((function(e){return parseFloat(e)})))),we(e,"MRF_META/CachedSource"))throw new I.a("mrf:open","currently does not support MRF referencing other data files");var b=we(e,"MRF_META/GeoTags"),y=we(b,"BoundingBox");if(null==y)throw new I.a("mrf:open","missing node MRF_META/GeoTags/BoundingBox");var v,m=parseFloat(y.getAttribute("minx")),g=parseFloat(y.getAttribute("miny")),j=parseFloat(y.getAttribute("maxx")),w=parseFloat(y.getAttribute("maxy")),x=Ie(b,"Projection"),M=Ie(e,"datafile"),O=Ie(e,"IndexFile");"LOCAL_CS[]"!==x&&(v=new P.a({wkt:x}));var k=new E.a(m,g,j,w);k.spatialReference=v;var S=we(e,"MRF_META/Rsets"),A=parseInt(S&&S.getAttribute("scale")||"2",10),T=new ee({origin:new K.a({x:k.xmin,y:k.ymax,spatialReference:v}),blockWidth:p,blockHeight:d,pyramidBlockWidth:p,pyramidBlockHeight:d,compression:o,pyramidScalingFactor:A}),C=new K.a({x:(j-m)/a,y:(w-g)/n,spatialReference:v});return{rasterInfo:new Q.a({width:a,height:n,extent:k,spatialReference:v,bandCount:i,pixelType:l,pixelSize:C,noDataValue:c,storageInfo:T}),files:{mrf:this.url,index:O||this.url.replace(".mrf",".idx"),data:M||this.url.replace(".mrf",He.get(o))}}}},{key:"_fetchAuxiliaryData",value:function(){var e=Object(i.a)(n.a.mark((function e(t){var r,a;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.request(this.url+".aux.xml",{responseType:"xml",signal:null==t?void 0:t.signal});case 3:return r=e.sent,a=r.data,e.abrupt("return",Ae(a));case 8:return e.prev=8,e.t0=e.catch(0),e.abrupt("return",null);case 11:case"end":return e.stop()}}),e,this,[[0,8]])})));return function(t){return e.apply(this,arguments)}}()}]),r}(se);Object(d.a)([Object(v.b)()],Pe.prototype,"_files",void 0),Object(d.a)([Object(v.b)()],Pe.prototype,"_storageIndex",void 0),Object(d.a)([Object(v.b)({type:String,json:{write:!0}})],Pe.prototype,"datasetFormat",void 0);var Ee=Pe=Object(d.a)([Object(w.a)("esri.layers.support.rasterIO.MRFRaster")],Pe),Ue=r(1019),Fe=r(1059),Ze=function(e,t){var r=e.get(t);return r&&r.values},Ge=function(e,t){var r=e.get(t);return r&&r.values[0]},Je=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){var e;return Object(s.a)(this,r),(e=t.apply(this,arguments))._files=null,e._headerInfo=null,e._bufferSize=1048576,e.datasetFormat="TIFF",e}return Object(l.a)(r,[{key:"open",value:function(){var e=Object(i.a)(n.a.mark((function e(t){var r,a,i,s,l,c,u,f,p,d,b,y,v,m,g,j,w,x,M,O,k,S,A,T,C,D,L,z,R,_,N,B;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.init();case 2:return a=t?Object(h.o)(t.signal):null,e.next=5,this.request(this.url,{range:{from:0,to:this._bufferSize},responseType:"array-buffer",signal:a});case 5:if(i=e.sent,s=i.data){e.next=9;break}throw new I.a("tiffraster:open","failed to open url "+this.url);case 9:return this.datasetName=this.url.slice(this.url.lastIndexOf("/")+1),l=Object(Fe.f)(s),c=l.littleEndian,u=l.firstIFD,f=l.isBigTiff,p=[],e.next=13,this.readIFDs(p,s,c,u,0,f?8:4,a);case 13:if(d=Object(Fe.c)(p),b=d.width,y=d.height,v=d.tileWidth,m=d.tileHeight,g=d.planes,j=d.pixelType,w=d.compression,x=d.firstPyramidLevel,M=d.maximumPyramidLevel,O=d.pyramidBlockWidth,k=d.pyramidBlockHeight,S=d.tileBoundary,A=d.metadata,T=E.a.fromJSON(d.extent),C=T.spatialReference,D=new K.a(T?{x:T.xmin,y:T.ymax,spatialReference:C}:{x:0,y:0}),L=new ee({blockWidth:v,blockHeight:m,pyramidBlockWidth:O,pyramidBlockHeight:k,compression:w,origin:D,firstPyramidLevel:x,maximumPyramidLevel:M,blockBoundary:S}),z=new K.a({x:(T.xmax-T.xmin)/b,y:(T.ymax-T.ymin)/y,spatialReference:C}),R=A?{BandProperties:A.bandProperties,DataType:A.dataType}:{},_=new Q.a({width:b,height:y,bandCount:g,pixelType:j,compression:w,pixelSize:z,storageInfo:L,spatialReference:C,keyProperties:R,extent:T,statistics:A?A.statistics:null}),-1!==(null==(r=this.ioConfig.skipExtensions)?void 0:r.indexOf("aux.xml"))){e.next=19;break}return e.next=17,this._fetchAuxiliaryData(t);case 17:null!=(N=e.sent)&&(_.statistics=null!=(B=N.statistics)?B:_.statistics,_.histograms=N.histograms,N.histograms&&!Object(h.i)(_.statistics)&&(_.statistics=Object(ae.e)(N.histograms)));case 19:if(this._set("rasterInfo",_),this._headerInfo=Object(o.a)({littleEndian:c,isBigTiff:f,ifds:p},d),this._headerInfo.isSupported){e.next=21;break}throw new I.a("tiffraster:open","this tiff is not supported: "+this._headerInfo.message);case 21:this.updateTileInfo();case 22:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"fetchRawTile",value:function(){var e=Object(i.a)(n.a.mark((function e(t,r,a){var i,o,s,l,c,u,f,p,d,h,b,y,v,m,g,j,w,I=arguments;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=I.length>3&&void 0!==I[3]?I[3]:{},this._headerInfo||!this._headerInfo.isSupported){e.next=3;break}return e.abrupt("return",null);case 3:if(o=this.rasterInfo.storageInfo.blockBoundary,s=t>0?this.rasterInfo.storageInfo.pyramidBlockWidth:this.rasterInfo.storageInfo.blockWidth,l=t>0?this.rasterInfo.storageInfo.pyramidBlockHeight:this.rasterInfo.storageInfo.blockHeight,!(!(c=o[t])||c.maxRow<r||c.maxCol<a||c.minRow>r||c.minCol>a)){e.next=6;break}return e.abrupt("return",null);case 6:if(u=this.getTileLocation(t,r,a)){e.next=9;break}return e.abrupt("return",null);case 9:return f=u.range,p=u.actualTileWidth,d=u.actualTileHeight,h=u.ifd,e.next=15,this.request(this.url,{range:f,responseType:"array-buffer",signal:i.signal});case 15:return b=e.sent,y=b.data,e.next=19,this.decodePixelBlock(y,{format:"tiff",customOptions:{headerInfo:this._headerInfo,ifd:h,offset:0,size:0},width:s,height:l,planes:null,pixelType:null});case 19:if(v=e.sent,p!==s||d!==l)if(w=v.mask)for(m=0;m<l;m++)if(j=m*s,m<d)for(g=p;g<s;g++)w[j+g]=0;else for(g=0;g<s;g++)w[j+g]=0;else for(w=new Uint8Array(s*l),v.mask=w,m=0;m<d;m++)for(j=m*s,g=0;g<p;g++)w[j+g]=1;return e.abrupt("return",v);case 22:case"end":return e.stop()}}),e,this)})));return function(t,r,a){return e.apply(this,arguments)}}()},{key:"readIFDs",value:function(){var e=Object(i.a)(n.a.mark((function e(t,r,a,i,o){var s,l,c,u=arguments;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=u.length>5&&void 0!==u[5]?u[5]:4,l=u.length>6?u[6]:void 0,i){e.next=4;break}return e.abrupt("return",null);case 4:if(!(i>=r.byteLength||i<0)){e.next=10;break}return e.next=7,this.request(this.url,{range:{from:i+o,to:i+o+this._bufferSize},responseType:"array-buffer",signal:l});case 7:r=e.sent.data,o=i+o,i=0;case 10:return e.next=12,this.readIFD(r,a,i,o,Ue.a.TIFF_TAGS,s,l);case 12:if(c=e.sent,t.push(c.ifd),c.nextIFD){e.next=15;break}return e.abrupt("return",null);case 15:return e.next=17,this.readIFDs(t,r,a,c.nextIFD-o,o,s,l);case 17:case"end":return e.stop()}}),e,this)})));return function(t,r,a,n,i){return e.apply(this,arguments)}}()},{key:"readIFD",value:function(){var e=Object(i.a)(n.a.mark((function e(t,r,a,i){var o,s,l,c,u,f,p,d,h,b,y,v,m,g,j=arguments;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=j.length>4&&void 0!==j[4]?j[4]:Ue.a.TIFF_TAGS,s=j.length>5&&void 0!==j[5]?j[5]:4,l=j.length>6?j[6]:void 0,t){e.next=5;break}return e.abrupt("return",null);case 5:if(!(c=Object(Fe.e)(t,r,a,i,o,s)).success){e.next=25;break}if(u=[],c.ifd.forEach((function(e){e.values||u.push(e)})),!(u.length>0)){e.next=16;break}if(f=u.map((function(e){return e.offlineOffsetSize})),p=Math.min.apply(null,f.map((function(e){return e[0]}))),!(Math.min.apply(null,f.map((function(e){return e[0]+e[1]})))-p<=this._bufferSize)){e.next=16;break}return e.next=13,this.request(this.url,{range:{from:p,to:p+this._bufferSize},responseType:"array-buffer",signal:l});case 13:d=e.sent,h=d.data,t=h,i=p,u.forEach((function(e){return Object(Fe.d)(t,r,e,i)}));case 16:if(!c.ifd.has("GEOKEYDIRECTORY")){e.next=24;break}if(b=c.ifd.get("GEOKEYDIRECTORY"),!((y=b.values)&&y.length>4)){e.next=24;break}return v=y[0]+"."+y[1]+"."+y[2],e.next=22,this.readIFD(t,r,b.valueOffset+6-i,i,Ue.a.GEO_KEYS,2,l);case 22:m=e.sent,b.data=m.ifd,b.data&&b.data.set("GEOTIFFVersion",{id:0,type:2,valueCount:1,valueOffset:null,values:[v]});case 24:return e.abrupt("return",c);case 25:if(!c.requiredBufferSize||c.requiredBufferSize===t.byteLength){e.next=30;break}return e.next=28,this.request(this.url,{range:{from:i,to:i+c.requiredBufferSize+4},responseType:"array-buffer",signal:l});case 28:return g=e.sent,e.abrupt("return",(t=g.data).byteLength<c.requiredBufferSize?null:this.readIFD(t,r,0,i,Ue.a.TIFF_TAGS,4,l));case 30:case"end":return e.stop()}}),e,this)})));return function(t,r,a,n){return e.apply(this,arguments)}}()},{key:"getTileLocation",value:function(e,t,r){var a=this.rasterInfo.storageInfo,n=a.firstPyramidLevel,i=a.blockBoundary,o=0===e?0:e-(n-1),s=this._headerInfo.ifds[o];if(!s)return null;var l=Ze(s,"TILEOFFSETS");if(void 0===l)return null;var c=Ze(s,"TILEBYTECOUNTS"),u=i[o],f=u.minRow,p=u.minCol,d=u.maxRow,h=u.maxCol;if(t>d||r>h||t<f||r<p)return null;var b=Ge(s,"IMAGEWIDTH"),y=Ge(s,"IMAGELENGTH"),v=Ge(s,"TILEWIDTH"),m=Ge(s,"TILELENGTH"),g=t*(h+1)+r,j=l[g],w=c[g];return null==j||null==w?null:{range:{from:j,to:j+w-1},ifd:s,actualTileWidth:r===h?b%v:v,actualTileHeight:t===d?y%m:m}}},{key:"_fetchAuxiliaryData",value:function(){var e=Object(i.a)(n.a.mark((function e(t){var r,a;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.request(this.url+".aux.xml",{responseType:"xml",signal:null==t?void 0:t.signal});case 3:return r=e.sent,a=r.data,e.abrupt("return",Ae(a));case 8:return e.prev=8,e.t0=e.catch(0),e.abrupt("return",null);case 11:case"end":return e.stop()}}),e,this,[[0,8]])})));return function(t){return e.apply(this,arguments)}}()}]),r}(se);Object(d.a)([Object(v.b)()],Je.prototype,"_files",void 0),Object(d.a)([Object(v.b)()],Je.prototype,"_headerInfo",void 0),Object(d.a)([Object(v.b)()],Je.prototype,"_bufferSize",void 0),Object(d.a)([Object(v.b)({type:String,json:{write:!0}})],Je.prototype,"datasetFormat",void 0);var Ve=Je=Object(d.a)([Object(w.a)("esri.layers.support.rasterDatasets.TIFFRaster")],Je),We=new Map;We.set("CRF",{desc:"Cloud Raster Format",constructor:pe}),We.set("MRF",{desc:"Meta Raster Format",constructor:Ee}),We.set("TIFF",{desc:"GeoTIFF",constructor:Ve}),We.set("RasterTileServer",{desc:"Raster Tile Server",constructor:Re}),We.set("JPG",{desc:"JPG Raster Format",constructor:Ce}),We.set("PNG",{desc:"PNG Raster Format",constructor:Ce}),We.set("GIF",{desc:"GIF Raster Format",constructor:Ce}),We.set("BMP",{desc:"BMP Raster Format",constructor:Ce});var qe=function(){function e(){Object(s.a)(this,e)}return Object(l.a)(e,null,[{key:"supportedFormats",get:function(){var e=new Set;return We.forEach((function(t,r){return e.add(r)})),e}},{key:"open",value:function(){var e=Object(i.a)(n.a.mark((function e(t){var r,a,i,o,s,l,c,u,f,p;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.url,a=t.ioConfig,i=t.sourceJSON,null==(o=t.datasetFormat)&&r.lastIndexOf(".")&&(o=r.slice(r.lastIndexOf(".")+1).toUpperCase()),"OVR"===o||"TIF"===o?o="TIFF":"JPG"!==o&&"JPEG"!==o&&"JFIF"!==o||(o="JPG"),r.toLowerCase().indexOf("/imageserver")>-1&&-1===r.toLowerCase().indexOf("/wcsserver")&&(o="RasterTileServer"),s={url:r,sourceJSON:i,datasetFormat:o,ioConfig:a||{bandIds:null,sampling:null}},!this.supportedFormats.has(o)){e.next=10;break}return l=We.get(o).constructor,c=new l(s),e.next=9,c.open({signal:t.signal});case 9:return e.abrupt("return",c);case 10:if(!o){e.next=12;break}throw new I.a("rasterfactory:open","not a supported format "+o);case 12:return u=Array.from(We.keys()),f=0,p=function e(){return(o=u[f++])?(l=We.get(o).constructor,(c=new l(s)).open({signal:t.signal}).then((function(){return c})).catch((function(){return e()}))):null},e.abrupt("return",p());case 16:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"register",value:function(e,t,r){We.has(e.toUpperCase())||We.set(e.toUpperCase(),{desc:t,constructor:r})}}]),e}(),Ke=Object(m.b)()({RSP_NearestNeighbor:"nearest",RSP_BilinearInterpolation:"bilinear",RSP_CubicConvolution:"cubic",RSP_Majority:"majority"});function Xe(){return{enabled:!this.loaded||"RasterTileServer"===this.raster.datasetFormat&&"Raster"===this.raster.tileType}}var Qe=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){var e;Object(s.a)(this,r);for(var a=arguments.length,n=new Array(a),i=0;i<a;i++)n[i]=arguments[i];return(e=t.call.apply(t,[this].concat(n))).bandIds=null,e.interpolation=null,e.legendEnabled=!0,e.isReference=null,e.listMode="show",e.sourceJSON=null,e.version=null,e.title=null,e.type="imagery-tile",e.operationalLayerType="ArcGISTiledImageServiceLayer",e.popupEnabled=!0,e.popupTemplate=null,e}return Object(l.a)(r,[{key:"normalizeCtorArgs",value:function(e,t){return"string"==typeof e?Object(o.a)({url:e},t):e}},{key:"load",value:function(e){var t=this,r=Object(h.i)(e)?e.signal:null;return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["Image Service"]},e).then((function(){return t._openRaster(r)}),(function(){return t._openRaster(r)}))),Object(M.u)(this)}},{key:"defaultPopupTemplate",get:function(){return this.createPopupTemplate()}},{key:"fields",get:function(){var e,t,r=[new D.a({name:"Raster.ServicePixelValue",alias:"Pixel Value",domain:null,editable:!1,length:50,type:"string"})],a=null==(e=this.rasterInfo)||null==(t=e.attributeTable)?void 0:t.fields;if(a){var n=a.filter((function(e){return"oid"!==e.type&&"value"!==e.name.toLowerCase()})).map((function(e){var t=e.clone();return t.name="Raster."+e.name,t}));r=r.concat(n)}return r}},{key:"renderer",set:function(e){this._set("renderer",e),this.updateRenderer()}},{key:"readRenderer",value:function(e,t,r){var a=t&&t.layerDefinition&&t.layerDefinition.drawingInfo&&t.layerDefinition.drawingInfo.renderer,n=Object(C.b)(a,r)||void 0;if(null!=n)return n}},{key:"createPopupTemplate",value:function(e){return Object(N.a)(this,e)}},{key:"write",value:function(e,t){var a=this.raster;if(this.loaded?"RasterTileServer"===a.datasetFormat&&("Raster"===a.tileType||"Map"===a.tileType):this.url&&/\/ImageServer(\/|\/?$)/i.test(this.url))return Object(c.a)(Object(u.a)(r.prototype),"write",this).call(this,e,t);if(t&&t.messages){var n="".concat(t.origin,"/").concat(t.layerContainerType||"operational-layers");t.messages.push(new I.a("layer:unsupported","Layers (".concat(this.title,", ").concat(this.id,") of type '").concat(this.declaredClass,"' are not supported in the context of '").concat(n,"'"),{layer:this}))}return null}},{key:"_openRaster",value:function(){var e=Object(i.a)(n.a.mark((function e(t){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.raster){e.next=8;break}if(e.t0=this.raster.rasterInfo,e.t0){e.next=5;break}return e.next=5,this.raster.open();case 5:this.url=this.raster.url,e.next=11;break;case 8:return e.next=10,qe.open({url:this.url,sourceJSON:this.sourceJSON,ioConfig:this.ioConfig,signal:t});case 10:this.raster=e.sent;case 11:if(this.raster.rasterInfo){e.next=14;break}throw new I.a("imagery-tile-layer:load","cannot load resources on "+this.url);case 14:this.sourceJSON=this.sourceJSON||this.raster.sourceJSON,null!=this.sourceJSON&&(this._set("version",this.sourceJSON.currentVersion),this._set("copyright",this.sourceJSON.copyrightText)),null==this.title&&(this.title=this.raster.datasetName),"Map"===this.raster.tileType&&(this.popupEnabled=!1),this._configDefaultSettings();case 15:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),r}(Object(L.a)(Object(_.a)(Object(R.a)(Object(T.a)(Object(z.a)(function(e){var t=function(e){Object(f.a)(r,e);var t=Object(p.a)(r);function r(){var e;return Object(s.a)(this,r),(e=t.apply(this,arguments))._rasterJobHandler={instance:null,refCount:0,connectionPromise:null},e.bandIds=null,e.copyright=null,e.fullExtent=null,e.interpolation="nearest",e.raster=null,e.rasterInfo=null,e.sourceJSON=null,e.spatialReference=null,e.tileInfo=null,e.symbolizer=null,e}return Object(l.a)(r,[{key:"multidimensionalDefinition",set:function(e){this.raster&&(this._sliceId=this.raster.getSliceIndex(e)),this._set("multidimensionalDefinition",e)}},{key:"url",set:function(e){this._set("url",Object(F.f)(e,q))}},{key:"renderer",set:function(e){this._set("renderer",e),this.updateRenderer()}},{key:"updateRenderer",value:function(){var e=Object(i.a)(n.a.mark((function e(){var t;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.loaded){e.next=2;break}return e.abrupt("return");case 2:if(JSON.stringify(this._cachedRendererJson)!==JSON.stringify(this.renderer)){e.next=4;break}return e.abrupt("return");case 4:if(t=this._rasterJobHandler.instance,e.t0=t,!e.t0){e.next=12;break}return this.symbolizer.rendererJSON=this.renderer.toJSON(),this.symbolizer.bind(),e.next=11,t.updateSymbolizer(this.symbolizer);case 11:this._cachedRendererJson=this.renderer.toJSON();case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"applyRenderer",value:function(){var e=Object(i.a)(n.a.mark((function e(t,r){var a,i,s,l;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((a=t&&t.pixelBlock)&&a.pixels&&a.pixels.length>0){e.next=3;break}return e.abrupt("return",null);case 3:if(this.updateRenderer(),s=this._rasterJobHandler.instance,l=this.bandIds,!s){e.next=11;break}return e.next=8,s.symbolize(Object(o.a)(Object(o.a)({},t),{},{simpleStretchParams:r,bandIds:l}));case 8:e.t0=e.sent,e.next=12;break;case 11:e.t0=this.symbolizer.symbolize(Object(o.a)(Object(o.a)({},t),{},{simpleStretchParams:r,bandIds:l}));case 12:return i=e.t0,e.abrupt("return",i);case 14:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getTileUrl",value:function(e,t,r){return"RasterTileServer"===this.raster.datasetFormat?"".concat(this.url,"/tile/").concat(e,"/").concat(t,"/").concat(r):""}},{key:"getCompatibleTileInfo",value:function(e,t){if(!this.loaded)return null;var r=Object(H.d)(e);return Z.a.create({size:256,spatialReference:e,origin:r?{x:r.origin[0],y:r.origin[1]}:{x:t.xmin,y:t.ymax}})}},{key:"getCompatibleFullExtent",value:function(e){return this.loaded?(this._compatibleFullExtent&&this._compatibleFullExtent.spatialReference.equals(e)||(this._compatibleFullExtent=this.raster.computeExtent(e)),this._compatibleFullExtent):null}},{key:"fetchTile",value:function(){var e=Object(i.a)(n.a.mark((function e(t,r,a){var i,s,l,c=arguments;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(i=c.length>3&&void 0!==c[3]?c[3]:{}).requestAsImageElement){e.next=4;break}return s=this.getTileUrl(t,r,a),e.abrupt("return",Object(U.default)(s,{responseType:"image",query:{sliceId:this._sliceId,_ts:i.timestamp},signal:i.signal}).then((function(e){return e.data})));case 4:return e.next=6,this._initJobHandler();case 6:if(!this.multidimensionalDefinition){e.next=9;break}l=this._sliceId,i=Object(o.a)({multidimensionalDefinition:this.multidimensionalDefinition,sliceId:l},i);case 9:return e.abrupt("return",("raster-shaded-relief"===this.renderer.type&&(i=Object(o.a)({buffer:{cols:1,rows:1}},i)),this.raster.fetchTile(t,r,a,i)));case 10:case"end":return e.stop()}}),e,this)})));return function(t,r,a){return e.apply(this,arguments)}}()},{key:"fetchPixels",value:function(){var e=Object(i.a)(n.a.mark((function e(t,r,a,i){var s;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._initJobHandler();case 2:if(!this.multidimensionalDefinition){e.next=5;break}s=this._sliceId,i=Object(o.a)({multidimensionalDefinition:this.multidimensionalDefinition,sliceId:s},i);case 5:return e.abrupt("return",this.raster.fetchPixels(t,r,a,i));case 6:case"end":return e.stop()}}),e,this)})));return function(t,r,a,n){return e.apply(this,arguments)}}()},{key:"identify",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.multidimensionalDefinition&&!t.multidimensionalDefinition&&(t=Object(o.a)(Object(o.a)({},t),{},{multidimensionalDefinition:this.multidimensionalDefinition})),this.raster.identify(e,t)}},{key:"increaseRasterJobHandlerUsage",value:function(){this._rasterJobHandler.refCount++}},{key:"decreaseRasterJobHandlerUsage",value:function(){this._rasterJobHandler.refCount--,this._rasterJobHandler.refCount<=0&&this._shutdownJobHandler()}},{key:"_configDefaultSettings",value:function(){this._configDefaultInterpolation(),this._configDefaultSlice(),this._configDefaultRenderer()}},{key:"_initJobHandler",value:function(){var e=this;if(null!=this._rasterJobHandler.connectionPromise)return this._rasterJobHandler.connectionPromise;var t=new J.a;return this._rasterJobHandler.connectionPromise=t.initialize().then((function(){e._rasterJobHandler.instance=t,e.raster.rasterJobHandler=t,e.renderer&&e.updateRenderer()})).catch((function(){return null})),this._rasterJobHandler.connectionPromise}},{key:"_shutdownJobHandler",value:function(){this._rasterJobHandler.instance&&this._rasterJobHandler.instance.destroy(),this._rasterJobHandler.instance=null,this._rasterJobHandler.connectionPromise=null,this._rasterJobHandler.refCount=0,this.raster.rasterJobHandler=null}},{key:"_configDefaultInterpolation",value:function(){if(null==this.interpolation){var e,t=Object(V.c)(this.rasterInfo,this.raster.tileType,null==(e=this.sourceJSON)?void 0:e.defaultResamplingMethod);this._set("interpolation",t)}}},{key:"_configDefaultSlice",value:function(){var e=this.raster.rasterInfo.multidimensionalInfo;if(Object(h.i)(e)){if(!this.multidimensionalDefinition){var t=e.variables[0],r=[];t.dimensions.forEach((function(e){r.push(new G.a({variableName:t.name,dimensionName:e.name,values:e.hasRegularIntervals?e.extent[0]:e.values[0],isSlice:!0}))})),this.multidimensionalDefinition=r}this._sliceId=this.raster.getSliceIndex(this.multidimensionalDefinition)}}},{key:"_configDefaultRenderer",value:function(){var e,t=this.raster.rasterInfo;this.bandIds||(this.bandIds=Object(V.b)(t)),this.renderer||(this.renderer=Object(V.a)(t,{bandIds:this.bandIds,variableName:null==(e=this.multidimensionalDefinition)?void 0:e[0].variableName})),this.symbolizer?(this.symbolizer.rendererJSON=this.renderer.toJSON(),this.symbolizer.rasterInfo=t):this.symbolizer=new W.a({rendererJSON:this.renderer.toJSON(),rasterInfo:t}),this.symbolizer.bind()||q.warn("imagery-tile-mixin","The given renderer is not supported by the layer.")}}]),r}(e);return Object(d.a)([Object(v.b)()],t.prototype,"_cachedRendererJson",void 0),Object(d.a)([Object(v.b)()],t.prototype,"_sliceId",void 0),Object(d.a)([Object(v.b)()],t.prototype,"_compatibleFullExtent",void 0),Object(d.a)([Object(v.b)()],t.prototype,"_rasterJobHandler",void 0),Object(d.a)([Object(v.b)()],t.prototype,"bandIds",void 0),Object(d.a)([Object(v.b)()],t.prototype,"copyright",void 0),Object(d.a)([Object(v.b)({type:E.a}),Object(B.a)("rasterInfo.extent")],t.prototype,"fullExtent",void 0),Object(d.a)([Object(v.b)()],t.prototype,"interpolation",void 0),Object(d.a)([Object(v.b)({type:[G.a]})],t.prototype,"multidimensionalDefinition",null),Object(d.a)([Object(v.b)()],t.prototype,"raster",void 0),Object(d.a)([Object(v.b)({readOnly:!0}),Object(B.a)("raster.rasterInfo")],t.prototype,"rasterInfo",void 0),Object(d.a)([Object(v.b)()],t.prototype,"sourceJSON",void 0),Object(d.a)([Object(v.b)({type:P.a}),Object(B.a)("rasterInfo.spatialReference")],t.prototype,"spatialReference",void 0),Object(d.a)([Object(v.b)({type:Z.a,dependsOn:["rasterInfo"]}),Object(B.a)("rasterInfo.storageInfo.tileInfo")],t.prototype,"tileInfo",void 0),Object(d.a)([Object(v.b)(A.j)],t.prototype,"url",null),Object(d.a)([Object(v.b)({types:C.a})],t.prototype,"renderer",null),Object(d.a)([Object(v.b)()],t.prototype,"symbolizer",void 0),t=Object(d.a)([Object(w.a)("esri.layers.ImageryTileMixin")],t),t}(Object(S.a)(k.a))))))));Object(d.a)([Object(v.b)()],Qe.prototype,"ioConfig",void 0),Object(d.a)([Object(v.b)({type:[y.a],json:{write:{overridePolicy:Xe}}})],Qe.prototype,"bandIds",void 0),Object(d.a)([Object(v.b)({json:{write:{overridePolicy:Xe}}}),Object(g.a)(Ke)],Qe.prototype,"interpolation",void 0),Object(d.a)([Object(v.b)({json:{write:!0}})],Qe.prototype,"multidimensionalDefinition",void 0),Object(d.a)([Object(v.b)(A.d)],Qe.prototype,"legendEnabled",void 0),Object(d.a)([Object(v.b)({type:Boolean,json:{read:!1,write:{enabled:!0,overridePolicy:function(){return{enabled:!1}}}}})],Qe.prototype,"isReference",void 0),Object(d.a)([Object(v.b)({type:["show","hide"]})],Qe.prototype,"listMode",void 0),Object(d.a)([Object(v.b)()],Qe.prototype,"sourceJSON",void 0),Object(d.a)([Object(v.b)({readOnly:!0})],Qe.prototype,"version",void 0),Object(d.a)([Object(v.b)()],Qe.prototype,"title",void 0),Object(d.a)([Object(v.b)({readOnly:!0,json:{read:!1}})],Qe.prototype,"type",void 0),Object(d.a)([Object(v.b)({type:["ArcGISTiledImageServiceLayer"]})],Qe.prototype,"operationalLayerType",void 0),Object(d.a)([Object(v.b)({type:Boolean,value:!0,json:{read:{source:"disablePopup",reader:function(e,t){return!t.disablePopup}},write:{target:"disablePopup",overridePolicy:Xe,writer:function(e,t,r){t[r]=!e}}}})],Qe.prototype,"popupEnabled",void 0),Object(d.a)([Object(v.b)({type:O.a,json:{read:{source:"popupInfo"},write:{target:"popupInfo",overridePolicy:Xe}}})],Qe.prototype,"popupTemplate",void 0),Object(d.a)([Object(v.b)({readOnly:!0,dependsOn:["title"]})],Qe.prototype,"defaultPopupTemplate",null),Object(d.a)([Object(v.b)({readOnly:!0,type:[D.a],dependsOn:["rasterInfo"]})],Qe.prototype,"fields",null),Object(d.a)([Object(v.b)({types:C.a,json:{name:"layerDefinition.drawingInfo.renderer",write:{overridePolicy:Xe},origins:{"web-scene":{types:C.c,name:"layerDefinition.drawingInfo.renderer",write:{overridePolicy:function(e){return{enabled:e&&"vector-field"!==e.type}}}}}}})],Qe.prototype,"renderer",null),Object(d.a)([Object(j.a)("renderer")],Qe.prototype,"readRenderer",null);var Ye=Qe=Object(d.a)([Object(w.a)("esri.layers.ImageryTileLayer")],Qe);t.default=Ye},1098:function(e,t,r){"use strict";r.d(t,"a",(function(){return d}));var a=r(9),n=r(10),i=r.n(n),o=r(21),s=r(2),l=r(3),c=r(23),u=r(16),f=r(900),p=r(383),d=function(){function e(){Object(s.a)(this,e),this._workerThread=null,this._destroyed=!1}return Object(l.a)(e,[{key:"initialize",value:function(){var e=Object(o.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(p.b)("RasterWorker");case 2:t=e.sent,this._destroyed?t.close():this._workerThread=t;case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"destroy",value:function(){this._destroyed=!0,this._workerThread&&(this._workerThread.close(),this._workerThread=null)}},{key:"decode",value:function(){var e=Object(o.a)(i.a.mark((function e(t,r){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._workerThread){e.next=2;break}throw new c.a("raster-jobhandler:no-connection","no available worker connection");case 2:return e.next=4,this._workerThread.invoke("decode",t,r);case 4:return a=e.sent,e.abrupt("return",a?new f.a(a):null);case 6:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"symbolize",value:function(){var e=Object(o.a)(i.a.mark((function e(t,r){var a,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._workerThread){e.next=2;break}throw new c.a("raster-jobhandler:no-connection","no available worker connection");case 2:return a={extent:t.extent&&t.extent.toJSON(),pixelBlock:t.pixelBlock.toJSON(),simpleStretchParams:t.simpleStretchParams,bandIds:t.bandIds},e.next=5,this._workerThread.invoke("symbolize",a,r);case 5:return n=e.sent,e.abrupt("return",n?new f.a(n):null);case 7:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"updateSymbolizer",value:function(){var e=Object(o.a)(i.a.mark((function e(t,r){var a,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._workerThread){e.next=2;break}throw new c.a("raster-jobhandler:no-connection","no available worker connection");case 2:return n=null==t||null==(a=t.rendererJSON)?void 0:a.histograms,e.next=5,Object(u.b)(this._workerThread.broadcast("updateSymbolizer",{symbolizerJSON:t.toJSON(),histograms:n},r));case 5:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"stretch",value:function(){var e=Object(o.a)(i.a.mark((function e(t,r){var a,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._workerThread){e.next=2;break}throw new c.a("raster-jobhandler:no-connection","no available worker connection");case 2:if(null!=t&&t.pixelBlock){e.next=4;break}return e.abrupt("return",null);case 4:return a={srcPixelBlock:t.pixelBlock.toJSON(),stretchParams:t.stretchParams},e.next=7,this._workerThread.invoke("stretch",a,r);case 7:return n=e.sent,e.abrupt("return",n?new f.a(n):null);case 9:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"split",value:function(){var e=Object(o.a)(i.a.mark((function e(t,r){var a,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._workerThread){e.next=2;break}throw new c.a("raster-jobhandler:no-connection","no available worker connection");case 2:if(null!=t&&t.pixelBlock){e.next=4;break}return e.abrupt("return",null);case 4:return a={srcPixelBlock:t.pixelBlock.toJSON(),tileSize:t.tileSize,maximumPyramidLevel:t.maximumPyramidLevel},e.next=7,this._workerThread.invoke("split",a,r);case 7:return n=e.sent,e.abrupt("return",(n&&n.forEach((function(e,t){n.set(t,e?f.a.fromJSON(e):null)})),Object(u.u)(n)));case 9:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"estimateStatisticsHistograms",value:function(){var e=Object(o.a)(i.a.mark((function e(t,r){var a,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._workerThread){e.next=2;break}throw new c.a("raster-jobhandler:no-connection","no available worker connection");case 2:if(null!=t&&t.pixelBlock){e.next=4;break}return e.abrupt("return",null);case 4:return a={srcPixelBlock:t.pixelBlock.toJSON()},e.next=7,this._workerThread.invoke("estimateStatisticsHistograms",a,r);case 7:return n=e.sent,e.abrupt("return",Object(u.u)(n));case 9:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"mosaicAndTransform",value:function(){var e=Object(o.a)(i.a.mark((function e(t,r){var n,o,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._workerThread){e.next=2;break}throw new c.a("raster-jobhandler:no-connection","no available worker connection");case 2:if(null!=t&&null!=(n=t.srcPixelBlocks)&&n.length){e.next=4;break}return e.abrupt("return",null);case 4:return o=Object(a.a)(Object(a.a)({},t),{},{srcPixelBlocks:t.srcPixelBlocks.map((function(e){return e?e.toJSON():null}))}),e.next=7,this._workerThread.invoke("mosaicAndTransform",o,r);case 7:return s=e.sent,e.abrupt("return",s?new f.a(s):null);case 9:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()}]),e}()},1104:function(e,t,r){"use strict";r.d(t,"a",(function(){return z})),r.d(t,"b",(function(){return B})),r.d(t,"c",(function(){return _})),r.d(t,"d",(function(){return R}));var a=r(9),n=r(4),i=r(52),o=(r(54),r(1079)),s=(r(994),r(823),r(947)),l=r(941),c=(r(935),r(936)),u=r(1080),f=r(832),p=r(940),d=(r(971),r(924)),h=r(2),b=r(3),y=r(5),v=r(6),m=r(0),g=(r(13),r(14),r(15),r(1)),j=r(50),w=r(8),I=(r(11),r(19),r(20),r(28)),x=r(105),M=r(956),O=new j.a({classBreaksDef:"class-breaks-definition",uniqueValueDef:"unique-value-definition"}),k=function(e){Object(y.a)(r,e);var t=Object(v.a)(r);function r(){var e;return Object(h.a)(this,r),(e=t.apply(this,arguments)).baseSymbol=null,e.colorRamp=null,e.type=null,e}return r}(I.a);Object(m.a)([Object(g.b)({type:x.a,json:{write:!0}})],k.prototype,"baseSymbol",void 0),Object(m.a)([Object(g.b)({types:M.b,json:{read:{reader:M.a},write:!0}})],k.prototype,"colorRamp",void 0),Object(m.a)([Object(g.b)({json:{read:O.read,write:O.write}})],k.prototype,"type",void 0);var S=k=Object(m.a)([Object(w.a)("esri.tasks.support.ClassificationDefinition")],k),A=new j.a({esriClassifyEqualInterval:"equal-interval",esriClassifyManual:"manual",esriClassifyNaturalBreaks:"natural-breaks",esriClassifyQuantile:"quantile",esriClassifyStandardDeviation:"standard-deviation"}),T=new j.a({esriNormalizeByLog:"log",esriNormalizeByPercentOfTotal:"percent-of-total",esriNormalizeByField:"field"}),C=function(e){Object(y.a)(r,e);var t=Object(v.a)(r);function r(){var e;return Object(h.a)(this,r),(e=t.apply(this,arguments)).breakCount=null,e.classificationField=null,e.classificationMethod=null,e.normalizationField=null,e.normalizationType=null,e.type="class-breaks-definition",e}return Object(b.a)(r,[{key:"standardDeviationInterval",set:function(e){"standard-deviation"===this.classificationMethod&&this._set("standardDeviationInterval",e)}}]),r}(S);Object(m.a)([Object(g.b)({json:{write:!0}})],C.prototype,"breakCount",void 0),Object(m.a)([Object(g.b)({json:{write:!0}})],C.prototype,"classificationField",void 0),Object(m.a)([Object(g.b)({type:String,json:{read:A.read,write:A.write}})],C.prototype,"classificationMethod",void 0),Object(m.a)([Object(g.b)({json:{write:!0}})],C.prototype,"normalizationField",void 0),Object(m.a)([Object(g.b)({json:{read:T.read,write:T.write}})],C.prototype,"normalizationType",void 0),Object(m.a)([Object(g.b)({value:null,json:{write:!0}})],C.prototype,"standardDeviationInterval",null),Object(m.a)([Object(g.b)()],C.prototype,"type",void 0);C=Object(m.a)([Object(w.a)("esri.tasks.support.ClassBreaksDefinition")],C);var D=o.a.fromJSON({type:"multipart",colorRamps:[{fromColor:[0,0,255],toColor:[0,255,255]},{fromColor:[0,255,255],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,0,0]}]}),L=o.a.fromJSON(s.a[0]);function z(e,t){var r=e.attributeTable,a=e.colormap,o=e.dataType;if("vector-uv"===o||"vector-magdir"===o)return new p.a;if(Object(n.i)(a)){var d=function(e){if(!U(e))return null;var t,r=e.attributeTable,a=e.colormap;if(Object(n.i)(r)){var i=P(r,"value"),o=H(r);"string"===o.type&&(t={},r.features.forEach((function(e){var r=e.attributes;t[r[i.name]]=o?r[o.name]:r[i.name]})))}return l.a.createFromColormap(Object(n.o)(a),t)}(e);if(Object(n.i)(d))return d}if(Object(n.i)(r)){var h=function(e,t){if(!E(e,t))return null;var r=e.attributeTable,a=H(r,t),n=P(r,"red"),o=P(r,"green"),l=P(r,"blue"),c=[],p=new Set,d=!!(n&&o&&l);if(r.features.forEach((function(e){var t=e.attributes[a.name];p.has(e.attributes[a.name])||null==t||(p.add(t),c.push(new u.a({value:e.attributes[a.name],label:e.attributes[a.name],symbol:{type:"simple-fill",style:"solid",outline:null,color:new i.a(d?[e.attributes[n.name],e.attributes[o.name],e.attributes[l.name],1]:[0,0,0,0])}})))})),!d){var h=Object(s.b)(L,c.length);c.forEach((function(e,t){return e.symbol.color=new i.a(h[t].slice(1,4))}))}return new f.a({field:a.name,uniqueValueInfos:c})}(e);if(Object(n.i)(h))return h}return function(e,t){var r,a,i,o,s=(e=N(e,null==t?void 0:t.variableName)).bandCount,l=t||{},u=l.bandIds,f=l.stretchType;null!=(r=u)&&r.some((function(e){return e>=s}))&&(u=null);var p,d=Object(n.o)(e.statistics),h=Object(n.o)(e.histograms);s>1?(u=null!=(p=u)&&p.length?u:B(e),d=null==d?null:u.map((function(e){return d[e]})),h=null==h?null:u.map((function(e){return h[e]}))):u=[0],null==f&&(f=function(e){var t="percent-clip",r=e.pixelType,a=e.dataType,i=e.histograms,o=e.statistics;return"u8"!==r||"processed"!==a&&Object(n.i)(i)&&Object(n.i)(o)?"u8"===r||"elevation"===a||"scientific"===a?t="min-max":Object(n.i)(i)?t="percent-clip":Object(n.i)(o)&&(t="min-max",t="min-max"):t="none",t}(e));var b=!1;switch(f){case"none":b=!1;break;case"percent-clip":b=!(null!=(a=h)&&a.length);break;default:b=!(null!=(i=d)&&i.length)}var y=1===(null==(o=u)?void 0:o.length)&&"scientific"===e.dataType?D:null,v=new c.a({stretchType:f,dynamicRangeAdjustment:b,colorRamp:y,outputMin:0,outputMax:255,gamma:1===u.length?[1]:[1,1,1],useGamma:!1});return"percent-clip"===f?v.maxPercent=v.minPercent=.25:"standard-deviation"===f&&(v.numberOfStandardDeviations=2),b||("percent-clip"===f?v.histograms=h:"min-max"!==f&&"standard-deviation"!==f||(v.statistics=d)),v}(e,t)}function R(e){var t=["raster-stretch"];return U(e)&&t.push("raster-colormap"),E(e)&&t.push("unique-value"),Z(e)&&t.push("class-breaks"),F(e)&&t.push("raster-shaded-relief"),function(e){var t=e.dataType;return"vector-uv"===t||"vector-magdir"===t}(e)&&t.push("vector-field"),t}function _(e,t,r){var a=["nearest","bilinear","cubic","majority"].find((function(e){return e===(null==r?void 0:r.toLowerCase())}));return"Map"===t?null!=a?a:"bilinear":"thematic"===e.dataType||e.attributeTable||e.colormap?"nearest"===a||"majority"===a?a:"nearest":null!=a?a:"bilinear"}function N(e,t){if(null==t)return e;var r=Object(n.o)(e.statistics),i=Object(n.o)(e.histograms),o=e.multidimensionalInfo;if(t&&Object(n.i)(o)){var s=o.variables.find((function(e){return e.name===t})),l=s.statistics,c=s.histograms;null!=l&&l.length&&(r=l),null!=c&&c.length&&(i=c)}return d.a.fromJSON(Object(a.a)(Object(a.a)({},e.toJSON()),{},{statistics:r,histograms:i}))}function B(e){var t=e.bandCount;if(1===t)return null;if(2===t)return[0];var r,a=e.keyProperties&&e.keyProperties.BandProperties;if(a&&a.length===t){var n=function(e){for(var t={},r=0;r<e.length;r++){var a,n=e[r],i=null==(a=n.BandName)?void 0:a.toLowerCase();if("red"===i)t.red=r;else if("green"===i)t.green=r;else if("blue"===i)t.blue=r;else if("nearinfrared"===i||"nearinfrared_1"===i||"nir"===i)t.nir=r;else if(n.WavelengthMax&&n.WavelengthMin){var o=n.WavelengthMin,s=n.WavelengthMax;null==t.blue&&o>=410&&o<=480&&s>=480&&s<=540?t.blue=r:null==t.green&&o>=490&&o<=560&&s>=560&&s<=610?t.green=r:null==t.red&&o>=595&&o<=670&&s>=660&&s<=730?t.red=r:null==t.nir&&o>=700&&o<=860&&s>=800&&s<=950&&(t.nir=r)}}return t}(a),i=n.red,o=n.green,s=n.blue,l=n.nir;null!=i&&null!=o&&null!=s?r=[i,o,s]:null!=l&&null!=i&&null!=o&&(r=[l,i,o])}return!r&&t>=3&&(r=[0,1,2]),r}function H(e,t){var r=e.fields.find((function(e){return"string"===e.type&&(t===e.name.toLowerCase()||e.name.toLowerCase().indexOf("class")>-1)}));return r||((r=e.fields.find((function(e){return"string"===e.type})))||(r=P(e,"value"))),r}function P(e,t){return e.fields.find((function(e){return e.name.toLowerCase()===t}))}function E(e,t){var r=e.attributeTable,a=e.bandCount;return!(!Object(n.i)(r)||a>1)&&(!t||null!=r.fields.find((function(e){return e.name.toLowerCase()===t.toLowerCase()})))}function U(e){var t=e.bandCount,r=e.colormap;return Object(n.i)(r)&&r.length&&1===t}function F(e){return"elevation"===e.dataType}function Z(e){var t=e.attributeTable;return 1===e.bandCount&&(Object(n.i)(t)||Object(n.i)(e.histograms))}},1106:function(e,t,r){"use strict";r.d(t,"a",(function(){return h})),r.d(t,"b",(function(){return v})),r.d(t,"c",(function(){return b})),r.d(t,"d",(function(){return f})),r.d(t,"e",(function(){return y})),r.d(t,"f",(function(){return p})),r.d(t,"g",(function(){return d})),r.d(t,"h",(function(){return m}));var a=r(4),n=r(37),i=(r(77),r(2)),o=r(3),s=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:15e3,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3;Object(i.a)(this,e),this._timer=null,this._cachedBlocks=new Map,this._size=-1,this._duration=t,this._interval=Math.min(t,r)}return Object(o.a)(e,[{key:"decreaseRefCount",value:function(e,t){var r=e+"/"+t,a=this._cachedBlocks;if(a.has(r)){var n=a.get(r);return n.refCount--,n.refCount<=0&&(a.delete(r),n.controller&&n.controller.abort()),n.refCount}return 0}},{key:"getBlock",value:function(e,t){var r=e+"/"+t,a=this._cachedBlocks;if(a.has(r)){var n=a.get(r);return n.ts=Date.now(),n.refCount++,a.delete(r),a.set(r,n),n.block}return null}},{key:"putBlock",value:function(e,t,r){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=this._cachedBlocks,i=e+"/"+t;if(n.has(i)){var o=n.get(i);o.ts=Date.now(),o.refCount++}else n.set(i,{block:r,ts:Date.now(),refCount:1,controller:a});this.trim(),this.updateTimer()}},{key:"deleteBlock",value:function(e,t){var r=this._cachedBlocks,a=e+"/"+t;r.has(a)&&r.delete(a)}},{key:"updateMaxSize",value:function(e){this._size=e,this.trim()}},{key:"empty",value:function(){this._cachedBlocks.clear(),this.clearTimer()}},{key:"getCurrentSize",value:function(){return this._cachedBlocks.size}},{key:"updateTimer",value:function(){var e=this;if(null==this._timer){var t=this._cachedBlocks;this._timer=setInterval((function(){for(var r=Array.from(t),a=Date.now(),n=0;n<r.length&&r[n][1].ts<=a-e._duration;n++)t.delete(r[n][0]);0===t.size&&e.clearTimer()}),this._interval)}}},{key:"trim",value:function(){var e=this._cachedBlocks;if(!(-1===this._size||this._size>=e.size))for(var t=Array.from(e),r=0;r<t.length-this._size;r++)e.delete(t[r][0])}},{key:"clearTimer",value:function(){null!=this._timer&&(clearInterval(this._timer),this._timer=null)}}]),e}(),l=r(969),c=new Map,u=new s;function f(e,t){return null==t?e:"".concat(e,"?sliceId=").concat(t)}function p(e,t){var r={extent:null,rasterInfo:t,cache:new Map};if(c.has(e)){var a=c.get(e);return a.push(r),a.length-1}return c.set(e,[r]),0}function d(e,t){c.has(e)&&(c.get(e)[t]=null)}function h(e,t,r){if(!c.has(e))return null==t?u.decreaseRefCount(e,r):0;var a=c.get(e);if(null==a[t])return u.decreaseRefCount(e,r);var n=a[t].cache;if(n.has(r)){var i=n.get(r);if(i.refCount--,0===i.refCount){n.delete(r);for(var o=0;o<a.length;o++)a[o]&&a[o].cache.has(r)&&a[o].cache.delete(r);i.controller&&i.controller.abort()}return i.refCount}return 0}function b(e,t,r){if(!c.has(e))return null==t?u.getBlock(e,r):null;var a=c.get(e);if(null==a[t]){for(var n=0;n<a.length;n++)if(a[n]&&a[n].cache.has(r)){var i=a[n].cache.get(r);return i.refCount++,i.block}return u.getBlock(e,r)}var o=a[t].cache;if(o.has(r)){var s=o.get(r);return s.refCount++,s.block}for(var l=0;l<a.length;l++)if(l!==t&&a[l]&&a[l]&&a[l].cache.has(r)){var f=a[l].cache.get(r);return f.refCount++,o.set(r,f),f.block}return null}function y(e,t,r,a){var n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if(c.has(e)){var i=c.get(e);if(null!=i[t]){var o={refCount:1,block:a,isResolved:!1,isRejected:!1,controller:n};a.then((function(){return o.isResolved=!0})).catch((function(){return o.isRejected=!0})),i[t].cache.set(r,o)}else u.putBlock(e,r,a,n)}else null==t&&u.putBlock(e,r,a,n)}function v(e,t,r){if(c.has(e)){var a=c.get(e);null!=a[t]?a[t].cache.delete(r):u.deleteBlock(e,r)}else null==t&&u.deleteBlock(e,r)}function m(e,t,r,i,o,s){var u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,f=function(e,t){if(!c.has(e))return null;var r=c.get(e);return null==r[t]?null:r[t]}(e,t),p=f.extent,d=f.cache,h=f.rasterInfo;if(!p||p.xmin!==r.xmin||p.xmax!==r.xmax||p.ymin!==r.ymin||p.ymax!==r.ymax){for(var b=r.clone().normalize(),y=h.spatialReference,v=h.transform,m=new Set,g=0;g<b.length;g++){var j=b[g];if(!(j.xmax-j.xmin<=i||j.ymax-j.ymin<=i)){var w=Object(l.d)(j,y,u);Object(a.i)(v)&&(w=v.inverseTransform(w));var I=new n.a({x:i,y:i,spatialReference:j.spatialReference});if(null===o&&!(o=Object(l.f)(I,y,j,u)))return;var x=Object(l.g)(o,h,s||"closest"),M=x.pyramidLevel,O=x.pyramidResolution,k=x.excessiveReading;if(k)return;for(var S=h.storageInfo,A=S.origin,T={x:Math.max(0,Math.floor((w.xmin-A.x)/O.x)),y:Math.max(0,Math.floor((A.y-w.ymax)/O.y))},C=Math.ceil((w.xmax-w.xmin)/O.x-.1),D=Math.ceil((w.ymax-w.ymin)/O.y-.1),L=M>0?S.pyramidBlockWidth:S.blockWidth,z=M>0?S.pyramidBlockHeight:S.blockHeight,R=1,_=Math.max(0,Math.floor(T.x/L)-R),N=Math.max(0,Math.floor(T.y/z)-R),B=Math.floor((T.x+C-1)/L)+R,H=Math.floor((T.y+D-1)/z)+R,P=N;P<=H;P++)for(var E=_;E<=B;E++)m.add("".concat(M,"/").concat(P,"/").concat(E))}}d.forEach((function(e,t){if(!m.has(t)){var r=d.get(t);(null==r||r.isResolved||r.isRejected)&&d.delete(t)}})),f.extent={xmin:r.xmin,ymin:r.ymin,xmax:r.xmax,ymax:r.ymax}}}},787:function(e,t,r){"use strict";r.d(t,"a",(function(){return g})),r.d(t,"b",(function(){return b})),r.d(t,"c",(function(){return p})),r.d(t,"d",(function(){return h})),r.d(t,"e",(function(){return v})),r.d(t,"f",(function(){return m})),r.d(t,"g",(function(){return f})),r.d(t,"h",(function(){return y})),r.d(t,"i",(function(){return u})),r.d(t,"j",(function(){return d}));var a=r(9),n=r(98),i=r(119),o=r(378),s=r(247),l=r(304),c=r(388),u={type:Boolean,value:!0,json:{origins:{"web-scene":{read:{source:["id","url","layerType"],reader:function(e,t){if(null!=t.screenSizePerspective||"defaults"!==this.originOf("screenSizePerspectiveEnabled"))return t.screenSizePerspective;Object(n.a)(this).store.set("screenSizePerspectiveEnabled",!1,0)}},write:{ignoreOrigin:!0,target:"screenSizePerspective",writer:function(e,t,r,a){("defaults"===this.originOf("screenSizePerspectiveEnabled")&&e||Object(o.a)(this,"screenSizePerspectiveEnabled",{},a))&&(t[r]=e)}}}}}},f={type:Boolean,value:!0,json:{name:"disablePopup",read:{reader:function(e,t){return!t.disablePopup}},write:{enabled:!0,writer:function(e,t,r){t[r]=!e}}}},p={type:Boolean,value:!0,json:{name:"showLabels",write:!0}},d={type:String,json:{origins:{"portal-item":{write:!1}},write:{isRequired:!0,ignoreOrigin:!0,writer:i.f}}},h={type:Boolean,value:!0,json:{origins:{service:{read:{enabled:!1}}},name:"showLegend",write:!0}},b={value:null,type:c.a,json:{origins:{service:{name:"elevationInfo",write:!0}},name:"layerDefinition.elevationInfo",write:!0}};function y(e){return{type:e,readOnly:!0,json:{origins:{service:{read:!0}},read:!1}}}var v={type:Number,json:{origins:{"web-document":{default:1,write:!0,read:!0},"portal-item":{write:!0}}}},m=Object(a.a)(Object(a.a)({},v),{},{json:Object(a.a)(Object(a.a)({},v.json),{},{origins:{"web-document":Object(a.a)(Object(a.a)({},v.json.origins["web-document"]),{},{write:{enabled:!0,target:{opacity:{type:Number},"layerDefinition.drawingInfo.transparency":{type:Number}}}})},read:{source:["layerDefinition.drawingInfo.transparency","drawingInfo.transparency"],reader:function(e,t,r){return r&&"service"!==r.origin||!t.drawingInfo||void 0===t.drawingInfo.transparency?t.layerDefinition&&t.layerDefinition.drawingInfo&&void 0!==t.layerDefinition.drawingInfo.transparency?Object(s.b)(t.layerDefinition.drawingInfo.transparency):void 0:Object(s.b)(t.drawingInfo.transparency)}}})}),g={type:l.a,dependsOn:["view.timeExtent","layer.timeExtent","layer.timeInfo","layer.timeOffset","layer.timeOffset.value","layer.timeOffset.unit","layer.useViewTime"],readOnly:!0,get:function(){var e,t;if(null==(e=this.layer)||!e.timeInfo)return null;var r=null==(t=this.view)?void 0:t.timeExtent,a=this.layer.timeExtent,n=this.layer.useViewTime?r&&a?r.intersection(a):r||a:a;if(!n||n.isEmpty)return n;var i=this.layer.timeOffset,o=i?n.offset(-i.value,i.unit):n,s=this._get("timeExtent");return o.equals(s)?s:o}}},794:function(e,t,r){"use strict";function a(e){return e&&"esri.renderers.visualVariables.SizeVariable"===e.declaredClass}function n(e){return null!=e&&!isNaN(e)&&isFinite(e)}function i(e){return e.valueExpression?"expression":e.field&&"string"==typeof e.field?"field":"unknown"}function o(e,t){var r=t||i(e),a=e.valueUnit||"unknown";return"unknown"===r?"constant":e.stops?"stops":null!=e.minSize&&null!=e.maxSize&&null!=e.minDataValue&&null!=e.maxDataValue?"clamped-linear":"unknown"===a?null!=e.minSize&&null!=e.minDataValue?e.minSize&&e.minDataValue?"proportional":"additive":"identity":"real-world-size"}r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return o})),r.d(t,"c",(function(){return a})),r.d(t,"d",(function(){return n}))},795:function(e,t,r){"use strict";r.d(t,"a",(function(){return M})),r.d(t,"b",(function(){return O}));var a=r(12),n=r(2),i=r(3),o=r(5),s=r(6),l=r(0),c=r(98),u=r(8),f=r(229),p=r(33),d=r(378),h=r(34),b=r(4),y=r(386),v=r(41),m=r(24),g=function(){function e(){Object(n.a)(this,e),this._propertyOriginMap=new Map,this._originStores=new Array(f.a),this._values=new Map}return Object(i.a)(e,[{key:"clone",value:function(t){var r=this,a=new e,n=this._originStores[0];n&&n.forEach((function(e,t){a.set(t,Object(m.a)(e),0)}));for(var i=function(e){var n=r._originStores[e];n&&n.forEach((function(r,n){t&&t.has(n)||a.set(n,Object(m.a)(r),e)}))},o=2;o<f.a;o++)i(o);return a}},{key:"get",value:function(e,t){var r=void 0===t?this._values:this._originStores[t];return r?r.get(e):void 0}},{key:"keys",value:function(e){var t=null==e?this._values:this._originStores[e];return t?Object(v.a)(t.keys()):[]}},{key:"set",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:6,a=this._originStores[r];if(a||(a=new Map,this._originStores[r]=a),a.set(e,t),!this._values.has(e)||Object(b.c)(this._propertyOriginMap.get(e))<=r){var n=this._values.get(e);return this._values.set(e,t),this._propertyOriginMap.set(e,r),n!==t}return!1}},{key:"delete",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6,r=this._originStores[t];if(r){var a=r.get(e);if(r.delete(e),this._values.has(e)&&this._propertyOriginMap.get(e)===t){this._values.delete(e);for(var n=t-1;n>=0;n--){var i=this._originStores[n];if(i&&i.has(e)){this._values.set(e,i.get(e)),this._propertyOriginMap.set(e,n);break}}}return a}}},{key:"has",value:function(e,t){var r=void 0===t?this._values:this._originStores[t];return!!r&&r.has(e)}},{key:"revert",value:function(e,t){for(;t>0&&!this.has(e,t);)--t;var r=this._originStores[t],a=r&&r.get(e),n=this._values.get(e);return this._values.set(e,a),this._propertyOriginMap.set(e,t),n!==a}},{key:"originOf",value:function(e){return this._propertyOriginMap.get(e)||0}},{key:"forEach",value:function(e){this._values.forEach(e)}}]),e}(),j=function(e){var t=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(){var e;Object(n.a)(this,r);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];e=t.call.apply(t,[this].concat(i));var s=Object(b.c)(Object(c.a)(Object(h.a)(e))),l=s.metadatas,u=s.store,f=new g;return s.store=f,u.keys().forEach((function(e){f.set(e,u.get(e),0)})),Object.keys(l).forEach((function(e){s.internalGet(e)&&f.set(e,s.internalGet(e),0)})),e}return Object(i.a)(r,[{key:"read",value:function(e,t){Object(y.a)(this,e,t)}},{key:"getAtOrigin",value:function(e,t){var r=w(this),a=Object(f.d)(t);if("string"==typeof e)return r.get(e,a);var n={};return e.forEach((function(e){n[e]=r.get(e,a)})),n}},{key:"originOf",value:function(e){return Object(f.b)(this.originIdOf(e))}},{key:"originIdOf",value:function(e){return w(this).originOf(e)}},{key:"revert",value:function(e,t){var r=w(this),a=Object(f.d)(t),n=Object(c.a)(this);("string"==typeof e?"*"===e?r.keys(a):[e]:e).forEach((function(e){n.propertyInvalidated(e),r.revert(e,a),n.propertyCommitted(e)}))}}]),r}(e);return t=Object(l.a)([Object(u.a)("esri.core.ReadOnlyMultiOriginJSONSupport")],t),t};function w(e){return Object(c.a)(e).store}var I=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(){return Object(n.a)(this,r),t.apply(this,arguments)}return r}(j(p.a));I=Object(l.a)([Object(u.a)("esri.core.ReadOnlyMultiOriginJSONSupport")],I);function x(e){return Object(c.a)(e).store}var M=function(e){var t=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(){Object(n.a)(this,r);for(var e=arguments.length,a=new Array(e),i=0;i<e;i++)a[i]=arguments[i];return t.call.apply(t,[this].concat(a))}return r}(function(e){var t=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(){Object(n.a)(this,r);for(var e=arguments.length,a=new Array(e),i=0;i<e;i++)a[i]=arguments[i];return t.call.apply(t,[this].concat(a))}return Object(i.a)(r,[{key:"clear",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"user";return x(this).delete(e,Object(f.d)(t))}},{key:"write",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return Object(d.b)(this,e=e||{},t),e}},{key:"setAtOrigin",value:function(e,t,r){Object(c.a)(this).setAtOrigin(e,t,Object(f.d)(r))}},{key:"removeOrigin",value:function(e){var t,r=x(this),n=Object(f.d)(e),i=r.keys(n),o=Object(a.a)(i);try{for(o.s();!(t=o.n()).done;){var s=t.value;r.originOf(s)===n&&r.set(s,r.get(s,n),6)}}catch(l){o.e(l)}finally{o.f()}}},{key:"updateOrigin",value:function(e,t){for(var r=x(this),a=Object(f.d)(t),n=this.get(e),i=a+1;i<f.a;++i)r.delete(e,i);r.set(e,n,a)}},{key:"toJSON",value:function(e){return this.write({},e)}}]),r}(e);return(t=Object(l.a)([Object(u.a)("esri.core.WriteableMultiOriginJSONSupport")],t)).prototype.toJSON.isDefaultToJSON=!0,t}(j(e)));return t=Object(l.a)([Object(u.a)("esri.core.MultiOriginJSONSupport")],t)},O=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(){return Object(n.a)(this,r),t.apply(this,arguments)}return r}(M(p.a));O=Object(l.a)([Object(u.a)("esri.core.MultiOriginJSONSupport")],O)},801:function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var a=r(2),n=r(3),i=r(5),o=r(6),s=r(0),l=(r(13),r(14),r(15),r(1)),c=r(8),u=(r(11),r(19),r(20),function(e){var t=function(e){Object(i.a)(r,e);var t=Object(o.a)(r);function r(){var e;return Object(a.a)(this,r),(e=t.apply(this,arguments)).refreshInterval=0,e}return Object(n.a)(r,[{key:"refresh",value:function(){this.emit("refresh")}}]),r}(e);return Object(s.a)([Object(l.b)({type:Number,cast:function(e){return e>=.1?e:e<=0?0:.1},json:{write:!0,origins:{"web-document":{write:!0}}}})],t.prototype,"refreshInterval",void 0),t=Object(s.a)([Object(c.a)("esri.layers.mixins.RefreshableLayer")],t)})},802:function(e,t,r){"use strict";r.d(t,"a",(function(){return O}));var a=r(9),n=r(10),i=r.n(n),o=r(21),s=r(2),l=r(3),c=r(61),u=r(55),f=r(5),p=r(6),d=r(0),h=(r(13),r(14)),b=(r(15),r(1)),y=r(63),v=r(8),m=r(47),g=r(23),j=r(11),w=(r(19),r(20),r(16)),I=r(124),x=r(384),M=h.a.getLogger("esri.layers.mixins.PortalLayer"),O=function(e){var t=function(e){Object(f.a)(n,e);var t=Object(p.a)(n);function n(){var e;return Object(s.a)(this,n),(e=t.apply(this,arguments)).resourceReferences={portalItem:null,paths:[]},e}return Object(l.a)(n,[{key:"destroy",value:function(){var e;null==(e=this.portalItem)||e.destroy(),this.portalItem=null}},{key:"portalItem",set:function(e){e!==this._get("portalItem")&&(this.removeOrigin("portal-item"),this._set("portalItem",e))}},{key:"readPortalItem",value:function(e,t,r){if(t.itemId)return new x.default({id:t.itemId,portal:r&&r.portal})}},{key:"writePortalItem",value:function(e,t){e&&e.id&&(t.itemId=e.id)}},{key:"loadFromPortal",value:function(){var e=Object(o.a)(i.a.mark((function e(t,a){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.portalItem||!this.portalItem.id){e.next=14;break}return e.prev=1,e.next=4,r.e(95).then(r.bind(null,937));case 4:return n=e.sent,Object(w.w)(a),e.next=8,n.load({instance:this,supportedTypes:t.supportedTypes,validateItem:t.validateItem,supportsData:t.supportsData},a);case 8:return e.abrupt("return",e.sent);case 11:throw e.prev=11,e.t0=e.catch(1),M.warn("Failed to load layer (".concat(this.title,", ").concat(this.id,") portal item (").concat(this.portalItem.id,")\n  ").concat(e.t0)),e.t0;case 14:case"end":return e.stop()}}),e,this,[[1,11]])})));return function(t,r){return e.apply(this,arguments)}}()},{key:"read",value:function(e,t){t&&(t.layer=this),Object(c.a)(Object(u.a)(n.prototype),"read",this).call(this,e,t)}},{key:"write",value:function(e,t){var r=t&&t.portal,i=this.portalItem&&this.portalItem.id&&(this.portalItem.portal||I.a.getDefault());return r&&i&&!Object(j.r)(i.restUrl,r.restUrl)?(t.messages&&t.messages.push(new g.a("layer:cross-portal","The layer '".concat(this.title," (").concat(this.id,")' cannot be persisted because it refers to an item on a different portal than the one being saved to. To save the scene, set the layer.portalItem to null or save the scene to the same portal as the item associated with the layer"),{layer:this})),null):Object(c.a)(Object(u.a)(n.prototype),"write",this).call(this,e,Object(a.a)(Object(a.a)({},t),{},{layer:this}))}}]),n}(e);return Object(d.a)([Object(b.b)({type:x.default})],t.prototype,"portalItem",null),Object(d.a)([Object(y.a)("web-document","portalItem",["itemId"])],t.prototype,"readPortalItem",null),Object(d.a)([Object(m.a)("web-document","portalItem",{itemId:{type:String}})],t.prototype,"writePortalItem",null),Object(d.a)([Object(b.b)()],t.prototype,"resourceReferences",void 0),t=Object(d.a)([Object(v.a)("esri.layers.mixins.PortalLayer")],t),t}},804:function(e,t,r){"use strict";r.d(t,"a",(function(){return v})),r.d(t,"b",(function(){return b})),r.d(t,"c",(function(){return y}));var a=r(26),n=r(12),i=r(4),o=r(98),s=r(33),l=r(40),c=["esri.Color","esri.portal.Portal","esri.symbols.support.Symbol3DAnchorPosition2D","esri.symbols.support.Symbol3DAnchorPosition3D"];function u(e){return e instanceof s.a}function f(e){return e instanceof l.a?Object.keys(e.items):u(e)?Object(o.a)(e).keys():e?Object.keys(e):[]}function p(e,t){return e instanceof l.a?e.items[t]:e[t]}function d(e){return e?e.declaredClass:null}function h(e,t){var r=e.diff;if(r&&"function"==typeof r)return r(e,t);var o=f(e),s=f(t);if(0!==o.length||0!==s.length){if(!o.length||!s.length||function(e,t){return!(!Array.isArray(e)||!Array.isArray(t))&&e.length!==t.length}(e,t))return{type:"complete",oldValue:e,newValue:t};var l,b=s.filter((function(e){return-1===o.indexOf(e)})),y=o.filter((function(e){return-1===s.indexOf(e)})),v=o.filter((function(r){return s.indexOf(r)>-1&&p(e,r)!==p(t,r)})).concat(b,y).sort(),m=d(e);if(m&&c.indexOf(m)>-1&&v.length)return{type:"complete",oldValue:e,newValue:t};var g,j=u(e)&&u(t),w=Object(n.a)(v);try{for(w.s();!(g=w.n()).done;){var I=g.value,x=p(e,I),M=p(t,I),O=void 0;(j||"function"!=typeof x&&"function"!=typeof M)&&x!==M&&(null==x&&null==M||(O=r&&r[I]&&"function"==typeof r[I]?r[I](x,M):"object"==typeof x&&"object"==typeof M&&d(x)===d(M)?h(x,M):{type:"complete",oldValue:x,newValue:M},Object(i.i)(O)&&(Object(i.i)(l)?l.diff[I]=O:l={type:"partial",diff:Object(a.a)({},I,O)})))}}catch(k){w.e(k)}finally{w.f()}return l}}function b(e,t){if(Object(i.h)(e))return!1;var r,a=t.split("."),o=e,s=Object(n.a)(a);try{for(s.s();!(r=s.n()).done;){var l=r.value;if("complete"===o.type)return!0;if("partial"!==o.type)return!1;var c=o.diff[l];if(!c)return!1;o=c}}catch(u){s.e(u)}finally{s.f()}return!0}function y(e,t){var r,a=Object(n.a)(t);try{for(a.s();!(r=a.n()).done;){if(b(e,r.value))return!0}}catch(i){a.e(i)}finally{a.f()}return!1}function v(e,t){if("function"!=typeof e&&"function"!=typeof t&&(e||t))return!e||!t||"object"==typeof e&&"object"==typeof t&&d(e)!==d(t)?{type:"complete",oldValue:e,newValue:t}:h(e,t)}},806:function(e,t,r){"use strict";r.d(t,"a",(function(){return l})),r.d(t,"b",(function(){return c})),r.d(t,"c",(function(){return u}));var a=r(32),n=r(12),i=r(2),o=r(3),s=r(129),l=-3,c=function(){function e(t,r,a){Object(i.a)(this,e),this._namespace=t,this._storage=r,this._removeFunc=!1,this._hit=0,this._miss=0,this._storage.register(this),this._namespace+=":",a&&(this._storage.registerRemoveFunc(this._namespace,a),this._removeFunc=!0)}return Object(o.a)(e,[{key:"namespace",get:function(){return this._namespace.slice(0,-1)}},{key:"hitRate",get:function(){return this._hit/(this._hit+this._miss)}},{key:"size",get:function(){return this._storage.size}},{key:"maxSize",get:function(){return this._storage.maxSize}},{key:"resetHitRate",value:function(){this._hit=this._miss=0}},{key:"destroy",value:function(){this._storage.clear(this._namespace),this._removeFunc&&this._storage.deregisterRemoveFunc(this._namespace),this._storage.deregister(this)}},{key:"put",value:function(e,t,r){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;this._storage.put(this._namespace+e,t,r,a)}},{key:"get",value:function(e){var t=this._storage.get(this._namespace+e);return void 0===t?++this._miss:++this._hit,t}},{key:"pop",value:function(e){var t=this._storage.pop(this._namespace+e);return void 0===t?++this._miss:++this._hit,t}},{key:"updateSize",value:function(e,t,r){this._storage.updateSize(this._namespace+e,t,r)}},{key:"clear",value:function(){this._storage.clear(this._namespace)}},{key:"clearAll",value:function(){this._storage.clearAll()}},{key:"getStats",value:function(){return this._storage.getStats()}},{key:"resetStats",value:function(){this._storage.resetStats()}}]),e}(),u=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10485760;Object(i.a)(this,e),this._maxSize=t,this._db=new Map,this._size=0,this._hit=0,this._miss=0,this._removeFuncs=[],this._users=new s.a}return Object(o.a)(e,[{key:"register",value:function(e){this._users.push(e)}},{key:"deregister",value:function(e){this._users.removeUnordered(e)}},{key:"registerRemoveFunc",value:function(e,t){this._removeFuncs.push([e,t])}},{key:"deregisterRemoveFunc",value:function(e){this._removeFuncs=this._removeFuncs.filter((function(t){return t[0]!==e}))}},{key:"size",get:function(){return this._size}},{key:"maxSize",get:function(){return this._maxSize},set:function(e){this._maxSize=Math.max(e,0),this._checkSizeLimit()}},{key:"put",value:function(e,t,r,a){var n=this._db.get(e);if(n&&(this._size-=n.size,this._db.delete(e),n.entry!==t&&this._notifyRemoved(e,n.entry)),r>this._maxSize)this._notifyRemoved(e,t);else if(void 0!==t)if(!r||r<0)console.warn("Refusing to cache entry with invalid size "+r);else{var i=1+Math.max(a,-3)- -3;this._db.set(e,{entry:t,size:r,lifetime:i,lives:i}),this._size+=r,this._checkSizeLimit()}else console.warn("Refusing to cache undefined entry ")}},{key:"updateSize",value:function(e,t,r){var a=this._db.get(e);a&&a.entry===t&&(this._size-=a.size,r>this._maxSize?this._notifyRemoved(e,t):(a.size=r,this._size+=r,this._checkSizeLimit()))}},{key:"pop",value:function(e){var t=this._db.get(e);if(t)return this._size-=t.size,this._db.delete(e),++this._hit,t.entry;++this._miss}},{key:"get",value:function(e){var t=this._db.get(e);if(void 0!==t)return this._db.delete(e),t.lives=t.lifetime,this._db.set(e,t),++this._hit,t.entry;++this._miss}},{key:"getStats",value:function(){var e=this,t={Size:Math.round(this._size/1048576)+"/"+Math.round(this._maxSize/1048576)+"MB","Hit rate":Math.round(100*this._getHitRate())+"%",Entries:this._db.size.toString()},r={},a=new Array;this._db.forEach((function(t,n){var i=t.lifetime;a[i]=(a[i]||0)+t.size,e._users.forAll((function(e){var a=e.namespace;if(n.startsWith(a)){var i=r[a]||0;r[a]=i+t.size}}))}));var n={};this._users.forAll((function(e){var t=e.namespace;if(!isNaN(e.hitRate)&&e.hitRate>0){var a=r[t]||0;r[t]=a,n[t]=Math.round(100*e.hitRate)+"%"}else n[t]="0%"}));var i=Object.keys(r);i.forEach((function(t){return r[t]=r[t]/e._size*100})),i.sort((function(e,t){return r[t]-r[e]})),i.forEach((function(e){return t[e]=Math.round(r[e])+"% / "+n[e]}));for(var o=a.length-1;o>=0;--o){var s=a[o];s&&(t["Priority "+(o+-3-1)]=Math.round(s/this.size*100)+"%")}return t}},{key:"resetStats",value:function(){this._hit=this._miss=0,this._users.forAll((function(e){return e.resetHitRate()}))}},{key:"clear",value:function(e){var t=this;this._db.forEach((function(r,a){a.startsWith(e)&&(t._size-=r.size,t._db.delete(a),t._notifyRemoved(a,r.entry))}))}},{key:"clearAll",value:function(){var e=this;this._db.forEach((function(t,r){return e._notifyRemoved(r,t.entry)})),this._size=0,this._db.clear()}},{key:"_getHitRate",value:function(){return this._hit/(this._hit+this._miss)}},{key:"_notifyRemoved",value:function(e,t){this._removeFuncs.forEach((function(r){e.startsWith(r[0])&&r[1](t)}))}},{key:"_checkSizeLimit",value:function(){if(!(this._size<=this._maxSize)){var e,t=Object(n.a)(this._db);try{for(t.s();!(e=t.n()).done;){var r=Object(a.a)(e.value,2),i=r[0],o=r[1];if(this._db.delete(i),o.lives<=1?(this._size-=o.size,this._notifyRemoved(i,o.entry)):(--o.lives,this._db.set(i,o)),this._size<=.9*this.maxSize)return}}catch(s){t.e(s)}finally{t.f()}}}}]),e}()},809:function(e,t,r){"use strict";r.d(t,"a",(function(){return g}));var a=r(9),n=r(2),i=r(3),o=r(61),s=r(55),l=r(5),c=r(6),u=r(0),f=(r(13),r(14),r(15),r(1)),p=r(8),d=r(47),h=r(23),b=(r(11),r(19),r(20),r(386)),y=r(378),v={"web-scene/operational-layers":{ArcGISFeatureLayer:!0,ArcGISImageServiceLayer:!0,ArcGISMapServiceLayer:!0,ArcGISSceneServiceLayer:!0,ArcGISTiledElevationServiceLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,BuildingSceneLayer:!0,GroupLayer:!0,IntegratedMeshLayer:!0,PointCloudLayer:!0,WebTiledLayer:!0,CSV:!0,VectorTileLayer:!0,WMS:!0,KML:!0,RasterDataLayer:!0},"web-scene/basemap":{ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,WebTiledLayer:!0,OpenStreetMap:!0,VectorTileLayer:!0,ArcGISImageServiceLayer:!0,WMS:!0,ArcGISMapServiceLayer:!0},"web-scene/ground":{ArcGISTiledElevationServiceLayer:!0,RasterDataElevationLayer:!0},"web-map/operational-layers":{ArcGISImageServiceLayer:!0,ArcGISImageServiceVectorLayer:!0,ArcGISMapServiceLayer:!0,ArcGISStreamLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,ArcGISFeatureLayer:!0,BingMapsAerial:!0,BingMapsRoad:!0,BingMapsHybrid:!0,CSV:!0,GeoRSS:!0,GroupLayer:!0,KML:!0,VectorTileLayer:!0,WFS:!0,SubtypeGroupLayer:!0,WMS:!0,WebTiledLayer:!0},"web-map/basemap":{ArcGISImageServiceLayer:!0,ArcGISImageServiceVectorLayer:!0,ArcGISMapServiceLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,OpenStreetMap:!0,VectorTileLayer:!0,WMS:!0,WebTiledLayer:!0,BingMapsAerial:!0,BingMapsRoad:!0,BingMapsHybrid:!0},"web-map/tables":{ArcGISFeatureLayer:!0},"portal-item/operational-layers":{ArcGISSceneServiceLayer:!0,PointCloudLayer:!0,BuildingSceneLayer:!0,IntegratedMeshLayer:!0}},m=r(787),g=function(e){var t=function(e){Object(l.a)(r,e);var t=Object(c.a)(r);function r(){var e;return Object(n.a)(this,r),(e=t.apply(this,arguments)).title=null,e}return Object(i.a)(r,[{key:"writeListMode",value:function(e,t,r,a){(a&&"ground"===a.layerContainerType||e&&Object(y.a)(this,r,{},a))&&(t[r]=e)}},{key:"writeOperationalLayerType",value:function(e,t,r,a){!e||a&&"tables"===a.layerContainerType||(t.layerType=e)}},{key:"writeTitle",value:function(e,t){t.title=e||"Layer"}},{key:"read",value:function(e,t){var a=this;t&&(t.layer=this),Object(b.b)(this,e,(function(t){return Object(o.a)(Object(s.a)(r.prototype),"read",a).call(a,e,t)}),t)}},{key:"write",value:function(e,t){if(t&&t.origin){var n="".concat(t.origin,"/").concat(t.layerContainerType||"operational-layers"),i=v[n],l=i&&i[this.operationalLayerType];if("ArcGISTiledElevationServiceLayer"===this.operationalLayerType&&"web-scene/operational-layers"===n&&(l=!1),!l)return t.messages&&t.messages.push(new h.a("layer:unsupported","Layers (".concat(this.title,", ").concat(this.id,") of type '").concat(this.declaredClass,"' are not supported in the context of '").concat(n,"'"),{layer:this})),null}var c=Object(o.a)(Object(s.a)(r.prototype),"write",this).call(this,e,Object(a.a)(Object(a.a)({},t),{},{layer:this})),u=!!t&&!!t.messages&&!!t.messages.filter((function(e){return e instanceof h.a&&"web-document-write:property-required"===e.name})).length;return!this.url&&u?null:c}},{key:"beforeSave",value:function(){}}]),r}(e);return Object(u.a)([Object(f.b)({type:String,json:{write:{ignoreOrigin:!0},origins:{"web-scene":{write:{isRequired:!0,ignoreOrigin:!0}},"portal-item":{write:!1}}}})],t.prototype,"id",void 0),Object(u.a)([Object(f.b)({json:{write:{ignoreOrigin:!0},origins:{"web-map":{read:!1,write:!1}}}})],t.prototype,"listMode",void 0),Object(u.a)([Object(d.a)("listMode")],t.prototype,"writeListMode",null),Object(u.a)([Object(f.b)({type:String,readOnly:!0,json:{read:!1,write:{target:"layerType",ignoreOrigin:!0},origins:{"portal-item":{write:!1}}}})],t.prototype,"operationalLayerType",void 0),Object(u.a)([Object(d.a)("operationalLayerType")],t.prototype,"writeOperationalLayerType",null),Object(u.a)([Object(f.b)(m.e)],t.prototype,"opacity",void 0),Object(u.a)([Object(f.b)({type:String,json:{write:{ignoreOrigin:!0,allowNull:!0},origins:{"web-scene":{write:{isRequired:!0,ignoreOrigin:!0,allowNull:!0}},"portal-item":{write:!1}}},value:"Layer"})],t.prototype,"title",void 0),Object(u.a)([Object(d.a)("title")],t.prototype,"writeTitle",null),Object(u.a)([Object(f.b)({type:Boolean,json:{name:"visibility",origins:{"web-document":{name:"visibility",default:!0},"portal-item":{name:"visibility",read:{source:["visible","visibility"]}}}}})],t.prototype,"visible",void 0),t=Object(u.a)([Object(p.a)("esri.layers.mixins.OperationalLayer")],t)}},812:function(e,t,r){"use strict";r.d(t,"a",(function(){return f}));var a=r(157),n=(r(130),r(213)),i=(r(308),r(309)),o=r(214),s=r(215),l=(r(216),r(178),r(276)),c=["oid","global-id"],u=["oid","global-id","guid"];function f(e,t){var r=e.displayField,i=e.editFieldsInfo,o=e.fields,c=e.objectIdField,u=e.title;if(!o)return null;var f=v({editFieldsInfo:i,fields:o,objectIdField:c},t);if(!f.length)return null;var p=function(e){var t=Object(a.l)(e),r=e.titleBase;return t?"".concat(r,": {").concat(t.trim(),"}"):r}({titleBase:u,fields:o,displayField:r}),d=[new s.a,new n.a];return new l.a({title:p,content:d,fieldInfos:f})}var p=[/^fnode_$/i,/^tnode_$/i,/^lpoly_$/i,/^rpoly_$/i,/^poly_$/i,/^subclass$/i,/^subclass_$/i,/^rings_ok$/i,/^rings_nok$/i,/shape/i,/perimeter/i,/objectid/i,/_i$/i],d=function(e,t){var r=t.editFieldsInfo,a=t.objectIdField,n=t.visibleFieldNames;return n?n.has(e.name):!b(e.name,r)&&(!a||e.name!==a)&&!(c.indexOf(e.type)>-1)&&!p.some((function(t){return t.test(e.name)}))};function h(e,t){return"oid"===e.type?-1:"oid"===t.type?1:g(e)?-1:g(t)?1:(e.alias||e.name).toLocaleLowerCase().localeCompare((t.alias||t.name).toLocaleLowerCase())}function b(e,t){if(!e||!t)return!1;var r=t.creationDateField,a=t.creatorField,n=t.editDateField,i=t.editorField;return-1!==[r&&r.toLowerCase(),a&&a.toLowerCase(),n&&n.toLowerCase(),i&&i.toLowerCase()].indexOf(e.toLowerCase())}function y(e,t){return e.editable&&-1===u.indexOf(e.type)&&!b(e.name,t)}function v(e,t){var r=e.editFieldsInfo,a=e.fields,n=e.objectIdField;return function(e,t){var r=e;return t&&(e=e.filter((function(e){return-1===t.indexOf(e.type)}))),e===r&&(e=e.slice()),e.sort(h),e}(a,(null==t?void 0:t.ignoreFieldTypes)||j).map((function(e){return new o.a({fieldName:e.name,isEditable:y(e,r),label:e.alias,format:m(e),visible:d(e,{editFieldsInfo:r,objectIdField:n,visibleFieldNames:null==t?void 0:t.visibleFieldNames})})}))}function m(e){switch(e.type){case"small-integer":case"integer":case"single":return new i.a({digitSeparator:!0,places:0});case"double":return new i.a({digitSeparator:!0,places:2});case"date":return new i.a({dateFormat:"long-month-day-year"});default:return null}}function g(e){return"name"===(e.name&&e.name.toLowerCase())||("name"===(e.alias&&e.alias.toLowerCase())||void 0)}var j=["geometry","blob","raster","guid","xml"]},819:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var a=r(2),n=r(3),i=r(806),o=function(){function e(t,r){Object(a.a)(this,e),this._storage=new i.c,this._storage.maxSize=t,r&&this._storage.registerRemoveFunc("",r)}return Object(n.a)(e,[{key:"put",value:function(e,t,r){this._storage.put(e,t,r,1)}},{key:"pop",value:function(e){return this._storage.pop(e)}},{key:"get",value:function(e){return this._storage.get(e)}},{key:"clear",value:function(){this._storage.clearAll()}},{key:"destroy",value:function(){this._storage.clearAll()}},{key:"maxSize",get:function(){return this._storage.maxSize},set:function(e){this._storage.maxSize=e}}]),e}()},820:function(e,t,r){"use strict";r.d(t,"a",(function(){return M})),r.d(t,"b",(function(){return y})),r.d(t,"c",(function(){return v})),r.d(t,"d",(function(){return m})),r.d(t,"e",(function(){return g})),r.d(t,"f",(function(){return I})),r.d(t,"g",(function(){return b}));var a=r(12),n=r(32),i=r(174),o=r(4),s=r(14),l=r(52),c=r(75),u=r(305),f=r(794),p=s.a.getLogger("esri.renderers.visualVariables.support.visualVariableUtils"),d=new c.a,h=Math.PI,b=/^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i;function y(e,t,r){var a="visualVariables"in e&&e.visualVariables?e.visualVariables.filter((function(e){return"color"===e.type}))[0]:e;if(a)if("esri.renderers.visualVariables.ColorVariable"===a.declaredClass){var n="number"==typeof t,i=n?null:t,s=i&&i.attributes,c=n?t:null,u=a.field,f=a.cache,d=f.ipData,h=f.hasExpression,b=a.cache.compiledFunc;if(!u&&!h){var y=a.stops;return y&&y[0]&&y[0].color}if("number"!=typeof c)if(h){if(!Object(o.i)(r)||!Object(o.i)(r.arcade))return void p.error("Use of arcade expressions requires an arcade context");var v={viewingMode:r.viewingMode,scale:r.scale,spatialReference:r.spatialReference},m=r.arcade.arcadeUtils,g=m.getViewInfo(v),j=m.createExecContext(i,g);if(!b){var w=m.createSyntaxTree(a.valueExpression);b=m.createFunction(w),a.cache.compiledFunc=b}c=m.executeFunction(b,j)}else s&&(c=s[u]);var I=a.normalizationField,M=s?parseFloat(s[I]):void 0;if(null!=c&&(!I||n||!isNaN(M)&&0!==M)){isNaN(M)||n||(c/=M);var O=x(c,d);if(O){var k=O[0],S=O[1],A=k===S?a.stops[k].color:l.a.blendColors(a.stops[k].color,a.stops[S].color,O[2],Object(o.i)(r)?r.color:void 0);return new l.a(A)}}}else p.warn("The visualVariable should be an instance of esri.renderers.visualVariables.ColorVariable")}function v(e,t,r){var a="visualVariables"in e&&e.visualVariables?e.visualVariables.filter((function(e){return"opacity"===e.type}))[0]:e;if(a)if("esri.renderers.visualVariables.OpacityVariable"===a.declaredClass){var n="number"==typeof t,i=n?null:t,s=i&&i.attributes,l=n?t:null,c=a.field,u=a.cache,f=u.ipData,d=u.hasExpression,h=a.cache.compiledFunc;if(!c&&!d){var b=a.stops;return b&&b[0]&&b[0].opacity}if("number"!=typeof l)if(d){if(Object(o.h)(r)||Object(o.h)(r.arcade))return void p.error("Use of arcade expressions requires an arcade context");var y={viewingMode:r.viewingMode,scale:r.scale,spatialReference:r.spatialReference},v=r.arcade.arcadeUtils,m=v.getViewInfo(y),g=v.createExecContext(i,m);if(!h){var j=v.createSyntaxTree(a.valueExpression);h=v.createFunction(j),a.cache.compiledFunc=h}l=v.executeFunction(h,g)}else s&&(l=s[c]);var w=a.normalizationField,I=s?parseFloat(s[w]):void 0;if(null!=l&&(!w||n||!isNaN(I)&&0!==I)){isNaN(I)||n||(l/=I);var M=x(l,f);if(M){var O=M[0],k=M[1];if(O===k)return a.stops[O].opacity;var S=a.stops[O].opacity;return S+(a.stops[k].opacity-S)*M[2]}}}else p.warn("The visualVariable should be an instance of esri.renderers.visualVariables.OpacityVariable")}function m(e,t,r){var a="visualVariables"in e&&e.visualVariables?e.visualVariables.filter((function(e){return"rotation"===e.type}))[0]:e;if(a){if("esri.renderers.visualVariables.RotationVariable"===a.declaredClass){var n=a.axis||"heading",i="heading"===n&&"arithmetic"===a.rotationType?90:0,s="heading"===n&&"arithmetic"===a.rotationType?-1:1,l="number"==typeof t?null:t,c=l&&l.attributes,u=a.field,f=a.cache.hasExpression,d=a.cache.compiledFunc,h=0;if(!u&&!f)return h;if(f){if(Object(o.h)(r)||Object(o.h)(r.arcade))return void p.error("Use of arcade expressions requires an arcade context");var b={viewingMode:r.viewingMode,scale:r.scale,spatialReference:r.spatialReference},y=r.arcade.arcadeUtils,v=y.getViewInfo(b),m=y.createExecContext(l,v);if(!d){var g=y.createSyntaxTree(a.valueExpression);d=y.createFunction(g),a.cache.compiledFunc=d}h=y.executeFunction(d,m)}else c&&(h=c[u]||0);return h="number"!=typeof h||isNaN(h)?null:i+s*h}p.warn("The visualVariable should be an instance of esri.renderers.visualVariables.RotationVariable")}}function g(e,t,r){var a="visualVariables"in e&&e.visualVariables?e.visualVariables.filter((function(e){return"size"===e.type}))[0]:e;if(a){if("esri.renderers.visualVariables.SizeVariable"===a.declaredClass){var i=function(e,t,r,a,i){switch(t.transformationType){case"additive":return function(e,t,r,a){return e+(j(t.minSize,r,a)||t.minDataValue)}(e,t,r,a);case"constant":return function(e,t,r){var a=e.stops,n=a&&a.length&&a[0].size;return null==n&&(n=e.minSize),j(n,t,r)}(t,r,a);case"clamped-linear":return function(e,t,r,a){var n=(e-t.minDataValue)/(t.maxDataValue-t.minDataValue),i=j(t.minSize,r,a),s=j(t.maxSize,r,a),l=Object(o.i)(a)?a.shape:void 0;if(e<=t.minDataValue)return i;if(e>=t.maxDataValue)return s;if("area"===t.scaleBy&&l){var c="circle"===l,u=c?h*Math.pow(i/2,2):i*i,f=u+n*((c?h*Math.pow(s/2,2):s*s)-u);return c?2*Math.sqrt(f/h):Math.sqrt(f)}return i+n*(s-i)}(e,t,r,a);case"proportional":return function(e,t,r,a){var n=Object(o.i)(a)?a.shape:void 0,i=e/t.minDataValue,s=j(t.minSize,r,a),l=j(t.maxSize,r,a);return w("circle"===n?2*Math.sqrt(i*Math.pow(s/2,2)):"square"===n||"diamond"===n||"image"===n?Math.sqrt(i*Math.pow(s,2)):i*s,s,l)}(e,t,r,a);case"stops":return function(e,t,r,a,i){var o=x(e,i),s=Object(n.a)(o,3),l=s[0],c=s[1],u=s[2];if(l===c)return j(t.stops[l].size,r,a);var f=j(t.stops[l].size,r,a);return f+(j(t.stops[c].size,r,a)-f)*u}(e,t,r,a,i);case"real-world-size":return function(e,t,r,a){var n=(Object(o.i)(a)&&a.resolution?a.resolution:1)*u.a[t.valueUnit],i=j(t.minSize,r,a),s=j(t.maxSize,r,a),l=t.valueRepresentation;return w("area"===l?2*Math.sqrt(e/h)/n:"radius"===l||"distance"===l?2*e/n:e/n,i,s)}(e,t,r,a);case"identity":return e;case"unknown":return null}}(function(e,t,r){var a="number"==typeof t,n=a?null:t,i=n&&n.attributes,s=a?t:null,l=e.cache.isScaleDriven,c=e.cache.compiledFunc;if(l){var u=Object(o.i)(r)?r.scale:void 0,d=Object(o.i)(r)?r.view:void 0;s=null==u||"3d"===d?function(e){var t=null,r=null,a=e.stops;return a?(t=a[0].value,r=a[a.length-1].value):(t=e.minDataValue||0,r=e.maxDataValue||0),(t+r)/2}(e):u}else if(!a)switch(e.inputValueType){case"expression":if(Object(o.h)(r)||Object(o.h)(r.arcade))return void p.error("Use of arcade expressions requires an arcade context");var h={viewingMode:r.viewingMode,scale:r.scale,spatialReference:r.spatialReference},b=r.arcade.arcadeUtils,y=b.getViewInfo(h),v=b.createExecContext(n,y);if(!c){var m=b.createSyntaxTree(e.valueExpression);c=b.createFunction(m),e.cache.compiledFunc=c}s=b.executeFunction(c,v);break;case"field":i&&(s=i[e.field]);break;case"unknown":s=null}if(!Object(f.d)(s))return null;if(a||!e.normalizationField)return s;var g=i?parseFloat(i[e.normalizationField]):null;return Object(f.d)(g)&&0!==g?s/g:null}(a,t,r),a,t,r,a.cache.ipData);return null==i||isNaN(i)?0:i}p.warn("The visualVariable should be an instance of esri.renderers.visualVariables.SizeVariable")}}function j(e,t,r){return null==e?null:Object(f.c)(e)?g(e,t,r):Object(f.d)(e)?e:null}function w(e,t,r){return Object(f.d)(r)&&e>r?r:Object(f.d)(t)&&e<t?t:e}function I(e,t,r){if(!(e.cache.isScaleDriven&&"3d"===r||t))return null;var a={scale:t,view:r},n=j(e.minSize,d,a),i=j(e.maxSize,d,a);if(null!=n||null!=i){if(n>i){var o=i;i=n,n=o}return{minSize:n,maxSize:i}}}function x(e,t){if(t){var r=0,a=t.length-1;return t.some((function(t,n){return e<t?(a=n,!0):(r=n,!1)})),[r,a,(e-t[r])/(t[a]-t[r])]}}function M(e,t,r){var n,o=["proportional","proportional","proportional"],s=Object(a.a)(e);try{for(s.s();!(n=s.n()).done;){var l=n.value,c=l.useSymbolValue?"symbol-value":g(l,t,r);switch(l.axis){case"width":o[0]=c;break;case"depth":o[1]=c;break;case"height":o[2]=c;break;case"width-and-depth":o[0]=c,o[1]=c;break;case"all":case void 0:case null:o[0]=c,o[1]=c,o[2]=c;break;default:Object(i.a)(l.axis)}}}catch(u){s.e(u)}finally{s.f()}return o}},828:function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return i})),r.d(t,"c",(function(){return l})),r.d(t,"d",(function(){return p})),r.d(t,"e",(function(){return u})),r.d(t,"f",(function(){return d})),r.d(t,"g",(function(){return f})),r.d(t,"h",(function(){return s})),r.d(t,"i",(function(){return c}));var a=r(32),n=r(12);function i(e,t,r){var i=function(e){for(var t=e.length;t--;)if(-1===" /-,\n".indexOf(e.charAt(t)))return!1;return!0},s=[],l=0,c=-1;do{if((c=t.indexOf("[",l))>=l){if(c>l){var u=t.substr(l,c-l);s.push([u,null,i(u)])}if(l=c+1,(c=t.indexOf("]",l))>=l){if(c>l){var f=e[t.substr(l,c-l)];f&&s.push([null,f,!1])}l=c+1}}}while(-1!==c);if(l<t.length-1){var p=t.substr(l);s.push([p,null,i(p)])}return function(e){var t,i="",l=null,c=Object(n.a)(s);try{for(c.s();!(t=c.n()).done;){var u=t.value,f=Object(a.a)(u,3),p=f[0],d=f[1],h=f[2];if(p)h?l=p:(l&&(i+=l,l=null),i+=p);else{var b=e.attributes[d];b&&(l&&(i+=l,l=null),i+=b)}}}catch(y){c.e(y)}finally{c.f()}return o(i,r)}}function o(e,t){switch("string"!=typeof e&&(e=String(e)),t){case"LowerCase":return e.toLowerCase();case"Allcaps":return e.toUpperCase();default:return e}}function s(e,t,r,a,n,i){for(var o=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],s=t/n,l=r/i,c=Math.ceil(s/2),u=Math.ceil(l/2),f=0;f<i;f++)for(var p=0;p<n;p++){for(var d=4*(p+(o?i-f-1:f)*n),h=0,b=0,y=0,v=0,m=0,g=0,j=0,w=(f+.5)*l,I=Math.floor(f*l);I<(f+1)*l;I++)for(var x=Math.abs(w-(I+.5))/u,M=(p+.5)*s,O=x*x,k=Math.floor(p*s);k<(p+1)*s;k++){var S=Math.abs(M-(k+.5))/c,A=Math.sqrt(O+S*S);A>=-1&&A<=1&&((h=2*A*A*A-3*A*A+1)>0&&(j+=h*e[(S=4*(k+I*t))+3],y+=h,e[S+3]<255&&(h=h*e[S+3]/250),v+=h*e[S],m+=h*e[S+1],g+=h*e[S+2],b+=h))}a[d]=v/b,a[d+1]=m/b,a[d+2]=g/b,a[d+3]=j/y}}function l(e){return e?{r:e[0],g:e[1],b:e[2],a:e[3]/255}:{r:0,g:0,b:0,a:0}}function c(e){var t;return null==(t=e.data)?void 0:t.symbol}function u(e){return"CIMVectorMarker"===e.type||"CIMPictureMarker"===e.type||"CIMBarChartMarker"===e.type||"CIMCharacterMarker"===e.type||"CIMPieChartMarker"===e.type||"CIMStackedBarChartMarker"===e.type}function f(e){return"CIMGradientStroke"===e.type||"CIMPictureStroke"===e.type||"CIMSolidStroke"===e.type}function p(e){return"CIMGradientFill"===e.type||"CIMHatchFill"===e.type||"CIMPictureFill"===e.type||"CIMSolidFill"===e.type||"CIMWaterFill"===e.type}function d(e){return"CIMMarkerPlacementAlongLineRandomSize"===e.type||"CIMMarkerPlacementAlongLineSameSize"===e.type||"CIMMarkerPlacementAlongLineVariableSize"===e.type||"CIMMarkerPlacementAtExtremities"===e.type||"CIMMarkerPlacementAtMeasuredUnits"===e.type||"CIMMarkerPlacementAtRatioPositions"===e.type||"CIMMarkerPlacementOnLine"===e.type||"CIMMarkerPlacementOnVertices"===e.type}},920:function(e,t,r){"use strict";r.d(t,"a",(function(){return L}));var a=r(10),n=r.n(a),i=r(21),o=r(9),s=r(2),l=r(3),c=r(5),u=r(6),f=r(0),p=(r(13),r(14)),d=r(1),h=r(73),b=r(8),y=r(23),v=r(11),m=(r(19),r(20),r(129)),g=r(16),j=r(102),w=r(33),I=r(81),x=r(56),M=r(30),O=r(819),k=r(24),S=r(132),A=function(){function e(){Object(s.a)(this,e),this.location={left:0,top:0,width:0,height:0},this._allAvailability="unknown",this.byteSize=40}return Object(l.a)(e,[{key:"getAvailability",value:function(e,t){if("unknown"!==this._allAvailability)return this._allAvailability;var r=(e-this.location.top)*this.location.width+(t-this.location.left),a=r%8,n=r>>3,i=this._tileAvailabilityBitSet;return n<0||n>i.length?"unknown":i[n]&1<<a?"available":"unavailable"}},{key:"_updateFromData",value:function(e){for(var t=this.location.width,r=this.location.height,a=!0,n=!0,i=Math.ceil(t*r/8),o=new Uint8Array(i),s=0,l=0;l<e.length;l++){var c=l%8;e[l]?(n=!1,o[s]|=1<<c):a=!1,7===c&&++s}n?this._allAvailability="unavailable":a?this._allAvailability="available":(this._allAvailability="unknown",this._tileAvailabilityBitSet=o,this.byteSize+=o.length)}}],[{key:"fromDefinition",value:function(t,r){var a=t.service.request||I.default,n=t.row,i=t.col,s=t.width,l=t.height,c={query:{f:"json"}};return r=r?Object(o.a)(Object(o.a)({},c),r):c,a(function(e){var t;if("vector-tile"===e.service.type)t="".concat(e.service.url,"/tilemap/").concat(e.level,"/").concat(e.row,"/").concat(e.col,"/").concat(e.width,"/").concat(e.height);else{var r=e.service.tileServers;t="".concat(r&&r.length?r[e.row%r.length]:e.service.url,"/tilemap/").concat(e.level,"/").concat(e.row,"/").concat(e.col,"/").concat(e.width,"/").concat(e.height)}var a=e.service.query;return a&&(t="".concat(t,"?").concat(a)),t}(t),r).then((function(e){return e.data})).catch((function(e){if(e&&e.details&&422===e.details.httpStatus)return{location:{top:n,left:i,width:s,height:l},valid:!0,data:Object(S.b)(s*l,0)};throw e})).then((function(t){if(t.location&&(t.location.top!==n||t.location.left!==i||t.location.width!==s||t.location.height!==l))throw new y.a("tilemap:location-mismatch","Tilemap response for different location than requested",{response:t,definition:{top:n,left:i,width:s,height:l}});return e.fromJSON(t)}))}},{key:"fromJSON",value:function(t){e.validateJSON(t);var r=new e;return r.location=Object.freeze(Object(k.a)(t.location)),r._updateFromData(t.data),Object.freeze(r)}},{key:"validateJSON",value:function(e){if(!e||!e.location)throw new y.a("tilemap:missing-location","Location missing from tilemap response");if(!1===e.valid)throw new y.a("tilemap:invalid","Tilemap response was marked as invalid");if(!e.data)throw new y.a("tilemap:missing-data","Data missing from tilemap response");if(!Array.isArray(e.data))throw new y.a("tilemap:data-mismatch","Data must be an array of numbers");if(e.data.length!==e.location.width*e.location.height)throw new y.a("tilemap:data-mismatch","Number of data items does not match width/height of tilemap")}}]),e}();function T(e){return"".concat(e.level,"/").concat(e.row,"/").concat(e.col,"/").concat(e.width,"/").concat(e.height)}var C,D=p.a.getLogger("esri.layers.support.TilemapCache"),L=C=function(e){Object(c.a)(r,e);var t=Object(u.a)(r);function r(e){var a;return Object(s.a)(this,r),(a=t.call(this,e))._handles=new x.a,a._pendingTilemapRequests={},a._availableLevels={},a.levels=5,a.cacheByteSize=2097152,a.request=I.default,a._prefetchingEnabled=!0,a}return Object(l.a)(r,[{key:"initialize",value:function(){var e=this;this._tilemapCache=new O.a(this.cacheByteSize),this._handles.add([this.watch(["layer.parsedUrl","layer.tileServers?"],(function(){return e._initializeTilemapDefinition()})),Object(M.a)(this,"layer.tileInfo.lods",(function(t){return e._initializeAvailableLevels(t)}),!0)]),this._initializeTilemapDefinition()}},{key:"destroy",value:function(){this._handles&&(this._handles.destroy(),this._handles=null)}},{key:"castLevels",value:function(e){return e<=2?(D.error("Minimum levels for Tilemap is 3, but got ",e),3):e}},{key:"size",get:function(){return 1<<this.levels}},{key:"fetchTilemap",value:function(e,t,r,a){var n=this;if(!this._availableLevels[e])return Object(g.t)(new y.a("tilemap-cache:level-unavailable","Level ".concat(e," is unavailable in the service")));var i=this._tmpTilemapDefinition,s=this._tilemapFromCache(e,t,r,i);if(s)return Object(g.u)(s);var l=a&&a.signal;return a=Object(o.a)(Object(o.a)({},a),{},{signal:null}),Object(g.c)((function(e,t){Object(g.r)(l,(function(){return t(Object(g.e)())}));var r=T(i),o=n._pendingTilemapRequests[r];if(!o){o=A.fromDefinition(i,a).then((function(e){return n._tilemapCache.put(r,e,e.byteSize),e}));var s=function(){return delete n._pendingTilemapRequests[r]};n._pendingTilemapRequests[r]=o,o.then(s,s)}o.then(e,t)}))}},{key:"getAvailability",value:function(e,t,r){if(!this._availableLevels[e])return"unavailable";var a=this._tilemapFromCache(e,t,r,this._tmpTilemapDefinition);return a?a.getAvailability(t,r):"unknown"}},{key:"getAvailabilityUpsample",value:function(e,t,r,a){a.level=e,a.row=t,a.col=r;var n=this.layer.tileInfo;for(n.updateTileInfo(a);;){var i=this.getAvailability(a.level,a.row,a.col);if("unavailable"!==i)return i;if(!n.upsampleTile(a))return"unavailable"}}},{key:"fetchAvailability",value:function(e,t,r,a){return this._availableLevels[e]?this.fetchTilemap(e,t,r,a).catch((function(e){return e})).then((function(a){if(a instanceof A){var n=a.getAvailability(t,r);return"unavailable"===n?Object(g.t)(new y.a("tile-map:tile-unavailable","Tile is not available",{level:e,row:t,col:r})):n}if(Object(g.n)(a))throw a;return"unknown"})):Object(g.t)(new y.a("tilemap-cache:level-unavailable","Level ".concat(e," is unavailable in the service")))}},{key:"fetchAvailabilityUpsample",value:function(e,t,r,a,n){var i=this;a.level=e,a.row=t,a.col=r;var o=this.layer.tileInfo;o.updateTileInfo(a);var s=this.fetchAvailability(e,t,r,n).catch((function(e){if(Object(g.n)(e))throw e;if(o.upsampleTile(a))return i.fetchAvailabilityUpsample(a.level,a.row,a.col,a);throw e}));return this._fetchAvailabilityUpsamplePrefetch(a.id,e,t,r,n,s),s}},{key:"_fetchAvailabilityUpsamplePrefetch",value:function(){var e=Object(i.a)(n.a.mark((function e(t,r,a,i,s,l){var c,u,f,p,d,h,b,y,v,m=this;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._prefetchingEnabled){e.next=2;break}return e.abrupt("return");case 2:if(c="prefetch-".concat(t),!this._handles.has(c)){e.next=5;break}return e.abrupt("return");case 5:return u=Object(g.d)(),l.then((function(){return u.abort()}),(function(){return u.abort()})),f=!1,p={remove:function(){f||(f=!0,u.abort())}},this._handles.add(p,c),e.next=12,Object(j.c)(10,u.signal).catch((function(){}));case 12:if(f||(f=!0,this._handles.remove(c)),!Object(g.o)(u)){e.next=15;break}return e.abrupt("return");case 15:for(d={id:t,level:r,row:a,col:i},h=Object(o.a)(Object(o.a)({},s),{},{signal:u.signal}),b=this.layer.tileInfo,y=function(e){var t=m.fetchAvailability(d.level,d.row,d.col,h);C._prefetches.push(t);var r=function(){C._prefetches.removeUnordered(t)};t.then(r,r)},v=0;C._prefetches.length<C._maxPrefetch&&b.upsampleTile(d);++v)y();case 18:case"end":return e.stop()}}),e,this)})));return function(t,r,a,n,i,o){return e.apply(this,arguments)}}()},{key:"_initializeTilemapDefinition",value:function(){if(this.layer.parsedUrl){var e=this.layer.parsedUrl,t=e.query;this._tilemapCache.clear(),this._tmpTilemapDefinition={service:{url:e.path,query:t?Object(v.C)(t):null,tileServers:this.layer.tileServers,request:this.request,type:this.layer.type},width:this.size,height:this.size,level:0,row:0,col:0}}}},{key:"_tilemapFromCache",value:function(e,t,r,a){a.level=e,a.row=t-t%this.size,a.col=r-r%this.size;var n=T(a);return this._tilemapCache.get(n)}},{key:"_initializeAvailableLevels",value:function(e){var t=this;this._availableLevels={},e&&e.forEach((function(e){return t._availableLevels[e.level]=!0}))}},{key:"test",get:function(){var e=this;return{get prefetchingEnabled(){return e._prefetchingEnabled},set prefetchingEnabled(t){e._prefetchingEnabled=t},hasTilemap:function(t,r,a){return!!e._tilemapFromCache(t,r,a,e._tmpTilemapDefinition)}}}}]),r}(w.a);L._maxPrefetch=4,L._prefetches=new m.a({initialSize:C._maxPrefetch}),Object(f.a)([Object(d.b)({constructOnly:!0,type:Number})],L.prototype,"levels",void 0),Object(f.a)([Object(h.a)("levels")],L.prototype,"castLevels",null),Object(f.a)([Object(d.b)({readOnly:!0,dependsOn:["levels"],type:Number})],L.prototype,"size",null),Object(f.a)([Object(d.b)({constructOnly:!0,type:Number})],L.prototype,"cacheByteSize",void 0),Object(f.a)([Object(d.b)({constructOnly:!0})],L.prototype,"layer",void 0),Object(f.a)([Object(d.b)({constructOnly:!0})],L.prototype,"request",void 0),L=C=Object(f.a)([Object(b.a)("esri.layers.support.TilemapCache")],L)},935:function(e,t,r){"use strict";var a,n=r(2),i=r(3),o=r(5),s=r(6),l=r(0),c=(r(13),r(24)),u=(r(14),r(15),r(1)),f=r(42),p=r(63),d=r(8),h=(r(11),r(19),r(20),r(28)),b=r(956),y=a=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var a;return Object(n.a)(this,r),(a=t.call(this,e)).altitude=45,a.azimuth=315,a.colorRamp=null,a.hillshadeType="multi-directional",a.pixelSizePower=.664,a.pixelSizeFactor=.024,a.scalingType="none",a.type="raster-shaded-relief",a.zFactor=1,a}return Object(i.a)(r,[{key:"readColorRamp",value:function(e){return Object(b.a)(e)}},{key:"clone",value:function(){return new a({hillshadeType:this.hillshadeType,altitude:this.altitude,azimuth:this.azimuth,zFactor:this.zFactor,scalingType:this.scalingType,pixelSizeFactor:this.pixelSizeFactor,pixelSizePower:this.pixelSizePower,colorRamp:Object(c.a)(this.colorRamp)})}}]),r}(h.a);Object(l.a)([Object(u.b)({type:Number,json:{write:!0}})],y.prototype,"altitude",void 0),Object(l.a)([Object(u.b)({type:Number,json:{write:!0}})],y.prototype,"azimuth",void 0),Object(l.a)([Object(u.b)({types:b.b,json:{write:!0}})],y.prototype,"colorRamp",void 0),Object(l.a)([Object(p.a)("colorRamp")],y.prototype,"readColorRamp",null),Object(l.a)([Object(u.b)({type:["traditional","multi-directional"],json:{write:!0}})],y.prototype,"hillshadeType",void 0),Object(l.a)([Object(u.b)({type:Number,json:{write:!0}})],y.prototype,"pixelSizePower",void 0),Object(l.a)([Object(u.b)({type:Number,json:{write:!0}})],y.prototype,"pixelSizeFactor",void 0),Object(l.a)([Object(u.b)({type:["none","adjusted"],json:{write:!0}})],y.prototype,"scalingType",void 0),Object(l.a)([Object(f.a)({rasterShadedRelief:"raster-shaded-relief"})],y.prototype,"type",void 0),Object(l.a)([Object(u.b)({type:Number,json:{write:!0}})],y.prototype,"zFactor",void 0);var v=y=a=Object(l.a)([Object(d.a)("esri.renderers.RasterShadedReliefRenderer")],y);t.a=v},936:function(e,t,r){"use strict";var a,n=r(2),i=r(3),o=r(5),s=r(6),l=r(0),c=(r(13),r(24)),u=(r(14),r(15)),f=r(1),p=r(42),d=r(63),h=r(8),b=r(47),y=(r(11),r(19),r(20),r(28)),v=r(956),m=r(1024),g=a=function(e){Object(o.a)(r,e);var t=Object(s.a)(r);function r(e){var a;return Object(n.a)(this,r),(a=t.call(this,e)).colorRamp=null,a.computeGamma=!1,a.dynamicRangeAdjustment=!1,a.gamma=[],a.maxPercent=null,a.minPercent=null,a.numberOfStandardDeviations=null,a.outputMax=null,a.outputMin=null,a.sigmoidStrengthLevel=null,a.statistics=[],a.histograms=null,a.useGamma=!1,a.stretchType="none",a.type="raster-stretch",a}return Object(i.a)(r,[{key:"readColorRamp",value:function(e){if(e)return Object(v.a)(e)}},{key:"writeStatistics",value:function(e,t,r){var a;null!=(a=e)&&a.length&&(Array.isArray(e[0])||(e=e.map((function(e){return[e.min,e.max,e.avg,e.stddev]}))),t[r]=e)}},{key:"readStretchType",value:function(e,t){var r=t.stretchType;return"number"==typeof r&&(r=m.a[r]),m.b.read(r)}},{key:"clone",value:function(){return new a({stretchType:this.stretchType,outputMin:this.outputMin,outputMax:this.outputMax,useGamma:this.useGamma,computeGamma:this.computeGamma,statistics:Object(c.a)(this.statistics),gamma:Object(c.a)(this.gamma),sigmoidStrengthLevel:this.sigmoidStrengthLevel,numberOfStandardDeviations:this.numberOfStandardDeviations,minPercent:this.minPercent,maxPercent:this.maxPercent,colorRamp:Object(c.a)(this.colorRamp),histograms:Object(c.a)(this.histograms),dynamicRangeAdjustment:this.dynamicRangeAdjustment})}}]),r}(y.a);Object(l.a)([Object(f.b)({types:v.b,json:{write:!0}})],g.prototype,"colorRamp",void 0),Object(l.a)([Object(d.a)("colorRamp")],g.prototype,"readColorRamp",null),Object(l.a)([Object(f.b)({type:Boolean,json:{write:!0}})],g.prototype,"computeGamma",void 0),Object(l.a)([Object(f.b)({type:Boolean,json:{write:{target:"dra"},read:{source:"dra"}}})],g.prototype,"dynamicRangeAdjustment",void 0),Object(l.a)([Object(f.b)({type:[Number],json:{write:!0}})],g.prototype,"gamma",void 0),Object(l.a)([Object(f.b)({type:Number,json:{write:!0}})],g.prototype,"maxPercent",void 0),Object(l.a)([Object(f.b)({type:Number,json:{write:!0}})],g.prototype,"minPercent",void 0),Object(l.a)([Object(f.b)({type:u.a,json:{write:!0}})],g.prototype,"numberOfStandardDeviations",void 0),Object(l.a)([Object(f.b)({type:Number,json:{read:{source:"max"},write:{target:"max"}}})],g.prototype,"outputMax",void 0),Object(l.a)([Object(f.b)({type:Number,json:{read:{source:"min"},write:{target:"min"}}})],g.prototype,"outputMin",void 0),Object(l.a)([Object(f.b)({type:Number,json:{write:!0}})],g.prototype,"sigmoidStrengthLevel",void 0),Object(l.a)([Object(f.b)({json:{type:[[Number]],write:!0}})],g.prototype,"statistics",void 0),Object(l.a)([Object(f.b)()],g.prototype,"histograms",void 0),Object(l.a)([Object(b.a)("statistics")],g.prototype,"writeStatistics",null),Object(l.a)([Object(f.b)({type:Boolean,json:{write:!0}})],g.prototype,"useGamma",void 0),Object(l.a)([Object(f.b)({type:m.b.apiValues,json:{type:m.b.jsonValues,write:m.b.write}})],g.prototype,"stretchType",void 0),Object(l.a)([Object(d.a)("stretchType",["stretchType"])],g.prototype,"readStretchType",null),Object(l.a)([Object(p.a)({rasterStretch:"raster-stretch"})],g.prototype,"type",void 0);var j=g=a=Object(l.a)([Object(h.a)("esri.renderers.RasterStretchRenderer")],g);t.a=j},940:function(e,t,r){"use strict";var a=r(10),n=r.n(a),i=r(21),o=r(12),s=r(2),l=r(3),c=r(5),u=r(6),f=r(0),p=(r(13),r(24)),d=(r(14),r(15),r(1)),h=r(50),b=r(42),y=r(63),v=r(8),m=(r(11),r(19),r(20),r(28)),g=r(37),j=(r(77),r(52)),w=r(110),I=r(254),x=r(118),M=r(149),O=r(75),k=r(1020),S=r(820),A=r(885),T=r(909),C=r(994),D=r(823),L=r(381),z=r(32),R=r(900),_=180/Math.PI,N=function(e){return e&&"esri.layers.support.PixelBlock"===e.declaredClass&&e.pixels&&e.pixels.length>0},B=new Map;function H(e,t){return B.get(t)/B.get(e)||1}function P(e){return(450-e)%360}function E(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"geographic",r=Object(z.a)(e,2),a=r[0],n=r[1],i=Math.sqrt(a*a+n*n),o=Math.atan2(n,a)*_;return o=(360+o)%360,"geographic"===t&&(o=P(o)),[i,o]}function U(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"geographic",r=e[1];"geographic"===t&&(r=P(r)),r%=360;var a=e[0];return[a*Math.cos(r/_),a*Math.sin(r/_)]}function F(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"geographic",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;if(!N(e))return e;for(var n=e.pixels,i=e.width,o=e.height,s=i*o,l=n[0],c=n[1],u=R.a.createEmptyBand(e.pixelType,s),f=R.a.createEmptyBand(e.pixelType,s),p=0,d=0;d<o;d++)for(var h=0;h<i;h++){var b,y,v,m;"vector-uv"===t?(b=E([l[p],c[p]],r),y=Object(z.a)(b,2),u[p]=y[0],f[p]=y[1],u[p]*=a):(v=U([l[p],c[p]],r),m=Object(z.a)(v,2),u[p]=m[0],f[p]=m[1],u[p]*=a,f[p]*=a),p++}var g=new R.a({pixelType:e.pixelType,width:e.width,height:e.height,mask:e.mask,validPixelCount:e.validPixelCount,maskIsAlpha:e.maskIsAlpha,pixels:[u,f]});return g.updateStatistics(),g}function Z(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(1===r||!N(e))return e;for(var a=e.clone(),n=a.pixels,i=a.width,o=a.height,s=n[0],l=n[1],c=0,u=0;u<o;u++)for(var f=0;f<i;f++)"vector-uv"===t?(s[c]*=r,l[c]*=r):s[c]*=r,c++;return a.updateStatistics(),a}B.set("meter-per-second",1),B.set("kilometer-per-hour",.277778),B.set("knots",.514444),B.set("feet-per-second",.3048),B.set("mile-per-hour",.44704);var G=r(4),J=(r(36),r(145),r(278)),V=r(18),W=(r(16),r(81),r(74)),q=r(945);r(9),r(828);Object(W.a)("esri/symbols/patterns/"),new q.a(1e3);var K;(function(){var e={}})(),new j.a([128,128,128]),new j.a("white");function X(e,t){return Q.apply(this,arguments)}function Q(){return(Q=Object(i.a)(n.a.mark((function e(t,a){var o;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=t.symbolLayers,e.t0=o,!e.t0){e.next=5;break}return e.next=5,Object(J.a)(o,function(){var e=Object(i.a)(n.a.mark((function e(t){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",function(){var e=Object(i.a)(n.a.mark((function e(t,a){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t.type,e.next="extrude"===e.t0?3:"icon"===e.t0||"line"===e.t0||"text"===e.t0?5:"path"===e.t0?7:"object"===e.t0?9:11;break;case 3:return function(e,t){e.size="number"==typeof t[2]?t[2]:0}(t,a),e.abrupt("break",11);case 5:return function(e,t){var r=Y(t);Object(G.i)(r)&&(e.size=r)}(t,a),e.abrupt("break",11);case 7:return function(e,t){var r=$(t,V.a,[e.width,void 0,e.height]);e.width=ee(t[0],e.width,1,r),e.height=ee(t[2],e.height,1,r)}(t,a),e.abrupt("break",11);case 9:return e.next=11,function(){var e=Object(i.a)(n.a.mark((function e(t,a){var o,s,l,c;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,function(){var e=Object(i.a)(n.a.mark((function e(t){var a,i,o,s,l,c,u,f,p;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.e(208).then(r.bind(null,1316));case 2:return a=e.sent,e.next=5,a.computeObjectLayerResourceSize(t,10);case 5:i=e.sent,o=t.width,s=t.height,l=t.depth,c=[o,l,s],u=1,f=0;case 12:if(!(f<3)){e.next=19;break}if(null==c[f]){e.next=16;break}return u=c[f]/i[f],e.abrupt("break",19);case 16:f++,e.next=12;break;case 19:for(p=0;p<3;p++)null==c[p]&&(c[p]=i[p]*u);return e.abrupt("return",{resourceSize:i,symbolSize:c});case 21:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()(t);case 2:o=e.sent,s=o.resourceSize,l=o.symbolSize,c=$(a,s,l),t.width=ee(a[0],l[0],s[0],c),t.depth=ee(a[1],l[1],s[1],c),t.height=ee(a[2],l[2],s[2],c);case 7:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()(t,a);case 11:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()(t,a));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Y(e){var t,r=Object(o.a)(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;if("number"==typeof a)return a}}catch(n){r.e(n)}finally{r.f()}return null}function $(e,t,r){for(var a=0;a<3;a++){var n=e[a];switch(n){case"symbol-value":return null!=r[a]?r[a]/t[a]:1;case"proportional":break;default:if(n&&t[a])return n/t[a]}}return 1}function ee(e,t,r,a){switch(e){case"proportional":return r*a;case"symbol-value":return null!=t?t:r;default:return e}}function te(){return(te=Object(i.a)(n.a.mark((function e(t,r){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t||!r){e.next=2;break}return e.abrupt("return",Object(M.h)(t)?X(t,r):void(Object(M.c)(t)&&function(e,t){var r=Y(t);if(!Object(G.h)(r))switch(e.type){case"simple-marker":e.size=r;break;case"picture-marker":var a=e.width/e.height;a>1?(e.width=r,e.height=r*a):(e.width=r*a,e.height=r);break;case"simple-line":e.width=r;break;case"text":e.font.size=r}}(t,r)));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var re=new Set(["esriMetersPerSecond","esriKilometersPerHour","esriKnots","esriFeetPerSecond","esriMilesPerHour"]),ae=new h.a({esriMetersPerSecond:"meter-per-second",esriKilometersPerHour:"kilometer-per-hour",esriKnots:"knots",esriFeetPerSecond:"feet-per-second",esriMilesPerHour:"mile-per-hour"}),ne=new h.a({beaufort_ft:"beaufort-ft",beaufort_km:"beaufort-km",beaufort_kn:"beaufort-kn",beaufort_m:"beaufort-m",beaufort_mi:"beaufort-mi",classified_arrow:"classified-arrow",ocean_current_kn:"ocean-current-kn",ocean_current_m:"ocean-current-m",simple_scalar:"simple-scalar",single_arrow:"single-arrow",wind_speed:"wind-barb"}),ie=new h.a({flow_from:"flow-from",flow_to:"flow-to"}),oe=K=function(e){Object(c.a)(r,e);var t=Object(u.a)(r);function r(e){var a;return Object(s.a)(this,r),(a=t.call(this,e)).attributeField="Magnitude",a.flowRepresentation="flow-from",a.rotationType="arithmetic",a.style="single-arrow",a.symbolTileSize=50,a.type="vector-field",a}return Object(l.a)(r,[{key:"readInputUnit",value:function(e,t){return re.has(e)?ae.fromJSON(e):null}},{key:"readOutputUnit",value:function(e,t){return re.has(e)?ae.fromJSON(e):null}},{key:"styleRenderer",get:function(){var e=this.style,t=this.attributeField,r=this._createStyleRenderer(e);return r.field=t,r}},{key:"sizeVariables",get:function(){var e=[];if(this.visualVariables){var t,r=Object(o.a)(this.visualVariables);try{for(r.s();!(t=r.n()).done;){var a=t.value;"size"===a.type&&e.push(a)}}catch(i){r.e(i)}finally{r.f()}}if(0===e.length){var n=new A.a({minSize:.2*this.symbolTileSize,maxSize:.8*this.symbolTileSize});this.visualVariables?this.visualVariables.push(n):this._set("visualVariables",[n]),e.push(n)}return e}},{key:"rotationVariables",get:function(){var e=[];if(this.visualVariables){var t,r=Object(o.a)(this.visualVariables);try{for(r.s();!(t=r.n()).done;){var a=t.value;"rotation"===a.type&&e.push(a)}}catch(i){r.e(i)}finally{r.f()}}if(0===e.length){var n=new k.a({field:"Direction",rotationType:this.rotationType});this.visualVariables?this.visualVariables.push(n):this._set("visualVariables",[n]),e.push(n)}return e}},{key:"clone",value:function(){return new K({attributeField:this.attributeField,flowRepresentation:this.flowRepresentation,rotationType:this.rotationType,style:this.style,visualVariables:Object(p.a)(this.visualVariables),inputUnit:this.inputUnit,outputUnit:this.outputUnit})}},{key:"getGraphicsFromPixelData",value:function(){var e=Object(i.a)(n.a.mark((function e(t){var r,a,i,o,s,l,c,u,f,p,d,h,b,y,v,m=arguments;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=m.length>1&&void 0!==m[1]&&m[1],a=[],i=H(this.inputUnit,this.outputUnit),o=r?F(t.pixelBlock,"vector-uv",this.rotationType,i):Z(t.pixelBlock,"vector-magdir",i),s=t.extent,l=o.mask&&o.mask.length>0,u=0,f=(s.xmax-s.xmin)/o.width,p=(s.ymax-s.ymin)/o.height,d=0;case 5:if(!(d<o.height)){e.next=22;break}h=0;case 7:if(!(h<o.width)){e.next=19;break}if(c=[s.xmin+h*f+f/2,s.ymax-d*p-p/2],l&&!o.mask[u]||!c||2!==c.length){e.next=16;break}return b={Magnitude:o.pixels[0][u],Direction:o.pixels[1][u]},y=new g.a({x:c[0],y:c[1],spatialReference:s.spatialReference}),e.next=13,Object(L.a)(y);case 13:y=e.sent[0],(v=new O.a({geometry:{type:"point",x:y.x,y:y.y,spatialReference:s.spatialReference},attributes:b})).symbol=this._getVisualVariablesAppliedSymbol(v),a.push(v);case 16:h++,u++,e.next=7;break;case 19:d++,e.next=5;break;case 22:return e.abrupt("return",a);case 23:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getSymbol",value:function(e,t){}},{key:"getSymbolAsync",value:function(){var e=Object(i.a)(n.a.mark((function e(t,r){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getSymbols",value:function(){return[]}},{key:"getClassBreakInfos",value:function(){var e;return null==(e=this.styleRenderer)?void 0:e.classBreakInfos}},{key:"getDefaultSymbol",value:function(){var e;return null==(e=this.styleRenderer)?void 0:e.defaultSymbol}},{key:"_getDefaultSymbol",value:function(e){return new x.a({path:"M14,32 14,18 9,23 16,3 22,23 17,18 17,32 z",outline:new w.a({width:0}),size:20,color:e||new j.a([0,92,230])})}},{key:"_getVisualVariablesAppliedSymbol",value:function(e){if(e){var t=this.styleRenderer&&this.styleRenderer.getSymbol(e);t=t.clone();var r=this.sizeVariables,a=this.rotationVariables;if(r&&r.length&&this.sizeVariables.forEach((function(r){return function(e,t){return te.apply(this,arguments)}(t,Object(S.a)([r],e))})),a&&a.length){var n=e.attributes.Direction;e.attributes.Direction="flow-from"===this.flowRepresentation?n:n+180,this.rotationVariables.forEach((function(r){return function(e,t,r){if(e&&null!=t)if(Object(M.h)(e)){var a=e.symbolLayers;a&&a.forEach((function(e){if(e&&"object"===e.type)switch(r){case"tilt":e.tilt=t;break;case"roll":e.roll=t;break;default:e.heading=t}}))}else Object(M.c)(e)&&("simple-marker"!==e.type&&"picture-marker"!==e.type&&"text"!==e.type||(e.angle=t))}(t,Object(S.d)(r,e),r.axis)}))}return t}}},{key:"_createStyleRenderer",value:function(e){var t={defaultSymbol:this._getDefaultSymbol(),classBreakInfos:[]};switch(e){case"single-arrow":t=this._createSingleArrowRenderer();break;case"beaufort-kn":t=this._createBeaufortKnotsRenderer();break;case"beaufort-m":t=this._createBeaufortMeterRenderer();break;case"beaufort-ft":t=this._createBeaufortFeetRenderer();break;case"beaufort-mi":t=this._createBeaufortMilesRenderer();break;case"beaufort-km":t=this._createBeaufortKilometersRenderer();break;case"ocean-current-m":t=this._createCurrentMeterRenderer();break;case"ocean-current-kn":t=this._createCurrentKnotsRenderer();break;case"simple-scalar":t=this._createSimpleScalarRenderer();break;case"wind-barb":t=this._createWindBarbsRenderer();break;case"classified-arrow":t=this._createClassifiedArrowRenderer()}return new D.a(t)}},{key:"_createSingleArrowRenderer",value:function(){return{defaultSymbol:this._getDefaultSymbol()}}},{key:"_createBeaufortKnotsRenderer",value:function(){return{defaultSymbol:this._getDefaultSymbol(new j.a([214,47,39])),classBreakInfos:this._getClassBreaks([0,1,3,6,10,16,21,27,33,40,47,55,63],[[40,146,199],[89,162,186],[129,179,171],[160,194,155],[191,212,138],[218,230,119],[250,250,100],[252,213,83],[252,179,102],[250,141,52],[247,110,42],[240,71,29]])}}},{key:"_createBeaufortMeterRenderer",value:function(){return{defaultSymbol:this._getDefaultSymbol(new j.a([214,47,39])),classBreakInfos:this._getClassBreaks([0,.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,32.7],[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,204,190],[222,227,191],[255,255,191],[255,220,161],[250,185,132],[245,152,105],[237,117,81],[232,21,21]])}}},{key:"_createBeaufortFeetRenderer",value:function(){var e=this._getDefaultSymbol(new j.a([214,47,39])),t=[0,.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,32.7];return t=t.map((function(e){return 3.28084*e})),{defaultSymbol:e,classBreakInfos:this._getClassBreaks(t,[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,204,190],[222,227,191],[255,255,191],[255,220,161],[250,185,132],[245,152,105],[237,117,81],[232,21,21]])}}},{key:"_createBeaufortMilesRenderer",value:function(){var e=this._getDefaultSymbol(new j.a([214,47,39])),t=[0,.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,32.7];return t=t.map((function(e){return 2.23694*e})),{defaultSymbol:e,classBreakInfos:this._getClassBreaks(t,[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,204,190],[222,227,191],[255,255,191],[255,220,161],[250,185,132],[245,152,105],[237,117,81],[232,21,21]])}}},{key:"_createBeaufortKilometersRenderer",value:function(){var e=this._getDefaultSymbol(new j.a([214,47,39])),t=[0,.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,32.7];return t=t.map((function(e){return 3.6*e})),{defaultSymbol:e,classBreakInfos:this._getClassBreaks(t,[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,204,190],[222,227,191],[255,255,191],[255,220,161],[250,185,132],[245,152,105],[237,117,81],[232,21,21]])}}},{key:"_createCurrentMeterRenderer",value:function(){return{defaultSymbol:this._getDefaultSymbol(new j.a([177,177,177])),classBreakInfos:this._getClassBreaks([0,.5,1,1.5,2],[[78,26,153],[179,27,26],[202,128,26],[177,177,177]])}}},{key:"_createCurrentKnotsRenderer",value:function(){return{defaultSymbol:this._getDefaultSymbol(new j.a([177,177,177])),classBreakInfos:this._getClassBreaks([0,.25,.5,1,1.5,2,2.5,3,3.5,4],[[0,0,0],[0,37,100],[78,26,153],[151,0,100],[179,27,26],[177,78,26],[202,128,26],[177,179,52],[177,177,177]])}}},{key:"_createClassifiedArrowRenderer",value:function(){var e,t=this._getDefaultSymbol(new j.a([56,168,0])),r=[0,1e-6,3.5,7,10.5,14];if(null!=(e=this.sizeVariables)&&e.length){var a=this.sizeVariables[0].minDataValue,n=this.sizeVariables[0].maxDataValue;if(a&&n){var i=(n-a)/5;r=Array.from(Array(6).keys()).map((function(e){return a+i*e}))}}return{defaultSymbol:t,classBreakInfos:this._getClassBreaks(r,[[56,168,0],[139,309,0],[255,255,0],[255,128,0],[255,0,0]])}}},{key:"_createSimpleScalarRenderer",value:function(){return{defaultSymbol:I.a.fromJSON({imageData:"iVBORw0KGgoAAAANSUhEUgAAACsAAAArCAQAAABLVLlLAAAABGdBTUEAAYagMeiWXwAAAAJiS0dEAACqjSMyAAAACXBIWXMAAABIAAAASABGyWs+AAAC3ElEQVRIx9XXvW4cVRQH8N982btpsIREJECyiCXsxX4DKh6AliqGKCBBE2SlwlHgAbBD/AKmyEYUeQ1KahPZSZQvBCkQLTHZ7KGY8Xodz4w3a1NwbzVzz/znfJ//zbStVC5q3icKak9GAs2QIdDx3PtW/S011NW3p+M5Eomh11ipTIKe6+4LQzHaQ+G+63pIZNJJQXMpljwTwj1brpgx5w1zZlyx5Z4QnllEIm2xeeSUHBf0hV0bejo1Uh09G3aFvgXk7cCJFBc9EdaRVuHJJaOdKyTV2TVhYLMduNR0Q9gxL5GaaTDw8GzejrDRBpxWoGsySRW0dttKuattwNkIlFw2YXgzOdYq4Ox49PlM+JrKd5OusjTWhBuVxUfMX/KXXZ3WEmkuqa67wspR4BTbwtKr/5u4fFgStse/T7EifFPnnYl9zPq4vmUOPrRndgoHjDti1gOPqlyXoifcRNGQzUd31lDyfHmob1Gp35vSr+P6vilcQ5Egtyd8YF/ySg9NhPM+9M/IOaHwp5+PSZayXTvCogEUwlatC3J8LLwYtcWB8EuDXQVuCkV5/B4eNHb7wGBs87LBDS+xjdVSn09wq1G8dFM+9tSUhIGneLvUdniKxKpTYljCpu3j7rVWlHj/P23v4NPGUEyeCQnexe9lJjzEQqMjJs+EzNAX6B98dBZVRmroJx95x/A/6gln18EyfCUsl+qdXb/tjvfbw+mwforpUOBz4XLVoBwAn3aWnfeH246NyBXhrq7TTN5lNSP9RkU+puUJm3W2Tsdq0nZWM07srk7MwQrZSRysjjGWBLRJNsNbfj2JMR4AbxpU1XLAb9Mxfpsq5EjMuuiR8L0JiHOOBX3hiUvOmavN0nMueSzcceFk0BK4pMqLo7vDD1Z0qrtDx7Itt4Xwm9UqbMmk8S0Dtuzb2pvOU99Z1nLTOfleNmvfZfP2pYZmPfajwosKdDBNpacNpVGGsWX9CyDI8Xq/Sj6QAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE0LTExLTEwVDAzOjE3OjU4LTA1OjAwF+tHyQAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxNC0xMS0xMFQwMzoxNzo1OC0wNTowMGa2/3UAAAAASUVORK5CYII=",height:20,width:20,type:"esriPMS",angle:0})}}},{key:"_createWindBarbsRenderer",value:function(){var e=Array.from(Array(31).keys()).map((function(e){return 5*e})),t=[{range:"0-5",path:"M20 20 M5 20 A15 15 0 1 0 35 20 A15 15 0 1 0 5 20 M20 20 M10 20 A10 10 0 1 0 30 20 A10 10 0 1 0 10 20",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTIwIDIwIE01IDIwIEExNSAxNSAwIDEgMCAzNSAyMCBBMTUgMTUgMCAxIDAgNSAyMCBNMjAgMjAgTTEwIDIwIEExMCAxMCAwIDEgMCAzMCAyMCBBMTAgMTAgMCAxIDAgMTAgMjAiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4="},{range:"5-10",path:"M25 0 L25 40 M25 35 L17.5 37.5",imageData:"PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjE1IDIwIDIwIDIwIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgogIDxwYXRoIGQ9Ik0yNSAwIEwyNSA0MCBNMjUgMzUgTDE3LjUgMzcuNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg=="},{range:"10-15",path:"M25 0 L25 40 L10 45 L25 40",imageData:"PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjkgMCAyNyA0NiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8cGF0aCBkPSJNMjUgMCBMMjUgNDAgTDEwIDQ1IEwyNSA0MCIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg=="},{range:"15-20",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L17.5 37.5",imageData:"PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjEyIDAgMTUgNDUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0NSBMMjUgNDAgTTI1IDM1IEwxNy41IDM3LjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4="},{range:"20-25",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L10 40",imageData:"PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjkgMCAyNiA0NiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8cGF0aCBkPSJNMjUgMCBMMjUgNDAgTDEwIDQ1IEwyNSA0MCBNMjUgMzUgTDEwIDQwIiBzdHlsZT0ic3Ryb2tlOnJnYigwLDAsMCk7c3Ryb2tlLXdpZHRoOjEuNSIvPgogPC9zdmc+"},{range:"25-30",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L17.5 32.5",imageData:"PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjkgMCAyNiA0NiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8cGF0aCBkPSJNMjUgMCBMMjUgNDAgTDEwIDQ1IEwyNSA0MCBNMjUgMzUgTDEwIDQwIEwyNSAzNSBNMjUgMzAgTDE3LjUgMzIuNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg=="},{range:"30-35",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjIwcHgiIHZpZXdCb3g9IjkgMCAyNiA0NiI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0NSBMMjUgNDAgTTI1IDM1IEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg=="},{range:"35-40",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L17.5 27.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjIwcHgiIHZpZXdCb3g9IjkgMCAyNiA0NiI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0NSBMMjUgNDAgTTI1IDM1IEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxNy41IDI3LjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4="},{range:"40-45",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjIwcHgiIHZpZXdCb3g9IjkgMCAyNiA0NiI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0NSBMMjUgNDAgTTI1IDM1IEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg=="},{range:"45-50",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L17.5 22.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjIwcHgiIHZpZXdCb3g9IjkgMCAyNiA0NiI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0NSBMMjUgNDAgTTI1IDM1IEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCBMMjUgMjUgTTI1IDIwIEwxNy41IDIyLjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4="},{range:"50-55",path:"M25 0 L25 40 L10 40 L25 35",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjIwcHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4="},{range:"55-60",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L17.5 32.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjIwcHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxNy41IDMyLjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4="},{range:"60-65",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg=="},{range:"65-70",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L17.5 27.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxNy41IDI3LjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4="},{range:"70-75",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg=="},{range:"75-80",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L17.5 22.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCBMMjUgMjUgTTI1IDIwIEwxNy41IDIyLjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4="},{range:"80-85",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCBMMjUgMjUgTTI1IDIwIEwxMCAyNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg=="},{range:"85-90",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25 L25 20 M25 15 L17.5 17.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCBMMjUgMjUgTTI1IDIwIEwxMCAyNSBMMjUgMjAgTTI1IDE1IEwxNy41IDE3LjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4="},{range:"90-95",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25 L25 20 M25 15 L10 20",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCBMMjUgMjUgTTI1IDIwIEwxMCAyNSBMMjUgMjAgTTI1IDE1IEwxMCAyMCIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg=="},{range:"95-100",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25 L25 20 M25 15 L10 20 L25 15 M25 10 L17.5 12.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCBMMjUgMjUgTTI1IDIwIEwxMCAyNSBMMjUgMjAgTTI1IDE1IEwxMCAyMCBMMjUgMTUgTTI1IDEwIEwxNy41IDEyLjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4="},{range:"100-105",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg=="},{range:"105-110",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L17.5 27.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDE3LjUgMjcuNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg=="},{range:"110-115",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIiBzdHlsZT0ic3Ryb2tlOnJnYigwLDAsMCk7c3Ryb2tlLXdpZHRoOjEuNSIvPgogPC9zdmc+"},{range:"115-120",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L17.5 22.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDE3LjUgMjIuNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg=="},{range:"120-125",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDEwIDI1IiBzdHlsZT0ic3Ryb2tlOnJnYigwLDAsMCk7c3Ryb2tlLXdpZHRoOjEuNSIvPgogPC9zdmc+"},{range:"125-130",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L17.5 17.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDEwIDI1IE0yNSAyMCBNMjUgMTUgTDE3LjUgMTcuNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg=="},{range:"130-135",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDEwIDI1IE0yNSAyMCBNMjUgMTUgTDEwIDIwIiBzdHlsZT0ic3Ryb2tlOnJnYigwLDAsMCk7c3Ryb2tlLXdpZHRoOjEuNSIvPgogPC9zdmc+"},{range:"135-140",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20 M25 15 M25 10 L17.5 12.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDEwIDI1IE0yNSAyMCBNMjUgMTUgTDEwIDIwIE0yNSAxNSBNMjUgMTAgTDE3LjUgMTIuNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg=="},{range:"140-145",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20 M25 15 M25 10 L17.5 12.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDEwIDI1IE0yNSAyMCBNMjUgMTUgTDEwIDIwIE0yNSAxNSBNMjUgMTAgTDEwIDE1IiBzdHlsZT0ic3Ryb2tlOnJnYigwLDAsMCk7c3Ryb2tlLXdpZHRoOjEuNSIvPgogPC9zdmc+"},{range:"145-150",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20 M25 15 M25 10 L17.5 12.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDEwIDI1IE0yNSAyMCBNMjUgMTUgTDEwIDIwIE0yNSAxNSBNMjUgMTAgTDEwIDE1IE0yNSAxMCBNMjUgNSBMMTcuNSA3LjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4="}],r=I.a.fromJSON({imageData:"iVBORw0KGgoAAAANSUhEUgAAACgAAAApCAQAAADtq6NDAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJiS0dEAP+Hj8y/AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAEY0lEQVRIx5XXWWxWRRQH8N+d+31tUdGAVjGglYJABFEBY91jfDAg7piYaFTccA++uMQEFRcSXlATtxiXqMQt4G4iisYl0ai4sIQYtVFZ1KIFKdTS0l4f7vRCS5fPebozc+bM/2z/Mzcx0AgSiUxXnKfIdMn875FIhX53U2n/B/s+kKM4UINTjTBZImixxnrv+9a2iL6zEoUBXcoudrWj/OtHm3wt02lfU9Qao9OnHvIhgmww84MEl1qnxfNmGrqHxAizLdPpC6chGcAxKGGcL+30gOERf1BSpUqVslQSV8d5ReZFe8VQ9avufJn31cWwlJV7iafKStGOE/1qvfH9qUxxu8ydUdmuSKbGO8YUdT2inKLG69pM70tliktl5qIkCAJGmusDG7Vqsc0WjZa4UBlBiA5YZIcjYzB7qDtH5kaUJFLs7RGZTZ42W4PRRmtwvbdt1+wGiaS4drEtDttdZYIDNVuAclR3vA3+dI3qHqmVSy7U6Tv1MScCPvPR7nIpFlsdCy3FdTLPGhK92e2CUITjMJ9ocwKxnsZqc3O3JwMma3d6UVLnyVxB4aXemZqvPqLdpJhW3KVVbY4yYImPo6M5Urv50fj+0z/FG9YaEiENs8UtMfXUaTeTePNHlhXfA1UU+2lyD1Il3Gtt9+adfpNG7dNlpg2U/T3KYLZ2dUWFdTgp3/rQ4sK973qnInV5TIf40x3dhvrJPBiqyWUo4wAtLqhQYS71qK+QKOFRywmGK/kpikzV6WMKhh58vGWs4TIJNjiEYLIuP8Tt4/zmLyqk+AyrJSbF+Qq1DgqRUPMxyl+9q3IQhX/rMCJ6tEunriDs1oSyQZKlr9AkhT2ZIARbJfaJS1vtVbHB+Rgi0RK/y1q1BWsEEyLoz40xtGKcARPVWB1BTPO7f4LNtpkUl1aoMbViLyZo0GRjPD3BxnxjqXeLYlvhqYrzMMG3HoyJXa3JjfnGlbYYFlP7Jh3qKsKY4hQ7TY0nG+xwRL61n63mxHtqNHosigyMLmClNwvuecFnOZB88nNBDzNkzhxEZaKMBVoKapggMzvHHXBEpNSSFAvtcFRsVn0bW8LlMmcXs+c0Kne3gRR32+zg4uXwjC6zit6Wt4a8LXVfcp/MtQXHn2ynGbuCmb8GvvFeJLEE82ReU9/n6+dkq2x3buG9Wn94smcgAw631RPR7BTH+kbmHReZoEpOdEe7zWqZl40s0JWs9Hmv7hjBHqPDwsjGKVJnWWqjbdZp1KhJi0aPmxYZsIRhlttgeF+Jlke41QcOQKoqilSb6HJzSvNG3G/UoWnxwsmt+sVaYwd63dRbqdnMyCPVeyRPvpYgdavM22oGKoMUVRbJfOWMwidJ8Zzb1UvmWK/VVUXzHaTjjrVYh1897HT7xxYEVUaa5SWb/WO+YUWa9SrwvigzM8YlzlYv2GSdVCYxxlBtVnnFq5olwp5/BEk/OLsf5LUmG2+inRJdVvjZ97ZH9/zP34ug1O91pf4p+D+JYBpvrKxfbwAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxNC0xMS0xMFQwMzoxMjowOS0wNTowMB9ViV0AAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTQtMTEtMTBUMDM6MTI6MDktMDU6MDBuCDHhAAAAAElFTkSuQmCC",height:20,width:20,type:"esriPMS",angle:0}),a=e.map((function(a,n){var i;if(n!==e.length-1)if(0===n)i={minValue:a,maxValue:e[n+1],symbol:r};else{var o=I.a.fromJSON({type:"esriPMS",imageData:t[n].imageData,contentType:"image/svg+xml",height:32,width:32,angle:0});i={minValue:a,maxValue:e[n+1],symbol:o}}return new C.a(i)}));return{defaultSymbol:r,classBreakInfos:a}}},{key:"_getClassBreaks",value:function(e,t){var r=this;return t.map((function(t,a){return new C.a({minValue:e[a],maxValue:e[a+1],symbol:r._getDefaultSymbol(new j.a(t))})}))}}]),r}(Object(T.a)(m.a));Object(f.a)([Object(d.b)({type:String,json:{write:!0}})],oe.prototype,"attributeField",void 0),Object(f.a)([Object(d.b)({type:ie.apiValues,json:{type:ie.jsonValues,read:{reader:ie.read},write:{writer:ie.write}}})],oe.prototype,"flowRepresentation",void 0),Object(f.a)([Object(d.b)({type:["geographic","arithmetic"],json:{write:!0}})],oe.prototype,"rotationType",void 0),Object(f.a)([Object(d.b)({type:ne.apiValues,json:{type:ne.jsonValues,read:{reader:ne.read},write:{writer:ne.write}}})],oe.prototype,"style",void 0),Object(f.a)([Object(d.b)({json:{write:!0}})],oe.prototype,"symbolTileSize",void 0),Object(f.a)([Object(d.b)({type:ae.apiValues,json:{type:ae.jsonValues,write:{writer:ae.write}}})],oe.prototype,"inputUnit",void 0),Object(f.a)([Object(y.a)("inputUnit")],oe.prototype,"readInputUnit",null),Object(f.a)([Object(d.b)({type:ae.apiValues,json:{type:ae.jsonValues,read:{reader:ae.read},write:{writer:ae.write}}})],oe.prototype,"outputUnit",void 0),Object(f.a)([Object(y.a)("outputUnit")],oe.prototype,"readOutputUnit",null),Object(f.a)([Object(b.a)({vectorField:"vector-field"})],oe.prototype,"type",void 0),Object(f.a)([Object(d.b)({type:D.a,dependsOn:["style","attributeField"]})],oe.prototype,"styleRenderer",null),Object(f.a)([Object(d.b)({type:A.a,dependsOn:["visualVariables","symbolTileSize"]})],oe.prototype,"sizeVariables",null),Object(f.a)([Object(d.b)({type:k.a,dependsOn:["visualVariables","rotationType"]})],oe.prototype,"rotationVariables",null);var se=oe=K=Object(f.a)([Object(v.a)("esri.renderers.VectorFieldRenderer")],oe);t.a=se},941:function(e,t,r){"use strict";var a=r(2),n=r(3),i=r(5),o=r(6),s=r(0),l=(r(13),r(14),r(15)),c=r(1),u=r(42),f=r(8),p=(r(11),r(19),r(20),r(28)),d=r(52),h=function(e){Object(i.a)(r,e);var t=Object(o.a)(r);function r(){var e;return Object(a.a)(this,r),(e=t.apply(this,arguments)).value=null,e.label=null,e.color=null,e}return r}(p.a);Object(s.a)([Object(c.b)({type:Number,json:{write:!0}})],h.prototype,"value",void 0),Object(s.a)([Object(c.b)({type:String,json:{write:!0}})],h.prototype,"label",void 0),Object(s.a)([Object(c.b)({type:d.a,json:{type:[l.a],write:!0}})],h.prototype,"color",void 0);var b,y=h=Object(s.a)([Object(f.a)("esri.renderers.support.ColormapInfo")],h),v=r(947),m=b=function(e){Object(i.a)(r,e);var t=Object(o.a)(r);function r(e){var n;return Object(a.a)(this,r),(n=t.call(this,e)).colormapInfos=null,n.type="raster-colormap",n}return Object(n.a)(r,[{key:"clone",value:function(){return new b({colormapInfos:this.colormapInfos.map((function(e){return e.toJSON()}))})}},{key:"extractColormap",value:function(){return this.colormapInfos.map((function(e){return[e.value,e.color.r,e.color.g,e.color.b,e.color.a>1?e.color.a:255*e.color.a&255]})).sort((function(e,t){return e[0]-t[0]}))}}],[{key:"createFromColormap",value:function(e,t){if(!e)return null;function r(e){return t?t[e]||"":String(e[0])}var a=5===e[0].length,n=e.sort((function(e){return e[0][0]-e[1][0]})),i=a?n.map((function(e){return y.fromJSON({value:e[0],color:e.slice(1,5),label:r(e[0])})})):n.map((function(e){return y.fromJSON({value:e[0],color:e.slice(1,4).concat([255]),label:r(e[0])})}));return new b({colormapInfos:i})}},{key:"createFromColorramp",value:function(e){var t=Object(v.b)(e,256);return b.createFromColormap(t)}}]),r}(p.a);Object(s.a)([Object(c.b)({type:[y],json:{write:!0}})],m.prototype,"colormapInfos",void 0),Object(s.a)([Object(u.a)({rasterColormap:"raster-colormap"})],m.prototype,"type",void 0);var g=m=b=Object(s.a)([Object(f.a)("esri.renderers.RasterColormapRenderer")],m);t.a=g},944:function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return i}));var a=r(9),n=r(382),i={type:n.a,json:{origins:{service:{read:{source:["tileInfo","minScale","maxScale","minLOD","maxLOD"],reader:o}}}}};function o(e,t,r,i){if(!e)return null;var o=t.minScale,s=t.maxScale,l=t.minLOD,c=t.maxLOD;if(null!=l&&null!=c)return i&&i.ignoreMinMaxLOD?n.a.fromJSON(e):n.a.fromJSON(Object(a.a)(Object(a.a)({},e),{},{lods:e.lods.filter((function(e){var t=e.level;return null!=t&&t>=l&&t<=c}))}));if(0!==o&&0!==s){var u=function(e){return Math.round(1e4*e)/1e4},f=o?u(o):1/0,p=s?u(s):-1/0;return n.a.fromJSON(Object(a.a)(Object(a.a)({},e),{},{lods:e.lods.filter((function(e){var t=u(e.scale);return t<=f&&t>=p}))}))}return n.a.fromJSON(e)}},945:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var a=r(2),n=r(3),i=r(806),o=function(){function e(t,r){Object(a.a)(this,e),this._storage=new i.c,this._storage.maxSize=t,r&&this._storage.registerRemoveFunc("",r)}return Object(n.a)(e,[{key:"put",value:function(e,t){this._storage.put(e,t,1,1)}},{key:"pop",value:function(e){return this._storage.pop(e)}},{key:"get",value:function(e){return this._storage.get(e)}},{key:"clear",value:function(){this._storage.clearAll()}},{key:"destroy",value:function(){this._storage.clearAll()}}]),e}()},969:function(e,t,r){"use strict";r.d(t,"a",(function(){return x})),r.d(t,"b",(function(){return w})),r.d(t,"c",(function(){return b})),r.d(t,"d",(function(){return j})),r.d(t,"e",(function(){return g})),r.d(t,"f",(function(){return v})),r.d(t,"g",(function(){return I}));var a=r(10),n=r.n(a),i=r(32),o=r(21),s=r(23),l=r(46),c=r(53),u=r(37),f=r(62),p=(r(77),r(54)),d=r(136),h=function(e,t){var r=(e.isWGS84||e.isWebMercator)&&(t.isWGS84||t.isWebMercator);return!(e.equals(t)||r)};function b(){return y.apply(this,arguments)}function y(){return(y=Object(o.a)(n.a.mark((function e(){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Object(d.e)()&&Object(d.f)()){e.next=2;break}return e.abrupt("return",null);case 2:return e.next=4,Object(d.g)();case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function v(e,t,r){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(e.spatialReference.equals(t))return e;var n=h(e.spatialReference,t);if(n&&!Object(d.e)())throw new s.a("rasterprojectionhelper-projectResolution","projection engine is not loaded");var i=r.center,o=new f.a({xmin:i.x-e.x/2,xmax:i.x+e.x/2,ymin:i.y-e.y/2,ymax:i.y+e.y/2,spatialReference:e.spatialReference}),l=n?Object(d.h)(o,t,a):Object(c.d)(o,t);return null==l?null:{x:l.xmax-l.xmin,y:l.ymax-l.ymin}}function m(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.01;return Object(p.c)(e)?t/Object(p.c)(e):0}function g(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],n=e.spatialReference;if(n.equals(t))return e;var o=h(n,t);if(o&&!Object(d.e)())throw new s.a("rasterprojectionhelper-projectResolution","projection engine is not loaded");var u=o?Object(d.h)(e,t,r):Object(c.d)(e,t);if(u&&a&&t.isGeographic){var f,p,b=n.isWebMercator?Object(l.d)(n).origin:null!=(f=null==(p=Object(l.d)(n))?void 0:p.valid)?f:[],y=Object(i.a)(b,2),v=y[0],g=y[1],j=m(n);j&&null!=v&&null!=g&&(Math.abs(e.x-v)<j&&Math.abs(180-u.x)<5e-4?u.x-=360:Math.abs(e.x-g)<j&&Math.abs(180+u.x)<5e-4&&(u.x+=360))}return u}function j(e,t){var r,a,n,o,f=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,p=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],b=e.spatialReference;if(b.equals(t))return e;var y=h(b,t);if(y&&!Object(d.e)())throw new s.a("rasterprojectionhelper-projectExtent","projection engine is not loaded");var v=y?Object(d.h)(e,t,f):Object(c.d)(e,t),j=null!=(r=null==(a=Object(l.d)(b))?void 0:a.origin)?r:[],w=Object(i.a)(j,2),I=w[0],x=w[1];if(v&&p&&b.isWebMercator&&t.isGeographic&&null!=I&&null!=x){var M=.001,O=1e3;if(Math.abs(e.xmin-I)<M&&Math.abs(x-e.xmax)>O&&Math.abs(180-v.xmax)<5e-4){v.xmin=-180;var k=[];k.push(new u.a(e.xmax,e.ymin,b)),k.push(new u.a(e.xmax,(e.ymin+e.ymax)/2,b)),k.push(new u.a(e.xmax,e.ymax,b));var S=k.map((function(e){return g(e,t,f)})).filter((function(e){return!isNaN(null==e?void 0:e.x)})).map((function(e){return e.x}));v.xmax=Math.max.apply(null,S)}if(Math.abs(e.xmax-x)<M&&Math.abs(I-e.xmin)>O&&Math.abs(180+v.xmin)<5e-4){v.xmax=180;var A=[];A.push(new u.a(e.xmin,e.ymin,b)),A.push(new u.a(e.xmin,(e.ymin+e.ymax)/2,b)),A.push(new u.a(e.xmin,e.ymax,b));var T=A.map((function(e){return g(e,t,f)})).filter((function(e){return!isNaN(null==e?void 0:e.x)})).map((function(e){return e.x}));v.xmin=Math.min.apply(null,T)}}var C=t.isWebMercator?Object(l.d)(t).origin:null!=(n=null==(o=Object(l.d)(t))?void 0:o.valid)?n:[],D=Object(i.a)(C,2);I=D[0],x=D[1];var L=m(t);return L&&null!=I&&null!=x&&(Math.abs(v.xmin-I)<L&&(v.xmin=I),Math.abs(v.xmax-x)<L&&(v.xmax=x)),v}function w(e,t,r){var a,n,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,f=arguments.length>5&&void 0!==arguments[5]&&arguments[5],p=arguments.length>6&&void 0!==arguments[6]?arguments[6]:[32,32];if(h(e.spatialReference,t.spatialReference)&&!Object(d.e)())throw new s.a("rasterprojectionhelper-projectResolution","projection engine is not loaded");if(!(e&&t&&r))return null;for(var b,y=e.xmin,v=e.ymin,m=e.xmax,j=e.ymax,w=e.spatialReference,I=t.spatialReference,x=null!=(a=null==(n=Object(l.d)(w))?void 0:n.valid)?a:[],M=Object(i.a)(x,2),O=M[0],k=M[1],S={x:p[0]*r.x,y:p[1]*r.y},A={cols:Math.ceil((m-y)/S.x-.1)+1,rows:Math.ceil((j-v)/S.y-.1)+1},T=S.x,C=S.y,D=[],L=!1,z=0;z<A.cols;z++){for(var R=[],_=0;_<A.rows;_++){var N=g(new u.a({x:y+T*z,y:j-C*_,spatialReference:w}),I,o);c&&(N=c.inverseTransform(N)),R.push(N),z>0&&f&&N&&b[_]&&null!=O&&N.x<b[_].x&&(N.x+=k-O),N?(D.push((N.x-t.xmin)/(t.xmax-t.xmin)),D.push((t.ymax-N.y)/(t.ymax-t.ymin))):(D.push(NaN),D.push(NaN),L=!0)}b=R}for(var B=function(e,t){var r=(e[0]+e[4]+e[4*t.cols]+e[4*t.cols+4])/4,a=(e[1]+e[5]+e[4*t.rows+1]+e[4*t.rows+5])/4;return[Math.abs(r-e[2*t.rows+2]),Math.abs(a-e[2*t.rows+3])]}(D,A),H=new Float32Array((A.cols-1)*(A.rows-1)*2*6),P=new Float32Array([-0,-1,1,-1,1,-0,1,-0,-0]),E=new Float32Array([-1,1,0,0,-1,1,1,0,0]),U=0;U<A.cols-1;U++){for(var F=0;F<A.rows-1;F++){for(var Z=U*A.rows*2+2*F,G=D[Z],J=D[Z+1],V=D[Z+2],W=D[Z+3],q=D[Z+=2*A.rows],K=D[Z+1],X=D[Z+2],Q=D[Z+3],Y=0,$=12*(F*(A.cols-1)+U),ee=0;ee<3;ee++)H[$++]=P[Y++]*G+P[Y++]*V+P[Y++]*X;Y=0;for(var te=0;te<3;te++)H[$++]=P[Y++]*J+P[Y++]*W+P[Y++]*Q;Y=0;for(var re=0;re<3;re++)H[$++]=E[Y++]*G+E[Y++]*q+E[Y++]*X;Y=0;for(var ae=0;ae<3;ae++)H[$++]=E[Y++]*J+E[Y++]*K+E[Y++]*Q}if(L)for(var ne=0;ne<H.length;ne++)isNaN(H[ne])&&(H[ne]=-1)}return{offsets:D,error:B,coefficients:H,spacing:p,size:[A.cols-1,A.rows-1]}}function I(e,t,r){var a=Math.log(e.x/t.pixelSize.x)/Math.LN2,n=Math.log(e.y/t.pixelSize.y)/Math.LN2,i=t.storageInfo.maximumPyramidLevel||0,o="down"===r?Math.floor(Math.min(a,n)):"up"===r?Math.ceil(Math.max(a,n)):Math.round((a+n)/2),s=!1;o<0?o=0:o>i&&(s=o>i+3,o=i);var l=Math.pow(2,o);return{pyramidLevel:o,pyramidResolution:new u.a({x:l*t.nativePixelSize.x,y:l*t.nativePixelSize.y,spatialReference:t.spatialReference}),excessiveReading:s}}function x(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:512,a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],n=e.extent,i=e.spatialReference,o=e.pixelSize,s=v(new u.a({x:o.x,y:o.y,spatialReference:i}),t,n);if(null==s)return{projectedPixelSize:null,scales:null,srcResolutions:null};var l=(s.x+s.y)/2,c=Object(p.c)(t),f=l*c*96*39.37,d=t.isGeographic?512/r*295828763.7958547:512/r*591657527.591555,h=!1;if(a&&(t.isGeographic||t.isWebMercator)){var b=j(n,t);h=b.xmin*b.xmax<0}var y,m=f,g=1.001;if(h){var w=(m=d)/(96*c*39.37);y=v(new u.a({x:w,y:w,spatialReference:t}),i,n)}else{y={x:o.x,y:o.y};for(var I=Math.ceil(Math.log(Math.min(e.width,e.height)/32)/Math.LN2),x=0;m<.5005*d&&x<I;)x++,m*=2,y.x*=2,y.y*=2;Math.max(m,d)/Math.min(m,d)<=g&&(m=d)}for(var M=[],O=[],k=Math.min(70.5310735,f)/g;m>=k;)M.push(m),O.push({x:y.x,y:y.y}),m/=2,y.x/=2,y.y/=2;return{projectedPixelSize:s,scales:M,srcResolutions:O}}},971:function(e,t,r){"use strict";r.d(t,"a",(function(){return f})),r.d(t,"b",(function(){return h})),r.d(t,"c",(function(){return p}));var a=r(9),n=r(175),i=r(823),o=r(941),s=r(935),l=r(936),c=r(832),u=r(940),f={key:"type",base:null,typeMap:{"unique-value":c.a,"class-breaks":i.a,"raster-colormap":o.a,"raster-stretch":l.a,"vector-field":u.a,"raster-shaded-relief":s.a}},p=Object(a.a)(Object(a.a)({},f),{},{typeMap:Object(a.a)({},f.typeMap)});delete p.typeMap["vector-field"];var d={uniqueValue:c.a,classBreaks:i.a,rasterStretch:l.a,rasterColormap:o.a,vectorField:u.a,rasterShadedRelief:s.a};function h(e,t){if(!e)return null;var r,a=(r=e)&&d[r.type]||null;if(a){var i=new a;return i.read(e,t),i}return t&&t.messages&&e&&t.messages.push(new n.a("renderer:unsupported","Renderers of type '"+(e.type||"unknown")+"' are not supported",{definition:e,context:t})),null}}}]);
//# sourceMappingURL=56.fd929ec5.chunk.js.map